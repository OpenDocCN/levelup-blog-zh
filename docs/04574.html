<html>
<head>
<title>Common Vue Problems — Debouncing Computed Properties, Back Navigation, and More</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">常见的Vue问题—去抖动计算属性、后退导航等</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/common-vue-problems-debouncing-computed-properties-back-navigation-and-more-5753fccb46d0?source=collection_archive---------4-----------------------#2020-07-03">https://levelup.gitconnected.com/common-vue-problems-debouncing-computed-properties-back-navigation-and-more-5753fccb46d0?source=collection_archive---------4-----------------------#2020-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6cb6035aaa7f68e94e45069c33f4374d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wo4TLmX90vAU8fB2"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">安库什·明达在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="10de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Vue.js让开发前端应用变得简单。然而，我们仍有可能遇到问题。</p><p id="0df2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将看看一些常见的问题，并看看如何解决它们。</p><h1 id="38c0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">去抖动计算的属性</h1><p id="cefa" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以使用Lodash <code class="fe mh mi mj mk b">debounce</code>方法来谴责setter。</p><p id="046c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2917" class="mt lf it mk b gy mu mv l mw mx">const vm = new Vue({<br/>  el: '#app',<br/>  data: {<br/>    text: ''<br/>  },<br/>  computed: {<br/>    textComputed: {<br/>      get() {<br/>        return this.text;<br/>      },<br/>      set: _.debounce((newValue) =&gt; {<br/>        this.text = newValue;<br/>      }, 500)<br/>    }<br/>  }<br/>})</span></pre><p id="3c8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们用<code class="fe mh mi mj mk b">debounce</code>方法包装我们的setter方法。</p><p id="a2cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个参数是以毫秒为单位的延迟。</p><p id="62d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以在500毫秒后<code class="fe mh mi mj mk b">this.text</code>将被设置为<code class="fe mh mi mj mk b">newValue</code>值。</p><h1 id="00c2" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">搜索框和复选框过滤器</h1><p id="41ce" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用计算出的属性来过滤数组。</p><p id="1403" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="e9b4" class="mt lf it mk b gy mu mv l mw mx">filtered() {<br/>  const result =  this.estates.filter((estate) =&gt;<br/>    estate.name == that.search;<br/>  );<br/>  if(this.checkedRegions.length || this.checkedRooms.length) {<br/>    return result.filter(estate =&gt; this.checkedRegions.includes(estate.region) || this.checkedRooms.includes(estate.rooms))<br/>  }<br/>  return result;<br/>  }<br/>}</span></pre><p id="5c04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有<code class="fe mh mi mj mk b">filtered</code>方法，它以两种方式过滤我们的代码。</p><p id="aae8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">this.checkedRegions</code>有检查过的值，所以我们可以使用<code class="fe mh mi mj mk b">filter</code>和其中的<code class="fe mh mi mj mk b">includes</code>方法来检查<code class="fe mh mi mj mk b">estate.region</code>是否有在<code class="fe mh mi mj mk b">this.checkedRegions</code>数组中的值。</p><p id="95ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以用<code class="fe mh mi mj mk b">this.checkedRooms</code>做同样的事情，它也是一个校验值数组。</p><p id="5ed2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，如果我们没有任何检查过的值，我们返回从第一个过滤器得到的值。</p><h1 id="4ce1" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Vue和jQuery</h1><p id="9f94" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Vue提供了许多使jQuery变得多余的特性。</p><p id="0c96" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，在大多数情况下，我们不应该将jQeurt放在我们的代码中。</p><h1 id="ae06" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在BootstrapVue中添加到卡组的链接</h1><p id="9dfc" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要向卡组添加链接，我们可以在<code class="fe mh mi mj mk b">b-card-body</code>中添加一个<code class="fe mh mi mj mk b">b-link</code>。</p><p id="64e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="269f" class="mt lf it mk b gy mu mv l mw mx">&lt;b-card&gt;<br/>  &lt;b-card-body&gt;<br/>    &lt;b-link to="/"&gt;<br/>      Title<br/>    &lt;/b-link&gt;<br/>    &lt;p class="card-text"&gt;<br/>       text<br/>    &lt;/p&gt;<br/>  &lt;/b-card-body&gt;<br/>&lt;/b-card&gt;</span></pre><p id="7352" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们只是在添加卡片文本之前添加它。</p><h1 id="fdd5" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">绑定到img元素的src属性</h1><p id="3553" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了绑定到图像URL，我们可以使用<code class="fe mh mi mj mk b">v-bind</code>或<code class="fe mh mi mj mk b">:</code>语法，</p><p id="2c9c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们有:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="6410" class="mt lf it mk b gy mu mv l mw mx">&lt;img :src="<!-- -->require('./assets/pic.png')<!-- -->" :alt="pic"&gt;</span></pre><p id="5eee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们也可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="4f86" class="mt lf it mk b gy mu mv l mw mx">import img from './assets/<!-- -->pic<!-- -->.png';</span><span id="9f44" class="mt lf it mk b gy my mv l mw mx">export default {<br/>  ...<br/>  data(){<br/>    return {<br/>      img<br/>    }<br/>  } <br/>  ...<br/>}</span></pre><p id="b7df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Webpack将图像视为模块。</p><p id="22b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是为什么我们可以使用<code class="fe mh mi mj mk b">require</code>或<code class="fe mh mi mj mk b">import</code>将它们包含在我们的应用程序中。</p><h1 id="b4b7" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">要求和默认导出</h1><p id="7e14" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们使用<code class="fe mh mi mj mk b">require</code>将组件包含在我们的应用程序中，我们需要访问带有<code class="fe mh mi mj mk b">default</code>属性的组件。</p><p id="fe4a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们必须写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="ef00" class="mt lf it mk b gy mu mv l mw mx">Vue.component('Header', require("./components/Header.vue").default);</span></pre><p id="3327" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是因为Vue组件代码被导出为默认导出。</p><p id="ee37" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Vue组件中，我们有:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="cf0e" class="mt lf it mk b gy mu mv l mw mx">export default {<br/>  ...<br/>}</span></pre><p id="d70b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe mh mi mj mk b">script</code>标签之间。</p><h1 id="822a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">检测Vue路由器中的后退按钮导航</h1><p id="0b48" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当我们有Vue路由器时，我们可以检查后退按钮导航。</p><p id="6753" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="ca1b" class="mt lf it mk b gy mu mv l mw mx">window.popStateDetected = false<br/>window.addEventListener('popstate', () =&gt; {<br/>  window.popStateDetected = true<br/>})</span><span id="4596" class="mt lf it mk b gy my mv l mw mx">router.beforeEach((to, from, next) =&gt; {<br/>  const isBackButton = window.popStateDetected;<br/>  window.popStateDetected = false;<br/>  if (isBackButton &amp;&amp; from.meta.something) {<br/>    next(false) <br/>    return ''<br/>  }<br/>  next()<br/>})</span></pre><p id="1b87" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以听听<code class="fe mh mi mj mk b">popstate</code>事件。</p><p id="e8ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，当检测到状态时，我们将一个全局<code class="fe mh mi mj mk b">window.popStateDetected</code>变量设置为<code class="fe mh mi mj mk b">true</code>。</p><p id="d0a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，当我们在应用程序中导航时运行导航卫士，我们可以检查<code class="fe mh mi mj mk b">window.popStateDetected</code>变量，它应该被设置为<code class="fe mh mi mj mk b">true</code>。</p><p id="4585" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在它里面，我们可以检查如果<code class="fe mh mi mj mk b">window.popStateDetected</code>是<code class="fe mh mi mj mk b">true</code>是否按下后退按钮来导航。</p><p id="e13d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以在里面做我们想做的事。</p><p id="92b9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">from.meta.something</code>是我们在路线的<code class="fe mh mi mj mk b">meta</code>属性中定义的自定义属性。</p><p id="d6f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mh mi mj mk b">next(false)</code>如果<code class="fe mh mi mj mk b">if</code>中的条件为<code class="fe mh mi mj mk b">true</code>，则停止继续导航。</p><p id="e9b9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码应该在<code class="fe mh mi mj mk b">main.js</code>里。</p><h1 id="01ff" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">在页面加载时调用Vue函数</h1><p id="824c" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">要在页面加载中调用Vue函数，我们可以在<code class="fe mh mi mj mk b">beforeMount</code>钩子中调用它。</p><p id="f504" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以写:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a5e5" class="mt lf it mk b gy mu mv l mw mx">...<br/>methods:{<br/>  getData() {...}<br/>},<br/>beforeMount(){<br/>  this.getData();<br/>},<br/>...</span></pre><p id="9a80" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们定义了<code class="fe mh mi mj mk b">getData</code>方法。</p><p id="2134" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们在<code class="fe mh mi mj mk b">beforeMount</code>钩子中调用它，这个钩子在<code class="fe mh mi mj mk b">created</code>钩子被调用之后但是在<code class="fe mh mi mj mk b">mounted</code>钩子之前被调用。</p><p id="7dbe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当组件被完全安装时调用它。</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/f75bfa9c26cd5c43de4eb2365f2f1010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2VdbeY9Zl738TZUc"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@enriq_b312?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">奥克塔维奥·福萨蒂</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="028e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="dd1f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以用Lodash <code class="fe mh mi mj mk b">debounce</code>方法公开计算的属性。</p><p id="29e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，如果在<code class="fe mh mi mj mk b">methods</code>属性中定义了组件代码，我们可以在组件代码中调用方法。</p><p id="3ca2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以检查checked和search值，并在computed property方法中相应地返回一些内容。</p></div></div>    
</body>
</html>