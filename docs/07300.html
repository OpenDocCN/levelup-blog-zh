<html>
<head>
<title>How JavaScript Closures and IIFEs Work</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript闭包和生命是如何工作的</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-javascript-closures-and-iifes-work-446320b45a8f?source=collection_archive---------13-----------------------#2021-02-07">https://levelup.gitconnected.com/how-javascript-closures-and-iifes-work-446320b45a8f?source=collection_archive---------13-----------------------#2021-02-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c7ce724ef824a148621174b4ec116c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6JvhtBc7iyDXxuyZ"/></div></div></figure><p id="011b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在2021年的前100天里，作为#100DaysOfCode的一部分，我将重新向自己介绍常见的JavaScript概念，并写博客介绍它们！在这篇文章中，我将谈谈闭包和闭包<em class="kw">以及它们在JavaScript编程中的重要性。</em></p><h1 id="d52a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">关闭</h1><p id="bcd2" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在JavaScript中，函数被认为是“一级”的，因为像其他变量一样，它们可以被赋值，作为参数传递，甚至可以从其他函数返回！因为JS函数被认为是这样的，所以每次创建它们时，它们都具有利用其作用域之外的变量的能力。这个能力被称为<strong class="ka ir"><em class="kw"/></strong>。</p><p id="aeac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">闭包指的是被封闭的函数对其周围状态的访问，即<em class="kw">词法范围</em>。例如，在这个简短的代码片段中:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5723" class="mj ky iq mf b gy mk ml l mm mn">let A = "Hello, World!"<br/>function greeting() {<br/>  console.log(A) <br/>}<br/><br/>greeting() // --&gt; Hello, World!</span></pre><p id="200a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽管<code class="fe mo mp mq mf b">A</code>没有被定义在<code class="fe mo mp mq mf b">greeting()</code>的范围之外，但是它仍然可以在函数中被访问。让我们看看如果我们在<code class="fe mo mp mq mf b">greeting()</code>函数的定义下改变<code class="fe mo mp mq mf b">A</code>的值会发生什么:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="b5c9" class="mj ky iq mf b gy mk ml l mm mn">let A = "Hello, World!"<br/>function greeting() {<br/>  console.log(A) <br/>}<br/><br/>A = "Hello, Other World!"<br/><br/>greeting() // --&gt; Hello, Other World!</span></pre><p id="0cd4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通常，这在其他语言中是不可能的。但是在JavaScript中，由于闭包，当执行<code class="fe mo mp mq mf b">greeting()</code>时，其作用域内的<code class="fe mo mp mq mf b">A</code>变量被绑定到全局<code class="fe mo mp mq mf b">A</code>变量的最新版本。于是，“你好，另一个世界！”记录到控制台。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/af953bbbb6bbcb5ea3bd5f65609c7b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JThCiDG4s8S7nYzrTSsJg.jpeg"/></div></div></figure><p id="1f09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用JS闭包最经典的例子是在一个函数内部调用另一个函数。让我们看另一个例子:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="9783" class="mj ky iq mf b gy mk ml l mm mn">function FuncA() {<br/>  let name = "Brandon" <br/>  function FuncB() {<br/>    console.log(name)<br/>  }<br/>  FuncB() <br/>}<br/><br/>FuncA() // --&gt; Brandon</span></pre><p id="c0a4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，闭包通过允许封闭的内部函数访问其周围环境中的所有内容，使代码具有功能性(双关语)。</p><p id="3dfa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你要<em class="kw">返回</em> <code class="fe mo mp mq mf b">FuncB</code>而不是仅仅调用它，那么<code class="fe mo mp mq mf b">name</code>信息仍然会因为闭包而存在。我们可以用附加变量赋值来执行:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e55e" class="mj ky iq mf b gy mk ml l mm mn">function FuncA() {<br/>  let name = "Brandon" <br/>  function FuncB() {<br/>    console.log(name)<br/>  }<br/>  return FuncB<br/>}<br/><br/>let newFunc = FuncA()<br/>newFunc() // --&gt; Brandon</span></pre><p id="1e2f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">…或双括号:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="de07" class="mj ky iq mf b gy mk ml l mm mn">function FuncA() {<br/>  let name = "Brandon" <br/>  function FuncB() {<br/>    console.log(name)<br/>  }<br/>  return FuncB<br/>}<br/><br/>FuncA()() // --&gt; Brandon</span></pre><p id="8620" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我们进入了更多的括号…</p><h1 id="7e5d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">生活</h1><p id="2130" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">IIFE(或“iffy”)代表<strong class="ka ir"> <em class="kw">立即调用函数表达式</em> </strong>。当您运行JavaScript代码时，函数语句会经历一个“创建”阶段，在这个阶段，它们已经准备好执行，但是还没有运行。这发生在“执行”阶段。但是有时候，我们不希望一个函数一直挂着，等着被执行；我们希望它一创建就能正常运行。输入生活。</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="ca52" class="mj ky iq mf b gy mk ml l mm mn">(function(name) {<br/>  console.log("Hello, " + name)<br/>}("Brandon")) // --&gt; Brandon</span></pre><p id="a9dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的例子中，我们将一个匿名函数语句放在一组额外的括号中。如果我们不这样做，就会抛出一个<code class="fe mo mp mq mf b">SyntaxError</code>,因为函数语句通常应该有一个名字。生活就是这样。IIFEs将函数<em class="kw">语句</em>转换成一个被立即调用的<em class="kw">表达式</em>。</p><h1 id="e7ae" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="3c8f" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">如果你用JavaScript编码，你已经在使用closers了。即使一个<code class="fe mo mp mq mf b">function</code>被写入一个文件，它仍然被包含在<em class="kw">全局作用域</em>中。闭包允许您将全局作用域中定义的数据与操作该数据的内部函数链接起来。</p><p id="4375" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有许多库和框架将它们的整个代码基础包装在一个函数中，以避免全局范围(IIFEs)中的值冲突。这确保了任何具有不同值的重复变量在执行时属于它们各自的上下文，防止了冲突。</p><p id="4cf4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">闭包和生命一起保护您的JavaScript程序及其数据。</p><h1 id="a650" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">资源</h1><p id="bf97" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated"><a class="ae ms" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures" rel="noopener ugc nofollow" target="_blank">闭包(MDN文档)</a></p><p id="9798" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ms" href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE" rel="noopener ugc nofollow" target="_blank">iife(MDN文档)</a></p><p id="31fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ms" rel="noopener ugc nofollow" target="_blank" href="/javascript-under-the-hood-pt-7-iifes-23b70358db73">罩下JavaScript。7:生活</a></p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="fa29" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">原载于</em><a class="ae ms" href="https://blog.mydevdiary.net/how-javascript-closures-and-iifes-work-ckkskq7ui0a4liis198zr1wcl" rel="noopener ugc nofollow" target="_blank"><em class="kw">https://blog.mydevdiary.net</em></a><em class="kw">。</em></p></div></div>    
</body>
</html>