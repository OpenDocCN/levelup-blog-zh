<html>
<head>
<title>How to Deploy a Python + Flask API on Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Heroku上部署Python + Flask API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-deploy-a-python-flask-api-on-heroku-2e5ddfd943ef?source=collection_archive---------4-----------------------#2022-01-17">https://levelup.gitconnected.com/how-to-deploy-a-python-flask-api-on-heroku-2e5ddfd943ef?source=collection_archive---------4-----------------------#2022-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0c42" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">#解释喜欢我m5</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8e8701da7040a8ca783162474790c8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xPctdBbW0lA5cGu5"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@carstyler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">泰勒B </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="9be8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi lf translated">哦，你去过那里，是吗？您的Python + Flask脚本在您的本地环境中创造了奇迹，但是部署就是不行。到处都是混乱的指令。您的脚本既不复杂也不重要，不值得AWS头痛。您只是想要一个简单、快速、方便的解决方案来让它上线运行。有人告诉你Heroku是一个伟大的想法，但你无法找到好的和简洁的指示，就如何做到这一点，而不失去一夜的睡眠。</p><p id="a73e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不再恐慌。我是来救援的！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/e32e632f7acbc3d47ecb3f3d6a81902c.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*yioeA0RfS5PBchVzMZ-pTw.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">上船吧</figcaption></figure><p id="cf12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将从头开始用Python + Flask创建一个简单的脚本，将其推送到GitHub存储库，然后部署到Heroku上。我们将使用<code class="fe lp lq lr ls b">python3</code>和<code class="fe lp lq lr ls b">pip3</code>来安装依赖项，但是同一个系统应该可以与其他Python和pip版本一起工作。</p><p id="9407" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，让我们开始吧！</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="c9e4" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">1.在GitHub上创建回购</h1><p id="c5aa" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">首先，我们需要我们的工作代码在GitHub上可用，因为这是我们将它链接到Heroku的方式。在我们的例子中，让我们称我们的库为<code class="fe lp lq lr ls b">medium-greeting-api</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nd"><img src="../Images/ffddc08561d3b216d1141e43748db52e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnaYTYKU3jaJ5JULemKuLw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">我们全新的仓库</figcaption></figure><h1 id="3181" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">2.创建venv</h1><p id="c5de" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">虚拟环境帮助我们创建一个特定于我们正在进行的项目的本地环境。Athreya Anand写了一篇很好的更长的解释，说明为什么我们应该在每个Python项目中使用它们。</p><p id="4da6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在项目文件夹中，在终端上写下:</p><pre class="kp kq kr ks gt nj ls nk nl aw nm bi"><span id="91e7" class="nn mb it ls b gy no np l nq nr">python3 -m venv venv/</span></pre><p id="3a95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您的文件夹现在应该看起来像这样:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/f36b3d2d9e16f37de9545881ba2f5aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*Gf2yEAtUbBWZpwKKfKbeog.png"/></div></figure><h1 id="76f6" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">3.启动静脉</h1><p id="5acb" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">在终端上键入以激活虚拟环境:</p><pre class="kp kq kr ks gt nj ls nk nl aw nm bi"><span id="89c7" class="nn mb it ls b gy no np l nq nr">source venv/bin/activate</span></pre><p id="81ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您现在应该看到您的终端看起来像这样:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nt"><img src="../Images/54ec0076e86a6d728e2455d4e1be3d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJC2rKWBwXqhEkbwjvK-zA.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">看左边的(venv)——这意味着它现在被激活了！</figcaption></figure><h1 id="de3c" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">4.安装烧瓶和gunicorn</h1><p id="dbd9" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated"><em class="nu"> Flask </em>是一个针对Python的微型web开发框架，易学易用。它被称为微框架，因为它是轻量级的，只提供web开发所必需的组件，比如路由、请求处理、会话等等。</p><p id="bee5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nu"> Gunicorn </em>是一个Python HTTP Web服务器网关接口(WSGI ),它与我们的Python web应用程序代码接口，以提供动态内容。换句话说，它是确保web服务器和Python web应用程序能够相互通信的桥梁。</p><p id="fb39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们使用<code class="fe lp lq lr ls b">pip3</code>来安装它们:</p><pre class="kp kq kr ks gt nj ls nk nl aw nm bi"><span id="84ad" class="nn mb it ls b gy no np l nq nr">pip3 install flask gunicorn</span></pre><h1 id="5712" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">5.创建。gitignore文件</h1><p id="5236" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">我们需要忽略<code class="fe lp lq lr ls b">.gitignore</code>上的<code class="fe lp lq lr ls b">/venv</code>文件夹，这样它就不会被推送到我们的GitHub库。您的<code class="fe lp lq lr ls b">.gitignore</code>文件应该是这样的:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="6ac7" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated"><strong class="ak"> 6。创建api.py文件</strong></h1><p id="5d3a" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">让我们最终创建我们的小应用程序！在本例中，我们将创建一个简单的API，该API返回一条带有用户提供的名称的消息。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="44e0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要测试它，您只需在终端上键入:</p><pre class="kp kq kr ks gt nj ls nk nl aw nm bi"><span id="d20b" class="nn mb it ls b gy no np l nq nr">python3 greeting.py</span></pre><p id="b149" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在您的浏览器上，您应该在索引页面上看到以下内容:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/d88a728e8926d29099e231364292041b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tsJE53KauXNf-Eglq5dzAg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">索引页</figcaption></figure><p id="369b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我们发送参数<code class="fe lp lq lr ls b">?name=Deborah</code>，这是预期的结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/d7f637cbb82a64c81856ecfab3959f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJNOqThV9uYyTZEntNLbVQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">有用！</figcaption></figure><h1 id="6b86" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">7.创建requirements.txt</h1><p id="278c" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated"><code class="fe lp lq lr ls b">requirements.txt</code>文件用于指定运行我们的项目需要哪些Python包。通常情况下，<code class="fe lp lq lr ls b">requirements.txt</code>文件位于项目的根目录下。</p><p id="894e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要创建它，我们只需在终端上键入:</p><pre class="kp kq kr ks gt nj ls nk nl aw nm bi"><span id="2cd5" class="nn mb it ls b gy no np l nq nr">pip3 freeze &gt; requirements.txt</span></pre><p id="b47a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保你仍然在你的<code class="fe lp lq lr ls b">(venv)</code>环境中。结果文件应该如下所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="884e" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">8.创建Procfile</h1><p id="eb47" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">Heroku应用程序应该包含一个<code class="fe lp lq lr ls b">Procfile</code>，这个<strong class="js iu">指定了应用程序在启动</strong>时执行的命令。你可以使用一个<code class="fe lp lq lr ls b">Procfile</code>来声明各种各样的进程类型，比如你的应用的web服务器、工作进程、时钟进程，以及在部署新版本之前运行的任务。Heroku的<code class="fe lp lq lr ls b">Procfiles</code>的完整文档可以在<a class="ae le" href="https://devcenter.heroku.com/articles/procfile" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="ecb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们的例子中，我们的<code class="fe lp lq lr ls b">Procfile</code>应该是这样的:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="09f9" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">9.将项目推送到GitHub</h1><p id="41f7" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">现在您已经拥有了在Heroku上部署所需的所有文件，您可以将它们推送到GitHub。在这个阶段，您的存储库应该是这样的，包含这4个文件:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nz"><img src="../Images/4355a0aa7df5101afe92cd3a9612b123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Txq2mXTxirkfRY1cTXOUDw.png"/></div></div></figure><h1 id="c9cb" class="ma mb it bd mc md ne mf mg mh nf mj mk ml ng mn mo mp nh mr ms mt ni mv mw mx bi translated">10.将GitHub的知识库链接到一个新的Heroku应用程序</h1><p id="70b7" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">该部署了！在Heroku上，我们只需要将您的帐户连接到您的GitHub帐户，并将存储库链接到新的Heroku应用程序。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/6cf2f24465836ff51a05be666aa85ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUCFMg32slgo6BfLNqMpcQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">搜索项目的存储库</figcaption></figure><p id="0921" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦完成，我们就可以开始部署。在Heroku的部署设置中，您可以启用自动部署，然后点击手动部署上的<code class="fe lp lq lr ls b">Deploy Branch</code>进行首次部署。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/f47e01f9ee87982189ab0836e26873ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uxQ1O30fddCSCvPG5WM0RA.png"/></div></div></figure><p id="1186" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们的例子中，我们的应用程序现在托管在<a class="ae le" href="https://medium-greeting-api.herokuapp.com/getmsg/?name=Debbie" rel="noopener ugc nofollow" target="_blank">https://medium-greeting-api.herokuapp.com</a>上。如果你导航到它，并尝试发送你的名字作为请求，例如，【https://medium-greeting-api.herokuapp.com/getmsg/? T2】name=Deborah ，我们应该得到添加了Deborah名字的消息作为响应。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/a20339eac59dda0f30fc6a43fd217784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PpktG83I2-qdha4Ar07lLg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">工作！</figcaption></figure></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="1f80" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">瞧啊！我们现在已经在Heroku上部署了一个运行正常的Python + Flask API，只需不到15分钟。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/df6e4f504546f70fe745854bb899a286.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*9000N9xOGxO11ypmR9r2AQ.gif"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">好哇</figcaption></figure><p id="497f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你有什么问题或者在这个过程中遇到什么困难吗？请在下面留下评论，我会帮你解决的。我希望这个教程已经足够清楚了，所以现在你可以部署一堆Heroku APIs了！</p><p id="060f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有兴趣看到更多这样的教程，你可以在这里查看我的#ExplainLikeI'm5系列<a class="ae le" href="https://medium.com/@ithos" rel="noopener">的其余部分</a>。编码快乐！</p><p id="5ed0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">黛比x</p></div></div>    
</body>
</html>