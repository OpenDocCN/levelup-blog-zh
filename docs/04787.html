<html>
<head>
<title>How to upload a phaser game with Webpack to Heroku (No Express)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Webpack上传phaser游戏到Heroku(无Express)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-upload-a-phaser-game-with-webpack-to-heroku-no-express-e083ab741dc3?source=collection_archive---------7-----------------------#2020-07-15">https://levelup.gitconnected.com/how-to-upload-a-phaser-game-with-webpack-to-heroku-no-express-e083ab741dc3?source=collection_archive---------7-----------------------#2020-07-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1afc1b493a8ab85f368dccb4df74edce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wl5SMm-AxLH8Nj_-EkOrRQ.png"/></div></div></figure><p id="b197" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这可能是一个非常小众的话题，但就在最近，我有一个项目需要我使用Webpack，令我惊讶的是，在如何将phaser(和Webpack)制作的游戏上传到Heroku方面，没有多少清晰明确的指南。</p><p id="a42c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以托管自己的服务器，并做所有需要的事情来运行一个游戏，只使用Webpack，所以没有理由争论和打破你的头撞向键盘，试图让你的phaser游戏运行与快速。</p><p id="a9cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以这一次我将试着写一个特别的教程，它容易理解，任何对Javascript(和JSON)有一点经验的人都可以理解。</p><p id="9228" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw">足下</em> </strong> 🦶</p><p id="c309" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从下载我们将用于本指南的材料开始。</p><p id="f2f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kx" href="https://phasertutorials.com/creating-a-phaser-3-template-part-3/" rel="noopener ugc nofollow" target="_blank">我们需要一个可以在这里下载的Webpack模板。</a>不需要做这个教程，但我强烈推荐它，以防你有什么问题。</p><p id="e174" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，<a class="ae kx" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">我们必须创建一个Heroku账户</a>并下载Heroku CLI。</p><p id="727b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您使用Linux，您可以简单地用下面这行代码安装它:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="96f1" class="lh li iq ld b gy lj lk l ll lm">sudo snap install --classic heroku</span></pre><p id="6fcb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在macOS上:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="7c44" class="lh li iq ld b gy lj lk l ll lm">brew tap heroku/brew &amp;&amp; brew install heroku</span></pre><p id="4158" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于windows，你需要<a class="ae kx" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank">来访问网站并下载。</a></p><p id="8a4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，安装完Heroku CLI后，您需要使用终端登录Heroku帐户。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="9c54" class="lh li iq ld b gy lj lk l ll lm">heroku login</span></pre><p id="e574" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">登录游戏应用程序目录后，我们将创建一个新的Heroku应用程序:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="6cc1" class="lh li iq ld b gy lj lk l ll lm">heroku create phaserGameName</span></pre><p id="7880" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">只需为您的游戏应用程序添加任何您想要使用的名称，这样您就可以记住它。</p><p id="5763" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw">设置</em> </strong> ⚙️</p><p id="1440" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在您最近下载的phaser模板中，应该有一个名为“package.json”的文件。</p><p id="e125" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用您的代码编辑器打开这个文件，让我们在最后添加一行:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="0abc" class="lh li iq ld b gy lj lk l ll lm">"heroku-run-build-script": true</span></pre><p id="75f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据Heroku文档，它将请求Heroku运行您在package.json文件的脚本部分提到的任何命令。</p><p id="501b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们必须对脚本部分中的“start”行进行一些更改。我们将让Heroku绑定Heroku-dyno创建的任何端口，并默认使用公共IP地址，而不是请求端口8000。</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="bacc" class="lh li iq ld b gy lj lk l ll lm">“start”: “npm run build &amp;&amp; webpack-dev-server --host=0.0.0.0 --port=$PORT”</span></pre><p id="882d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您的package.json应该如下所示:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2f41" class="lh li iq ld b gy lj lk l ll lm">{<br/>  "name": "StarTrooper",<br/>  "version": "1.0.0",<br/>  "description": "A Phaser 3 Space Shooter Game",<br/>  "main": "src/index.js",<br/>  "scripts": {<br/>    "build": "webpack",<br/>    "start": "npm run build &amp;&amp; webpack-dev-server --host=0.0.0.0 --port=$PORT"<br/>  },<br/>  "repository": {<br/>    "type": "git",<br/>    "url": "git+<a class="ae kx" href="https://github.com/idgm5/shootergame.git" rel="noopener ugc nofollow" target="_blank">https://github.com/idgm5/shootergame.git</a>"<br/>  },<br/>  "license": "MIT",<br/>  "licenseUrl": "<a class="ae kx" href="http://www.opensource.org/licenses/mit-license.php" rel="noopener ugc nofollow" target="_blank">http://www.opensource.org/licenses/mit-license.php</a>",<br/>  "bugs": {<br/>    "url": "<a class="ae kx" href="https://github.com/idgm5/shootergame.git/issues" rel="noopener ugc nofollow" target="_blank">https://github.com/idgm5/shootergame.git/issues</a>"<br/>  },<br/>  "homepage": "<a class="ae kx" href="https://github.com/idgm5/shootergame" rel="noopener ugc nofollow" target="_blank">https://github.com/idgm5/shootergame</a>",<br/>  "devDependencies": {<br/>    "canvas": "^2.1.0",<br/>    "phaser": "^3.3.0",<br/>    "raw-loader": "^0.5.1",<br/>    "webpack": "^3.12.0",<br/>    "webpack-dev-server": "^2.11.0"<br/>  },<br/>  "heroku-run-build-script": true<br/>}</span></pre><p id="ee1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在将应用程序上传到Heroku之前，因为我们使用的是devDependencies而不是Dependencies，所以我们必须请求Heroku安装Package.json文件中指定的任何依赖项。</p><p id="85d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以通过在终端中运行以下命令来做到这一点:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="2533" class="lh li iq ld b gy lj lk l ll lm">heroku config:set NPM_CONFIG_PRODUCTION=false</span></pre><p id="5ea7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">注意:不建议用于生产发布。</em></p><p id="6ef3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kw">上传时间</em> </strong> ☁️</p><p id="f353" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上传应用程序后，您会看到Heroku正在使用Webpack构建应用程序:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/709a881a4c8b4c5d97e94daaca9a4244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ZGIGl-VYpblMBVW92QFFQ.png"/></div></div></figure><p id="278e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在网络浏览器中打开你的应用程序，哇！✨</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/b73259fc320e886f356b8ac926249e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*bRjA0DuzZShKWlZJmJnUfA.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">坏了！😭</figcaption></figure><p id="9300" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据<a class="ae kx" href="https://help.crossbrowsertesting.com/faqs/testing/invalid-host-header-error/" rel="noopener ugc nofollow" target="_blank"> smart bear </a>的说法，这种错误最常见的原因是应用服务器的错误配置导致其拒绝非本地连接。</p><p id="a392" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个快速的解决方法就是在“start”的末尾增加这一行:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="657b" class="lh li iq ld b gy lj lk l ll lm">--disable-host-check</span></pre><p id="4d00" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它应该是这样的:</p><pre class="ky kz la lb gt lc ld le lf aw lg bi"><span id="648b" class="lh li iq ld b gy lj lk l ll lm">"start": "npm run build &amp;&amp; webpack-dev-server --host=0.0.0.0 --port=$PORT --disable-host-check"</span></pre><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/c4bef9f2da7b336e6d6bd03ee22c4daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*aJPD3cvovuSunPP747T0tQ.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">这是一个游戏，我前几天做的。请尝试一下:【http://startrooper.herokuapp.com/ T2】</figcaption></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="73ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">现在，如果你更新你的代码并将修改提交给Heroku，它应该可以工作了——祝贺你！</strong>🎉</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="mb mc l"/></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="162c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你想看更多的教程吗？ <a class="ae kx" href="https://twitter.com/idgm5" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">用tweet </strong> </a> <strong class="ka ir">或</strong> <a class="ae kx" href="http://github.com/idgm5" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">告诉我如果你有任何问题请在Github </strong> </a> <strong class="ka ir">上给我发消息！📣</strong></p></div></div>    
</body>
</html>