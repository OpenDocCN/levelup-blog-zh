<html>
<head>
<title>How To Send A Direct Slack Message With Node</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用节点发送直接松弛消息</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-send-a-direct-slack-message-with-node-8e88c5ea4e4d?source=collection_archive---------7-----------------------#2020-06-01">https://levelup.gitconnected.com/how-to-send-a-direct-slack-message-with-node-8e88c5ea4e4d?source=collection_archive---------7-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/7207c3f834d1119811bad1e06d7fd335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhyF9cPQ_rDnTaTYn1zbAQ.png"/></div></div></figure><div class=""/><div class=""><h2 id="e220" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">这篇文章假设你已经安装了一个Slack应用程序，并且对Slack和Node有基本的了解。</h2></div><p id="c439" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们的目标是从我们的机器人那里获得一个直接的信息给用户。该消息应该出现在机器人的直接消息通道中，而不是Slackbot通道中。假设这个应用叫做<em class="lp">consolidotlog</em>，我们的最终结果应该是这样的。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/5faa1c56e2ed0406c928b757cb990531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*Z3T1pQH5-KRM52ReeYsTaA.png"/></div></figure><p id="5dbc" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在<a class="ae lv" href="https://slack.com" rel="noopener ugc nofollow" target="_blank"> Slack </a>上打开你的应用。在页面左侧找到<em class="lp">功能</em> = &gt; <em class="lp"> OAuth &amp;权限</em>。</p><p id="4e3f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在范围下，启用<strong class="kv jf">聊天:写</strong>。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lw"><img src="../Images/20f63d6ce8fcfc45be2e3b30e7774415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6c-P9hWLuXfrEDr82fuWfg.png"/></div></div></figure><p id="d2e0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">保存，然后滚动到页面顶部。按下<em class="lp">重新安装App </em>。重新安装应用程序后，复制您的<strong class="kv jf"> OAuth令牌</strong>。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lx"><img src="../Images/676b53e889d75b1ecd844513acaac39a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uK199-nD4QgMPdLFh2RgFQ.png"/></div></div></figure><p id="9e25" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">最后，我们需要<strong class="kv jf">客户端签名密码</strong>，它可以在您的应用程序基本信息页面上找到。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ly"><img src="../Images/ebf57507f7a3fd33b38f631ad75b7e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KHptMN8kyLRJTknMTIIJew.png"/></div></div></figure><h2 id="8151" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">获取用户ID作为postMessage函数的通道进行输入</h2><p id="823f" class="pw-post-body-paragraph kt ku je kv b kw ms kf ky kz mt ki lb lc mu le lf lg mv li lj lk mw lm ln lo im bi translated">用户ID是Slack知道如何从你的应用程序而不是Slackbot直接发送消息的方式。<em class="lp">用户ID </em>放在<code class="fe mx my mz na b">postMessage</code>函数的<code class="fe mx my mz na b">channel</code>属性中。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/db741dc0ed3c5f1b9bf546f3e88fc6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*jwiwS41ZqZmmknAsMHp5hw.png"/></div></figure><p id="f3c6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在公共制作应用程序中，你手头会有这些信息。它将包含在用户安装您的应用程序时发生的握手中。在这种情况下，您可以保存它，这样就可以在没有用户输入的情况下启动操作。</p><p id="b67e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但是在开发过程中，你可能手头没有用户id。因此，您需要<a class="ae lv" href="https://medium.com/@PhilipAndrews/how-to-list-slack-users-with-node-7121a55efde8" rel="noopener">获得您在</a>中工作的Slack工作区的用户列表。请单击该链接了解具体操作方法。</p><p id="c68b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">一旦您有了想要开始直接聊天的用户的id，请继续下一步。</p><p id="ab2e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">将这段代码插入到你选择的编辑器中，点击run，你会看到一条新的消息从应用程序直接弹出给用户。</p><pre class="lr ls lt lu gt nc na nd ne aw nf bi"><span id="9528" class="lz ma je na b gy ng nh l ni nj">const { App } = require('<strong class="na jf">@slack/bolt</strong>')</span><span id="cfe6" class="lz ma je na b gy nk nh l ni nj">const app = new App({<br/>  token: <strong class="na jf"><em class="lp">OAUTH TOKEN</em></strong>,<br/>  signingSecret: <strong class="na jf"><em class="lp">CLIENT SIGNING SECRET</em></strong><br/>});</span><span id="7667" class="lz ma je na b gy nk nh l ni nj">(async () =&gt; {<em class="lp"><br/></em>  const result = await app.client.chat.<strong class="na jf">postMessage</strong>({<br/><em class="lp">    </em>token: <strong class="na jf"><em class="lp">OAUTH TOKEN,<br/>    </em></strong>channel: <strong class="na jf"><em class="lp">USER ID</em></strong>,<br/>    text: 'hello world'<br/>  });<br/>  console.log(result)<br/>})();</span></pre><p id="ee5e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">返回值如下所示:</p><pre class="lr ls lt lu gt nc na nd ne aw nf bi"><span id="951f" class="lz ma je na b gy ng nh l ni nj">{<br/>  ok: true,<br/>  channel: 'ALJKLK****',<br/>  ts: '1590880123.000400',<br/>  message: {<br/>    bot_id: 'GGTGTG****',<br/>    type: 'message',<br/>    text: {....<br/>    user: 'LSKDFL****',<br/>    ts: '1590880123.000400',<br/>    team: 'LKJL****',<br/>    bot_profile: {<br/>      id: 'EWEWEWE*****',<br/>      deleted: false,<br/>      name: 'ConsoleDotLog',<br/>      updated: 1590807463,<br/>      app_id: 'BBMJMMM****',<br/>      icons: [Object],<br/>      team_id: 'T0BHC03D0'<br/>    }<br/>  },<br/>  response_metadata: {<br/>    scopes: [<br/>      'incoming-webhook',<br/>      'chat:write',<br/>      'files:write',<br/>      'im:write',<br/>      'im:read',<br/>      'files:read',<br/>      'users:read'<br/>    ],<br/>    acceptedScopes: [ 'chat:write' ]<br/>  }<br/>}</span></pre><p id="08b5" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">完全松弛文档:<a class="ae lv" href="https://api.slack.com/methods/chat.postMessage" rel="noopener ugc nofollow" target="_blank">松弛文档后消息</a></p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="fcc3" class="ns ma je bd mb nt nu nv me nw nx ny mh kk nz kl mk kn oa ko mn kq ob kr mq oc bi translated">开发无服务器时，希望恢复您的控制台日志吗？签出树枝…</h1><figure class="lr ls lt lu gt iv gh gi paragraph-image"><a href="https://www.twig.im/"><div class="gh gi od"><img src="../Images/36a4b9f9e789e19a238bbaa9a45b7975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zOVO7JmICUotRiX95LCOKA.jpeg"/></div></a></figure></div></div>    
</body>
</html>