<html>
<head>
<title>How to Build a Secure Login Page in PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用PHP构建一个安全的登录页面</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-build-a-secure-login-page-in-php-954f51d08701?source=collection_archive---------1-----------------------#2020-06-12">https://levelup.gitconnected.com/how-to-build-a-secure-login-page-in-php-954f51d08701?source=collection_archive---------1-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f8c9c8df91c93bfacda9a2bb3f8b901e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jD9ejR1cF4cNw4dc6Vg0Nw.jpeg"/></div></div></figure><p id="a2e7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">几乎每个移动、桌面和web应用程序都要求用户在访问服务之前进行身份验证。在创建登录页面时，一些开发人员更关注设计和视觉元素，却忘记了实现安全措施。</p><p id="f20b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">登录系统应该避免安全漏洞，如SQL注入或会话劫持。这可以通过在创建登录页面时使用准备好的语句、适当的输入验证、会话管理、密码散列和其他<a class="ae kz" href="https://wiki.sei.cmu.edu/confluence/display/seccode/Top+10+Secure+Coding+Practices?focusedCommentId=88044413" rel="noopener ugc nofollow" target="_blank">安全实践</a>来实现。</p><p id="2ea7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，您将学习如何创建一个可以在任何应用程序中使用的安全PHP登录页面。</p><p id="46db" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们将用PHP构建安全登录页面的过程分解成几个简单、易于遵循的步骤。</p><h1 id="8186" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">创建登录表单</h1><p id="b478" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">第一步是创建一个HTML登录表单，接受用户的登录凭证。你可以使用下面的代码片段，并把它放在一个名为login.php的新文件中</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/767c9c8550ac3a31e35f356130dedba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DIo40BAg6rUWiRBr.png"/></div></div></figure><h1 id="f03c" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">设置表单样式</h1><p id="80cf" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">接下来，我们对标题和错误消息应用一些额外的CSS样式。您可以使用下面的代码片段作为设计表单和输入字段样式的基础。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/45d9b7c836a40d0f99b5eebc466560ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/0*7B7e_vwmUgBpC-OD.png"/></div></figure><h1 id="fe1e" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">创建用户表</h1><p id="a54e" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">下一步是创建一个数据库，存储所有注册用户的信息。在这里，您需要使用一个数据库管理应用程序来访问MySQL，比如<a class="ae kz" href="https://www.phpmyadmin.net/" rel="noopener ugc nofollow" target="_blank"> phpMyAdmin </a>。</p><p id="ad8e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您只需要创建一个accounts表，其中有四列用于保存用户ID、用户名、电子邮件和密码。</p><p id="161f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以使用以下SQL语句来生成此表:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/9bc898ec743796b29dce74fc00071824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/0*RFWJutOYGwU35bFX.png"/></div></figure><h1 id="2a5f" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">连接到数据库</h1><p id="147e" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">创建完用户表后，需要创建一个PHP配置脚本来连接MySQL数据库。</p><p id="ad33" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为此，请将以下代码放在名为config.php的新文件中</p><p id="2d75" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里，在测试服务器连接之前，您必须用自己的参数替换连接参数。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mk"><img src="../Images/eb07f31be0dc97a4f17dfddaa05e0241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8iLTkEyAVDSvKYyu.png"/></div></div></figure><p id="a277" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">用您的数据库名称替换数据库名称“logintest ”,用您的数据库用户名替换用户名“root”。您还必须指定数据库密码(如果有)。</p><h1 id="c872" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">实现登录功能</h1><p id="8a6c" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">一旦成功连接到数据库，现在就可以实现身份验证逻辑了。</p><p id="3056" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里，首先检查用户是否使用isset()方法在登录表单中提供了输入。</p><p id="43d0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果用户没有填写必填字段就单击登录按钮，则会返回错误。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/78c4833b775fb57c67261f4417486314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/0*-gK5Vaggh_atLKRE.png"/></div></figure><p id="9e4b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们添加代码片段来检查用户提供的登录凭证是否与数据库中的相匹配。</p><p id="09e9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将这段代码添加到login.php文件的顶部。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mm"><img src="../Images/dcf2e5c643791a88fceac83de785be6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EXj9QWEv2CXJNPUz.png"/></div></div></figure><p id="3b3a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">password_verify函数还用于将提供的电子邮件和密码与数据库中的进行比较。这有助于防止登录期间的计时攻击。</p><p id="84d1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果用户名和密码组合不匹配，系统将返回错误。</p><p id="3f68" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">注意上面代码中的<a class="ae kz" href="https://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php" rel="noopener ugc nofollow" target="_blank"> PHP预准备语句</a>是如何用来防止SQL注入的。</p><h1 id="fc1f" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">创建欢迎页面</h1><p id="40c0" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">接下来，使用下面的代码片段创建一个欢迎页面，用户在成功登录后将被重定向到该页面。您可以将该文件命名为welcome.php</p><p id="2ea8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上面的代码示例中，<a class="ae kz" href="https://www.inanimatt.com/php-output-escaping.html" rel="noopener ugc nofollow" target="_blank"> html specialchars()函数</a>用于在浏览器上显示数据之前对数据进行转义。这将对来自用户的可能包含旨在发起攻击的恶意数据的输入进行过滤。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mn"><img src="../Images/5bfc20bca37349a7dc1ed571efbc4100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*durO6u-Z5yU3OuET.png"/></div></div></figure><p id="8871" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所有特殊字符都会被转义，以确保浏览器不会执行恶意脚本。</p><h1 id="d027" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">添加注销脚本</h1><p id="d2dd" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">最后，我们创建一个允许用户退出应用程序的脚本。注销脚本应该销毁一个实时会话，并将用户重定向到登录页面。</p><p id="9bb1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以将下面的代码添加到一个单独的文件中，并将其命名为logout.php</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/1e50923a9eddfd4ef7e5ae1d40ab2ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/0*D-qfYiMEbb9Z5eC5.png"/></div></figure><p id="831e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此时，您可以在浏览器中测试您的登录页面，看看一切是如何工作的。</p><p id="d916" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您还可以考虑实现额外的逻辑，允许用户验证他们的电子邮件地址、重置密码等等。</p></div></div>    
</body>
</html>