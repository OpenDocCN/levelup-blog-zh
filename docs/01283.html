<html>
<head>
<title>A First Look at Vue3 — A Composition API Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue3初探——一个组合API教程</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-first-look-at-vue3-composition-api-3154c6ea2c26?source=collection_archive---------2-----------------------#2019-12-11">https://levelup.gitconnected.com/a-first-look-at-vue3-composition-api-3154c6ea2c26?source=collection_archive---------2-----------------------#2019-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/fc5b4fdeac731c01eb976c3170914f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-_yFveb4fQ7K7hVM"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创作者</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="86a4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然Vue 3还没有完全出来，但是仍然有一些部分可以在Vue 2项目中实现。许多开发人员一直在探索的最流行的特性之一是复合API。</p><p id="1444" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">实际上，在现有项目中开始使用它非常容易——所以我们不要浪费时间，直接开始吧。</p><h1 id="b4d3" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">那么什么是组合API呢？</h1><p id="647d" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">通过将特定特性(例如搜索)的所有代码分组在一起，组合API允许更直观地定义反应式组件逻辑。</p><p id="1f3c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与当前的API相比，新组件API的结构在几个组件之间也更具可伸缩性和可重用性。</p><p id="11fe" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从本质上讲，它允许将组件逻辑组合到一个整洁的小组合函数中，这些函数可以在组件之间重用。</p><p id="10e1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想了解更多关于组合API的技术细节，我肯定会继续下去，查看更深入解释它的<a class="ae jg" href="https://vue-composition-api-rfc.netlify.com/#basic-example" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h1 id="878c" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">组合API示例</h1><p id="52e4" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">对于这个例子，我们将创建一个简单的杂货列表组件，它显示杂货列表并允许用户添加/删除商品。</p><p id="e44f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们看看使用当前的Vue 2 API会是什么样子。</p><figure class="mh mi mj mk gt iv"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="a0de" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是维护购物清单项目的功能。现在想象一下我们可能希望这个组件具有的所有其他特性:搜索、排序、价格匹配等。</p><p id="3d0b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这应该只是显示这样一个简单的应用程序。</p><figure class="mh mi mj mk gt iv gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/341bcf1c3e99aa734be0877c6b77d1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*TYuRc94I5n4ezbFOD8C0Xg.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">生成的网页。</figcaption></figure><p id="37d3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有这些特性都会给组件的数据和方法部分添加大量代码，并使跟踪单个特性变得更加困难。这就是组合API发挥作用的地方。</p><h1 id="6db1" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">实现组合API</h1><p id="72c4" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在，让我们将它转换成包含新的组合API。首先，我们必须使用<code class="fe mo mp mq mr b">npm install --save @vue/composition-api</code>来安装它</p><p id="6d97" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，为了将它实际导入到您的项目中——我们必须将它包含在<code class="fe mo mp mq mr b">main.js</code>文件中。为此，只需添加以下几行:</p><pre class="mh mi mj mk gt ms mr mt mu aw mv bi"><span id="307f" class="mw lf jj mr b gy mx my l mz na">import VueCompositionApi from '@vue/composition-api' </span><span id="e263" class="mw lf jj mr b gy nb my l mz na">Vue.use(VueCompositionApi)</span></pre><p id="0000" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将展示这个新组件，然后进一步分解它。</p><figure class="mh mi mj mk gt iv"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="6508" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这应该与我们创建的第一个组件具有完全相同的功能。</p><h1 id="3655" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">等等，这是怎么回事？</h1><p id="8f6e" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">您可能会注意到脚本的组织看起来完全不同。让我们深入了解一下。</p><p id="fa36" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，<code class="fe mo mp mq mr b">data</code>和<code class="fe mo mp mq mr b">methods</code>选项完全消失了，取而代之的是这个新的<code class="fe mo mp mq mr b">setup</code>方法。这个方法在生命周期钩子<code class="fe mo mp mq mr b">beforeCreate</code>之后、<code class="fe mo mp mq mr b">create</code>之前被调用。</p><p id="92a7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然您可以在这个setup方法中声明state变量和方法，但是这个示例的工作方式是将所有的杂货列表功能都包含在它自己的方法中。这也可以从可重复使用的外部文件导入。这个方法所要做的就是从其他方法返回它希望可见的变量和函数。</p><pre class="mh mi mj mk gt ms mr mt mu aw mv bi"><span id="6dfc" class="mw lf jj mr b gy mx my l mz na">setup() {<br/>    const { state, addGrocery, deleteGrocery } = useGroceryList();</span><span id="b67e" class="mw lf jj mr b gy nb my l mz na">    return { state, addGrocery, deleteGrocery };<br/>}</span></pre><p id="2720" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，就有了这个<code class="fe mo mp mq mr b">state</code>可变的东西。需要注意的一件重要事情是，它指向电抗值，这是Vue3的变化之一，能够直接控制暴露哪些电抗元素。虽然这并不意味着我们必须在模板中引用变量作为<code class="fe mo mp mq mr b">state.input</code>,但它给了我们更多的精度，让我们确切地看到从每个方法中导出了什么。</p><pre class="mh mi mj mk gt ms mr mt mu aw mv bi"><span id="9f58" class="mw lf jj mr b gy mx my l mz na">let state = reactive({<br/>    input: "",<br/>    groceries: []<br/>});</span></pre><p id="2293" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们不必在组件的一个宽泛的<code class="fe mo mp mq mr b">methods</code>选项中声明我们所有的函数，我们只需在我们的<code class="fe mo mp mq mr b">useGroceryList</code>方法中声明它们，并将它们组合在一起。当一个组件中有许多不同的特性和方法时，这是非常有用的。</p><pre class="mh mi mj mk gt ms mr mt mu aw mv bi"><span id="4233" class="mw lf jj mr b gy mx my l mz na">function addGrocery() {<br/>    state.groceries.push(state.input);<br/>    state.input = "";<br/>}</span><span id="4512" class="mw lf jj mr b gy nb my l mz na">function deleteGrocery(index) {<br/>    state.groceries.splice(index, 1);<br/>}</span><span id="2689" class="mw lf jj mr b gy nb my l mz na">return { state, addGrocery, deleteGrocery };</span></pre><p id="9303" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">重要的是，我们希望能够从模板中访问的所有内容都由<em class="nc"/><code class="fe mo mp mq mr b">useGroceryList()</code>和<code class="fe mo mp mq mr b">setup()</code>方法返回。</p><h1 id="883c" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">这怎么更好？</h1><p id="552d" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">与Vue 2当前用于实现组件逻辑的API相比，使用组合API有三大优势:可读性、可伸缩性和熟悉性。</p><h2 id="9a39" class="mw lf jj bd lg nd ne dn lk nf ng dp lo kr nh ni ls kv nj nk lw kz nl nm ma nn bi translated">1.可读性</h2><p id="7027" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在Vue 2中，每个组件都有许多不同的部分，这些部分是成功拥有反应逻辑所必需的:数据、计算、方法等等。</p><p id="054a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在具有数百/数千行代码的大型应用程序中，这些部分可能彼此相距很远，这使得跟踪代码和调试声明、逻辑等变得更加困难。</p><p id="fd20" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">组合函数包含了所有的声明和逻辑——使得代码更易读、更易理解。</p><h2 id="c681" class="mw lf jj bd lg nd ne dn lk nf ng dp lo kr nh ni ls kv nj nk lw kz nl nm ma nn bi translated">2.可量测性</h2><p id="334b" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">除了组合功能允许代码更加模块化和组织化，它还允许代码更容易维护和扩展。</p><p id="eef9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，有几种方法可以重用组件逻辑，最流行的方法是VueJS Mixins。然而，mixins有一些限制。</p><div class="is it gp gr iu no"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-mixins-in-vuejs-a40cc3fb4428"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd jk gy z fp nt fr fs nu fu fw ji bi translated">如何管理VueJS中的Mixins</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">通过正确使用mixins来避免键入重复的代码，从而节省您的时间、代码和精力。</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ja no"/></div></div></a></div><p id="5645" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，当mixins与组件内部的变量名/方法冲突时，它会变得很棘手。第二，也是更重要的一点，mixins不灵活——它们被定义，然后原样导入到组件中。</p><p id="4953" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用组件功能，特定功能所需的所有数据都是独立的，不会与组件冲突。此外，因为它们只是您的典型函数，所以它们可以接受各种参数并适应每个组件的需求。</p><h2 id="89a0" class="mw lf jj bd lg nd ne dn lk nf ng dp lo kr nh ni ls kv nj nk lw kz nl nm ma nn bi translated">3.熟悉</h2><p id="547f" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">正如您可能在示例中看到的，对于熟悉Javascript的人来说，这些函数的语法非常直观。现在，您需要了解更多关于VueJS特定生命周期挂钩和组件架构的知识来实现一个特性。但是通过暴露Vue的反应能力，用组合API，Vue 3使它变得简单多了。</p><p id="ada7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于一门已经非常适合初学者的语言来说，这只会让它变得更好。</p><h1 id="70e3" class="le lf jj bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">总之…</h1><p id="b12e" class="pw-post-body-paragraph kg kh jj ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">组合API是使代码更具可读性和可维护性的好方法。它将有助于更大的Vue项目更加模块化和可重用，这大大减少了开发人员将面临的麻烦。</p><p id="f4ef" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然这只是Vue 3即将到来的变化的冰山一角，预计将于2020年在Q1正式发布，但这是Vue团队正在进行的对开发人员友好的变化的一个非常有希望的迹象。看起来他们已经发现了开发团队的许多痛点，并试图提供可行的解决方案，同时不做极端激烈的改变。</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="d6d2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有兴趣了解更多关于Vue 3的知识，请下载我的免费Vue 3备忘单，里面有一些基本知识，比如合成API、Vue 3模板语法和事件处理。</p></div></div>    
</body>
</html>