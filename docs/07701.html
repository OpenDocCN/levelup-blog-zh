<html>
<head>
<title>Yield in Yield in Ruby ‘.erb’ Templates for Sinatra Web App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">红宝石产量中的产量。Sinatra Web应用程序的erb模板</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/yield-in-yield-in-ruby-erb-for-sinatra-web-app-37d445363afe?source=collection_archive---------12-----------------------#2021-03-06">https://levelup.gitconnected.com/yield-in-yield-in-ruby-erb-for-sinatra-web-app-37d445363afe?source=collection_archive---------12-----------------------#2021-03-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1fbd2c1234b34ef382b43c0f63558ae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E9je9qQeLRK27mWYW9z9MA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">YIELD/等到一个块执行完！！！</figcaption></figure><p id="87a4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在<strong class="ke ir"> Ruby-Sinatra </strong>组合(甚至<strong class="ke ir"> Ruby-on-Rails </strong>)中使用模板的一个最重要的部分就是如何有效地使用<code class="fe la lb lc ld b">yield</code>关键字。</p><p id="73b1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下面是您创建Ruby-Sinatra web应用程序时最有可能使用的基本文件夹结构:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="a557" class="lm ln iq ld b gy lo lp l lq lr">|- app<br/>|    |- controllers<br/>|    |- models<br/>|    |- views<br/>|- config<br/>|       environment.rb<br/>|- db<br/>|   |- migrate<br/>|<br/>config.ru<br/>Gemfile<br/>Rakefile</span></pre><p id="8109" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在<code class="fe la lb lc ld b">controllers</code>文件夹中有你的<code class="fe la lb lc ld b">application_controller.rb</code>文件，在<code class="fe la lb lc ld b">views</code>目录下有你的<code class="fe la lb lc ld b">.erb</code>视图文件。假设你有基本控制器和带<code class="fe la lb lc ld b">show.erb</code>的<code class="fe la lb lc ld b">layout.erb</code>。请在此处查看代码:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="4603" class="lm ln iq ld b gy lo lp l lq lr"># (assuming that you already have Gemfile, Rakefile, config.ru, environment.rb, and some other basic files)</span></pre><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="fe7d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，您认识到必要的<code class="fe la lb lc ld b">yield</code>关键字出现在<code class="fe la lb lc ld b">layout.erb</code>文件中，以将该文件用作所有其他<code class="fe la lb lc ld b">.erb</code>文件的背景模板(您可能知道，Sinatra在默认情况下会为该角色查找这个<code class="fe la lb lc ld b">layout.erb</code>)。因为控制器<code class="fe la lb lc ld b">application_controller.rb</code>调用带有参数<code class="fe la lb lc ld b">:show</code>的<code class="fe la lb lc ld b">erb</code>方法，所以<code class="fe la lb lc ld b">views</code>文件夹中的<code class="fe la lb lc ld b">show.erb</code>文件将是要填充到<code class="fe la lb lc ld b">layout.erb</code>文件中的<code class="fe la lb lc ld b">yield</code>位置的块。结果如下:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/2018900ce347beb17065bdaeb63e488c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8STm_JdYfijZzllUfyLkQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">做得好！</figcaption></figure><p id="1412" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">大家都知道这么远！但是，我想提的是，“我们能在<code class="fe la lb lc ld b">show.erb</code>里再放一个<code class="fe la lb lc ld b">yield</code>吗？”我的情况是，我有一个帖子的<code class="fe la lb lc ld b">show</code>页面，每个帖子的底部都有评论区。大概是这样的:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/e0fbd1f4d53c5d416a6ad8a9df81caca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EpOJvmPQpEw_kN0338NAA.png"/></div></div></figure><p id="a00d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如你所看到的，评论部分和主文章部分是完全分开的。它也来自数据库中的不同模型/表。换句话说，这个评论区分开会更好！那么，有一个包含<code class="fe la lb lc ld b">yield</code>的post <code class="fe la lb lc ld b">show</code>文件怎么样，这样一个单独的<code class="fe la lb lc ld b">comments.erb</code>视图文件可以在以后填充那个<code class="fe la lb lc ld b">yield</code>部分。这是可能的！</p><p id="d850" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们稍微改变一下我们的<code class="fe la lb lc ld b">show.erb</code>文件，使它看起来像一篇博文:</p><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="98f1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">并且，您有一个单独的<code class="fe la lb lc ld b">comments.erb</code>文件，如下所示:</p><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="7e6d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你认为这行得通吗？</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/8ac1216f8874a25cbcb4408d8694b758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ti5RF5TdDcWCuiIj57N7A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">为什么，为什么，为什么？！？“无块给定(产量)”嗯…</figcaption></figure><p id="e3c2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这就是我们目前掌握的密码。为什么？理论上一个<code class="fe la lb lc ld b">yield</code>取一个块，那么<code class="fe la lb lc ld b">show.erb</code>文件中的<code class="fe la lb lc ld b">yield</code>应该取<code class="fe la lb lc ld b">comments.erb</code>作为它的块！对吗？一点也不！！！<code class="fe la lb lc ld b">show.erb</code>档中的<code class="fe la lb lc ld b">yield</code>根本不知道<code class="fe la lb lc ld b">comments.erb</code>的存在。因此，我们必须让它知道一个名为<code class="fe la lb lc ld b">comments.erb</code>的文件存在，并准备好填充其中的<code class="fe la lb lc ld b">yield</code>。方法如下:</p><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="3d97" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你看到附加部分了吗？是啊！我们为<code class="fe la lb lc ld b">show.erb</code>中的<code class="fe la lb lc ld b">yield</code>取另一个块<code class="fe la lb lc ld b">erb :comments</code>。这样，<code class="fe la lb lc ld b">show.erb</code>文件中的<code class="fe la lb lc ld b">yield</code>现在知道了<code class="fe la lb lc ld b">comments.erb</code>的存在。结果？</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/9beef4c3d563bc60205569d5c5b5807f.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*UXnhfJuXjzOBzf-Zp1uM2Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">漂亮~</figcaption></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><p id="3a9c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如你可能猜到的，我们可以在<code class="fe la lb lc ld b">yield</code>中做<code class="fe la lb lc ld b">yield</code>在<code class="fe la lb lc ld b">yield</code>中做<code class="fe la lb lc ld b">yield</code>在<code class="fe la lb lc ld b">yield</code>中做<code class="fe la lb lc ld b">yield</code>……你懂我的意思吧！以防万一，这里是如何:</p><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="c624" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以，下次你在你的Sinatra网络应用程序中有一个复杂的页面时，使用这个技术！为了更好的理解，你可以阅读<a class="ae mf" href="http://sinatrarb.com/intro.html" rel="noopener ugc nofollow" target="_blank"> Sinatra文档</a>和一些好的相关文章，比如<a class="ae mf" href="https://allysonw.github.io/nested_layouts_in_sinatra_with_erb" rel="noopener ugc nofollow" target="_blank">Allyson Wesman的这篇</a>。并且，请知道你甚至可以使用名字标记的多个<code class="fe la lb lc ld b">yield</code>，使用Sinatra extension gem名为'<strong class="ke ir"> sinatra-contrib </strong>'(请参见<a class="ae mf" href="http://sinatrarb.com/contrib/content_for" rel="noopener ugc nofollow" target="_blank"> Sinatra文档</a>和<a class="ae mf" href="https://jaketrent.com/post/multiple-yields-in-erb-template" rel="noopener ugc nofollow" target="_blank">一篇由<em class="mg"> Jake Trent </em>撰写的相关文章</a>)。更复杂的例子，你可以在<a class="ae mf" href="https://github.com/jinook929?tab=repositories" rel="noopener ugc nofollow" target="_blank">我的Github repo </a>里试试我的<a class="ae mf" href="https://github.com/jinook929/_flatiron_project2" rel="noopener ugc nofollow" target="_blank"> TraVlog App </a>。</p></div></div>    
</body>
</html>