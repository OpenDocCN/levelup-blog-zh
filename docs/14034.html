<html>
<head>
<title>Brief introduction of dependency-cruiser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从属巡洋舰简介</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/brief-introduction-of-dependency-cruiser-7e38a41afa4f?source=collection_archive---------3-----------------------#2022-10-26">https://levelup.gitconnected.com/brief-introduction-of-dependency-cruiser-7e38a41afa4f?source=collection_archive---------3-----------------------#2022-10-26</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="bd49" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">验证和可视化代码的依赖性</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/05c307773428dec797e698fcbcc36020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OjBOOv7p80ajxlQLRXStsQ.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">反应的依赖者</figcaption></figure><h2 id="548c" class="kw kx ir bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">前言</h2><p id="d208" class="pw-post-body-paragraph ls lt ir lu b lv lw js lx ly lz jv ma lf mb mc md lj me mf mg ln mh mi mj mk ik bi translated">如果我们想知道代码是否是多余的，或者依赖项是否没有被安装等等。我们可以使用<a class="ae ml" href="https://www.npmjs.com/package/dependency-cruiser" rel="noopener ugc nofollow" target="_blank">依赖浏览器</a>来分析目录或文件的依赖关系，这些依赖关系可以通过<a class="ae ml" href="https://www.graphviz.org/about/" rel="noopener ugc nofollow" target="_blank"> graphviz </a>可视化。</p><p id="d13b" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">在这篇文章中，我们将看看如何使用依赖巡洋舰。</p><h2 id="0f44" class="kw kx ir bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">如何使用依赖巡洋舰</h2><p id="601e" class="pw-post-body-paragraph ls lt ir lu b lv lw js lx ly lz jv ma lf mb mc md lj me mf mg ln mh mi mj mk ik bi translated">我们可以用<code class="fe mr ms mt mu b">npm i -g dependency-cruiser</code>在全球范围内安装<a class="ae ml" href="https://www.npmjs.com/package/dependency-cruiser" rel="noopener ugc nofollow" target="_blank">依赖巡洋舰</a>(建议在本地安装)。然后进入我们想要分析的项目的文件夹，作为一个例子，我们可以在<a class="ae ml" href="https://www.npmjs.com/package/formidable" rel="noopener ugc nofollow" target="_blank">强大的</a>中运行下面的命令:</p><pre class="kh ki kj kk gu mv mu mw mx aw my bi"><span id="f598" class="kw kx ir mu b gz mz na l nb nc">depcruise --exclude "^node_modules" --output-type html src &gt; dependencies.html</span></pre><p id="be8e" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">这将生成一个html文件<code class="fe mr ms mt mu b">dependencies.html</code>,如下所示</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nd"><img src="../Images/1401a4cf2adbe5a07739bd3b218a91e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1TXyu6BxqU3wOY7eBuOOdA.png"/></div></div></figure><p id="af0c" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated"><a class="ae ml" href="https://www.npmjs.com/package/dependency-cruiser" rel="noopener ugc nofollow" target="_blank">依赖巡洋舰</a>支持多种类型的输出，如<code class="fe mr ms mt mu b">html</code>、<code class="fe mr ms mt mu b">json</code>、<code class="fe mr ms mt mu b">dot</code>、<code class="fe mr ms mt mu b">text</code>等。你可以参考这篇<a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--output-type-specify-the-output-format" rel="noopener ugc nofollow" target="_blank">文章</a>来了解其他支持的类型。</p><h2 id="3413" class="kw kx ir bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">concert dependency-cruiser with graphviz</h2><p id="789c" class="pw-post-body-paragraph ls lt ir lu b lv lw js lx ly lz jv ma lf mb mc md lj me mf mg ln mh mi mj mk ik bi translated">作为输出类型的<code class="fe mr ms mt mu b">dot</code>将使dependency-cruiser编写一个<a class="ae ml" href="https://www.graphviz.org/about/" rel="noopener ugc nofollow" target="_blank"> graphviz </a>点格式的有向图。我们可以用<a class="ae ml" href="https://www.graphviz.org/about/" rel="noopener ugc nofollow" target="_blank"> graphviz </a> <em class="ne"> </em>到<em class="ne"> </em>把它形象化。但是我们必须额外安装graphviz。</p><p id="f558" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">在MacOS中，我们可以使用<code class="fe mr ms mt mu b">brew</code>来安装它:</p><pre class="kh ki kj kk gu mv mu mw mx aw my bi"><span id="aea5" class="kw kx ir mu b gz mz na l nb nc">brew install graphviz</span></pre><p id="abd6" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">然后我们可以输出图形可视化:</p><pre class="kh ki kj kk gu mv mu mw mx aw my bi"><span id="e504" class="kw kx ir mu b gz mz na l nb nc">depcruise --exclude "^node_modules" --output-type dot src | dot -T jpg &gt; dependencies.jpg</span></pre><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj nf"><img src="../Images/957060ca7b681964f8d7216f5729feb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*BWhO0DMpKEkNN2t-zNpJGw.jpeg"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk translated">dependencies.jpg</figcaption></figure><p id="334b" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">如果我们想输出其他格式的图形，替换<code class="fe mr ms mt mu b">dot -T [format]</code>的格式类型，例如我们生成一个pdf文件:</p><pre class="kh ki kj kk gu mv mu mw mx aw my bi"><span id="69a2" class="kw kx ir mu b gz mz na l nb nc">depcruise --exclude "^node_modules" --output-type dot src | dot -T pdf &gt; dependencies.pdf</span></pre><p id="03cf" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">graphviz支持的所有输出类型都可以引用<a class="ae ml" href="https://www.graphviz.org/docs/outputs/" rel="noopener ugc nofollow" target="_blank">https://www.graphviz.org/docs/outputs/</a>。</p><h2 id="1470" class="kw kx ir bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">从属巡洋舰的主要选择</h2><p id="9ec1" class="pw-post-body-paragraph ls lt ir lu b lv lw js lx ly lz jv ma lf mb mc md lj me mf mg ln mh mi mj mk ik bi translated">有时，我们可能不关心一些目录，并希望排除它们。有4个选项可以做到:</p><ol class=""><li id="8517" class="ng nh ir lu b lv mm ly mn lf ni lj nj ln nk mk nl nm nn no bi translated"><code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--do-not-follow-dont-cruise-modules-adhering-to-this-pattern-any-further" rel="noopener ugc nofollow" target="_blank">--do-not-follow</a></code> <a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--do-not-follow-dont-cruise-modules-adhering-to-this-pattern-any-further" rel="noopener ugc nofollow" target="_blank">:不要再巡航坚持这种模式的模块</a></li><li id="377f" class="ng nh ir lu b lv np ly nq lf nr lj ns ln nt mk nl nm nn no bi translated"><code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--include-only-only-include-modules-satisfying-a-pattern" rel="noopener ugc nofollow" target="_blank">--include-only</a></code> <a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--include-only-only-include-modules-satisfying-a-pattern" rel="noopener ugc nofollow" target="_blank">:仅包含满足模式</a>的模块</li><li id="984a" class="ng nh ir lu b lv np ly nq lf nr lj ns ln nt mk nl nm nn no bi translated"><code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--focus-show-modules-and-their-neighbours" rel="noopener ugc nofollow" target="_blank">--focus</a></code> <a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--focus-show-modules-and-their-neighbours" rel="noopener ugc nofollow" target="_blank">:显示模块及其邻居</a></li><li id="4f49" class="ng nh ir lu b lv np ly nq lf nr lj ns ln nt mk nl nm nn no bi translated"><code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--exclude-exclude-dependencies-from-being-cruised" rel="noopener ugc nofollow" target="_blank">--exclude</a></code> <a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--exclude-exclude-dependencies-from-being-cruised" rel="noopener ugc nofollow" target="_blank">:排除被巡览的依赖关系</a></li></ol><p id="8bf5" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">我将制作一些图片来帮助理解这种不同。</p><ol class=""><li id="36e8" class="ng nh ir lu b lv mm ly mn lf ni lj nj ln nk mk nl nm nn no bi translated"><code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--do-not-follow-dont-cruise-modules-adhering-to-this-pattern-any-further" rel="noopener ugc nofollow" target="_blank">--do-not-follow</a></code>如果匹配此模式，将停止巡航子模块。</li></ol><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nu"><img src="../Images/2b315a0968a6e53c92a4f39d36379d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U8TGKnpTZdeJGbGFJRbRLw.png"/></div></div></figure><p id="5f86" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">2.<code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--include-only-only-include-modules-satisfying-a-pattern" rel="noopener ugc nofollow" target="_blank">--include-onl</a>y</code>只包含满足模式的模块，在这个演示中是插件和解析器目录。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nv"><img src="../Images/d6176ec4ac47e0cedeecddc47c99985d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ZNar3fSjQnqrNQdLvIxsg.png"/></div></div></figure><p id="24f7" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">3.<code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--focus-show-modules-and-their-neighbours" rel="noopener ugc nofollow" target="_blank">--focus</a></code>将包含模块和依赖或依赖关系。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nw"><img src="../Images/4c65a29859f60f5fdc305b7815a3575e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-IzdG-VEXXtTbb898yKaTw.png"/></div></div></figure><p id="2765" class="pw-post-body-paragraph ls lt ir lu b lv mm js lx ly mn jv ma lf mo mc md lj mp mf mg ln mq mi mj mk ik bi translated">4.<code class="fe mr ms mt mu b"><a class="ae ml" href="https://github.com/sverweij/dependency-cruiser/blob/HEAD/doc/cli.md#--exclude-exclude-dependencies-from-being-cruised" rel="noopener ugc nofollow" target="_blank">--exclude</a></code>将删除匹配模式模块及其子模块。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nx"><img src="../Images/3a09a9dade58c27ac819aadcafc7d559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAzmuuiaVSH4h1T89mAyBQ.png"/></div></div></figure><h2 id="a401" class="kw kx ir bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h2><p id="38c8" class="pw-post-body-paragraph ls lt ir lu b lv lw js lx ly lz jv ma lf mb mc md lj me mf mg ln mh mi mj mk ik bi translated">在本文中，我们将学习如何使用<a class="ae ml" href="https://www.npmjs.com/package/dependency-cruiser" rel="noopener ugc nofollow" target="_blank">依赖浏览器</a>来分析项目的依赖关系，并且我们可以使用<a class="ae ml" href="https://www.graphviz.org/about/" rel="noopener ugc nofollow" target="_blank"> graphviz </a>来进行依赖关系的图形可视化。dependency-cruiser 支持许多有用的选项来帮助我们关注我们关心的模块。如果我们想重构代码，这个工具会很有帮助。</p></div></div>    
</body>
</html>