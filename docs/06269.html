<html>
<head>
<title>Manage Python Virtual Environments with Conda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Conda管理Python虚拟环境</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/manage-python-virtual-environments-with-conda-75360c3fe490?source=collection_archive---------18-----------------------#2020-11-09">https://levelup.gitconnected.com/manage-python-virtual-environments-with-conda-75360c3fe490?source=collection_archive---------18-----------------------#2020-11-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="30dc" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">数据科学、编程、Python</h2><div class=""/><div class=""><h2 id="1546" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">数据科学家和Python开发人员最常用的7个命令</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/604bf6e944c6c23680a8489fb13828ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HlbHHxOVSUs4Q0dm"/></div></div><figcaption class="le lf gk gi gj lg lh bd b be z dk translated">克里斯·里德在<a class="ae li" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl lj lk hy ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="in io ip iq ir"><h1 id="603f" class="lq lr iu bd ls lt lu lv lw lx ly lz ma kj mb kk mc km md kn me kp mf kq mg mh bi translated">什么是虚拟环境？</h1><p id="e833" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">Python虚拟环境的主要目的是为每个项目创建单独的环境。</p><p id="9686" class="pw-post-body-paragraph mi mj iu mk b ml ne ke mn mo nf kh mq mr ng mt mu mv nh mx my mz ni nb nc nd in bi translated">让我们通过一个例子来理解对虚拟环境的需求。假设您在同一个系统/机器中从事两个项目- <code class="fe nj nk nl nm b">Project_A</code>和<code class="fe nj nk nl nm b">Project_B</code>。<code class="fe nj nk nl nm b">Project_A</code>要求spacy = 2 . 3 . 0&amp;Python≤3.6<code class="fe nj nk nl nm b">Project_B</code>要求spacy &gt; 2.3.0和Python &gt; 3.6。你如何处理这种情况？如果你想在基础环境中安装所有的东西，那么你迟早会遇到问题。最好的方法是为每个项目创建单独的虚拟环境，并相应地使用它。本文讨论如何使用Python虚拟环境。</p><p id="91b1" class="pw-post-body-paragraph mi mj iu mk b ml ne ke mn mo nf kh mq mr ng mt mu mv nh mx my mz ni nb nc nd in bi translated"><strong class="mk je">要运行这些命令，请使用Anaconda命令提示符。</strong></p><h1 id="06fb" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">1.创造环境</h1><p id="e7d6" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">下面的命令将创建一个名为<code class="fe nj nk nl nm b">myenv</code>的环境。您可以随意使用任何环境名称。默认情况下，在Windows机器中，所有的环境都将存储在<code class="fe nj nk nl nm b">C:\Users\&lt;&lt;use_id&gt;&gt;\.conda\envs</code>中。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="a0f5" class="nw lr iu nm b gz nx ny l nz oa">conda create — name myenv</span></pre><h2 id="9af9" class="nw lr iu bd ls ob oc dn lw od oe dp ma mr of og mc mv oh oi me mz oj ok mg ja bi translated">使用特定版本的Python创建一个环境</h2><p id="fcc4" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">这将创建一个安装了python 3.6的环境<code class="fe nj nk nl nm b">myenv</code>。激活环境后，您可以开始安装您需要的任何软件包。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="c732" class="nw lr iu nm b gz nx ny l nz oa">conda create --name myenv python=3.6</span></pre><h2 id="b327" class="nw lr iu bd ls ob oc dn lw od oe dp ma mr of og mc mv oh oi me mz oj ok mg ja bi translated">用特定的包创建一个环境</h2><p id="1763" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">这将创建一个带有<code class="fe nj nk nl nm b">spacy</code>最新版本的环境<code class="fe nj nk nl nm b">myenv</code>。如果需要安装特定版本的包，可以用<code class="fe nj nk nl nm b">spacy=2.3.0</code>代替<code class="fe nj nk nl nm b">spacy</code>。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="815e" class="nw lr iu nm b gz nx ny l nz oa">conda create --name myenv spacy</span></pre><h2 id="3c04" class="nw lr iu bd ls ob oc dn lw od oe dp ma mr of og mc mv oh oi me mz oj ok mg ja bi translated">使用特定版本的Python &amp; package创建环境</h2><p id="9130" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">该命令将创建环境<code class="fe nj nk nl nm b">python 3.6</code>和<code class="fe nj nk nl nm b">spacy 2.3.0</code>。您可以根据需要使用任意数量的软件包。如果你需要安装很多包，最好的方法是使用下面将要讨论的<code class="fe nj nk nl nm b">yml</code>文件。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="521a" class="nw lr iu nm b gz nx ny l nz oa">conda create -n myenv python=3.6 spacy=2.3.0</span></pre><h2 id="50e2" class="nw lr iu bd ls ob oc dn lw od oe dp ma mr of og mc mv oh oi me mz oj ok mg ja bi translated">从environment.yml文件创建环境</h2><p id="10cb" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">如果在创建环境时需要安装一个很长的软件包列表，您可以通过包含需要安装的软件包列表来创建一个yml文件，并在创建环境时使用它。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="0238" class="nw lr iu nm b gz nx ny l nz oa"><strong class="nm je">environment.yml<br/></strong>name: myenv<br/>dependencies:<br/>- spacy&gt;=2.3.0<br/>- pandas<br/>- seaborn<br/>- scikit-learn</span></pre><p id="d82b" class="pw-post-body-paragraph mi mj iu mk b ml ne ke mn mo nf kh mq mr ng mt mu mv nh mx my mz ni nb nc nd in bi translated">一旦你创建了yml文件，运行下面的命令将会创建一个名为<code class="fe nj nk nl nm b">myenv</code>的环境，在这个环境中安装了yml文件中的所有包。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="feca" class="nw lr iu nm b gz nx ny l nz oa">conda env create -f environment.yml</span></pre><h1 id="95d7" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">2.克隆环境</h1><p id="b60d" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">出于任何原因，如果您需要克隆现有的环境，可以使用下面的命令。这将通过克隆<code class="fe nj nk nl nm b">myenv</code>创建一个名为<code class="fe nj nk nl nm b">myenv_new</code>的新环境。这将克隆包括python版本在内的所有包。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="33f1" class="nw lr iu nm b gz nx ny l nz oa">conda create --name myenv_new --clone myenv</span></pre><h1 id="f5df" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">3.激活和停用环境</h1><h2 id="2761" class="nw lr iu bd ls ob oc dn lw od oe dp ma mr of og mc mv oh oi me mz oj ok mg ja bi translated">使活动</h2><p id="0fcb" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">创建环境后，要激活并开始使用，请运行以下命令。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="e94d" class="nw lr iu nm b gz nx ny l nz oa">conda activate myenv</span></pre><h2 id="2ad1" class="nw lr iu bd ls ob oc dn lw od oe dp ma mr of og mc mv oh oi me mz oj ok mg ja bi translated">复员</h2><p id="ebfd" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">要停用，只需运行命令-</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="a8f2" class="nw lr iu nm b gz nx ny l nz oa">conda deactivate</span></pre><h1 id="6854" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">4.确定和查看您当前的环境</h1><p id="3817" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">这两个命令用于列出系统中安装的所有环境。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="c5a4" class="nw lr iu nm b gz nx ny l nz oa">conda info --envs<br/>Or<br/>conda env list</span></pre><p id="f65e" class="pw-post-body-paragraph mi mj iu mk b ml ne ke mn mo nf kh mq mr ng mt mu mv nh mx my mz ni nb nc nd in bi translated">请注意，在上面的列表中，您当前的环境以星号(*)突出显示。</p><h1 id="e983" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">5.共享一个环境</h1><p id="254f" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">如果您想在同事的系统中设置相同的环境，您可以将环境详细信息导出到yml文件中，然后使用该文件在同事的系统中设置类似的环境。</p><p id="2d60" class="pw-post-body-paragraph mi mj iu mk b ml ne ke mn mo nf kh mq mr ng mt mu mv nh mx my mz ni nb nc nd in bi translated">首先，您需要激活环境，然后运行export命令来创建包含环境细节的yml文件，如下所示。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="3de6" class="nw lr iu nm b gz nx ny l nz oa">conda activate myenv<br/>conda env export &gt; environment.yml</span></pre><h1 id="c53b" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">6.恢复环境</h1><p id="8ed0" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">Conda跟踪环境的所有变化，以便您可以轻松地回滚到以前的版本。第一个命令列出了环境的每次更改的历史记录，第二个命令用于回滚到特定版本。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="06f1" class="nw lr iu nm b gz nx ny l nz oa">conda list --revisions</span><span id="dc5f" class="nw lr iu nm b gz ol ny l nz oa">conda install --revision=&lt;&lt;REVNUM&gt;&gt; #replace &lt;&lt;&gt;REVNUM&gt;&gt; with number</span></pre><h1 id="893b" class="lq lr iu bd ls lt nn lv lw lx no lz ma kj np kk mc km nq kn me kp nr kq mg mh bi translated">7.移除环境</h1><p id="8c1f" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">以下命令将删除<code class="fe nj nk nl nm b">myenv</code>环境。您可以通过检查<code class="fe nj nk nl nm b">conda info — envs</code>的结果来验证环境是否被移除。</p><pre class="kt ku kv kw gu ns nm nt nu aw nv bi"><span id="b76d" class="nw lr iu nm b gz nx ny l nz oa">conda remove --name myenv --all</span></pre></div><div class="ab cl lj lk hy ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="in io ip iq ir"><h1 id="02af" class="lq lr iu bd ls lt lu lv lw lx ly lz ma kj mb kk mc km md kn me kp mf kq mg mh bi translated">结论</h1><p id="7391" class="pw-post-body-paragraph mi mj iu mk b ml mm ke mn mo mp kh mq mr ms mt mu mv mw mx my mz na nb nc nd in bi translated">这些是所有数据科学家和Python开发人员使用Conda管理不同Python环境时最常用的命令。希望这篇文章对你有用。</p></div><div class="ab cl lj lk hy ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="in io ip iq ir"><p id="9add" class="pw-post-body-paragraph mi mj iu mk b ml ne ke mn mo nf kh mq mr ng mt mu mv nh mx my mz ni nb nc nd in bi translated"><em class="om">阅读更多关于Python和数据科学的此类有趣文章，</em> <a class="ae li" href="https://pythonsimplified.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="mk je"> <em class="om">订阅</em> </strong> </a> <em class="om">到我的博客</em><a class="ae li" href="http://www.pythonsimplified.com" rel="noopener ugc nofollow" target="_blank"><strong class="mk je"><em class="om">www.pythonsimplified.com</em></strong></a><strong class="mk je"><em class="om">。</em> </strong>你也可以通过<a class="ae li" href="https://www.linkedin.com/in/chetanambi/" rel="noopener ugc nofollow" target="_blank"> <strong class="mk je"> LinkedIn </strong> </a>联系我。</p></div></div>    
</body>
</html>