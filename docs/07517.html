<html>
<head>
<title>Compare &amp; Contrast: Exploration of Datasets with Many Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比较和对比:探索具有许多特征的数据集</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/compare-contrast-eda-of-datasets-with-many-features-f9665da15132?source=collection_archive---------31-----------------------#2021-02-22">https://levelup.gitconnected.com/compare-contrast-eda-of-datasets-with-many-features-f9665da15132?source=collection_archive---------31-----------------------#2021-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8c5077fe2c58e5299ae26c9d340fd608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wU3b2AIWPdeK-4bF"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6c1b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我刚刚和<a class="lb lc ep" href="https://medium.com/u/2532759cb06a?source=post_page-----f9665da15132--------------------------------" rel="noopener" target="_blank">加里·卢</a>进行了一场追逐赛。我们研究了波士顿房价的数据集，并建立了预测模型。结果是在9%以内。</p><p id="e3f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">开始后不久，我注意到数据集有许多特征(总共80个:37个连续的和43个分类的)。弄清楚所有这些肯定会为特性工程和模型构建过程铺平具体的道路。然而，也有太多的方法可以做到这一点，有一段时间我对“正确”的方法感到困惑…</p><p id="499f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过反复试验，我觉得虽然没有绝对正确的方法，但“比较和对比”式的分析和可视化仍然可以很好地实现最终目标:<strong class="kf ir">快速识别潜力，以改进预测模型。</strong></p><p id="f7ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我将详细阐述我的实践，将“比较和对比”的理念引入探索:</p><h2 id="6b79" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">1.比较训练和测试数据之间的数据类型和空值</h2><p id="b676" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">对于包含许多要素的数据集，汇总数据类型和空值非常重要。对比分析不仅可以分别研究训练数据集和测试数据集，还可以提供更多信息:数据集之间的数据类型是否一致？一个数据集中缺少的值比另一个多吗？以下是示例和代码(Python):</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="8172" class="ld le iq mg b gy mk ml l mm mn"># Data Type Comparison<br/>s1 = train_data.dtypes<br/>s2 = test_data.dtypes<br/>s1_train = s1.drop('SalePrice')<br/>s1_train.compare(s2)</span></pre><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/141a52ea415201cc752697dfe9e216bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*nMiLFQf-z2JdLKN4phzE-Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">结果:具有不同数据类型的要素</figcaption></figure><p id="2b83" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，从上面我们可以很容易地看到，有9个特征在训练和测试数据中具有不同的数据类型。有关系吗？它需要更多的探索，在我们的例子中不需要，因为它们都是数字类型，但如果其中一个是对象类型，这可能是一个问题。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="7590" class="ld le iq mg b gy mk ml l mm mn"># Null Value Comparison<br/>null_train = train_data.isnull().sum()<br/>null_test = test_data.isnull().sum()<br/>null_train = null_train.drop('SalePrice')<br/>null_train.compare(null_test).sort_values(['self','other'], ascending= [False,False])</span></pre><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/d0eaf9a90bdc07521e9e98ae205ef4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*Vf4wPuNmZoKWUKvkwBER6Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">结果:部分要素具有空值</figcaption></figure><p id="777e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们可以看到空值似乎均匀地分布在两个数据集上，这向我们保证，我们可以对两个数据集以类似的方式处理这些空值。</p><h2 id="f06a" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">2.训练和测试数据的对比分布</h2><p id="1f8f" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">特征的分布是特征工程的一个关键考虑因素，我们总是想回答一些问题:</p><p id="7783" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">连续特征是否正态分布？有没有哪一个范畴的特征被某一个范畴所支配，并遮蔽了其他范畴？同样，我们可以对比它们，而不是分别研究训练和测试数据的问题。</p><p id="977c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">对于连续特征，我们可以如下应用Seaborn直方图:</strong></p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="52a5" class="ld le iq mg b gy mk ml l mm mn"># Distribution Comparison - Continuous Variables</span><span id="43e4" class="ld le iq mg b gy mq ml l mm mn">con_var = s1[s1.values != 'object'].index<br/>f, axes = plt.subplots(7,6 , figsize=(30, 30), sharex=False)<br/>for i, feature <strong class="mg ir">in</strong> enumerate(con_var):<br/>    sns.histplot(data=combined_data, x = feature, hue="Label",ax=axes[i%7, i//7])</span></pre><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/e7a28ef17128fc117317a0ef00f463fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xoxbBJ7i_9DYQlb3j_94UA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分布比较—连续变量的一部分</figcaption></figure><p id="02c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上述分布显示:</p><ul class=""><li id="1482" class="ms mt iq kf b kg kh kk kl ko mu ks mv kw mw la mx my mz na bi translated">对于大多数特征，训练和测试数据的分布是相似的；</li><li id="d355" class="ms mt iq kf b kg nb kk nc ko nd ks ne kw nf la mx my mz na bi translated">一些特征可以被重新分类为‘分类的’，例如‘ms subclass’；</li><li id="83da" class="ms mt iq kf b kg nb kk nc ko nd ks ne kw nf la mx my mz na bi translated">有些特性是由0/null支配的(例如:PoolArea)，因此我们可以考虑丢弃。</li></ul><p id="fc77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">对于分类特征，我们可以如下应用Seaborn计数图:</strong></p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="c5bb" class="ld le iq mg b gy mk ml l mm mn"># Distribution Comparison - Catagorical Variables</span><span id="2b2a" class="ld le iq mg b gy mq ml l mm mn">cat_var = s1[s1.values == 'object'].index<br/>f, axes = plt.subplots(7,7 , figsize=(30, 30), sharex=False)<br/>for i, feature <strong class="mg ir">in</strong> enumerate(cat_var):<br/>    sns.countplot(data = combined_data, x = feature, hue="Label",ax=axes[i%7, i//7])</span></pre><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/e2bf5472003c51bfaedddc8f2aff4daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYx9otiWaSnd7bmFFZmZgg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分布比较—分类变量的一部分</figcaption></figure><p id="7455" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分类变量的比较表明:</p><ul class=""><li id="647e" class="ms mt iq kf b kg kh kk kl ko mu ks mv kw mw la mx my mz na bi translated">大多数特征的训练数据和测试数据分布是相似的</li><li id="5f6d" class="ms mt iq kf b kg nb kk nc ko nd ks ne kw nf la mx my mz na bi translated">有些功能有主导项，我们可以考虑把一些次要项组合成一组，比如' HeatingQC '、' FireplaceQu '、' GarageQual '、' GarageCond '中的' Fa' &amp; 'Po '</li></ul><h2 id="d39b" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">3.比较响应变量和连续特征之间的线性</h2><p id="9886" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">线性影响我们模型的质量。一些特征可能与响应变量有正/负关系，但不是线性的，对于这种情况，转换可能有助于改进我们的模型。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="cba7" class="ld le iq mg b gy mk ml l mm mn">f, axes = plt.subplots(7,6 , figsize=(30, 30), sharex=False)<br/>for i, feature <strong class="mg ir">in</strong> enumerate(con_var):<br/>    sns.scatterplot(data=train_data, x = feature, y= "SalePrice",ax=axes[i%7, i//7])</span></pre><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/69fa00047bdba2c69ed1e1f1bc868ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ah8_E3tlRlPNlNEJwaoT7w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">销售价格与连续特征的比较—连续变量的一部分</figcaption></figure><p id="e58b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们可以看到一些关系似乎是积极的，但不是完全线性的:“SalePrice”对“BsmtUnfSF”，“SalePrice”对“LotFrontage”等，因此我们将考虑将这些特征转换成对数形式以提高线性。</p><h2 id="7eea" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">4.通过响应变量对比分类特征项目</h2><p id="03b9" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">在过程2中，我们已经确定了我们想要组合的分类特征，然后我们将继续确认我们想要组合的这些项目具有相似的价格(响应变量)。(这样我们就不会重新分组导致响应变量的不同表现)</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="0e65" class="ld le iq mg b gy mk ml l mm mn">f, axes = plt.subplots(7,7 , figsize=(30, 30), sharex=False)<br/>for i, feature <strong class="mg ir">in</strong> enumerate(cat_var):<br/>    sort_list = sorted(train_data.groupby(feature)['SalePrice'].median().items(), key= lambda x:x[1], reverse = True)<br/>    order_list = [x[0] for x <strong class="mg ir">in</strong> sort_list ]<br/>    sns.boxplot(data = train_data, x = feature, y = 'SalePrice', order=order_list, ax=axes[i%7, i//7])<br/>plt.show()</span></pre><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/6e8f76e92be590ea7e139b3604e76b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdG0S96WRKfPa3jXx82-6g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分类特征内销售价格对比的一部分</figcaption></figure><p id="8056" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们可以看到“HeatingQC”、“FireplaceQu”、“GarageQual”和“GarageCond”中“Fa”和“Po”的销售价格是相似的，因此我们可以考虑继续合并这些项目。</p><h1 id="ce5f" class="nj le iq bd lf nk nl nm li nn no np ll nq nr ns lo nt nu nv lr nw nx ny lu nz bi translated">摘要</h1><p id="8a83" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">有了上面提到的四个主要的“比较和对比”过程，我很快就发现了需要进行特征工程的地方。我觉得在对具有许多特征的数据集进行探索性数据分析时，使用我们的批判性思维模式是很重要的:我们不应该展示所有细节，而是应该始终专注于<strong class="kf ir">快速识别潜力以改进预测模型。</strong>从这个意义上说，“比较和对比”方法可以帮助我们保持正确的方向。</p><h2 id="fb87" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">Gary Lu的相关文章:</h2><div class="oa ob gp gr oc od"><a href="https://glucn.medium.com/tuning-hyperparameters-with-optuna-af342facc549" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">使用Optuna调整超参数</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">本文讨论了我使用Optuna调优ML模型超参数的经验。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">glucn.medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or jw od"/></div></div></a></div><h2 id="9c32" class="ld le iq bd lf lg lh dn li lj lk dp ll ko lm ln lo ks lp lq lr kw ls lt lu lv bi translated">链接:</h2><p id="8ec5" class="pw-post-body-paragraph kd ke iq kf b kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la ij bi translated">【https://www.kaggle.com/garylucn/house-price T4】</p><p id="8a22" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://github.com/glucn/kaggle/blob/main/House_Prices/notebook/house-price.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Glu cn/ka ggle/blob/main/House _ Prices/notebook/House-price . ipynb</a></p></div></div>    
</body>
</html>