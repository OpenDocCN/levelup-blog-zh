<html>
<head>
<title>Understanding the Groupby() Function in Pandas Dataframe — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Pandas数据框架中的Groupby()函数—第1部分</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/understanding-groupby-function-in-pandas-dataframe-part-1-23cc762b3174?source=collection_archive---------5-----------------------#2020-07-17">https://levelup.gitconnected.com/understanding-groupby-function-in-pandas-dataframe-part-1-23cc762b3174?source=collection_archive---------5-----------------------#2020-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c5ddd372f2885543a4d556b0402b6c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EosZDVyMBrb0j9LR"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">卡洛斯·穆扎在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b182" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code> <strong class="ki iu"> </strong>函数是在Pandas中处理大型数据帧时最有用的函数之一。groupby操作通常包括拆分对象、应用函数和组合结果的组合。</p><p id="0c6d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果你是第一次使用<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>功能，事情一开始会有点吓人。因此，本文的目的是对这个简单却极其强大的函数做一个简单的介绍。</p><p id="10e0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通常，最好的学习方法是通过例子，很多例子。所以让我们开始吧！</p><h1 id="3b50" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">加载示例数据帧</h1><p id="2272" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">让我们用下面的代码片段加载一个数据帧:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="7970" class="mt lj it lh b gy mu mv l mw mx">import pandas as pd</span><span id="d495" class="mt lj it lh b gy my mv l mw mx">scores = {'Zone': ['North','South','South',<br/>                   'East','East','West','West','West'], <br/>          'School': ['Rushmore','Bayside','Rydell',<br/>                     'Shermer','Shermer','Ridgemont','Hogwarts','Hogwarts'],             <br/>          'Name': ['Jonny','Joe','Jakob', <br/>                   'Jimmy','Erik','Lam','Yip','Chen'], <br/>          'Math': [78,76,56,67,89,100,55,76],<br/>          'Science': [70,68,90,45,66,89,32,98]}</span><span id="a0ea" class="mt lj it lh b gy my mv l mw mx">df = pd.DataFrame(scores, columns = <br/>                  ['Zone', 'School', 'Name', <br/>                   'Science', 'Math'])<br/>df</span></pre><p id="3146" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据帧(<code class="fe le lf lg lh b"><strong class="ki iu">df</strong></code>)如下所示:</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/cfb4ce9cbc98e69d8ecdb1c5dab24f52.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*_uEzDGZAWY85MeneC-u2uQ.png"/></div></figure><h1 id="a8bf" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">使用字符串(列名)调用groupby()</h1><p id="bbcc" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">让我们按<code class="fe le lf lg lh b"><strong class="ki iu">Zone</strong></code>对数据帧进行分组:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="5501" class="mt lj it lh b gy mu mv l mw mx">gp = df.groupby(<strong class="lh iu">'Zone'</strong>)      # pass in a string to groupby()<br/>for zone, group in gp:<br/>    print(zone)<br/>    print(group)             # group is a dataframe</span></pre><p id="a999" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它应该打印出以下输出:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="3980" class="mt lj it lh b gy mu mv l mw mx">East<br/>   Zone   School   Name  Science  Math<br/>3  East  Shermer  Jimmy       45    67<br/>4  East  Shermer   Erik       66    89<br/>North<br/>    Zone    School   Name  Science  Math<br/>0  North  Rushmore  Jonny       70    78<br/>South<br/>    Zone   School   Name  Science  Math<br/>1  South  Bayside    Joe       68    76<br/>2  South   Rydell  Jakob       90    56<br/>West<br/>   Zone     School  Name  Science  Math<br/>5  West  Ridgemont   Lam       89   100<br/>6  West   Hogwarts   Yip       32    55<br/>7  West   Hogwarts  Chen       98    76</span></pre><p id="8ffb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如您从输出中看到的，您正在按<code class="fe le lf lg lh b"><strong class="ki iu">Zone</strong></code>对数据帧进行分组。本例中的<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>函数返回一个<code class="fe le lf lg lh b"><strong class="ki iu">DataFrameGroupBy</strong></code>对象。要打印出每个区域及其相关的分组，可以使用<em class="na"> for-in </em>循环来遍历<code class="fe le lf lg lh b"><strong class="ki iu">DataFrameGroupBy</strong></code>对象。在这种情况下,<code class="fe le lf lg lh b"><strong class="ki iu">zone</strong></code>变量将采用每个区域的值，而<code class="fe le lf lg lh b"><strong class="ki iu">group</strong></code>变量将包含与每个区域相关的行(包含在一个数据帧中)。要打印出每个学生的<code class="fe le lf lg lh b"><strong class="ki iu">Name</strong></code>以及他/她的<code class="fe le lf lg lh b"><strong class="ki iu">Science</strong></code>和<code class="fe le lf lg lh b"><strong class="ki iu">Math</strong></code>分数，您可以选择<strong class="ki iu">组</strong>数据框中相应的列:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="3aa5" class="mt lj it lh b gy mu mv l mw mx">gp = df.groupby('Zone')<br/>for zone, group in gp:<br/>    print(zone)<br/>    print(group[<strong class="lh iu">['Name','Science','Math']</strong>])</span></pre><p id="171c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述修改后的语句输出如下:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="f4a3" class="mt lj it lh b gy mu mv l mw mx">East<br/>    Name  Science  Math<br/>3  Jimmy       45    67<br/>4   Erik       66    89<br/>North<br/>    Name  Science  Math<br/>0  Jonny       70    78<br/>South<br/>    Name  Science  Math<br/>1    Joe       68    76<br/>2  Jakob       90    56<br/>West<br/>   Name  Science  Math<br/>5   Lam       89   100<br/>6   Yip       32    55<br/>7  Chen       98    76</span></pre><h1 id="b405" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用字符串列表(列名)调用<code class="fe le lf lg lh b">groupby()</code></h1><p id="5858" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">假设您现在想按<code class="fe le lf lg lh b"><strong class="ki iu">Zone</strong></code>和<code class="fe le lf lg lh b"><strong class="ki iu">School</strong></code>分组，那么现在您用一个字符串列表(包含列名)调用<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>函数:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="a587" class="mt lj it lh b gy mu mv l mw mx">gp = df.groupby(<strong class="lh iu">['Zone','School']</strong>)        # pass a list to groupby()<br/>for zone_school, group in gp:<br/>    print(zone_school)<br/>    print(group[['Name','Science','Math']])</span></pre><p id="47c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的代码片段将打印以下内容:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="5358" class="mt lj it lh b gy mu mv l mw mx">('East', 'Shermer')<br/>    Name  Science  Math<br/>3  Jimmy       45    67<br/>4   Erik       66    89<br/>('North', 'Rushmore')<br/>    Name  Science  Math<br/>0  Jonny       70    78<br/>('South', 'Bayside')<br/>  Name  Science  Math<br/>1  Joe       68    76<br/>('South', 'Rydell')<br/>    Name  Science  Math<br/>2  Jakob       90    56<br/>('West', 'Hogwarts')<br/>   Name  Science  Math<br/>6   Yip       32    55<br/>7  Chen       98    76<br/>('West', 'Ridgemont')<br/>  Name  Science  Math<br/>5  Lam       89   100</span></pre><p id="6ad0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b"><strong class="ki iu">zone_school</strong></code>变量现在是一个包含<code class="fe le lf lg lh b"><strong class="ki iu">Zone</strong></code>和<code class="fe le lf lg lh b"><strong class="ki iu">School</strong></code>的元组。</p><h1 id="9dc2" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用序列(数据帧中的列)调用groupby()</h1><p id="9245" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">假设你只对有<code class="fe le lf lg lh b"><strong class="ki iu">Math</strong></code>成绩和<code class="fe le lf lg lh b"><strong class="ki iu">School</strong></code>的学生的<code class="fe le lf lg lh b"><strong class="ki iu">Name</strong></code>感兴趣。您现在可以首先按列过滤数据帧，然后调用<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>函数按<strong class="ki iu">区域</strong>对数据帧进行分组:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="ee93" class="mt lj it lh b gy mu mv l mw mx">gp = df<strong class="lh iu">[['Name','Math','School']]</strong>.groupby(<strong class="lh iu">df['Zone']</strong>) # pass in a <br/>                                                      # Series to <br/>                                                      # groupby() <br/>                                                      # function<br/>for zone, group in gp:<br/>    print(zone)<br/>    print(group)</span></pre><p id="3890" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，在这种情况下，您必须将<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>函数传递给一个<code class="fe le lf lg lh b"><strong class="ki iu">Series</strong></code>对象，<strong class="ki iu"> </strong>，因为语句<code class="fe le lf lg lh b"><strong class="ki iu">df[['Name','Math','School']]</strong></code>已经将dataframe减少到只有<code class="fe le lf lg lh b"><strong class="ki iu">Name</strong></code>、<code class="fe le lf lg lh b"><strong class="ki iu">Math,</strong></code>和<code class="fe le lf lg lh b"><strong class="ki iu">School</strong></code>列。以下语句无效:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="0350" class="mt lj it lh b gy mu mv l mw mx"><strong class="lh iu"># Error</strong><br/>gp = df[['Name','Math','School']].groupby(<strong class="lh iu">'Zone'</strong>) <strong class="lh iu"># KeyError: 'Zone'</strong></span></pre><p id="2dd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">前面的代码片段将返回以下内容:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="0619" class="mt lj it lh b gy mu mv l mw mx">East<br/>    Name  Math   School<br/>3  Jimmy    67  Shermer<br/>4   Erik    89  Shermer<br/>North<br/>    Name  Math    School<br/>0  Jonny    78  Rushmore<br/>South<br/>    Name  Math   School<br/>1    Joe    76  Bayside<br/>2  Jakob    56   Rydell<br/>West<br/>   Name  Math     School<br/>5   Lam   100  Ridgemont<br/>6   Yip    55   Hogwarts<br/>7  Chen    76   Hogwarts</span></pre><h1 id="c827" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">DataFrameGroupBy和SeriesGroupBy对象</h1><p id="532a" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">观察前面的陈述:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="e150" class="mt lj it lh b gy mu mv l mw mx">gp = df[['Name','Math','School']].groupby(<strong class="lh iu">df['Zone']</strong>)</span></pre><p id="e7b2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的例子中，<code class="fe le lf lg lh b"><strong class="ki iu">gp</strong></code>是一个<code class="fe le lf lg lh b"><strong class="ki iu">DataFrameGroupBy</strong></code>对象。但是，在下面的语句中:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="62f5" class="mt lj it lh b gy mu mv l mw mx">gp = df['Name'].groupby(df['Zone'])</span></pre><p id="ea3d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b"><strong class="ki iu">gp</strong></code>是一个<code class="fe le lf lg lh b"><strong class="ki iu">SeriesGroupBy</strong></code>对象，因为<code class="fe le lf lg lh b"><strong class="ki iu">df[‘Name’]</strong></code>的结果是一个<code class="fe le lf lg lh b"><strong class="ki iu">Series</strong></code></p><h1 id="e96f" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">提高groupby()的性能</h1><p id="4564" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">注意到<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>功能自动对组键进行分类。如果数据帧很大，最好关闭排序以提高性能:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="53b9" class="mt lj it lh b gy mu mv l mw mx">gp = df[['Name','Math','School']].groupby(df['Zone']<strong class="lh iu">, sort=False</strong>)<br/>for zone, group in gp:<br/>    print(zone)<br/>    print(group)</span></pre><p id="5bd8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在不会对组密钥进行排序:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="10c0" class="mt lj it lh b gy mu mv l mw mx">North<br/>    Name  Math    School<br/>0  Jonny    78  Rushmore<br/>South<br/>    Name  Math   School<br/>1    Joe    76  Bayside<br/>2  Jakob    56   Rydell<br/>East<br/>    Name  Math   School<br/>3  Jimmy    67  Shermer<br/>4   Erik    89  Shermer<br/>West<br/>   Name  Math     School<br/>5   Lam   100  Ridgemont<br/>6   Yip    55   Hogwarts<br/>7  Chen    76   Hogwarts</span></pre><h1 id="51d8" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">执行聚合函数</h1><p id="2230" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">dataframe的一个常见任务是对列执行聚合函数。例如，假设您想找到每个学校的平均分数<code class="fe le lf lg lh b"><strong class="ki iu">Science</strong></code>和<code class="fe le lf lg lh b"><strong class="ki iu">Math</strong></code>。您可以执行以下操作:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="4c73" class="mt lj it lh b gy mu mv l mw mx">df.groupby(['Zone','School'])<strong class="lh iu">.mean()</strong></span></pre><p id="b33f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述语句产生以下结果:</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/e4cc000d758f4dfb0156e4d6b9cef4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*HwD9-MhlBxyDcFvkpqYLWg.png"/></div></figure><p id="ee70" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当您在<strong class="ki iu"> DataframeGroupBy </strong>对象上调用<strong class="ki iu"> mean() </strong>函数时，它会自动计算所有数值列的平均值(在本例中是<strong class="ki iu">科学</strong>和<strong class="ki iu">数学</strong>)。</p><p id="f39f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果只想计算<strong class="ki iu">理科</strong>列的均值，可以对<strong class="ki iu"> groupby() </strong>函数的结果调用<strong class="ki iu"> agg() </strong>函数，如下所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="4bab" class="mt lj it lh b gy mu mv l mw mx">df.groupby(['Zone','School'])<strong class="lh iu">.agg({'Science':'mean'})</strong></span></pre><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/8fa3fb1d33bf93b43b8c9d9381d42f65.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*KHD9N-P1La1kJO8TtBKBOw.png"/></div></figure><p id="01bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想计算<code class="fe le lf lg lh b"><strong class="ki iu">Science</strong></code>列的<em class="na">平均值</em>、<em class="na">最小值</em>和<em class="na">最大值</em>值，那么传入一个包含聚合函数的列表:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="d768" class="mt lj it lh b gy mu mv l mw mx">df.groupby(['Zone','School']).agg({'Science':<strong class="lh iu">['mean','min','max']</strong>})</span></pre><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/a7292f9d73ee32f191628bc1f97350ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*HCKBiAJ34OdPypGXZoPTvA.png"/></div></figure><p id="d828" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，您也可以在<strong class="ki iu"> Math </strong>列上应用聚合函数:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="9139" class="mt lj it lh b gy mu mv l mw mx">df.groupby(['Zone','School']).agg({'Science':['mean','min','max']<strong class="lh iu">,</strong><br/>                                   <strong class="lh iu">'Math'   :['mean','min','max']</strong>})</span></pre><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/3a366ef44396ffaf4b6613c9c4df1599.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*ahOsP4CZcrnpqAXiybiFVg.png"/></div></figure><h1 id="3a82" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">创建自定义聚合函数</h1><p id="8abe" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">除了Pandas中可用的聚合函数(如<code class="fe le lf lg lh b"><strong class="ki iu">mean()</strong></code>、<code class="fe le lf lg lh b"><strong class="ki iu">min()</strong></code>和<code class="fe le lf lg lh b"><strong class="ki iu">max()</strong></code>)，您还可以编写自己的自定义聚合函数。假设您想要查看所有学校的<code class="fe le lf lg lh b"><strong class="ki iu">Science</strong></code>分数，并生成一个列来指示该学校的所有学生是否都通过了该科目。你可以定义一个函数，比如说<code class="fe le lf lg lh b"><strong class="ki iu">grade()</strong></code>:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="b07b" class="mt lj it lh b gy mu mv l mw mx">def grade(score):<br/>    if (score &gt;= 50).all():<br/>        return 'All Pass'<br/>    else:<br/>        return 'Some Failure'</span></pre><p id="3a7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，当从<code class="fe le lf lg lh b"><strong class="ki iu">agg()</strong></code>函数调用一个函数时，参数是一个<code class="fe le lf lg lh b"><strong class="ki iu">Series</strong></code>对象。所以在上面的例子中<code class="fe le lf lg lh b"><strong class="ki iu">score</strong></code>是一个<code class="fe le lf lg lh b"><strong class="ki iu">Series</strong></code>对象。在这里，我正在检查<code class="fe le lf lg lh b"><strong class="ki iu">Series</strong></code>对象中的所有值是否都大于或等于50(使用<code class="fe le lf lg lh b"><strong class="ki iu">.all()</strong></code>函数)。如果是，那么我返回“全部通过”字符串。否则，将返回“某些失败”字符串。</p><p id="9778" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在可以像这样调用<code class="fe le lf lg lh b"><strong class="ki iu">grade</strong></code>函数:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="0895" class="mt lj it lh b gy mu mv l mw mx">df.groupby(['Zone','School']).agg({'Science':['mean','min','max',<strong class="lh iu">grade</strong>]})</span></pre><p id="e445" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结果会是这样的:</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/faf9c3575e2590835e9ea325eeb42bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*86qQU5dFOL7Ngz43ZxRJ-w.png"/></div></figure><h1 id="67fb" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">摘要</h1><p id="145c" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">我希望这个对<code class="fe le lf lg lh b"><strong class="ki iu">groupby()</strong></code>函数的快速介绍是有用的，并有助于减轻你对这个极其强大的函数的恐惧。就像我说的，最好的学习方法是自己去尝试。不要害怕犯错误。你尝试得越多，你就越明白！下次见！</p><div class="ng nh gp gr ni nj"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">weimenglee.medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jz nj"/></div></div></a></div></div></div>    
</body>
</html>