<html>
<head>
<title>A Beginners Guide To Tesseract OCR Using Pytesseract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pytesseract的Tesseract OCR初学者指南</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/a-beginners-guide-to-tesseract-ocr-using-pytesseract-23036f5b2211?source=collection_archive---------1-----------------------#2020-12-28">https://levelup.gitconnected.com/a-beginners-guide-to-tesseract-ocr-using-pytesseract-23036f5b2211?source=collection_archive---------1-----------------------#2020-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/fe2d6ee8d8bdfe0859c51b15bdc695b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fp_lg2Tb-8OwvIcT"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@brandi1?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布兰迪·里德</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="1831" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">光学字符识别</strong>或光学字符阅读器(OCR)是将打字、手写或印刷文本的图像电子或机械转换成机器编码的文本，无论是扫描的文档还是文档的照片。在当今世界，我们不是将数据存储在纸张和书籍上，而是以数字方式存储它们，因为计算机硬件现在可以存储万亿字节的数据，所以我们在1g的硬盘上存储数百万本书没有问题。OCR帮助我们扫描图像、文档或任何纸质文档，并将它们的文本转换为数字文本形式，而不是手写或计算机生成的收据。作为一个过程，OCR通常由几个子过程组成，以尽可能精确地执行。子流程包括:</p><ul class=""><li id="6907" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">图像预处理</li><li id="482b" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">文本本地化</li><li id="b258" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">字符分割</li><li id="8d81" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">字符电子识别</li><li id="7a95" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">后加工</li></ul><p id="ab19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面列表中的子过程当然可以不同，但是这些是实现自动字符识别所需的大致步骤。在OCR编程语言中，我们有tesseract API。它被认为是当时最准确的开源OCR引擎之一。它最初是由惠普开发的，后来谷歌赞助了他们的开发，并对其进行了大量改进。在本文中，我们将介绍如何使用<code class="fe ls lt lu lv b">Pytesseract</code>通过Python读取各种扫描文档。</p><h1 id="2b78" class="lw lx it bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">宇宙魔方</h1><p id="4e26" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">Python-tesseract是Python的光学字符识别(OCR)工具。也就是说，它将识别并“读取”嵌入图像中的文本。</p><p id="5662" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Python-tesseract是<code class="fe ls lt lu lv b">Google’s Tesseract-OCR Engine</code>的包装器。它作为tesseract的独立调用脚本也很有用，因为它可以读取Pillow和Leptonica图像库支持的所有图像类型，包括jpeg、png、gif、bmp、tiff等。此外，如果用作脚本，Python-tesseract将打印识别的文本，而不是将其写入文件。</p><h1 id="5a9a" class="lw lx it bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">安装:</h1><p id="9635" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在windows上安装宇宙魔方非常简单，只需从<a class="ae kf" href="https://digi.bib.uni-mannheim.de/tesseract/" rel="noopener ugc nofollow" target="_blank">这里</a>下载最新版本。有关Mac和Linux安装指南，请访问此处的<a class="ae kf" href="https://tesseract-ocr.github.io/tessdoc/Installation.html" rel="noopener ugc nofollow" target="_blank"/>。安装完成后，通过在终端或cmd中键入命令来验证一切正常</p><p id="cfdb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ls lt lu lv b">tesseract — version</code></p><p id="7c86" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，您可以使用pip为tesseract安装python包装器。<br/> <code class="fe ls lt lu lv b">pip install pytesseract</code></p><h1 id="0684" class="lw lx it bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">图像到文本</h1><p id="d87c" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在一个目录中创建一个py文件，并在你的代码编辑器中打开它，第一步我们将加载by <code class="fe ls lt lu lv b">pytesseract</code>模块和Pillow模块，然后进行图像到文本部分。</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="017d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经导入了我们需要的两个主要模块<code class="fe ls lt lu lv b">pytesseract</code>和<code class="fe ls lt lu lv b">PIL</code>，接下来，我们在<code class="fe ls lt lu lv b">tesseract_cmd</code>类对象中设置宇宙魔方文件夹的路径。我们在代码中使用Pil模块(Pillow)来读取图像，并将其传递给<code class="fe ls lt lu lv b">pytesseract</code>来识别文本。Pytesseract类有一个方法名<code class="fe ls lt lu lv b">image_to_string()</code>，我们通过<code class="fe ls lt lu lv b">Pil</code> open函数传递图像文件名，还有一个语言参数，现在我们不传递任何语言参数，函数将它设置为默认的英语语言，以便从图像中识别文本。下面是我用来提取文本的图片。</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/19b777495028db81d4d2c4dc8ea05ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*t4bo8ptFFmSNbYduTCrcKg.jpeg"/></div></figure><h2 id="5be4" class="ng lx it bd ly nh ni dn mc nj nk dp mg kr nl nm mk kv nn no mo kz np nq ms nr bi translated">输出:</h2><pre class="mz na nb nc gt ns lv nt nu aw nv bi"><span id="cbe1" class="ng lx it lv b gy nw nx l ny nz">THE BIG SLEEP<br/>by Raymond Chandler<br/><br/>It was about eleven o'clock in the morning, mid October, with the sun not<br/>shining and a look of hard wet rain in the clearness of the foothills. I was<br/>wearing my powder-blue suit, with dark blue shirt, tie and display<br/>handkerchief, black brogues, black wool socks with dark blue clocks on them. I was neat, clean, shaved and sober, and I didn’t care who knew it. I was everything the well-dressed private detective ought to be. It was calling on four million dollars. ‘The main hallway of the Sternwood place was two stories high. Over the entrance doors, which would have let in a troop of Indian elephants, there ‘was a broad stained-glass panel showing a knight in dark armor rescuing</span></pre><p id="229c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们更深入地研究一下Pytesseract，我们可以绕过image_to_text方法中的<code class="fe ls lt lu lv b">lang=</code>关键字来处理多种语言。</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="b791" class="ng lx it bd ly nh ni dn mc nj nk dp mg kr nl nm mk kv nn no mo kz np nq ms nr bi translated">在文本周围放置方框</h2><p id="7867" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">Pytesseract可以为您提供OCR的边界框信息。下面的代码将为您提供一个tesseract中边界框检测的每个字符或文本。</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/e41dc8806ae5ed083b2e538a4b2f99ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uXksjgqiwRg2W_N_2nW61Q.png"/></div></div></figure><h2 id="950f" class="ng lx it bd ly nh ni dn mc nj nk dp mg kr nl nm mk kv nn no mo kz np nq ms nr bi translated">输出:</h2><pre class="mz na nb nc gt ns lv nt nu aw nv bi"><span id="d9e7" class="ng lx it lv b gy nw nx l ny nz">O 70 201 98 233 0<br/>r 87 192 109 235 0<br/>b 102 201 116 225 0<br/>i 120 201 140 235 0<br/>t 145 201 168 233 0<br/>i 172 201 178 233 0<br/>n 184 201 203 225 0<br/>g 207 192 228 225 0<br/>t 240 201 254 230 0<br/>h 258 201 278 234 0<br/>i 284 201 289 233 0<br/>s 294 201 309 225 0<br/>a 323 201 342 225 0<br/>t 346 201 360 230 0<br/>...<br/>...<br/>...<br/>...<br/>a 409 25 427 58 0<br/>. 419 25 450 49 0</span></pre><h2 id="f6c7" class="ng lx it bd ly nh ni dn mc nj nk dp mg kr nl nm mk kv nn no mo kz np nq ms nr bi translated">把盒子放在单词上</h2><p id="d184" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">如果你想要单词周围的框而不是字符，函数<code class="fe ls lt lu lv b">image_to_data</code>将会派上用场。您可以使用image_to_data函数，其输出类型由<code class="fe ls lt lu lv b">pytesseract</code>输出指定。我还添加了我们使用<code class="fe ls lt lu lv b">image_to_box</code>方法的同一个图像planet.png的输出。</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="506f" class="ng lx it bd ly nh ni dn mc nj nk dp mg kr nl nm mk kv nn no mo kz np nq ms nr bi translated">输出:</h2><pre class="mz na nb nc gt ns lv nt nu aw nv bi"><span id="8099" class="ng lx it lv b gy nw nx l ny nz">level   page_num        block_num       par_num line_num        word_num        left    top     width   height  conf<br/>        text<br/>1       1       0       0       0       0       0       0       1417    247     -1<br/>2       1       1       0       0       0       17      12      1357    219     -1<br/>3       1       1       1       0       0       17      12      1357    219     -1<br/>4       1       1       1       1       0       70      12      1294    43      -1<br/>5       1       1       1       1       1       70      12      158     43      95      Orbiting<br/>5       1       1       1       1       2       240     13      69      33      96      this<br/>5       1       1       1       1       3       323     17      37      29      96      at<br/>5       1       1       1       1       4       374     22      18      24      96      a<br/>5       1       1       1       1       5       408     13      160    33      96      distance<br/>...<br/>...<br/>...<br/>5       1       1       1       4       3       129     193     116     38      96      pretty<br/>5       1       1       1       4       4       260     193     84      29      95      neat<br/>5       1       1       1       4       5       359     189     91      33      96      idea.</span></pre><h1 id="80a0" class="lw lx it bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">图像预处理</h1><p id="fda8" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">有时图像有一个通常无法读取的文本，在这种情况下，我们需要使用Opencv模块进行图像预处理。Python OpenCV是用C++做的计算机视觉库。使用此命令<code class="fe ls lt lu lv b">pip install python-opencv</code>安装模块，下面是我们将从中提取文本的图像，如果您尝试使用普通的<code class="fe ls lt lu lv b">pytesseract</code>您将不会得到100个结果，因为如果您看到的图像有颜色噪声和一些灯光效果。</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/45b97ce0b1ff5f48d73c5a7bcf722db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyyisAG7o8p4w4son8IHNQ.jpeg"/></div></div></figure><p id="ca8d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在将图像交给OCR之前，我们可以做很多操作来改善图像。下面我将会给你一些建议。检查以下几点。</p><ul class=""><li id="6269" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">将图像转换为灰度</li><li id="09cc" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">将图像转换为黑白</li><li id="a9db" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">消除噪音</li></ul><p id="3fb2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将应用其中的几个。首先，我将调整图像的大小，使其变小，然后我将它转换为灰度，最后，我使用自适应阈值方法将它转换为黑白。</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4b5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有几种方法可以分析页面，tesseract API提供了页面分段模式功能，可以分析小区域或不同的页面方向。要使用页面分割模式，只需使用关键字<code class="fe ls lt lu lv b">— psm.</code>，我们将使用tesseract页面分割<code class="fe ls lt lu lv b">psm 3</code>。而宇宙魔方有13页分段模式。</p><p id="ecdd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是tesseract支持的页面分段模式列表。</p><pre class="mz na nb nc gt ns lv nt nu aw nv bi"><span id="fefc" class="ng lx it lv b gy nw nx l ny nz">0 =   Orientation and script detection (OSD) only.<br/>1 =   Automatic page segmentation with OSD.<br/>2 =  Automatic page segmentation, but no OSD, or OCR.<br/>3 =   Fully automatic page segmentation, but no OSD. (Default)<br/>4 =   Assume a single column of text of variable sizes.<br/>5 =   Assume a single uniform block of vertically aligned text.<br/>6 =   Assume a single uniform block of text.<br/>7 =   Treat the image as a single text line.<br/>8 =   Treat the image as a single word.<br/>9 =   Treat the image as a single word in a circle.<br/>10 =    Treat the image as a single character.<br/>11 =   Sparse text. Find as much text as possible in no particular order.<br/>12 =   Sparse text with OSD.<br/>13 =   Raw line. Treat the image as a single text line, bypassing hacks that are Tesseract-specific.</span></pre><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="7d00" class="ng lx it bd ly nh ni dn mc nj nk dp mg kr nl nm mk kv nn no mo kz np nq ms nr bi translated">输出:</h2><pre class="mz na nb nc gt ns lv nt nu aw nv bi"><span id="cfad" class="ng lx it lv b gy nw nx l ny nz">Desgin before you implement<br/>Particularly if the project invols desgning a product or service<br/>ensure you have the best possible answer in the design phase<br/>befe you start implementation~! Another 80/20 rule says that 20 per cent of the prob/lems with any design project cause 80 per cent of the costs<br/>or overruns"! and are hugely expensive to correct later.<br/>requiring massive rework and in sem cases retooling.</span></pre><p id="64f2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出被很好地检测到，很好，但它是一些小错误，就像你看到一些未知的特殊字符。我们可以应用更多的OpenCV功能来清除图像的噪声，并增加检测的百分比。</p><h1 id="187c" class="lw lx it bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">最后的想法</h1><p id="a0da" class="pw-post-body-paragraph kg kh it ki b kj mu kl km kn mv kp kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">到目前为止，我们已经学习了使用pytessera CT(python tessera CT包装器模块)进行tesseract OCR的基础知识。我们已经看到了如何使用OpenCV函数和tesseract API页面调优函数从图像中提取简单文本和从图像中提取复杂文本。但有时我们有一个文本图像，像非常困难的手写文本或文本验证码，这是非常难以分析的宇宙魔方，所以我们需要更多的调整，以应用于使用Opencv和宇宙魔方函数的图像。因此，请阅读他们的官方文档，进一步探索宇宙魔方。这篇文章只是让你对如何使用tesseract和如何使用计算机视觉提高检测百分比有一点基本的了解。希望这篇文章对你以后有所帮助。请随时分享反馈。</p></div></div>    
</body>
</html>