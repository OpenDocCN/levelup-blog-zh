<html>
<head>
<title>Two simple, reusable custom Hooks for your React Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React应用程序的两个简单、可重复使用的定制挂钩</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/two-simple-reusable-custom-hooks-for-your-react-apps-a0275724f8ab?source=collection_archive---------1-----------------------#2019-01-28">https://levelup.gitconnected.com/two-simple-reusable-custom-hooks-for-your-react-apps-a0275724f8ab?source=collection_archive---------1-----------------------#2019-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2d79a56edf2fbbaa37988a1ca4b33860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wcOrQI9YEQl2bmhIZ9FvxQ.png"/></div></div></figure><p id="d9a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">React的新Hooks API提供了一系列非常棒的工具，供您用来创建和管理应用程序。包含的钩子函数有<code class="fe kw kx ky kz b">useState</code>用于管理组件中的本地状态，<code class="fe kw kx ky kz b">useEffect</code>用于创建各种生命周期方法以及从外部API获取数据，<code class="fe kw kx ky kz b">useContext</code>允许每个组件使用应用上下文的一个实例。此外，React允许您创建自己的定制挂钩，使您能够将组件的逻辑(有状态或无状态)提取到外部化的可重用函数中。</p><p id="e7c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据<a class="ae la" href="https://reactjs.org/docs/hooks-custom.html" rel="noopener ugc nofollow" target="_blank"> React文档</a>，“<strong class="ka ir">自定义钩子是一个JavaScript函数，它的名字以‘use’开头，可以调用其他钩子。”</strong>建议使用这种命名约定是为了遵循已经存在的模式。</p><p id="200b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于编写你自己的定制钩子，我最喜欢的部分是它们不仅可以在定义它们的应用程序中重用，而且可以在你所有的应用程序中重用。对于我将要描述的两个钩子也是如此。所以让我们开始吧。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="d177" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">useInputValue</h1><pre class="mg mh mi mj gt mk kz ml mm aw mn bi"><span id="7ef4" class="mo lj iq kz b gy mp mq l mr ms">import { useState } from "react";</span><span id="4ca6" class="mo lj iq kz b gy mt mq l mr ms">export const useInputValue = initialValue =&gt; {<br/>  const [value, setValue] = useState(initialValue);<br/>   return {<br/>     value,<br/>     onChange: e =&gt; { <br/>      setValue(e.target.value || e.target.innerText);<br/>    };  <br/>  };<br/>};</span></pre><p id="f96a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意这里我们甚至不需要<code class="fe kw kx ky kz b">React</code>，因为我们不返回/呈现任何JSX，这仅仅是一个JavaScript函数。<code class="fe kw kx ky kz b">useInputValue</code>函数只是接受一个初始值，将其设置为从<code class="fe kw kx ky kz b">useState</code>接收的<code class="fe kw kx ky kz b">value</code>变量的值，然后返回一个包含该值的对象和一个更新该值的<code class="fe kw kx ky kz b">onChange</code>函数。我知道这看起来有点奇怪，但是它使得在组件中处理输入更加简洁。让我们看一个如何使用它的例子:</p><pre class="mg mh mi mj gt mk kz ml mm aw mn bi"><span id="fc19" class="mo lj iq kz b gy mp mq l mr ms">import React from "react";<br/>import { Link } from "react-router-dom";<br/>import { useInputValue } from "./hooks/useInputValue";<br/>import { loginUser } from "../api/user"; </span><span id="c03a" class="mo lj iq kz b gy mt mq l mr ms">const Landing = () =&gt; {  <br/>const email = useInputValue("");  <br/>const password = useInputValue("");   </span><span id="d911" class="mo lj iq kz b gy mt mq l mr ms">const handleSubmit = e =&gt; {    <br/>  e.preventDefault();    <br/>  loginUser(email.value, password.value);<br/>};</span><span id="87a1" class="mo lj iq kz b gy mt mq l mr ms">...</span><span id="ea0d" class="mo lj iq kz b gy mt mq l mr ms">&lt;input type="text" placeholder="Email" {...email} /&gt;<br/>&lt;input type="password" placeholder="Password" {...password} /&gt;</span></pre><p id="cc36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">语法最初可能令人不快，但是如果你熟悉<a class="ae la" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax" rel="noopener ugc nofollow" target="_blank">对象传播</a>的话，这实际上很酷。如果你还记得，我们从我们的自定义钩子返回一个对象，所以<code class="fe kw kx ky kz b">email</code>看起来像这个<code class="fe kw kx ky kz b">{ value, onChange: () =&gt; ...}</code>。这意味着通过将<code class="fe kw kx ky kz b">email</code>和<code class="fe kw kx ky kz b">password</code>变量分布在我们的输入上，我们将<code class="fe kw kx ky kz b">onChange</code>处理程序暴露给了输入，因此这就是我们更新输入值所需要的。请记住，如果我们将updater函数命名为除了<code class="fe kw kx ky kz b">onChange</code>或React中的任何其他事件侦听器之外的任何名称，则spread语法将不起作用。</p><h1 id="c8c6" class="li lj iq bd lk ll mu ln lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf bi translated">使用开关</h1><p id="48bc" class="pw-post-body-paragraph jy jz iq ka b kb mz kd ke kf na kh ki kj nb kl km kn nc kp kq kr nd kt ku kv ij bi translated">这可能是我最喜欢的，我在我工作的项目中经常使用它。它也非常简洁，可读性很强:</p><pre class="mg mh mi mj gt mk kz ml mm aw mn bi"><span id="34c0" class="mo lj iq kz b gy mp mq l mr ms">import { useState, useCallback } from "react";</span><span id="00c5" class="mo lj iq kz b gy mt mq l mr ms">export const useToggle = (initial) =&gt; {  <br/>  const [open, setOpen] = useState(initial);   <br/>  <br/>  return [open, useCallback(() =&gt; setOpen(status =&gt; !status))];<br/>};</span></pre><p id="aa52" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意我是如何利用React提供的<code class="fe kw kx ky kz b"><a class="ae la" href="https://reactjs.org/docs/hooks-reference.html#usecallback" rel="noopener ugc nofollow" target="_blank">useCallback</a></code>钩子的。这个钩子做了你认为它会做的事情，允许你，根据React文档，“<em class="ne">返回一个回调的记忆版本，只有当其中一个输入改变时它才会改变。这在将回调传递给依赖引用相等来防止不必要呈现的优化子组件时很有用。</em></p><p id="3414" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">说什么？？“记忆化”本身就是一个话题，我不会在这里深入探讨，但是如果你想了解更多，请查看这篇文章。我是这样解释文档的解释的:每当我们使用<code class="fe kw kx ky kz b">useCallback</code>钩子时，它足够聪明地知道组件是否需要被重新呈现(“引用相等”位)或者切换功能是否需要发生。为了实现这种切换功能，我们又一次有了一个函数，它接收一个初始值，并将其存储在从<code class="fe kw kx ky kz b">useState</code>接收的状态(<code class="fe kw kx ky kz b">open</code>)中。然后，它返回一个具有该状态的数组以及一个回调来切换容器的打开状态。仅此而已。</p><p id="2d2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，这里有一个我如何使用这个钩子来切换搜索过滤器的查看能力的例子(注意，我使用的是<a class="ae la" href="https://www.npmjs.com/package/styled-components" rel="noopener ugc nofollow" target="_blank">样式化组件</a>):</p><pre class="mg mh mi mj gt mk kz ml mm aw mn bi"><span id="5a1c" class="mo lj iq kz b gy mp mq l mr ms">import React, { useState, useEffect } from "react";<br/>import { Link } from "react-router-dom";<br/>import { useToggle } from "../hooks/useToggle";<br/>import {  LandingContainer,  FlexContainer,  Button} from "../styled_elements/layout";<br/>import Filters from "./Filters";<br/>import { fetchProducts } from "../actions/index";<br/>import { Pages } from "../styled_elements/layout";<br/>import ProductList from "./ProductList"; </span><span id="7d90" class="mo lj iq kz b gy mt mq l mr ms">const Landing = ({ products, total, pages }) =&gt; {  <br/>  const [open, toggle] = useToggle(false);<br/>  const [activePage, setActivePage] = useState(1);<br/>   <br/> useEffect(() =&gt; {      <br/>  fetchProducts(activePage);<br/> },<br/>  [activePage] <br/> );</span><span id="c6b9" class="mo lj iq kz b gy mt mq l mr ms">const handlePageClick = page =&gt; setActivePage(page);</span><span id="6048" class="mo lj iq kz b gy mt mq l mr ms">const pageCrumbs = generatePages();<br/>  return (    <br/>  &lt;&gt;      <br/>{open &amp;&amp; &lt;Filters /&gt;}      <br/>&lt;LandingContainer&gt;        <br/>  &lt;div&gt;          <br/>   &lt;Pages&gt;{pageCrumbs}&lt;/Pages&gt;        <br/>  &lt;/div&gt;        <br/>  &lt;FlexContainer&gt;          <br/>    &lt;Button onClick={toggle}&gt;Refine search&lt;/Button&gt;<br/>    &lt;Link to="/reviews"&gt;&lt;Button&gt;View reviews&lt;/Button&gt;&lt;/Link<br/>  &lt;/FlexContainer&gt;</span></pre><p id="85bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，<code class="fe kw kx ky kz b">&lt;Filters /&gt;</code>组件和<code class="fe kw kx ky kz b">toggle</code>函数的条件呈现被传递给“Refine search”按钮。这只是利用这个钩子的许多不同方法中的一种，它真的适用于你想切换的任何东西。</p><p id="46cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我就知道这些了。我希望你能从中找到一些用处，或者如果你有任何改进的建议或者你自己的一些窍门，我很乐意听听。</p><p id="d352" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我离开之前，【useHooks.com】是一个很棒的基于订阅的网站，它提供了大量你能想象到的定制挂钩。如果你想了解更多关于React钩子的知识，我强烈建议你去看看。</p><p id="06c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的倾听。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><figure class="mg mh mi mj gt jr gh gi paragraph-image"><a href="https://levelup.gitconnected.com"><div class="gh gi nf"><img src="../Images/9914c5dd23ac08b70eea6f4f9ba6fed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E6CoI_MRyZ1JInNPsBSHtA.png"/></div></a></figure><div class="ng nh gp gr ni nj"><a href="https://gitconnected.com/learn/react" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd ir gy z fp no fr fs np fu fw ip bi translated">学习React -最佳React教程(2019) | gitconnected</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">排名前49的React教程-免费学习React。课程由开发人员提交并投票，使您能够…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">gitconnected.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jw nj"/></div></div></a></div></div></div>    
</body>
</html>