<html>
<head>
<title>How to display images from Google drive folder to your webpage using Google Apps Script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Google Apps脚本将Google drive文件夹中的图像显示到您的网页上</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-display-images-from-google-drive-folder-to-your-webpage-using-google-apps-script-33a6fabfad16?source=collection_archive---------1-----------------------#2022-11-27">https://levelup.gitconnected.com/how-to-display-images-from-google-drive-folder-to-your-webpage-using-google-apps-script-33a6fabfad16?source=collection_archive---------1-----------------------#2022-11-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/90c9f00cdb5b23d8f92062cbcac00030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*I9-rdS3OVQSVa8oLMunU4A.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">图片来源:Dev Genius博客</figcaption></figure><p id="481b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">图片总是通过上传到你的主机服务器并使用HTML代码中的路径显示在你的网站上，对吗？</p><p id="9a36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是，我有一个方法可以使用Google Apps脚本来自动化这个过程。下面是对该过程的详细解释。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="ef48" class="ld le iq bd lf lg lh dn li lj lk dp ll kj lm ln lo kn lp lq lr kr ls lt lu lv bi translated">从Google drive文件夹获取图像的过程</h2><ol class=""><li id="305c" class="lw lx iq ka b kb ly kf lz kj ma kn mb kr mc kv md me mf mg bi translated">创建函数来获取Google Drive图像的URL</li><li id="ba2d" class="lw lx iq ka b kb mh kf mi kj mj kn mk kr ml kv md me mf mg bi translated">将脚本发布为Web应用程序</li><li id="44fd" class="lw lx iq ka b kb mh kf mi kj mj kn mk kr ml kv md me mf mg bi translated">解析网页上的JSON数组</li></ol></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="5424" class="ld le iq bd lf lg lh dn li lj lk dp ll kj lm ln lo kn lp lq lr kr ls lt lu lv bi translated">步骤1:创建函数来获取Google Drive图像的URL</h2><p id="480a" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">我们需要从Google drive创建Google脚本文件，并编写如下脚本:</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/5e4fd01ccecf63b7339b068bd1345492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*YHNFVqU6_zxwJTWDTE9hNg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">创建Google应用程序脚本文件</figcaption></figure><p id="fc20" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建Google Apps脚本文件后，我们编写了如下代码块所示的脚本。</p><pre class="mq mr ms mt gt mu mv mw bn mx my bi"><span id="727b" class="mz le iq mv b be na nb l nc nd">var filelinks = [];<br/>var mimetypes = ["image/png","image/jpeg","image/gif","image/bmp"];<br/><br/>function doGet(e) {<br/><br/>  var fid;<br/>  //var data = travseFolderGetId(e.parameters.folderId[0]);<br/>  if(e.parameters.fid==undefined){<br/>  fid='YOUR_FOLDER_ID';  // you can get it from folder URL, after folder/YOUR_FOLDER_ID <br/>  }  <br/>  var data = imageItems(fid);<br/>  return   buildSuccessResponse(data, 1); <br/>}</span></pre><p id="67fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面写的<strong class="ka ir"> doGet() </strong>函数会将响应返回给你的Web API，这里我们只是在<strong class="ka ir"> fid </strong>变量中定义了文件夹Id，并将其传递给<strong class="ka ir"> imageItems() </strong>函数。</p><p id="e815" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们详细看看<strong class="ka ir"> imageItems() </strong>函数的脚本。</p><pre class="mq mr ms mt gt mu mv mw bn mx my bi"><span id="2f5d" class="mz le iq mv b be na nb l nc nd">function imageItems(folderid){<br/> var folder = DriveApp.getFolderById(folderid);<br/> var files=folder.getFiles();  <br/>  var x=0;<br/>  <br/>  while(files.hasNext()){<br/>    <br/>    var file = files.next();<br/>    if( mimetypes.indexOf(file.getMimeType()) != -1){   <br/>      var filelink ={};<br/>      filelink['img_id']=file.getId();<br/>    <br/>      console.log(filelink['img_id']+"---folder:"+filelink['folder_id']+"\n\n");<br/>      filelinks.push(filelink);<br/>    }<br/>  return filelinks;<br/>  }</span></pre><p id="d610" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面编写的函数中，我们使用文件夹id从文件夹中获取文件，并使用<strong class="ka ir"> <em class="ne"> img_id </em> </strong>键值将它们存储在<strong class="ka ir"> filelink </strong>数组中。通过这样做，我们最终得到了包含所有文件URL的<strong class="ka ir"> filelink </strong>数组，这些URL是文件夹中图像的链接，在函数的末尾，我们将数组返回给<strong class="ka ir"> doGet() </strong>函数。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="c05e" class="ld le iq bd lf lg lh dn li lj lk dp ll kj lm ln lo kn lp lq lr kr ls lt lu lv bi translated">步骤2:将脚本发布为Web应用程序</h2><p id="d321" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">现在，我们在过程的末尾，我们只需要创建函数，它用于生成构建响应，包括我们从函数中获得的所有返回类型。同样的请见剧本。</p><pre class="mq mr ms mt gt mu mv mw bn mx my bi"><span id="5d1c" class="mz le iq mv b be na nb l nc nd">function buildSuccessResponse(posts, pages) {<br/>  var output = JSON.stringify({<br/>    status: 'success',<br/>    data: posts,<br/>    pages: pages<br/>  });<br/>  <br/>  return ContentService.createTextOutput(output).setMimeType(ContentService.MimeType.JSON);<br/>}</span></pre><p id="7087" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如图所示，我们在数据键中发送响应，其他键仅用于信息标签，它通知响应已成功发送。</p><p id="220e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们需要通过脚本编辑器<strong class="ka ir">部署</strong>菜单选项将脚本发布为Web App，如屏幕截图所示。点击<strong class="ka ir">部署</strong>，发布为<strong class="ka ir"> Web app </strong>。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/e3279163384b7dcab998607a03c187c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*C4euzZLYfZP2W0IluIPm2Q.png"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="ae38" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在在单个框架中查看整个代码。</p><pre class="mq mr ms mt gt mu mv mw bn mx my bi"><span id="cfa7" class="mz le iq mv b be na nb l nc nd"><br/>var filelinks = [];<br/>var mimetypes = ["image/png","image/jpeg","image/gif","image/bmp"];<br/><br/>function doGet(e) {<br/><br/>  var fid;<br/>  if(e.parameters.fid==undefined){<br/>  fid='YOU_FOLDER_ID';<br/>  }  else {<br/>    fid=e.parameters.fid[0];<br/>  }<br/>  var data = travseItems(fid);<br/>  return   buildSuccessResponse(data, 1);<br/>  <br/>}<br/><br/><br/>function travseItems(folderid){<br/> var folder = DriveApp.getFolderById(folderid);<br/> var files=folder.getFiles();  <br/>  var x=0;<br/>  <br/>  while(files.hasNext()){<br/>    <br/>    var file = files.next();<br/>    if( mimetypes.indexOf(file.getMimeType()) != -1){   <br/>      var filelink ={};<br/>      filelink['img_id']=file.getId();<br/>      filelink['name']='';<br/>      filelink['folder_id']='';<br/>    <br/>      console.log(filelink['img_id']+"---folder:"+filelink['folder_id']+"\n\n");<br/>      filelinks.push(filelink);<br/>    }<br/><br/>  }  //is file<br/> <br/>  return filelinks;<br/>}<br/><br/><br/>function buildSuccessResponse(posts, pages) {<br/>  var output = JSON.stringify({<br/>    status: 'success',<br/>    data: posts,<br/>    pages: pages<br/>  });<br/>  <br/>  return ContentService.createTextOutput(output).setMimeType(ContentService.MimeType.JSON);<br/>}</span></pre></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="9a92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第三步:解析网页上的JSON数组</strong></p><p id="443c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在编程语言中有很多不同的方法来解析网页上的JSON数组。我们将在PHP编程语言中看到它，如下所示。</p><p id="54b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发布Web应用程序后，您将获得如下URL:</p><p id="399e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae nf" href="https://script.google.com/macros/s/AKuskiehfbx9wvmmnkIEAXfFUXKfuN-spGN31kNT7c8qfOwdsPCJW5SrVi0/exec" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="ne">https://script . Google . com/macros/s/akuskiehfbx 9 wvmmnkieaxffuxkfun-spgn 31 knt 7 c 8 qfowdspcj w5 srvi 0/exec</em></strong></a></p><p id="019f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在在PHP代码中使用这个URL，如下所示:</p><pre class="mq mr ms mt gt mu mv mw bn mx my bi"><span id="3287" class="mz le iq mv b be na nb l nc nd">&lt;?php <br/>                            <br/>      $json = file_get_contents('YOUR_WEB_APP_URL');<br/>      $obj = json_decode($json);<br/>      $list = $obj-&gt;data;<br/>      <br/>      for($i=0;$i&lt;count($list); $i++){<br/>          $url_split[$i] = explode('/d/',$list[$i]-&gt;book_url);<br/>          $image_id[$i] = explode('/view', $url_split[$i][1]);<br/>          print_r($image_id[$i][0]);<br/>       }                       <br/>   ?&gt;</span></pre><p id="90f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从上面的代码中，您将获得这个</p><p id="48dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">变量=&gt; <strong class="ka ir"> $image_id[$i] </strong></p><p id="06f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你需要在你的HTML <img/>标签中使用这个图片id，如下所示:</p><pre class="mq mr ms mt gt mu mv mw bn mx my bi"><span id="8ec8" class="mz le iq mv b be na nb l nc nd">&lt;img src="&lt;?php echo 'https://drive.google.com/uc?export=view&amp;id='.$image_id[$i][0]?&gt;" &gt; </span></pre><p id="57a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用PHP中的for循环，你在Google drive文件夹中所有可用的图片都会显示在这个<strong class="ka ir"> &lt; img &gt; </strong>标签中。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="688d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这篇文章对你有所帮助。更多此类文章请<strong class="ka ir"> <em class="ne">向上投票，关注并与朋友分享</em> </strong>此文。</p><p id="9e7b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你有兴趣学习Google Apps脚本和自动化你的Google Workspace？一定要在“<a class="ae nf" href="https://www.amazon.com/dp/B0BTJC9X5R" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Google Apps脚本:初学者指南</strong> </a>”上试试这本<strong class="ka ir">电子书</strong></p><p id="0fa3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">快乐学习…😁✌️</p><p id="3387" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于本文的任何疑问或任何其他技术建议，您可以发送电子邮件至—<strong class="ka ir">dilipkashyap.sd@gmail.com</strong></p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="f94e" class="ng le iq bd lf nh ni nj li nk nl nm ll nn no np lo nq nr ns lr nt nu nv lu nw bi translated">分级编码</h1><p id="a348" class="pw-post-body-paragraph jy jz iq ka b kb ly kd ke kf lz kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="a3e6" class="lw lx iq ka b kb kc kf kg kj nx kn ny kr nz kv oa me mf mg bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="2e8f" class="lw lx iq ka b kb mh kf mi kj mj kn mk kr ml kv oa me mf mg bi translated">📰查看<a class="ae nf" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="9b50" class="lw lx iq ka b kb mh kf mi kj mj kn mk kr ml kv oa me mf mg bi translated">🔔关注我们:<a class="ae nf" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae nf" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae nf" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="6c04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">🚀👉<a class="ae nf" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">加入升级人才集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>