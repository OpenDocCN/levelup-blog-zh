<html>
<head>
<title>Git diffing advanced</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Git差分高级</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/git-diffing-advanced-634aa02d16e8?source=collection_archive---------6-----------------------#2020-03-29">https://levelup.gitconnected.com/git-diffing-advanced-634aa02d16e8?source=collection_archive---------6-----------------------#2020-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5f6c4c4ffb9710e17646ecfd3f1814fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMz3Q9meJ2LZCiKOnr4FZA.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">迪特尔马·贝克尔在<a class="ae jg" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><div class=""/><p id="7b41" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">版本控制的主要目的是使您能够管理对相同文件所做的更改。Git提供了一个命令<strong class="ki jk"> diff </strong>，它比较两个输入数据集并输出它们之间的变化。<code class="fe le lf lg lh b">git diff</code>是一个多用途的Git命令，当它被执行时，在Git数据源上运行一个diff函数。这些数据源可以是提交、分支、文件等等。</p><p id="e8eb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff</code>将显示自上次提交以来任何未提交的更改。差异将以补丁格式显示。修补格式意味着显示两个版本之间不同(添加或删除)的行。</p><h1 id="26eb" class="li lj jj bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">阅读差异:输出</h1><p id="fb03" class="pw-post-body-paragraph kg kh jj ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">让我们比较两个项目:项目# 1和项目#2。在大多数情况下，#1和#2可能是同一个文件，但也可能是提交、分支等。现在我们将使用文件比较来理解该命令。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="f001" class="mt lj jj lh b gy mu mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>index 532ce54..0f42eb5 100644<br/>--- a/example_diff.txt<br/>+++ b/example_diff.txt<br/>@@ -1 +1 @@<br/>-examplediff<br/>+example diff</span></pre><h2 id="7b31" class="mt lj jj bd lk my mz dn lo na nb dp ls kr nc nd lw kv ne nf ma kz ng nh me ni bi translated">比较输入</h2><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="dbed" class="mt lj jj lh b gy mu mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt</span></pre><p id="2513" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一行显示diff的输入源。我们可以看到<code class="fe le lf lg lh b">a/diff_test.txt</code>和<code class="fe le lf lg lh b">b/diff_test.txt</code>已经被传递给了diff。</p><h2 id="5a7b" class="mt lj jj bd lk my mz dn lo na nb dp ls kr nc nd lw kv ne nf ma kz ng nh me ni bi translated">[计]元数据</h2><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="9df6" class="mt lj jj lh b gy mu mv l mw mx">index 532ce54..0f42eb5 100644</span></pre><p id="a4aa" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一行显示了一些内部Git元数据。你很可能不需要这些信息。这个输出中的数字对应于Git对象版本散列标识符。</p><h2 id="3f3a" class="mt lj jj bd lk my mz dn lo na nb dp ls kr nc nd lw kv ne nf ma kz ng nh me ni bi translated">变更标记</h2><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="1c8f" class="mt lj jj lh b gy mu mv l mw mx">--- a/example_diff.txt<br/>+++ b/example_diff.txt</span></pre><p id="1d70" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些线是为每个diff输入源分配符号的图例。在这种情况下，来自<code class="fe le lf lg lh b">a/diff_test.txt</code>的变化标有<code class="fe le lf lg lh b">---</code>，来自<code class="fe le lf lg lh b">b/diff_test.txt</code>的变化标有<code class="fe le lf lg lh b">+++</code>符号。</p><h2 id="e0d2" class="mt lj jj bd lk my mz dn lo na nb dp ls kr nc nd lw kv ne nf ma kz ng nh me ni bi translated">差异块</h2><p id="4932" class="pw-post-body-paragraph kg kh jj ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">剩下的diff输出是diff“块”的列表。差异仅显示文件中有更改的部分。在我们当前的例子中，我们只有一个块，因为我们正在处理一个简单的场景。组块有自己的粒度输出语义。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="7d82" class="mt lj jj lh b gy mu mv l mw mx">@@ -1 +1 @@<br/>-examplediff<br/>+example diff</span></pre><p id="127c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一行是块头。每个块都有一个包含在<code class="fe le lf lg lh b">@@</code>符号中的头。文件头的内容是对文件所做更改的总结。在我们简化的例子中，我们有-1 +1，意味着第一行已经改变。在更实际的diff中，您会看到一个标题，如下所示:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="75b9" class="mt lj jj lh b gy mu mv l mw mx">@@ -40,6 +62,15 @@</span></pre><p id="cbaf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个标题示例中，从第40行开始提取了6行。此外，从第62行开始添加了15行。</p><p id="317a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">diff块的剩余内容显示最近的更改。每一个被修改的行前面都有一个<code class="fe le lf lg lh b">+</code>或<code class="fe le lf lg lh b">-</code>符号，表示修改来自哪个版本的diff输入。正如我们之前所讨论的，<code class="fe le lf lg lh b">-</code>表示从<code class="fe le lf lg lh b">a/example_diff.txt</code>开始的变化，<code class="fe le lf lg lh b">+</code>表示从<code class="fe le lf lg lh b">b/example_diff.txt</code>开始的变化。</p><h1 id="dde3" class="li lj jj bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">有用的命令</h1><p id="f27c" class="pw-post-body-paragraph kg kh jj ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --name-only</code>将给出被修改的文件名的快速摘要。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="c599" class="mt lj jj lh b gy mu mv l mw mx">$ git diff --name only</span><span id="0bcc" class="mt lj jj lh b gy nj mv l mw mx">example_diff.txt</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="ccdc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --name-status</code>将快速总结已修改的文件名以及状态信息。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="b631" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->--name-status</span><span id="549a" class="mt lj jj lh b gy nj mv l mw mx">M       example_diff.txt</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="31a4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --word-diff</code>将在<em class="nr">字</em>粒度级别显示差异。单词被分成记号，其中空格被用作分隔符。<br/><code class="fe le lf lg lh b">[- -]</code>中的项目代表删除的项目，<code class="fe le lf lg lh b">{+ +}</code>中的项目代表增加的项目。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="8f58" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->--word-diff</span><span id="9800" class="mt lj jj lh b gy nj mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>index 532ce54..0f42eb5 100644<br/>--- a/example_diff.txt<br/>+++ b/example_diff.txt<br/>@@ -1 +1 @@<br/>[-examplediff-]{+example diff+}</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="3521" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --ignore-all-space</code>比较时忽略所有空格。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="0af4" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->--ignore-all-space</span><span id="bea0" class="mt lj jj lh b gy nj mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>index 532ce54..7d13e83 100644<br/>--- a/example_diff.txt<br/>+++ b/example_diff.txt<br/>@@ -1 +1,2 @@<br/> example diff<br/>+new line</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="51c4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --ignore-space-at-eol</code>忽略行尾的空白变化。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="15ef" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->--ignore-space-at-eol</span><span id="6f8e" class="mt lj jj lh b gy nj mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>index 532ce54..0f42eb5 100644<br/>--- a/example_diff.txt<br/>+++ b/example_diff.txt<br/>@@ -1 +1 @@<br/>-examplediff<br/>+example diff</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="198d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --ignore-blank-lines</code>忽略所有行都是空白的更改。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="12b3" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->--ignore-blank-lines</span><span id="0e82" class="mt lj jj lh b gy nj mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>index 532ce54..0f42eb5 100644<br/>--- a/example_diff.txt<br/>+++ b/example_diff.txt<br/>@@ -1 +1 @@<br/>-examplediff<br/>+example diff</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="770e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --[staged|cached]</code>根据本地存储库区分临时区域。暂存和缓存是同义词，可以互换使用。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="5a65" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->--staged</span><span id="4083" class="mt lj jj lh b gy nj mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>new file mode 100644<br/>index 0000000..532ce54<br/>--- /dev/null<br/>+++ b/example_diff.txt<br/>@@ -0,0 +1 @@<br/>+examplediff</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="8ce8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff &lt;ident&gt;</code>也可以指定一个版本进行比较。<code class="fe le lf lg lh b">&lt;ident&gt;</code>将是SHA提交、对它的引用或符号名。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="1845" class="mt lj jj lh b gy mu mv l mw mx">$ git diff <!-- -->HEAD</span><span id="8e7c" class="mt lj jj lh b gy nj mv l mw mx">diff --git a/example_diff.txt b/example_diff.txt<br/>new file mode 100644<br/>index 0000000..532ce54<br/>--- /dev/null<br/>+++ b/example_diff.txt<br/>@@ -0,0 +1 @@<br/>+examplediff</span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="1083" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff &lt;ident1&gt; &lt;ident2&gt;</code>将显示用<code class="fe le lf lg lh b">&lt;ident1&gt;</code>和<code class="fe le lf lg lh b">&lt;ident2&gt;</code>指定的两次提交之间的差异。<code class="fe le lf lg lh b">&lt;ident&gt;</code>将是SHA提交、对它的引用或符号名。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="ed7b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff &lt;ident1&gt; &lt;ident2&gt; -- &lt;filename&gt;</code>与先前相同，但将显示仅与<code class="fe le lf lg lh b">&lt;filename&gt;</code>相关的变更。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="5176" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">git diff --raw</code>将以原始格式显示差异。这与<code class="fe le lf lg lh b">git st -s</code>类似，但会用不同的特定数据来修饰它。</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="c894" class="mt lj jj lh b gy mu mv l mw mx">$ <!-- -->git diff --raw</span><span id="e28a" class="mt lj jj lh b gy nj mv l mw mx">:100644 100644 532ce54... 0000000... M  example_diff.txt</span></pre><h1 id="28be" class="li lj jj bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">用于区分的GUI工具</h1><p id="5df7" class="pw-post-body-paragraph kg kh jj ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">在终端/命令行中运行<code class="fe le lf lg lh b">git diff</code>将显示补丁格式的变化。但是有时候使用视觉界面更方便。为此git提供了一个特殊的命令<code class="fe le lf lg lh b">git difftool</code>。通过调用这个命令，git用适当的参数启动所需的工具。</p><p id="b120" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用的一些最常用的比较工具(在撰写本文时)有:</p><ul class=""><li id="c59e" class="ns nt jj ki b kj kk kn ko kr nu kv nv kz nw ld nx ny nz oa bi translated">KDiff3</li><li id="8324" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">P4Merge</li><li id="ee8b" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">无与伦比</li><li id="4b07" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">千变万化</li><li id="3bac" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">代码比较</li><li id="b9fd" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">Vimdiff</li><li id="46f8" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">WinMerge</li><li id="26bc" class="ns nt jj ki b kj ob kn oc kr od kv oe kz of ld nx ny nz oa bi translated">合并</li></ul><p id="e875" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要配置特定的工具，可以使用下面的<br/> <code class="fe le lf lg lh b">git config --global diff.tool &lt;tool&gt;</code> <br/>，其中<code class="fe le lf lg lh b">&lt;tool&gt;</code>代表工具的简单名称(例如kdiff3、meld、…)</p><p id="5127" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个恼人的事情是可以抑制的提示信息，每个文件被区分。消息看起来是这样的:<em class="nr">“查看(1/3): 'file.txt '启动' kdiff3' [Y/n]: " </em>。这可以通过在运行difftool时添加<code class="fe le lf lg lh b">--no-prompt</code>选项或将<code class="fe le lf lg lh b">difftool.prompt</code>配置值设为false <br/> <code class="fe le lf lg lh b">git config --global difftool.prompt false</code>来抑制。</p><p id="5863" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有些情况下，用户会将diff工具安装在默认位置以外的目录中。假设您已经在Windows上的以下路径安装了kdiff 3<em class="nr">C:/apps/kdiff 3。</em> Git不知道如何使用安装在这里的应用程序，所以我们现在应该帮助Git并通过<code class="fe le lf lg lh b">git config --global difftool.kdiff3.path &lt;path&gt;</code>为difftool设置路径值</p></div></div>    
</body>
</html>