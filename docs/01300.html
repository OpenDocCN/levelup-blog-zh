<html>
<head>
<title>What is the 2’s Complement?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是二进制补码？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/what-is-the-2s-complement-d185800bcdab?source=collection_archive---------1-----------------------#2019-12-13">https://levelup.gitconnected.com/what-is-the-2s-complement-d185800bcdab?source=collection_archive---------1-----------------------#2019-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a43621664b6e5569287426dc7d62cba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nhu2QYrst87Vs9D1"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@markusspiske" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kc" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="40a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">二进制补码是对二进制数的数学运算，也是大多数数字系统存储数字的方式。<br/> NB。在进一步阅读之前，你应该对二进制数字系统有一个很好的理解。</p><h1 id="b3c0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何取2的补码</h1><h2 id="2d65" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf lp ks mg mh lt kw mi mj lx mk bi translated">方法一</h2><p id="e618" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">要得到一个数的二进制补码，只需对每个位进行补码，然后加1。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="793f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">例子</strong></p><p id="748e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">二进制中的数字<code class="fe mx my mz na b">6</code>为<code class="fe mx my mz na b">0110</code>，取2的补码，对每一位进行补码:<code class="fe mx my mz na b">1001</code>，加1: <code class="fe mx my mz na b">1010</code></p><h2 id="fff8" class="lz lc iq bd ld ma mb dn lh mc md dp ll ko me mf lp ks mg mh lt kw mi mj lx mk bi translated">方法二</h2><p id="252c" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">另一种取二进制补码的方法是从右边的位开始，向左移动，直到找到第一个<code class="fe mx my mz na b">1</code>，然后对其后的每个位进行补码。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="1a01" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">例子</strong></p><p id="6e31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">二进制中的数字10是<code class="fe mx my mz na b">01010</code>，右边的位是<code class="fe mx my mz na b">0</code>，所以我们保留它，下一个位是<code class="fe mx my mz na b">1</code>，所以在它之后的每一位都向左补。<br/>于是我们有了<code class="fe mx my mz na b">10110</code>。</p><h1 id="60ec" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">二进制补码和负数表示</h1><p id="e93b" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">如果你取一个正数的二进制补码，你就得到这个数的负表示，反之亦然。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="c806" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">示例</strong></p><p id="9dfd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你取<code class="fe mx my mz na b">5</code> ( <code class="fe mx my mz na b">0101</code>)的2的补码，你得到<code class="fe mx my mz na b">1011</code>这就是你如何表示<code class="fe mx my mz na b">-5</code>。<br/>如果取-5的2的补码(<code class="fe mx my mz na b">1011</code>，得到<code class="fe mx my mz na b">0101</code>，也就是<code class="fe mx my mz na b">5</code>。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="63cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">怎么知道<code class="fe mx my mz na b">1011</code>是<code class="fe mx my mz na b">-5</code>，还是<code class="fe mx my mz na b">11</code>？<br/>负数使用二进制补码结合所谓的“有符号数表示法”进行存储。<br/>用有符号数表示，最高有效位(MSB)，即左边的数，用来表示该数是正(<code class="fe mx my mz na b">0</code>)还是负(<code class="fe mx my mz na b">1</code>)。这个位被称为“符号位”。只要遵循二进制补码方法，并记住MSB是符号位，您可以使用任意位数来表示+ve或–ve数。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="27dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">示例</strong></p><p id="a2ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数字<code class="fe mx my mz na b">6</code>可以表示为<code class="fe mx my mz na b">0110</code>，那么–ve的表示就是<code class="fe mx my mz na b">1010</code>。<br/>我们可以在<code class="fe mx my mz na b">0110</code>前面放置任意数量的<code class="fe mx my mz na b">0</code>，那么如果用<code class="fe mx my mz na b">00110</code>你会如何表示<code class="fe mx my mz na b">6</code>？只要按照2的补码:<br/><code class="fe mx my mz na b">00110 </code>-&gt;-T8】</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="333c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，只要记住MSB代表符号位，就可以使用任意位数。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="ccf4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">示例</strong></p><p id="e74b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要用有符号数表示法表示<code class="fe mx my mz na b">6</code>，不能写<code class="fe mx my mz na b">110</code>。由于MSB是<code class="fe mx my mz na b">1</code>，所以这个数字实际上代表的是<code class="fe mx my mz na b">-2</code>。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="3f62" class="lb lc iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">那么我们可以用n位表示什么数呢？</h1><p id="c9e3" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">先说个例子。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="6a9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">示例</strong></p><p id="9ce4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不关心2的补码或有符号数表示，用<code class="fe mx my mz na b">n = 4</code>位可以有什么组合？<br/>通过<code class="fe mx my mz na b">n = 4</code>，可以有<code class="fe mx my mz na b">2⁴ = 16</code>的组合，如下表所示:</p><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b2e48262f80803edbcb0a7fbbd3b8a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*Pt_CXz1ycPFFvVjc7X-DpQ.png"/></div></figure><h1 id="dbed" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">1000的二进制补码呢？</h1><p id="19f5" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">有趣的是，如果取<code class="fe mx my mz na b">1000</code>的2的补码，就得到<code class="fe mx my mz na b">1000</code>！<br/>记住<code class="fe mx my mz na b">1000</code>是<code class="fe mx my mz na b">-8</code>，而不是<code class="fe mx my mz na b">+8</code>，因为MSB是<code class="fe mx my mz na b">1</code>。<br/>也不是<code class="fe mx my mz na b">-0</code>，因为<code class="fe mx my mz na b">0</code>和<code class="fe mx my mz na b">-0</code>相等，<code class="fe mx my mz na b">0</code>已经用<code class="fe mx my mz na b">0000</code>表示了。一个数字没有必要有两种表示。为了表示<code class="fe mx my mz na b">+8</code>，你需要一个额外的位(<code class="fe mx my mz na b">01000</code>)。<br/>这让很多人困惑，但是如果你坚持取2的补码，你会发现<code class="fe mx my mz na b">1000</code>等于<code class="fe mx my mz na b">-8</code>。</p><h1 id="3c67" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">公式</h1><p id="444b" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">有了<code class="fe mx my mz na b">4</code>位，就可以有无符号数<code class="fe mx my mz na b">0</code>到<code class="fe mx my mz na b">15</code> (NB。<code class="fe mx my mz na b">15 = 2⁴-1</code>)，这总共给我们提供了<code class="fe mx my mz na b">16</code>(或<code class="fe mx my mz na b">2⁴</code>)个数字。<br/>使用带符号的数字表示法，你可以有<code class="fe mx my mz na b">-8</code>(或<code class="fe mx my mz na b">-2⁴–1</code>)到<code class="fe mx my mz na b">+7</code>(或(<code class="fe mx my mz na b">2^(4–1))–1</code>)(总共<code class="fe mx my mz na b">16</code>个数字)。<br/>这为我们提供了如下公式:<br/>用<code class="fe mx my mz na b">n</code>位，我们可以表示有符号数<code class="fe mx my mz na b">–2^(n-1)</code>到<code class="fe mx my mz na b">2^(n-1)–1</code>，<br/>用<code class="fe mx my mz na b">n</code>位，我们可以表示无符号数<code class="fe mx my mz na b">0</code>到<code class="fe mx my mz na b">2^(n-1)</code>。<br/>在这两种情况下，我们仍然有相同数量的数字(<code class="fe mx my mz na b">2^n</code>)，只是带符号的数字向左移动了一半，用负数替换了较高的+ve数字。</p><h1 id="f25e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">C#中的整数溢出</h1><p id="57fe" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">如果你再看一下上表，注意当你不断加1时，数字会变得更高，直到你到达<code class="fe mx my mz na b">7</code>。从<code class="fe mx my mz na b">7</code>开始，如果你加1，你会得到一个“溢出”，你会得到最大的负数。这就是在C#中发生的事情，当你给一个已经是最大值的int(或其他数据类型)加1，当这发生时，抛出一个<code class="fe mx my mz na b">System.OverflowException</code>。<br/>现在你已经了解了整数是如何在幕后工作的，你现在可以理解为什么在添加<code class="fe mx my mz na b">1</code>时，一个int会从<code class="fe mx my mz na b">2147483647</code>(或<code class="fe mx my mz na b">2³²–1</code>)变为<code class="fe mx my mz na b">-2147483648</code> ( <code class="fe mx my mz na b">-2³²</code>)(还记得公式吗？).</p><h1 id="940a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为什么Int32？MaxValue = 2，147，483，647？</h1><p id="956f" class="pw-post-body-paragraph kd ke iq kf b kg ml ki kj kk mm km kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">很多程序员都知道一个int可以存储的最大值是<code class="fe mx my mz na b">2,147,483,647</code>，但是实际上很少有人知道为什么。<br/>现在你知道了2的补码和有符号数表示，你就能理解为什么<code class="fe mx my mz na b">Int32.MaxValue</code> = <code class="fe mx my mz na b">2,147,483,647</code>了！<br/>顾名思义，<code class="fe mx my mz na b">Int32</code>整数是用<code class="fe mx my mz na b">32</code>位存储的。第一位(或MSB)是符号位，接下来的<code class="fe mx my mz na b">31</code>位代表数字。<br/>记住这一点，看看<code class="fe mx my mz na b">2,147,483,647</code>是如何使用二进制存储在内存中的:<br/> <code class="fe mx my mz na b">0111 1111 1111 1111 1111 1111 1111 1111</code>(或十六进制的<code class="fe mx my mz na b">0x7FFFFFFF</code>)<br/>每个半字节(<code class="fe mx my mz na b">4</code>位)之间的间距只是为了可读性。<br/>如你所见，这是使用<code class="fe mx my mz na b">32</code>位有符号数表示法可以存储的最大数。<br/>如果你试图将这个数增加<code class="fe mx my mz na b">1</code>，你会得到一个进入MSB的进位，这会将符号位设置为<code class="fe mx my mz na b">1</code>，并将所有其他位设置为<code class="fe mx my mz na b">0</code>，那么这个数就是<code class="fe mx my mz na b">-2,147,483,648</code>。想了解更多信息，请看一看MSDN。</p></div></div>    
</body>
</html>