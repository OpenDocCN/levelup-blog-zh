<html>
<head>
<title>Best Practices: Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最佳实践:Firebase</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/best-practices-firebase-f71c1dd4d2bf?source=collection_archive---------10-----------------------#2021-10-11">https://levelup.gitconnected.com/best-practices-firebase-f71c1dd4d2bf?source=collection_archive---------10-----------------------#2021-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3961" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Firebase并不贵，贵的是你的代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/7f79312038e59e31b52e712b8ced4db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFFbo8lkNxVQcmLrLDVRNw.png"/></div></div></figure><p id="6ab9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一名软件开发人员，您可能听说过Firebase及其帮助您快速构建产品并将其发布给受众的能力。但是，您可能也听说过Firebase会变得非常昂贵，非常快。</p><p id="8f77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">把Firebase想象成一把瑞士军刀。它有各种各样锋利的实用工具，但是如果你在使用它的时候不小心，你会割伤自己的。如果使用得当，Firebase可以成为一个有价值的盟友，让您的应用程序快速扩展到大量用户。</p><p id="7634" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们看看选择Firebase时可用的各种工具。</p><h1 id="9654" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">Firebase产品</h1><p id="2525" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Firebase将其产品范围分为三个部分:<em class="ma">构建、发布&amp;监视器和参与。</em></p><p id="8751" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">构建产品包括认证、云Firestore、云功能、云消息、云存储、Firebase ML (BETA)、托管、实时数据库和远程配置。</p><p id="5431" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">发布和监控产品包括应用分发(测试版)、Crashlytics、Google Analytics、性能监控、远程配置和测试实验室。</p><p id="b9cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Engage产品包括A/B测试(测试版)、身份验证、Crashlytics、云消息、动态链接、Google Analytics、应用内消息(测试版)、预测和远程配置。</p><p id="1c9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">深入讨论每个产品超出了本文的范围，所以我将在这里添加一个到Firebase产品<a class="ae mb" href="https://firebase.google.com/products-build" rel="noopener ugc nofollow" target="_blank">的链接。</a></p><h1 id="3b10" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">消防基地计划</h1><p id="2398" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">好消息是Firebase很灵活，适合初创公司和预算有限的企业。</p><p id="8e28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谷歌为开发者提供了一个免费层，称为“星火计划”，让你尝试Firebase。不过，Spark计划对每项服务都有一定的使用限制。</p><p id="2815" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，身份验证每月的验证次数限制为10，000次。他们的“Blaze Plan”上的相同服务是付费层，在美国、加拿大和印度的电话验证费用为0.01美元(0.75印度卢比)，在其他国家为0.06美元<strong class="jp ir"> <em class="ma">在</em> </strong>你跨过10k门槛之后。</p><p id="746f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无论您使用哪种计划，A/B测试、Firebase分析、应用分发、应用索引、云消息(FCM)、Crashlytics、动态链接、应用内消息、性能监控、预测和远程配置都可以免费使用，没有任何限制。</p><p id="f2bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">补充阅读:<a class="ae mb" href="https://firebase.google.com/pricing" rel="noopener ugc nofollow" target="_blank"> Firebase定价</a></p><h1 id="18e2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">谢谢，我们要那笔钱。</h1><p id="e8a8" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">当然，你一定认为这一切都很棒，但为什么我的应用程序仍然会收到Firebase的巨额账单？</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mc md l"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">资料来源:<a class="ae mb" href="https://media.giphy.com/media/3oEjHLUI9nBwbzMyf6/giphy.gif" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></figcaption></figure><p id="c4c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在大多数情况下，几乎是实时数据库或云Firestore耗尽了您的预算。</p><p id="fae6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Cloud Firestore是Google &amp; Firebase的下一代产品，进一步构建和扩展了实时数据库的功能。这两个数据库都在Android、iOS和网络上提供实时更新。然而，与Firebase实时数据库是单根JSON格式数据库不同，Cloud Firestore以分层数据结构存储数据。</p><p id="9f30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据库的选择取决于您的用例，Google在做出决定时提供了一些帮助。基于某些因素，您可以<a class="ae mb" href="https://firebase.google.com/docs/database/rtdb-vs-firestore" rel="noopener ugc nofollow" target="_blank">找出最适合您应用的</a>。</p><p id="e678" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请记住，这两种解决方案都提供:</p><ul class=""><li id="2e91" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">客户端优先的SDK，无需部署和维护服务器</li><li id="ca40" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">实时更新</li><li id="42b8" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">免费层，然后付费使用</li></ul><h1 id="7968" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">优化您的Firebase成本</h1><p id="c18a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">检查是否可以优化成本的最快方法是检查是否使用了正确的数据库。就带宽和存储而言，与云Firestore相比，实时数据库非常昂贵。</p><p id="7e06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Cloud Firestore，您只需为在数据库上执行的操作(创建、读取、更新、删除)付费，每GB存储费用较低。</p><p id="9ae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您有满足需求的合适数据库，下一步就是快速查看一下您的代码。</p><h2 id="30d8" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated"><strong class="ak">使用原生Firebase SDKs或客户端库</strong></h2><p id="2e6a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">确保您使用的是适用于您的平台的本机Firebase SDKs，而不是REST APIs。SDK保持开放连接，减少了SSL加密成本和数据库负载，这些成本和负载会与REST API一起增加。</p><p id="d150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">移动和网络SDK也支持实时更新和离线数据持久化。</p><h2 id="ae67" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated">维护平面数据库结构</h2><p id="2134" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Firebase将从子节点和路径中读取数据，因此尽可能保持数据结构的扁平化是有意义的。这防止了客户端不必要的数据下载。</p><p id="5473" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于Firebase实时数据库允许嵌套多达32层的数据，因此将复杂的数据嵌套在文档中很有吸引力。但是，当您在数据库中的某个位置提取数据时，也会检索它的所有子节点。</p><p id="3346" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">保持您的数据库平坦，使您的数据易于维护，并且读取成本更低！</p><h2 id="8b7f" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated"><strong class="ak">减少应用程序中的数据源数量</strong></h2><p id="1175" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">您可能需要仔细检查您的应用程序代码，以了解您是否在同一个屏幕/活动上创建了不必要的侦听器。这可以由一个后台服务来代替，该服务有一个侦听器，其他活动可以订阅一个可观察对象。</p><p id="2cd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">考虑到您要在应用程序的多个位置显示用户数据，每次调用Firebase API来获取每个位置的数据是非常昂贵的。将它放在一个每次数据更新时都会更新本地存储的服务中会便宜得多，还能减少数据库负载。</p><p id="9550" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，确保在适用的情况下销毁侦听器。</p><h2 id="af63" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated"><strong class="ak">防止未经授权的访问</strong></h2><p id="74fc" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">使用安全规则来防止未授权和恶意用户多次试图下载您的数据库。谷歌有一些关于保护你的Firebase项目的优秀文档。</p><h2 id="5c07" class="mw ky iq bd kz mx my dn ld mz na dp lh jy nb nc ll kc nd ne lp kg nf ng lt nh bi translated">创建高效的监听器</h2><p id="2b63" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">尽可能将侦听器放在路径的末端，以限制它们同步的数据量。你的听众应该接近你希望他们得到的数据。不要在数据库根监听，因为这会导致下载整个数据库。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="7cc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">需要注意的重要一点是，Firebase会随着你的应用程序而扩展，所以如果你的应用程序一夜之间变得流行起来，你就要为Firebase的巨额账单做好准备。以上几点是帮助你优化成本，而不是从10万美元降到10美元。</p><p id="5c98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，Firebase消除了中间服务器、数据库实例，以及让它们在一夜之间伸缩等。在应用程序开发周期中。这是Firebase最大的优点之一！</p></div></div>    
</body>
</html>