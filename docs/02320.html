<html>
<head>
<title>JavaScript Clean Code — Test-Driven Development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript干净代码——测试驱动的开发</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/javascript-clean-code-test-driven-development-91c48687fb5e?source=collection_archive---------9-----------------------#2020-03-05">https://levelup.gitconnected.com/javascript-clean-code-test-driven-development-91c48687fb5e?source=collection_archive---------9-----------------------#2020-03-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/76ed00954af687b53d8d669afe2790f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oynpO7Jzuey6x4e-"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@noguidebook?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">瑞秋</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="d496" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于今天这样复杂的软件，我们不能依赖手工测试来完成它的每一部分。这就是单元测试的用武之地。</p><p id="9558" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">开发软件的一种方法是在编写产品代码之前先编写测试。这被称为测试驱动开发或TDD。</p><p id="7a2e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将详细了解什么是测试驱动开发，以及我们如何编写测试和产品代码。</p><h1 id="b95f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">TDD三定律</h1><p id="d7a8" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">TDD有三个原则:</p><ul class=""><li id="c233" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">我们可能不会写产品代码，直到我们写了一些失败的单元测试。</li><li id="9b3f" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">我们只编写一个失败的测试，而不会导致编译失败。</li><li id="62a1" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">我们编写产品代码来使失败的测试通过。</li></ul><p id="0099" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着测试和代码是一起编写的。结果是，我们每天都要编写几十个测试，测试覆盖面将是全面的。</p><h1 id="d7c4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">保持测试清洁</h1><p id="8064" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">测试代码应该保持与正常生产代码相同的质量。这样，维护测试就容易了。</p><p id="d4f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">比如正确命名事物，创建不太长的函数，格式化等等。，所有这些都和产品代码一样适用于单元测试。这使得测试易于维护，因此人们可以继续编写生产代码。</p><p id="b9f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就设计和实现而言，它需要和生产代码一样多的关注。</p><p id="2dc1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们不能保持我们的测试与生产代码的质量相同，我们就会失去生产代码的灵活性，因为没有测试我们对生产代码没有信心。我们会害怕做出改变，因为我们没有测试来告诉我们，我们的产品代码没有产生错误。</p><h1 id="2321" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">干净的测试</h1><p id="dcc6" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">干净的测试是可读的。这是单元测试中最重要的部分，因为我们必须看着它们，知道它们在测试什么。</p><p id="628a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">可读性包括表达的清晰性、简洁性和密度。我们想用尽可能少的表达说很多。</p><p id="8b7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个测试都应该遵循构建-运行-检查模式。这意味着，如果需要的话，我们应该建立我们的模拟，并设置任何真实的数据，然后我们通过调用我们正在测试的代码对它们做一些事情，然后我们检查预期的结果。</p><h1 id="b839" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">双重标准</h1><p id="7177" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">因为测试代码只在测试环境中运行，所以它们不需要像生产代码那样高效。然而，它们必须很快，这样我们就不必等待太久来运行所有的测试，因为它们将在我们开发代码时运行。</p><h1 id="b766" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">每个测试一个断言</h1><p id="c269" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">为了尽可能细化测试，每个测试只有一个assert语句是个好主意。</p><p id="ab7a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这使得我们的测试简单，我们可以更容易地改变它们。它也更清楚我们在检查什么。</p><h1 id="c2ac" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">每个测试一个概念</h1><p id="48ca" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">对于单元测试来说，单一概念是更好的规则。测试用于检查一个概念，这样每个人都知道每个测试检查的是什么。没有惊喜或隐藏代码。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/bc583b04420f35ede268cbe07c5f1afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C3DwLs36MQLU1IsN"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">亚历克西斯·布朗在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="3182" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">第一</h1><p id="4342" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">FIRST是编写测试原则的首字母缩写。每个字母代表一个原则。它们如下:</p><ul class=""><li id="f92a" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">代表快速——测试应该快速运行。运行缓慢的测试是一种折磨，所以我们不想频繁地运行它们。如果我们不经常运行它们，那么我们会错过回归，直到我们后来发现它们。此外，由于我们无法通过运行测试来验证结果，因此我们对代码更改会感到不太舒服。</li><li id="9f47" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">代表独立——测试不应该互相依赖。他们不应该为下一次考试设置条件。这是因为当一个失败时，所有其他的都失败了，使得诊断变得困难</li><li id="8951" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">可重复——测试应该在任何环境下都是可重复的。有没有网络连接应该不重要。所以对于这种事情，我们应该嘲笑他们。当测试依赖于可能不总是可用的外部资源时，我们会遇到问题。</li><li id="27e7" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">用于自验证的<strong class="ki iu">S</strong>—测试应该有布尔输出，要么通过，要么失败。我们不应该通读日志来判断测试是否通过。否则，失败会变得主观，需要长时间的人工评估</li><li id="4c2a" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">及时——需要及时地编写测试。它们应该写在生产代码之前，以使它们通过。如果我们在之后编写测试，我们可能会遇到难以测试的产品代码。</li></ul><h1 id="f910" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="c78c" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">测试驱动开发是我们在编写代码时应该考虑的事情。我们可以在生产代码之前编写测试，以确保覆盖所有内容，并且生产代码易于测试。</p><p id="6e80" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个测试都应该运行得很快并且很小。他们应该坚持测试单一的概念，并且独立于其他测试进行测试。</p><p id="8a1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">测试应该以同样的方式在任何环境中运行。他们不应该依赖不总是可用的外部资源。</p><p id="afb2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">测试结果应该是通过或失败。这不应该由人来主观解释。</p><p id="1f15" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，测试代码必须和产品代码一样干净，这样我们才能容易地阅读和维护它们。</p></div></div>    
</body>
</html>