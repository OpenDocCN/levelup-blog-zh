<html>
<head>
<title>Angular Material Duration Input Component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度材料持续时间输入组件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/angular-material-duration-input-component-a75e14ed3cdf?source=collection_archive---------8-----------------------#2020-06-12">https://levelup.gitconnected.com/angular-material-duration-input-component-a75e14ed3cdf?source=collection_archive---------8-----------------------#2020-06-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b5d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建了这个简单的组件来收集和格式化持续时间输入。我希望这篇教程对你有所帮助😄</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/03d037345f07e6815bd6d0c7ded04648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJYo_EDhLwvkPoC4ly2R2g.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@aronvisuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Aron视觉效果</a>在<a class="ae lb" href="https://unsplash.com/s/photos/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="e14f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在进入代码之前，这里有一个组件的快速概述。稍后，我将一步一步地浏览代码。持续时间输入接受三个值:小时、分钟和秒，并将它们组合成一个字符串，格式如下:<code class="fe lc ld le lf b">hours:minutes:seconds</code>。</p><p id="1256" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">系统会自动检查这些值，以确保它们在有效范围内，例如，分钟和秒钟应该只在0-59之间。</p><p id="f416" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该组件有两个输入可用，<code class="fe lc ld le lf b">durationString</code>和<code class="fe lc ld le lf b">disabled</code>。<code class="fe lc ld le lf b">durationString</code>输入双向绑定到组件。您可以传入格式化字符串来填充持续时间输入。输入将自动设置<code class="fe lc ld le lf b">durationString</code>变量为一个新的更新的格式化字符串，代表输入的持续时间。禁用输入用于在需要时禁用持续时间输入。现在来看一些代码。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="f05a" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">持续时间输入HTML。</h2><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="9c37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">持续时间输入由三个独立的输入组成:小时、分钟和秒。每当输入的值发生变化时，就会触发<code class="fe lc ld le lf b">ngModelChange</code>方法，该方法用于检查值的有效性。</p><p id="d9fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可能想知道为什么输入是文本类型而不是数字。这样做的主要原因是我们将在控制器中操纵小时、分钟和秒变量。<code class="fe lc ld le lf b">ngModelChange</code>有一个奇怪的行为，它阻止输入值被更新，除非检测到新的对象。因此，我们将在更改变量时将它们设置为新的string对象，您将在下一节看到这一点。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="995f" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">持续时间输入控制器</h2><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="a05d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从顶部开始，我们首先初始化输入和输出。输出对于双向绑定的工作至关重要。输出的一个关键点是，它必须与您尝试双向绑定的输入同名，后跟“Change”。在我们的例子中，这是<code class="fe lc ld le lf b">durationStringChange</code></p><p id="98c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们能够将预先格式化的值传递到输入中，所以我们需要解析这个值，并相应地设置我们的小时、分钟和秒。这都是在<code class="fe lc ld le lf b">ngOnInit</code>方法中完成的。我们首先解析格式化的<code class="fe lc ld le lf b">durationString</code>值，然后设置小时、分钟和秒。</p><p id="46ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们有<code class="fe lc ld le lf b">check</code>和<code class="fe lc ld le lf b">getValidValue</code>方法来检查小时、分钟和秒的输入值，并确保它们是有效的。<code class="fe lc ld le lf b">getValidValue</code>中的方法<code class="fe lc ld le lf b">/^\d+$/.test(value)</code>(第46行)用于确保传入的值中只有数字。正如我们在HTML部分所讨论的，我们使用字符串输入，因为我们需要创建新的字符串对象，以便新的值反映在输入中。</p><p id="5e39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在创建新的字符串对象之前，我们使用<code class="fe lc ld le lf b">Math.min</code>和<code class="fe lc ld le lf b">Math.max</code>方法来确保我们的值在期望的范围内。使用<code class="fe lc ld le lf b">Math.max</code>和<code class="fe lc ld le lf b">Math.min</code>的好处是，如果超出范围，我们的值将自动设置为我们的最大值或最小值，从而获得更好的用户体验。</p><p id="274b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们有了有效值，我们就创建格式化字符串并更新<code class="fe lc ld le lf b">durationString</code>变量。双向绑定发生在第41行，我们将更新后的<code class="fe lc ld le lf b">durationString</code>值发送回传入的变量。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="f5a8" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">持续时间输入用法</h2><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="1fc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们可以在我们的项目中使用新的持续时间输入之前，我们需要在我们的<code class="fe lc ld le lf b">app.module.ts</code>中声明它，如上所示。</p><p id="ab5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦声明，我们就可以在我们的项目中自由使用它。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="510b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的持续时间输入可以像任何其他组件一样使用，只需添加它的HTML标签并传入我们的输入。同样，这两个输入是<code class="fe lc ld le lf b">durationString</code>和<code class="fe lc ld le lf b">disabled</code>，但是只需要<code class="fe lc ld le lf b">durationString</code>输入就能起作用。您可能还会注意到<code class="fe lc ld le lf b">durationString</code>是如何被<code class="fe lc ld le lf b">[]</code>和<code class="fe lc ld le lf b">()</code>包围的，这是因为它是双向绑定的。现在我们已经添加了持续时间输入，我们能够收集格式良好且有效的持续时间输入。😄</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="46d5" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">额外加分</h2><p id="cddc" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">虽然我在本教程中没有这样做，但是用这个输入创建一个npm包会很有趣。因此，如果你想要一个额外的挑战，请随意从你已经创建的一个很酷的组件创建你自己的npm包。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="a90e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望本教程是有帮助的，并且你已经学会了一些关于在angular中创建组件的东西。您可以在此基础上创建各种令人惊叹的定制输入。</p></div></div>    
</body>
</html>