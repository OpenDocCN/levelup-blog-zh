<html>
<head>
<title>Deploying a Node App on Amazon EC2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Amazon EC2上部署节点应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploying-a-node-app-on-amazon-ec2-d2fb9a6757eb?source=collection_archive---------0-----------------------#2018-11-18">https://levelup.gitconnected.com/deploying-a-node-app-on-amazon-ec2-d2fb9a6757eb?source=collection_archive---------0-----------------------#2018-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8d60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在EC2实例上部署节点应用程序似乎是一项艰巨的任务，但是如果您知道如何配置您的实例，这并不困难。</p><p id="0904" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将在以下步骤中部署用Nodejs编写的聊天应用程序</p><ol class=""><li id="81b4" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">启动一个EC2实例并对其进行SSH。</li><li id="b9cd" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">在EC2实例上安装节点。</li><li id="dce4" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">复制EC2实例上的代码并安装依赖项。</li><li id="81ae" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">启动服务器永远运行。</li></ol><p id="5e91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们开始吧。</p><h1 id="d4dd" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">1.启动一个EC2实例并对其进行SSH</h1><p id="3f4a" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">你可以参考我的文章<a class="ae mc" href="https://hackernoon.com/launching-an-ec2-instance-fbfd50894aac" rel="noopener ugc nofollow" target="_blank">启动一个Amazon EC2实例</a>来启动一个EC2实例并SSH到其中。</p><p id="8ba4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">配置安全组时，请确保打开运行节点应用程序的端口。在我的情况下，端口是5000。</p><h1 id="4d2d" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">2.在EC2实例上安装节点</h1><p id="b79c" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">在对您的实例执行SSH之后，我们将在实例上安装Node。</p><p id="e60e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装node，请在您的终端或git bash中运行以下命令</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="6e06" class="mm la iq mi b gy mn mo l mp mq">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash</span><span id="04ac" class="mm la iq mi b gy mr mo l mp mq">. ~/.nvm/nvm.sh</span><span id="ba04" class="mm la iq mi b gy mr mo l mp mq">nvm install 8.10</span></pre><p id="d502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令安装节点版本管理器(nvm ),我们使用它在Amazon Linux AMI上安装节点。</p><p id="2d81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二个命令激活nvm。</p><p id="579e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三个命令指定我们希望安装哪个版本的节点。在这里，我正在安装8.10版本的节点。</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ms"><img src="../Images/1d7a8ee426ec0f5a8a550d6b88ccdff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FfMUHATXdVt75zXzVPIzIQ.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">安装和激活nvm</figcaption></figure><p id="5662" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过在终端中键入以下命令来检查您的节点版本。</p><p id="8e28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">node -v</code></p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nh"><img src="../Images/115465c0dc218faec4bc34022808aa7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1q3r9RaiXW7jSKGgFcgzw.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">安装节点8.10</figcaption></figure><h1 id="3e47" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">3.复制EC2实例上的代码并安装依赖项</h1><p id="5519" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">通常有两种方法可以做到这一点</p><h2 id="bc09" class="mm la iq bd lb ni nj dn lf nk nl dp lj jy nm nn ln kc no np lr kg nq nr lv ns bi translated"><strong class="ak"> 1。使用Github、BitBucket或Gitlab </strong></h2><p id="1d84" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">这是在EC2实例上获取代码的最简单的方法之一。但是首先，您必须在实例上安装git。键入以下命令在Amazon Linux AMI上安装git。</p><p id="dc2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">sudo yum install -y git</code></p><p id="7b0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，你可以运行<code class="fe ne nf ng mi b">git clone</code>命令来克隆这个项目。</p><p id="be4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我克隆了一个节点聊天应用程序。</p><p id="ad3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">git clone https://github.com/abkunal/Chat-App-using-Socket.io.git</code></p><h2 id="5a07" class="mm la iq bd lb ni nj dn lf nk nl dp lj jy nm nn ln kc no np lr kg nq nr lv ns bi translated">2.使用亚马逊S3</h2><p id="d28a" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">我们可以为我们的节点项目制作一个zip文件(不包括node_modules文件夹),并将该zip文件上传到我们的S3存储桶。然后，我们可以公开我们的zip文件，在我们的实例上下载并解压缩它。</p><p id="3740" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">对于MacOS和Linux用户<br/> </strong>右击你的节点文件夹，选择“压缩”选项。它将创建一个zip文件</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/1a0381f5b62d588758cd8a8cc03b3a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*mcHpkzQOrhk_vro-VZnnvw.png"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">在MacOS中压缩文件夹</figcaption></figure><p id="5213" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">对于Windows用户<br/> </strong>右击你的节点文件夹，选择“发送到”中的“压缩(zipped)文件夹”选项。</p><p id="591f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们上传我们的压缩文件到一个S3桶。</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nu"><img src="../Images/0e582d5fd19f478478f60d17a340bb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLN0sdygPnMHTkJma793pA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">创建s3存储桶</figcaption></figure><p id="42a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.登录到您的AWS控制台并选择S3。点击<strong class="jp ir">创建存储桶</strong>按钮，为您的存储桶输入一个唯一的名称，然后点击<strong class="jp ir">下一步</strong>按钮。</p><p id="baec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.再次点击<strong class="jp ir">下一步</strong>按钮，<strong class="jp ir">取消选中<strong class="jp ir">设置权限</strong>选项卡中的</strong>所有复选框。</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nu"><img src="../Images/49eb338f4f5fea79c1884f7f55f0b08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4dROLSXnK6sK7-zIf9nBA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">修改s3权限设置</figcaption></figure><p id="97f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.点击<strong class="jp ir">下一个</strong>按钮，然后点击<strong class="jp ir">创建桶</strong>按钮。</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nv"><img src="../Images/6285f4348c46f8e308a0c963a8532446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R1EH0uCDzvdYKNXram9W_A.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">将zip文件上传到s3存储桶</figcaption></figure><p id="0a4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.选择您新创建的bucket并将项目的zip文件上传到bucket。</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/28b6c0978bde56427a51832b469d41b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*gcdJGdtLf4ZXllv2Hta0zQ.png"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">使zip文件可公开访问</figcaption></figure><p id="e3b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.点击zip文件然后点击<strong class="jp ir">公开</strong>按钮。</p><p id="2145" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.复制底部给出的链接，并将下面的命令粘贴到您的终端或git bash中，您可以通过ssh访问您的实例。</p><p id="32cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">wget LINK</code></p><p id="faf2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例- <code class="fe ne nf ng mi b">wget <a class="ae mc" href="https://s3.ap-south-1.amazonaws.com/abkun-chat-bucket/Chat-App-using-Socket.io.zip" rel="noopener ugc nofollow" target="_blank">https://s3.ap-south-1.amazonaws.com/abkun-chat-bucket/Chat-App-using-Socket.io.zip</a></code></p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nx"><img src="../Images/eda48ba89ec4cfeae1392b96fd57bc6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFz-HzHOecIX3pBA94q5mQ.png"/></div></div></figure><p id="0ca4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7.运行以下命令来解压缩zip文件。</p><p id="f4e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">unzip filename.zip</code></p><p id="d651" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例- <code class="fe ne nf ng mi b">unzip Chat-App-using-Socket.io.zip</code></p><h2 id="c854" class="mm la iq bd lb ni nj dn lf nk nl dp lj jy nm nn ln kc no np lr kg nq nr lv ns bi translated"><strong class="ak">安装依赖关系</strong></h2><p id="3f0d" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">现在，您可以通过导航到您的文件夹并运行以下命令来安装节点依赖项</p><p id="7d9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">cd Chat-App-using-Socket.io<br/>npm install</code></p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ny"><img src="../Images/6960fd4f610e371e2a33119dd144bb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3BUZdMODvSy2UbEOavV9Q.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">安装节点依赖项</figcaption></figure><h1 id="45f6" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">4.启动服务器永远运行</h1><p id="63ed" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">现在，为了让我们的服务器永远运行(即使我们没有SSH登录到实例)，我们将使用一个名为pm2的npm包。</p><p id="80a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.通过运行以下命令安装pm2</p><p id="4aac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">npm install -g pm2</code></p><p id="37c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.将pm2设置为在服务器重新启动时自动启动服务器。</p><p id="305c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ne nf ng mi b">pm2 start app.js<br/>pm2 save<br/>pm2 startup</code></p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nz"><img src="../Images/fbb5cf48c629459dd910b76489c4de4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtXw36nQr24Fv0G0hH5VUw.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">配置pm2</figcaption></figure><p id="cb0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，在运行<code class="fe ne nf ng mi b">pm2 startup</code>命令后，我们得到一个以“sudo”开头的命令。</p><p id="f5ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从<code class="fe ne nf ng mi b">sudo</code>开始复制命令，直到下一行结束，并将其粘贴到终端中，然后按回车键。</p><p id="ce93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您的节点服务器正在运行，并被设置为在您重新启动EC2实例时自动启动。</p><figure class="md me mf mg gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nu"><img src="../Images/1203931578cc86011325f7bf557a312a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVtuiQQzO2_lU-nPLnvxJg.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">在EC2实例上运行的聊天应用程序</figcaption></figure><p id="8edb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您可以使用实例的IP地址和运行服务器的端口来查看web应用程序的运行情况。</p><p id="3021" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如有疑问，请在下方评论。</p></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><p id="4cd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读这篇文章。如果你喜欢它，请给它一些掌声，让更多的人喜欢它！</p></div></div>    
</body>
</html>