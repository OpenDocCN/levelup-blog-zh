<html>
<head>
<title>Template Strings in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的模板字符串</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/template-strings-in-javascript-34b7fdc64b09?source=collection_archive---------1-----------------------#2019-10-20">https://levelup.gitconnected.com/template-strings-in-javascript-34b7fdc64b09?source=collection_archive---------1-----------------------#2019-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c1a6af05ebbd3376322f92c2fcc6fe50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B5TGU3LKHf1gXw6a"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">托马斯·詹森在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d64a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模板字符串是ES6中发布的现代JavaScript的一个强大特性。它允许我们将变量和表达式插入/插入到字符串中，而不需要像旧版本的JavaScript那样连接起来。它允许我们创建复杂的包含动态元素的字符串。模板字符串的另一个优点是标签。标签是将字符串和字符串的分解部分作为参数的函数，非常适合将字符串转换成不同的实体。</p><p id="24f4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建模板字符串的语法是使用反斜杠来分隔它们。例如，我们可以写:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="2e33" class="ln lo it lj b gy lp lq l lr ls">`This is a string`</span></pre><p id="17f4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个非常简单的模板字符串的例子。所有的内容都是常量，没有变量或表达式。要将变量和或表达式添加到字符串中，我们可以执行以下操作。</p><h1 id="c7c8" class="lt lo it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">插值变量和表达式</h1><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="22b2" class="ln lo it lj b gy lp lq l lr ls">// New JS with templates and interpolation<br/>const oldEnoughToDrink = age &gt;= 21;<br/>const oldEnough = `You are ${oldEnoughToDrink ? 'old enough' : 'too young'} to drink.`</span></pre><p id="7022" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过在字符串<code class="fe mq mr ms lj b">`${variable}`</code>中添加美元符号<code class="fe mq mr ms lj b">$</code>和花括号<code class="fe mq mr ms lj b">{}</code>来插入变量或表达式。这比旧JavaScript中的替代方法要好得多，在旧JavaScript中，我们必须像下面这样连接一个字符串:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="dd0f" class="ln lo it lj b gy lp lq l lr ls">// Old JS using concatenation<br/>const oldEnoughToDrink = age &gt;= 21;<br/>const oldEnough = 'You are ' + (oldEnoughToDrink ? 'old enough' : 'too young') + ' to drink.'</span></pre><p id="e0ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，如果我们有复杂的变量和表达式，旧的连接语法很容易出错。因此，模板字符串是对我们以前的一个很大的改进。</p><p id="16fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想在字符串的内容中使用反勾号字符，只需在字符串中的反勾号字符前加一个<code class="fe mq mr ms lj b">\</code>。= &gt; <code class="fe mq mr ms lj b">`will have a literal \` back tick`</code></p><h1 id="eb83" class="lt lo it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">多行字符串</h1><p id="0c26" class="pw-post-body-paragraph kg kh it ki b kj mt kl km kn mu kp kq kr mv kt ku kv mw kx ky kz mx lb lc ld im bi translated">模板字符串的另一个重要特性是，我们可以使用多行字符串来提高代码的可读性。用旧风格的琴弦是无法轻易做到这一点的。对于旧的字符串样式，我们必须连接字符串的每一行，以便将长字符串放在多行中，如下例所示:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="836b" class="ln lo it lj b gy lp lq l lr ls">const multilineStr = 'This is a very long string' + <br/>  'that spans multiple lines.'</span><span id="299f" class="ln lo it lj b gy my lq l lr ls">const multllineStr2 = 'At vero eos et accusamus et iusto odio' + 'dignissimos ducimus qui blanditiis praesentium voluptatum ' + 'deleniti atque corrupti quos dolores et quas molestias ' + 'excepturi sint occaecati cupiditate non provident, ' + <br/>'similique sunt in culpa qui ' + <br/>'officia deserunt mollitia animi.'</span></pre><p id="cba4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，如果我们有更多的行，这将变得非常痛苦。拥有所有这些加号，并把字符串分成多行是非常令人沮丧的。</p><p id="afc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用模板字符串，我们没有这个问题:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="79a1" class="ln lo it lj b gy lp lq l lr ls">const longString = `At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi.`</span></pre><p id="99e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这比将字符串连接在一起要好得多。编写代码花费的时间更少，出现语法错误的可能性也更低。它的可读性也更好。</p><p id="1e24" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，该方法确实向字符串<code class="fe mq mr ms lj b">\n</code>添加了一个实际的新like，如果您不希望字符串在其最终格式中有多行，只需在行尾添加一个<code class="fe mq mr ms lj b">\</code>。</p><h1 id="1e9b" class="lt lo it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">嵌套模板</h1><p id="6d11" class="pw-post-body-paragraph kg kh it ki b kj mt kl km kn mu kp kq kr mv kt ku kv mw kx ky kz mx lb lc ld im bi translated">模板字符串可以相互嵌套。这是一个很棒的特性，因为许多人想要创建动态字符串。模板字符串允许我们在模板字符串中嵌套常规字符串或模板字符串。例如，我们可以这样写:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="0de8" class="ln lo it lj b gy lp lq l lr ls">const oldEnoughToDrink = age &gt;= 21;<br/>const oldEnough = `You are ${oldEnoughToDrink ? 'old enough' : 'too young'} to drink.`</span></pre><p id="c56f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以用模板字符串将表达式插入字符串中来写同样的东西:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="238f" class="ln lo it lj b gy lp lq l lr ls">const TOO_YOUNG = 'too young';<br/>const OLD_ENOUGH = 'old enough';</span><span id="7e8e" class="ln lo it lj b gy my lq l lr ls">const oldEnoughToDrink = age &gt;= 21;</span><span id="7ba0" class="ln lo it lj b gy my lq l lr ls">const oldEnough = `You are ${oldEnoughToDrink ? OLD_ENOUGH : TOO_YOUNG} to drink.`</span></pre><p id="2868" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个例子很简单，但是对于复杂的字符串组合，能够为我们如何构建字符串添加逻辑是非常强大的。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/f8833349ea2df0d1929a1645a9e66a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c_UuXHxdt_h12tw2"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">布雷特·乔丹在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="9be6" class="lt lo it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">标记模板</h1><p id="06cf" class="pw-post-body-paragraph kg kh it ki b kj mt kl km kn mu kp kq kr mv kt ku kv mw kx ky kz mx lb lc ld im bi translated">有了模板字符串，我们可以在模板字符串前面添加一个叫做标签的东西。它们是将字符串和字符串的分解部分作为参数的函数。标记函数将模板字符串分解成一个数组作为第一个参数，数组中的每一项都是字符串的常量部分。函数的附加参数是所有变量和表达式，按照它们在字符串中出现的顺序排列。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="b8a1" class="ln lo it lj b gy lp lq l lr ls">const personOldTag = (<!-- -->strings, nameExp, ageExp, genderExp<!-- -->)=&gt;{<br/>  let <!-- -->str0 = strings[0]; // " is a "<br/>  <!-- -->let <!-- -->str1 = strings[1]; // " year old "<br/><br/>  let oldStr;<br/>  if (ageExp &gt; 75){<br/>    oldStr = 'senior';<br/>  } else {<br/>    oldStr = 'young';<br/>  }<br/><br/>  // We can even return a string built using a template literal<br/>  return `${nameExp}${str0}${oldStr}${genderExp}.`;<br/>}</span><span id="0420" class="ln lo it lj b gy my lq l lr ls">const name = 'Bob'<br/>const age = 80;<br/>const gender = 'male;</span><span id="355c" class="ln lo it lj b gy my lq l lr ls">const <!-- -->result <!-- -->= <!-- -->personOldTag<!-- -->`${ name } is a ${ age } year old ${ gender }`;</span><span id="7ef5" class="ln lo it lj b gy my lq l lr ls">// result should be `Bob is a <!-- -->senior <!-- -->man.`</span></pre><p id="297c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">标记模板非常适合将字符串转换成你想要的任何格式，因为它只是一个普通的函数。但是，它是一个特殊的函数，因为第一个参数是一个包含字符串常量部分的数组。其余的参数包含每个表达式返回的返回值。这对于操作字符串和将返回值转换为我们想要的值非常有用。</p><p id="e497" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">标签的返回值可以是你想要的任何值。所以我们可以返回字符串，数组，对象，或者其他任何东西。</p><p id="7d0a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们在上面的函数中看到的，在我们放在<code class="fe mq mr ms lj b">personOldTag</code>旁边的字符串中，我们首先插入了<code class="fe mq mr ms lj b">name</code>，然后是<code class="fe mq mr ms lj b">age</code>，然后是<code class="fe mq mr ms lj b">gender</code>。所以在参数中，它们也按这个顺序出现——<code class="fe mq mr ms lj b">nameExp</code>、<code class="fe mq mr ms lj b">ageEx</code>、<code class="fe mq mr ms lj b">genderExp.</code>它们是模板字符串中<code class="fe mq mr ms lj b">name</code>、<code class="fe mq mr ms lj b">age</code>和<code class="fe mq mr ms lj b">gender</code>的求值版本。</p><p id="0dcb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为标签是函数，所以我们可以返回任何我们想要的东西:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="3c82" class="ln lo it lj b gy lp lq l lr ls">const isOldTag = (<!-- -->strings, nameExp, ageExp, genderExp<!-- -->)=&gt;{<br/>  let <!-- -->str0 = strings[0]; // " is a "<br/>  <!-- -->let <!-- -->str1 = strings[1]; // " year old "<br/>  return ageExp &gt; 75<br/>}</span><span id="6d4e" class="ln lo it lj b gy my lq l lr ls">const name = 'Bob'<br/>const age = 80;<br/>const gender = 'male;</span><span id="f1b6" class="ln lo it lj b gy my lq l lr ls">const <!-- -->result <!-- -->= <!-- -->isOldTag<!-- -->`${ name } is a ${ age } year old ${ gender }`;</span><span id="e150" class="ln lo it lj b gy my lq l lr ls">// result is true</span></pre><p id="efca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如你所看到的，我们可以操作数据返回一个布尔值而不是一个字符串。模板标签是一种仅适用于模板字符串的功能。要对旧样式的字符串做同样的事情，我们必须用我们自己的字符串操作代码和内置的字符串操作函数来分解字符串，这远不如使用标签灵活。它将字符串的各个部分分解成参数，这些参数在模板标签中传递。</p><h1 id="e6a0" class="lt lo it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">原始字符串</h1><p id="7a41" class="pw-post-body-paragraph kg kh it ki b kj mt kl km kn mu kp kq kr mv kt ku kv mw kx ky kz mx lb lc ld im bi translated">模板字符串有一个特殊的<code class="fe mq mr ms lj b">raw</code>属性，可以从标签中获得。<code class="fe mq mr ms lj b">raw</code>属性在不转义特殊字符的情况下获取字符串，因此该属性被称为<code class="fe mq mr ms lj b">raw</code>。要访问一个字符串的<code class="fe mq mr ms lj b">raw</code>属性，我们可以按照下面的例子:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="df2a" class="ln lo it lj b gy lp lq l lr ls">const logTag = (strings) =&gt; {<br/>  console.log(strings.raw[0]);<br/>}<br/><br/>logTag`line 1 \r\n line 2`;<br/>// logs "line 1 \r\n line 2" including characters '\', 'r' and 'n'</span></pre><p id="619b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这有助于直观地显示带有完整特殊字符的字符串。</p><p id="801d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有<code class="fe mq mr ms lj b">String.raw</code>标签，在这里我们可以获取一个模板字符串并返回一个带有转义字符的字符串，而不需要对它们进行转义来查看字符串的完整形式。例如，用<code class="fe mq mr ms lj b">String.raw</code>标签，我们可以写:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="66ae" class="ln lo it lj b gy lp lq l lr ls">let hello = String.raw`Hello\n${'world'}!`;<br/>// "Hi\nworld!"<br/><br/>hello.length;<br/>// 13<br/><br/>hello.split('').join(',');<br/>// "<!-- -->H,e,l,l,o,\,n,w,o,r,l,d,!<!-- -->"</span></pre><p id="40f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，我们已经计算了表达式中的所有字符，但是我们保留了转义字符。</p><h1 id="4d83" class="lt lo it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">支持模板字符串</h1><p id="7cac" class="pw-post-body-paragraph kg kh it ki b kj mt kl km kn mu kp kq kr mv kt ku kv mw kx ky kz mx lb lc ld im bi translated">如今，几乎所有定期维护的浏览器都支持模板字符串。唯一一个不支持开箱即用的主要浏览器是Internet Explorer。不过不支持的浏览器可以用Babel添加。Node.js在版本4或更高版本中也支持它。</p><p id="7ef3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模板字符串是JavaScript字符串的新标准。它比ES6之前的字符串好得多，因为它支持字符串内部的插值表达式。我们也有标记模板，它们只是函数，模板字符串的分解部分作为参数。第一个参数中的常量字符串是分解后的数组形式的字符串，其余的参数是表达式在字符串中出现的顺序。标记模板函数可以返回任何变量类型。</p><p id="efc8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用字符串的<code class="fe mq mr ms lj b">raw</code>属性，这在标签中是可用的，可以得到带有未转义字符的字符串。</p></div></div>    
</body>
</html>