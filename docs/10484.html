<html>
<head>
<title>Build and deploy a WebJob alongside web app using azure pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用azure pipelines构建和部署WebJob以及web应用程序</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-and-deploy-a-webjob-alongside-web-app-using-azure-pipelines-220bde26642a?source=collection_archive---------3-----------------------#2021-12-13">https://levelup.gitconnected.com/build-and-deploy-a-webjob-alongside-web-app-using-azure-pipelines-220bde26642a?source=collection_archive---------3-----------------------#2021-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b3b4c6b50031cd1a1c378a2f5a4b5374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zvLp6ysMfLM8twxD0vIXKg.jpeg"/></div></div></figure><p id="9ca4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这篇文章中，我将分享我在尝试使用azure pipelines设置和部署WebJob以及web应用程序时遇到的一些问题和误解。WebJob是一个控制台应用程序，web app是一个ASP.NET核心。WebJob和web应用程序目标。净5。</p><p id="c5e5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">微软关于azure WebJob的文档提供了关于如何创建和发布WebJob的良好信息。然而，。如果您不熟悉WebJobs，以下是该文档的简要描述:</p><blockquote class="kz la lb"><p id="c8bb" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><em class="it"> WebJob是</em><a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/" rel="noopener ugc nofollow" target="_blank"><em class="it">Azure App Service</em></a><em class="it">的一项功能，使您能够在与web应用、API应用或移动应用相同的实例中运行程序或脚本。使用WebJobs不需要额外的费用。</em></p><p id="460a" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-create" rel="noopener ugc nofollow" target="_blank"> <em class="it">在Azure App服务中用WebJobs运行后台任务</em> </a></p></blockquote><p id="02b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以创建两种类型的web作业，连续或触发。顾名思义，连续的WebJob总是运行，而触发的WebJob按需或按计划运行。在我的例子中，我设置了一个触发的WebJob，按照计划通过电子邮件发送报告。</p><p id="f5e5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们回顾一下我对WebJob的一些误解或没有意识到的事情。</p><h1 id="8dfc" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">你不需要瞄准。NET框架将WebJob与web应用程序一起部署</h1><p id="783f" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">在浏览微软关于WebJobs的文档时，我看到了一个关于使用Visual Studio部署WebJobs的部分。该部分提到了将WebJob与web项目相链接，这样当您部署web项目时，web job已经是它的一部分了。</p><blockquote class="kz la lb"><p id="c3ca" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><em class="it">将项目单独部署为WebJob，或将其链接到web项目，以便在您部署web项目时自动部署。</em></p><p id="3335" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-dotnet-deploy-vs#webjobs-as-net-framework-console-apps" rel="noopener ugc nofollow" target="_blank"> <em class="it"> WebJobs as。NET框架控制台应用程序</em> </a></p></blockquote><p id="890b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果要将web作业与web项目相链接，web作业需要以。NET框架，而不是。网芯。</p><blockquote class="kz la lb"><p id="b6b3" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><em class="it">。NET核心Web应用程序和/或。NET Core WebJobs不能与web项目链接。如果您需要使用web应用程序部署您的WebJob，</em> <a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-dotnet-deploy-vs#webjobs-as-net-framework-console-apps" rel="noopener ugc nofollow" target="_blank"> <em class="it">将您的WebJobs创建为. NET Framework控制台应用程序</em> </a> <em class="it">。</em></p><p id="c4dd" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-dotnet-deploy-vs#webjobs-as-net-framework-console-apps" rel="noopener ugc nofollow" target="_blank"> <em class="it">乔布斯一样。NET Core控制台应用程序</em> </a></p></blockquote><p id="05bc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">刚开始看这一节的时候很迷茫。特别是，我不确定我是否需要目标。如果我想将WebJob与web应用程序一起部署，请在构建web job时使用. NET framework。答案是否定的。注意，这一节只针对使用Visual Studios部署WebJob。换句话说，WebJob只需要瞄准。如果您希望使用Visual Studios同时部署WebJob和web应用程序，请使用。在我的例子中，由于我使用azure devops，我能够一起部署我的WebJob和web app，两者都面向。净5。</p><h1 id="ac20" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">web作业需要有受支持的可执行文件</h1><p id="c7d3" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">当尝试部署WebJob时，我想知道为什么在使用azure devops自动部署WebJob和web应用程序时，WebJob没有显示在azure门户中。然而，如果我使用visual studios来部署WebJob，那么它会正确显示。我在网上找到了一些帖子，比如这个<a class="ae lg" href="https://stackoverflow.com/questions/58282701/webjob-gets-deployed-from-azure-devops-pipeline-but-doesnt-show-up-under-webapp" rel="noopener ugc nofollow" target="_blank"> StackOverflow </a>和这个<a class="ae lg" href="https://docs.microsoft.com/en-us/answers/questions/2147/fix-for-webjob-cannot-be-added-from-portal-if-depl.html" rel="noopener ugc nofollow" target="_blank">的文章</a>，并且得到了一个错误的印象，这个问题与从包装中运行有关。使用azure应用服务部署任务时，azure devops会自动更新应用服务的配置，并打开WEBSITE_RUN_FROM_PACKAGE标志。我花了很多时间试图修改管道以不设置标志，或者自己删除标志，但无法让它工作。</p><p id="4e83" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">原来问题是我使用ubuntu代理来发布WebJob，它只产生。dll文件。我的WebJob是一个. NET 5控制台应用程序，我必须指定目标平台(win-x64)来生成。EXE文件，如下面的代码片段所示。当我使用Visual Studios发布WebJob时，我使用的是windows机器，结果工件包含。该文件是WebJob显示的预期文件。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="d6ce" class="mt li it mp b gy mu mv l mw mx">- task: DotNetCoreCLI@2<br/>  inputs:<br/>    command: 'publish'<br/>    publishWebProjects: false<br/>    projects: '**/WebJob.csproj'<br/>    arguments: '--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)/App_Data/jobs/triggered -r win-x64 --self-contained false'<br/>    zipAfterPublish: false<br/>  displayName: 'Publish web job'</span></pre><h1 id="6eb8" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">如果两者运行在同一个实例上，WebJob无法通过HTTP调用web应用程序</h1><p id="3e15" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">我最初的计划是在web应用中构建所有的功能，并通过REST端点公开它们。但是，因为WebJob和web应用程序都运行在同一个应用程序服务上，所以不可能在没有变通办法的情况下从WebJob对web应用程序进行HTTP调用。根据文件，</p><blockquote class="kz la lb"><p id="0f89" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><em class="it">如果</em>同一个<em class="it">沙箱中的另一个进程在目标端口上创建了监听套接字，则</em>到本地地址(例如<em class="it"> </em> <code class="fe my mz na mp b"><em class="it">localhost</em></code> <em class="it">，</em> <code class="fe my mz na mp b"><em class="it">127.0.0.1</em></code> <em class="it">)和机器自身IP的连接尝试将失败，</em>除外<em class="it">。监听端口必须是&gt; 1024，并且当前未被使用。</em></p><p id="d940" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae lg" href="https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox#local-address-requests" rel="noopener ugc nofollow" target="_blank"> <em class="it"> Azure WebApp沙盒</em> </a></p></blockquote><p id="c21d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是我得到的异常，如文档中所述</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="a784" class="mt li it mp b gy mu mv l mw mx">Exception Details: System.Net.Sockets.SocketException: An attempt was made to access a socket in a way forbidden by its access permissions 127.0.0.1:...</span></pre><h1 id="5c09" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">Azure WebJob仪表板中缺少Azure WebJob Dashboard配置警告</h1><p id="22e7" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">如果没有在azure应用服务中设置AzureWebJobsDashboard配置，可能会在azure WebJob dashboard中看到一些警告，如下所示。</p><figure class="mk ml mm mn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/79aae5b6c854b12d3c613331f0266758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zP7CxDe45XdczDNJ"/></div></div></figure><p id="f1ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，这只是一个警告，并不会造成任何伤害。根据这个<a class="ae lg" href="https://github.com/Azure/azure-webjobs-sdk/issues/2179" rel="noopener ugc nofollow" target="_blank"> github问题</a>，似乎只有使用azure blob存储的仪表板日志记录才需要这个配置。在我的例子中，我能够登录到AppInsights，所以我不需要设置配置。但是，我也注意到仪表板最多只显示一定数量的日志。因此，如果您想使用azure blob存储持久化日志，或者设置AppInsights日志记录，您可能需要设置配置。</p><blockquote class="kz la lb"><p id="4e50" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">你遇到的根本问题是，webjobs dashboard UX不能用于webjobs 3.x及以上版本和功能2.x及以上版本。现已替换为 <a class="ae lg" href="https://github.com/Azure/azure-webjobs-sdk/wiki/Application-Insights-Integration#webjobs-version-3x" rel="noopener ugc nofollow" target="_blank"> <em class="it"> App见解集成</em> </a> <em class="it">。我们不再对这个UX进行任何工程投资。</em></p><p id="4bcc" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae lg" href="https://github.com/Azure/azure-webjobs-sdk/issues/2179" rel="noopener ugc nofollow" target="_blank"> <em class="it">确保您正在设置一个名为azurewebjobsdashard</em></a>的连接字符串</p></blockquote><h1 id="383e" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">如果触发的WebJob没有在计划的时间运行，请检查时区。</h1><p id="eb71" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">通过在Settings.job文件中指定cron表达式，我将WebJob设置为按计划运行。起初，我认为它没有在我根据cron表达式所预期的正确时间运行。我意识到这个问题是因为服务器的时间是UTC。我通过将<strong class="kd iu">网站_时区</strong>配置添加到应用服务中，使WebJob在预定的设置下正确运行。如需了解更多信息，请参见此<a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/faq-configuration-and-management#how-do-i-set-the-server-time-zone-for-my-web-app-" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="c945" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我已经了解了我对WebJob的一些误解，在下一节中，我将快速浏览一下项目和管道设置。</p><h1 id="1ed6" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">WebJob项目</h1><p id="d466" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">WebJob基本上是一个. NET 5控制台应用程序。我使用主机构建器并配置依赖注入，从json文件、环境变量、key vault加载配置，配置AppInsights日志记录等。有关如何使用WebJobs SDK开发WebJob的说明，请查看<a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-sdk-get-started" rel="noopener ugc nofollow" target="_blank">文档</a>。需要注意的是，我无法从HostBuilderContext的HostingEnvironment中获得正确的环境名称。我使用了<code class="fe my mz na mp b">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") </code>来检索环境。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="9678" class="mt li it mp b gy mu mv l mw mx">// codes omitted for brevity <br/>using Microsoft.Azure.WebJobs;<br/><br/>namespace WebJob<br/>{<br/>    public class Program<br/>    {<br/>        private static IConfigurationRoot _configuration;<br/><br/>        static async Task Main(string[] args)<br/>        {<br/>            var builder = new HostBuilder();<br/><br/>            builder.ConfigureWebJobs(b =&gt;<br/>            {<br/><br/>            });<br/>            builder.ConfigureAppConfiguration((context, config) =&gt;<br/>            {<br/>                ConfigureAppConfiguration(config, context);<br/>            });<br/><br/>            builder.ConfigureLogging((context, loggingBuilder) =&gt;<br/>            {<br/><br/>                loggingBuilder.AddConsole();<br/>                string appInsightsInstrumentationKey = _configuration["APPINSIGHTS_INSTRUMENTATIONKEY"];<br/>                if (!string.IsNullOrEmpty(appInsightsInstrumentationKey))<br/>                {<br/>                    Console.WriteLine("Configuring applicationInsights logging.");<br/>                    loggingBuilder.AddApplicationInsightsWebJobs(o =&gt; {<br/>                        o.InstrumentationKey = appInsightsInstrumentationKey;         <br/>                        });<br/>                }<br/>            });<br/><br/>            builder.ConfigureServices(services =&gt;<br/>            {<br/>                ConfigureServices(services);<br/>            });<br/><br/><br/>            var host = builder.Build();<br/>            using (host)<br/>            {<br/>                var jobHost = host.Services.GetService(typeof(IJobHost)) as JobHost;<br/>                // codes omitted for brevity <br/><br/>                var paymentReportJob = new PaymentReportJob(...);<br/>                var inputs = new Dictionary&lt;string, object&gt;<br/>                {<br/>                    { "reportJob", paymentReportJob }<br/>                };<br/><br/>                await host.StartAsync();<br/>                await jobHost.CallAsync("DoReport", inputs);<br/>                await host.StopAsync();<br/>            }<br/>        }<br/><br/>        [NoAutomaticTrigger]<br/>        public static async Task DoReport(PaymentReportJob reportJob)<br/>        {<br/>            await reportJob.SendReportAsync();<br/>        }<br/><br/>        private static void ConfigureServices(IServiceCollection services)<br/>        {<br/>            services.Configure&lt;SmtpConfigOptions&gt;(_configuration.GetSection("SmtpConfigOptions"));<br/>            // codes omitted for brevity <br/>        }<br/><br/>        private static void ConfigureAppConfiguration(IConfigurationBuilder config, HostBuilderContext context)<br/>        {<br/>            var environment = Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT");<br/>            Console.WriteLine("Environment: " + environment);<br/>            config.AddJsonFile("appsettings.WebJob.json", optional: false, reloadOnChange: true);<br/>            // codes omitted for brevity <br/>            _configuration = config.Build();<br/>        }<br/>    }<br/><br/>   // codes omitted for brevity <br/>}</span></pre><h1 id="3e9c" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">构建管道</h1><p id="1d36" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">下面的代码片段仅包含构建WebJob的相关步骤，并将它与web应用程序一起打包在一个工件中，准备部署到应用程序服务。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="6fb0" class="mt li it mp b gy mu mv l mw mx">trigger:<br/>- "master"<br/><br/>pool:<br/>  vmImage: 'ubuntu-latest'<br/><br/>variables:<br/>  solution: '**/*.sln'<br/>  buildPlatform: 'Any CPU'<br/>  <br/>  buildConfiguration: 'Release'<br/><br/>steps:<br/>- checkout: self<br/><br/># some codes omitted for brevity <br/><br/><br/>- task: DotNetCoreCLI@2<br/>  inputs:<br/>    command: 'publish'<br/>    publishWebProjects: true<br/>    modifyOutputPath: false<br/>    arguments: '--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)'<br/>    zipAfterPublish: false<br/>  displayName: 'Publish web project'<br/><br/>- task: DotNetCoreCLI@2<br/>  inputs:<br/>    command: 'publish'<br/>    publishWebProjects: false<br/>    projects: '**/WebJob.csproj'<br/>    arguments: '--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)/App_Data/jobs/triggered -r win-x64 --self-contained false'<br/>    zipAfterPublish: false<br/>  displayName: 'Publish web job'<br/><br/>- task: ArchiveFiles@2<br/>  inputs:<br/>    rootFolderOrFile: '$(Build.ArtifactStagingDirectory)'<br/>    includeRootFolder: false<br/>    archiveType: 'zip'<br/>    archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'<br/><br/>- task: PublishPipelineArtifact@1<br/>  inputs:<br/>    targetPath: '$(Build.ArtifactStagingDirectory)'<br/>    ArtifactName: 'drop'<br/>  displayName: 'Publish artifact'</span></pre><p id="739d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上面的代码片段中，请注意:</p><ul class=""><li id="bbe0" class="nc nd it kd b ke kf ki kj km ne kq nf ku ng ky nh ni nj nk bi translated">我有两个DotNetCoreCLI@2任务，一个用于发布web应用程序，一个用于发布WebJob。</li><li id="6fde" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">在“发布web作业”任务中，我将值为win-x64且自包含标志设置为false的运行时(-r)作为参数传递。</li><li id="fcf4" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">如果不设置运行时，结果工件文件不包含可执行文件(。exe)文件。这是因为我使用了ubuntu代理来构建。</li><li id="f6c4" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">在没有关闭自包含标志的情况下，我得到了一个错误，因为WebJob是一个可执行文件，它引用了其他不可执行且非自包含的项目。更多详情见本<a class="ae lg" href="https://docs.microsoft.com/en-us/dotnet/core/compatibility/sdk/5.0/referencing-executable-generates-error" rel="noopener ugc nofollow" target="_blank">文件</a>。</li><li id="e901" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">WebJob和web app工件文件位于同一个根文件夹下:$(Build。ArtifactStagingDirectory)。</li><li id="356b" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">WebJob文件转到子目录:$(Build。artifactstagingdirect)/App _ Data/jobs/triggered。</li><li id="c338" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">在azure app service上，<em class="lc"> azure期望触发的WebJob位于相对于工件根目录的子目录App_Data/jobs/triggered </em>下。<em class="lc">如果你的网络作业是连续的，那么你需要确保代码在/site/wwwroot/app _ data/Jobs/Continuous</em>下，根据<a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-create#webjob-types" rel="noopener ugc nofollow" target="_blank">文件</a>。</li><li id="08ad" class="nc nd it kd b ke nl ki nm km nn kq no ku np ky nh ni nj nk bi translated">我使用ArchiveFiles@2任务创建结果zip文件，为部署做好准备。</li></ul><h1 id="d164" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">释放管道</h1><p id="0c39" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">我不需要在发布管道中做任何特别的事情。这是因为WebJob只是web应用程序的一部分，构建管道将所有内容放在一个zip文件中。</p><h1 id="a298" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">参考</h1><p id="2c0b" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated"><a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-create" rel="noopener ugc nofollow" target="_blank">在Azure应用服务中使用WebJobs运行后台任务</a></p><p id="d5af" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae lg" href="https://docs.microsoft.com/en-us/dotnet/core/compatibility/sdk/5.0/referencing-executable-generates-error" rel="noopener ugc nofollow" target="_blank">可执行项目引用不匹配的可执行文件时产生错误</a></p><p id="1fd4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae lg" href="https://stackoverflow.com/questions/59471540/making-requests-to-localhost-within-azure-app-services-application" rel="noopener ugc nofollow" target="_blank">在Azure App Services应用程序中向本地主机发出请求</a></p><p id="5406" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae lg" href="https://docs.microsoft.com/en-us/azure/app-service/faq-configuration-and-management#how-do-i-set-the-server-time-zone-for-my-web-app-" rel="noopener ugc nofollow" target="_blank">如何为我的web应用程序设置服务器时区？</a></p><p id="72aa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae lg" href="https://github.com/Azure/azure-webjobs-sdk/issues/2179" rel="noopener ugc nofollow" target="_blank">确保您正在设置一个名为AzureWebJobsDashboard的连接字符串</a></p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="fe5a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="lc">最初发表于2021年12月13日</em><a class="ae lg" href="https://www.taithienbo.com/build-and-deploy-a-webjob-alongside-web-app-using-azure-pipelines/" rel="noopener ugc nofollow" target="_blank"><em class="lc">https://www.taithienbo.com</em></a>T22。</p></div></div>    
</body>
</html>