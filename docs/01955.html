<html>
<head>
<title>How to Securely Copy Folder or File from One Host Machine to Another</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何安全地将文件夹或文件从一台主机复制到另一台主机</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-securely-copy-folder-or-file-from-one-host-machine-to-another-b259dcd8572f?source=collection_archive---------6-----------------------#2020-02-08">https://levelup.gitconnected.com/how-to-securely-copy-folder-or-file-from-one-host-machine-to-another-b259dcd8572f?source=collection_archive---------6-----------------------#2020-02-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8b611747c54e5d30cf618036d48ac675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xr1G_0wUBD5SzV_W"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@crawford?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克劳福德·乔利</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="165f" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">介绍</h1><p id="03c6" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们都遇到过需要在本地机器和远程机器之间或者远程机器之间复制文件夹/文件的情况。当然，我们也希望安全地这样做，尤其是当文件包含秘密或敏感信息时。</p><p id="a41f" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">幸运的是，这一点也不难做到。多亏了一个叫做<code class="fe mo mp mq mr b">scp</code>或者安全拷贝的linux命令。<code class="fe mo mp mq mr b">scp</code>基于<code class="fe mo mp mq mr b">ssh</code>协议。</p><p id="af78" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">在这个简短的教程中，让我们看看如何使用这个命令在机器/主机之间安全地传输文件夹或文件。</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="e657" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">将您的源主机ssh公钥放入目标主机</h1><p id="f92a" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">如前所述，<code class="fe mo mp mq mr b">scp</code>依靠<code class="fe mo mp mq mr b">ssh</code>来完成它的复制。第一步是在机器/主机之间建立<code class="fe mo mp mq mr b">ssh</code>连接。如果我们定期将文件传输到目的主机，那么只需将源主机的ssh公钥放在目的主机的已知主机中就更容易了。</p><p id="ea3b" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">复制您的ssh公钥的内容，它通常位于<code class="fe mo mp mq mr b">~/.ssh/id_rsa.pub</code>，并将其放在目的主机的<code class="fe mo mp mq mr b">~/.ssh/known_hosts</code>中，在远程主机的正确用户下。</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="948f" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">安全副本</h1><p id="cf53" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">现在，我们准备做一个安全拷贝。让我们来看几个场景。</p><h2 id="05b3" class="ms ko it bd kp mt mu dn kt mv mw dp kx lw mx my lb ma mz na lf me nb nc lj nd bi translated">从本地主机到远程主机</h2><p id="2abd" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">假设我们需要在远程主机中放入一个用于本地开发的秘密文件，因为我们的应用程序将在那里运行。为此，您可以从本地计算机运行以下命令。</p><pre class="ne nf ng nh gt ni mr nj nk aw nl bi"><span id="1eaf" class="ms ko it mr b gy nm nn l no np">~ ❯ scp ./kafka-service/secrets.yml remote_username@190.123.321.55:/home/remote_username/kafka-service/secret/</span></pre><p id="6528" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">在这个命令中，我们将位于本地机器的<code class="fe mo mp mq mr b">secrets.yml</code>文件复制到位于远程主机<code class="fe mo mp mq mr b">190.123.321.55</code>的<code class="fe mo mp mq mr b">/home/remote_username/kafka-service/secret/</code>文件夹中。</p><p id="28b6" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">要复制一个文件夹而不是一个文件，我们只需要在命令中添加递归标志<code class="fe mo mp mq mr b">-r</code>。下面我们来看一个例子。</p><pre class="ne nf ng nh gt ni mr nj nk aw nl bi"><span id="d5e6" class="ms ko it mr b gy nm nn l no np">~ ❯ scp -r ./payment-processor/configuration/ remote_username@190.123.321.55:/home/remote_username/payment-processor/</span></pre><p id="68a7" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">该命令将把整个<code class="fe mo mp mq mr b">./payment-processor/configuration/</code>文件夹从本地机器复制到远程主机的<code class="fe mo mp mq mr b">/home/remote_username/payment-processor/</code>文件夹。</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h2 id="f239" class="ms ko it bd kp mt mu dn kt mv mw dp kx lw mx my lb ma mz na lf me nb nc lj nd bi translated">从远程主机到本地主机</h2><p id="743a" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">有时，我们可能会在远程主机上进行大量的大数据处理，因为它有更多的内存和更快的处理器。结果是一个csv文件，我们想用它来玩，如果文件在本地主机上就更容易了。</p><p id="2b23" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">要将文件从远程主机复制到本地主机，我们可以运行以下命令。</p><pre class="ne nf ng nh gt ni mr nj nk aw nl bi"><span id="4e56" class="ms ko it mr b gy nm nn l no np">~ ❯ scp remote_username@190.123.321.55:/home/remote_username/big-data/result/result.csv ./big-data/result/</span></pre></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h2 id="f366" class="ms ko it bd kp mt mu dn kt mv mw dp kx lw mx my lb ma mz na lf me nb nc lj nd bi translated">从一台远程主机到另一台远程主机</h2><p id="f8c7" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated"><code class="fe mo mp mq mr b">scp</code>也可以用来将文件或文件夹从一台远程主机复制到另一台。我们只需要确保一个远程主机的ssh公钥存储在另一个远程主机的<code class="fe mo mp mq mr b">~/.ssh/known_host</code>文件中。</p><p id="1b08" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">以下命令将文件从一台远程主机复制到另一台远程主机。</p><pre class="ne nf ng nh gt ni mr nj nk aw nl bi"><span id="e5b5" class="ms ko it mr b gy nm nn l no np">~ ❯ scp remote_username@190.123.321.55:/home/remote_username/customer-service/config.yml another_remote_host@196.153.112.61:/home/another_remote_host/customer-service/</span></pre></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="c8ef" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">包裹</h1><p id="e5c5" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">通过<code class="fe mo mp mq mr b">scp</code>，将文件或文件夹从一台主机安全地复制到另一台主机变得很容易。所以，下次你需要这样做的时候，记得使用这个方便的命令。</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/d178b1431edc1f70ef15f4e0b866965f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KOnZtlTEyeAOEX0n"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@volkanolmez?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">沃尔坎·奥尔梅斯</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure></div></div>    
</body>
</html>