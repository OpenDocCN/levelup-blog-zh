<html>
<head>
<title>Sending Bulk Emails With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python发送批量电子邮件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sending-bulk-emails-via-python-4592b7ee57a5?source=collection_archive---------1-----------------------#2019-10-18">https://levelup.gitconnected.com/sending-bulk-emails-via-python-4592b7ee57a5?source=collection_archive---------1-----------------------#2019-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ef74" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">发送电子邮件的自动化方式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/2bf3a17d00064421960f06aa74f5c9ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*mDE4PXx8N5nvmY25jTiI-A.png"/></div></figure><p id="d033" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">手动发送电子邮件是一项乏味、耗时且容易出错的任务。我们可以使用Python来自动化这个过程。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="35ad" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated"><strong class="ak">入门</strong></h1><p id="3b1e" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">Python附带了各种内置模块。我们可以用来发送邮件的是<a class="ae mq" href="https://docs.python.org/3/library/smtplib.html" rel="noopener ugc nofollow" target="_blank"> <em class="mr"> smptlib </em> </a>，<em class="mr"> </em>，它使用简单邮件传输协议(<a class="ae mq" href="https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol" rel="noopener ugc nofollow" target="_blank"> SMTP </a>)。我们编写的代码将使用Gmail SMTP服务器通过端口<strong class="ks iu"> 587 </strong>或<strong class="ks iu"> 465 </strong>发送电子邮件。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="0768" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated"><strong class="ak">发送纯文本电子邮件</strong></h1><p id="daf5" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">我们将从导入发送电子邮件所需的所有助手模块开始。</p><p id="5539" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将使用<a class="ae mq" href="https://docs.python.org/2/library/email.mime.html" rel="noopener ugc nofollow" target="_blank"> <em class="mr"> email.mime </em> </a>来构建我们的电子邮件消息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="b7b0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们需要指定电子邮件帐户及其凭证，它们将用于发送电子邮件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="76e1" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，核心部分将包括接收邮件列表和我们邮件的各种标题，如<em class="mr">主题</em>、<em class="mr">正文</em>。</p><p id="df41" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在这种情况下，我们将发送一条简单的文本消息。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="a1eb" class="mz lu it mv b gy na nb l nc nd"># list of users to whom email is to be sent<br/>email_send = ['LIST_OF_RECIPIENTS']</span><span id="a515" class="mz lu it mv b gy ne nb l nc nd">subject = 'EMAIL_SUBJECT'</span><span id="64f2" class="mz lu it mv b gy ne nb l nc nd">msg = MIMEMultipart()<br/>msg['From'] = email_user</span><span id="5c34" class="mz lu it mv b gy ne nb l nc nd"># converting list of recipients into comma separated string<br/>msg['To'] = ", ".join(email_send)</span><span id="1c94" class="mz lu it mv b gy ne nb l nc nd">msg['Subject'] = subject</span><span id="ea71" class="mz lu it mv b gy ne nb l nc nd">body = 'EMAIL_BODY'<br/>msg.attach(MIMEText(body,'plain'))</span><span id="5ccd" class="mz lu it mv b gy ne nb l nc nd">text = msg.as_string()<br/>server = smtplib.SMTP('smtp.gmail.com',587)<br/>server.starttls()<br/>server.login(email_user,email_password)<br/>server.sendmail(email_user,email_send,text)<br/>server.quit()</span></pre><p id="866b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">上述代码可以与任何前端屏幕集成，以动态接收<code class="fe nf ng nh mv b">LIST_OF_RECIPIENTS</code>来一次发送批量邮件。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="feb8" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">发送包含HTML内容的电子邮件</h1><p id="88b6" class="pw-post-body-paragraph kq kr it ks b kt ml ju kv kw mm jx ky kz mn lb lc ld mo lf lg lh mp lj lk ll im bi translated">当发送带有HTML内容的电子邮件时，没有太大的变化。我们只需要稍微调整一下我们的邮件正文，它将包含HTML格式的文本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3da8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以我们将我们的正文文本改为包含HTML的文本，包含我们正文的MIMEText将把它称为<code class="fe nf ng nh mv b">html</code>而不是<code class="fe nf ng nh mv b">plain</code>。</p><p id="ac4a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">您还可以使用上述方法发送包含附件的电子邮件。</p></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><h1 id="7ef8" class="lt lu it bd lv lw lx ly lz ma mb mc md jz me ka mf kc mg kd mh kf mi kg mj mk bi translated">更多信息/文档</h1><ul class=""><li id="9195" class="ni nj it ks b kt ml kw mm kz nk ld nl lh nm ll nn no np nq bi translated"><a class="ae mq" href="https://docs.python.org/3/library/email.examples.html" rel="noopener ugc nofollow" target="_blank"> Python文档</a></li><li id="25e6" class="ni nj it ks b kt nr kw ns kz nt ld nu lh nv ll nn no np nq bi translated"><a class="ae mq" href="https://realpython.com/python-send-email/" rel="noopener ugc nofollow" target="_blank">真正的Python文章</a></li></ul></div></div>    
</body>
</html>