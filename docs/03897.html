<html>
<head>
<title>Angular Reactive Forms with Custom Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带自定义验证的角反应式表单</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/angular-reactive-forms-with-custom-validation-703cc6eddeb5?source=collection_archive---------10-----------------------#2020-06-01">https://levelup.gitconnected.com/angular-reactive-forms-with-custom-validation-703cc6eddeb5?source=collection_archive---------10-----------------------#2020-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/436e5011d7629220ac7080af7ffa6553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A4aa_qWwnRsdyuGN"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@codestorm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">萨法尔·萨法罗夫</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a082" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">形式是每个角度项目的主要部分。反应式和模板驱动是Angular提供的通过表单处理用户输入的两种主要方法。模板驱动的表单更适合那些需求非常基本，并且具有可以在模板中单独管理的逻辑的表单。乍一看，反应式表单似乎很复杂，但是它们更具可伸缩性、可重用性和可测试性。在这篇文章中，我将实现一个带有动态和自定义验证器的角度反应式表单。造型是使用有棱角的材料完成的。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="dc07" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">设置角度项目</h2><p id="033d" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">首先，我们必须初始化我们的角度项目，并添加角度材料。您可以通过在<code class="fe mg mh mi mj b">Angular-CLI.</code>中运行以下命令来轻松完成</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/dd856a71584d7fa6d3c8d83f7e17af06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YV9_vxk8o9rbOi3a5m8t4g.png"/></div></div></figure><p id="94ff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">项目初始化成功后，我们可以将应用中将要用到的物料模块导入到<code class="fe mg mh mi mj b">app.module.ts</code>中</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/154777cb010d8c5cd4ae418f2a615008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emW4ala2EBbJrMqaD-qQjQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序模块</figcaption></figure><h2 id="4c7f" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">开始使用反应式表单</h2><p id="5813" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">要开始使用反应式表单，首先，我们必须在<code class="fe mg mh mi mj b">app.module.ts</code>中导入<strong class="kf ir"> </strong> <code class="fe mg mh mi mj b"><strong class="kf ir">Reactive Forms Modules</strong></code>而不是<code class="fe mg mh mi mj b"><strong class="kf ir">FormsModule</strong></code>。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/9e4793e3b8b0bf62e629b62f96254901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWGolT5sfiMPu7L32w_dEw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序模块</figcaption></figure><p id="7b65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们继续讨论<code class="fe mg mh mi mj b">app.component.ts</code>文件。在这里，我们需要从<code class="fe mg mh mi mj b"><strong class="kf ir">@angular/forms</strong></code> <strong class="kf ir"> </strong>导入两个模块来构建和验证表单。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/3a17a2a530cdf165515ef7f32408341f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6odvsd9D4hcQOuLlZ8O8Tw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序组件</figcaption></figure><p id="5daa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是时候开始创造我们的角形了。首先，让我们创建一个带有内置验证的基本表单。</p><h2 id="0082" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated"><strong class="ak"> 1。创建反应式表单</strong></h2><p id="bc9b" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">作为第一步，我们必须创建一个类型为<code class="fe mg mh mi mj b"><strong class="kf ir">FormGroup</strong></code>的属性，它也需要从<code class="fe mg mh mi mj b"><strong class="kf ir">@angular/forms</strong></code> <strong class="kf ir">中导入。</strong>然后在这个FormGroup的对象中，我们需要为我们的每个输入创建单独的<code class="fe mg mh mi mj b"><strong class="kf ir">FormControl’s</strong></code>属性。</p><p id="fd0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码应该如下所示:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/c5a17e7667ed5b28a51289ea70c73838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zITjQHlsExo3g8PWQ9pBLQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序组件</figcaption></figure><p id="fa0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一些要点需要注意。这里我在<code class="fe mg mh mi mj b"><strong class="kf ir">ngOnInit()</strong></code>方法中包含了formGroup，因为我们需要这个表单在页面加载时出现。我还添加了一个名为<code class="fe mg mh mi mj b"><strong class="kf ir">onSubmit()</strong></code>的方法，这个方法将在表单提交时被调用。</p><p id="7399" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们必须将这个表单绑定到我们的HTML。<code class="fe mg mh mi mj b"><strong class="kf ir">formGroup</strong></code>将表单绑定到我们创建的FormGroup对象，每个表单域应该有<code class="fe mg mh mi mj b"><strong class="kf ir">formControlName,</strong></code>，它与<code class="fe mg mh mi mj b">component.ts file</code>中给出的名称相同。HTML表单应该如下所示:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/7e8dabbd154ab7c9299c45e9c80995a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gfynzg5fIFWueMDTZZSsg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">app.component.html</figcaption></figure><p id="f66d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里你可以注意到<strong class="kf ir">角色</strong>输入从一组选项中选择一个值。要了解更多关于<code class="fe mg mh mi mj b">mat-select</code>的工作原理，您可以参考<a class="ae kc" href="https://material.angular.io/components/select/overview" rel="noopener ugc nofollow" target="_blank"> <em class="mq">角度材料选择。</em>T15】</a></p><h2 id="dc69" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">2.添加内置验证</h2><p id="1f91" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">Validator类中有几个内置的验证函数可供使用。让我们给表单域添加一些内置的验证。</p><p id="dac9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加验证表单后，一个组如下所示。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/567acb863a12a3b9b830d9d962f6b85b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3-nwVaRFFYoq3R5f18p-2Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序组件</figcaption></figure><h2 id="67bf" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">添加自定义验证</h2><p id="87ed" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">下一步是添加定制的验证器函数，它动态地工作到我们的组件中。考虑一种情况，当用户选择角色为<strong class="kf ir">卖方</strong>时，联系号码是必需的，但是如果用户的角色为<strong class="kf ir">买方</strong>联系号码是可选的。在这种情况下，我们需要在表单中添加自定义验证器。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/7470c61be99a69854376252725795b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KUPU3Ar7_D9zzjDwNTbF7w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序组件</figcaption></figure><blockquote class="mr ms mt"><p id="8d06" class="kd ke mq kf b kg kh ki kj kk kl km kn mu kp kq kr mv kt ku kv mw kx ky kz la ij bi translated"><em class="iq">请记住，</em><code class="fe mg mh mi mj b"><strong class="kf ir"><em class="iq">setValidators()</em></strong></code><strong class="kf ir"><em class="iq"/></strong><em class="iq">方法会清除所有之前的验证器，因此，如果您需要向phone form-field添加任何其他验证器，请确保在</em><code class="fe mg mh mi mj b"><strong class="kf ir"><em class="iq">setPhoneValidation()</em></strong></code><strong class="kf ir"><em class="iq"/></strong><em class="iq">方法中声明它们。</em></p></blockquote><p id="f66b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，为了确保<code class="fe mg mh mi mj b"><strong class="kf ir">setPhoneValidation()</strong></code> <strong class="kf ir"> </strong>方法正常工作，请在<code class="fe mg mh mi mj b">ngOnInit()</code>中调用它。</p><h2 id="60e0" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">显示错误消息</h2><p id="bae4" class="pw-post-body-paragraph kd ke iq kf b kg mb ki kj kk mc km kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">好了，已经应用了验证，现在让我们看看如何显示错误消息。因此，我们带有验证的整个表单应该如下所示:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/3915a3dc045334ecc5a90007cd3e1754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLCkAHRlhezZ2V6nmens2w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">应用程序组件</figcaption></figure><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/2724c4949445ef1420c9c28dada6c4ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fxq7gSdGEQPFrIlYww7Rzg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">app.component.html</figcaption></figure><p id="3674" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，如果整个表单无效，确保禁用<strong class="kf ir">提交</strong>按钮。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/d8f9bbf00e33ad165a1ac9baad28e1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w10cxzzPgA0v8WaAAuj6Ow.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">app.component.html</figcaption></figure><p id="f793" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行应用程序的时间到了！这是我们最终输出的图片:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/915b54494649fefcecd0b517836eb1be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CptXyYoS-_Cl--rVleb5vQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">最终输出</figcaption></figure><p id="57c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在这里找到这个项目的最终代码。</p><p id="8a9c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读。</p><p id="b80a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码快乐！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="844c" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">参考</h2><div class="mz na gp gr nb nc"><a href="https://angular.io/guide/reactive-forms" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">有角的</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">Angular是一个构建移动和桌面web应用程序的平台。加入数百万开发者的社区…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">angular.io</p></div></div></div></a></div><div class="mz na gp gr nb nc"><a href="https://www.pluralsight.com/guides/building-custom-validators-in-angular" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">在Angular中构建自定义验证器</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">Gaurav Singhal语言框架和工具大多数web、桌面和移动应用程序都包含各种形式的…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">www.pluralsight.com</p></div></div></div></a></div></div></div>    
</body>
</html>