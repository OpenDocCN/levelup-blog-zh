<html>
<head>
<title>How to Use Floating IPs for Easy Cloud Scaling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用浮动IPs轻松实现云扩展</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/tws-010-how-to-use-floating-ips-for-easy-cloud-scaling-968b541c47d9?source=collection_archive---------17-----------------------#2019-12-13">https://levelup.gitconnected.com/tws-010-how-to-use-floating-ips-for-easy-cloud-scaling-968b541c47d9?source=collection_archive---------17-----------------------#2019-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/93ccfda6cc0850d989587d51e711fbc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hyYrcTTcATzK0M8KlKUzVA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">纠结的Web服务每日站立</figcaption></figure><div class=""/><div class=""><h2 id="fd84" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">了解如何在没有Docker或Kubernetes的情况下扩展到更快的droplet</h2></div><p id="de51" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">在这一集里，Ivana自学了如何迁移到一个更强大的web服务器，只需45分钟，无需Docker或Kubernetes。</em></p><p id="5deb" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">火箭科学是为岩石城青少年开设的课后STEM项目。最近，Ivana设计了一个新的门户网站，学生和他们的导师可以远程访问作业。</p><p id="fa95" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">一切都很完美。其实太美了。是时候离开来自数字海洋的入门大小的水滴了。</p><p id="5f65" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">伊万娜害怕去打扰正在工作的东西。由于她以前从未面对过这种情况，所以她向队友征求意见。</p><p id="d316" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“集装箱化是答案，”该团队的码头工人Devin宣布。“将所有东西放入一个容器中，您就可以在任何地方构建一个新的实例，这对于测试和试运行来说尤其有用。”</p><p id="9d8e" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“但是我已经测试完了，”她回答。“一切都运转得很好。为什么我需要学习如何将它容器化？”</p><p id="dc9f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“一旦你知道它是如何工作的，它真的很强大，”这是他唯一的论点。</p><p id="a831" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">网上有很多指南，所以Ivana开始研究。</p><p id="4960" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“嗯，”她想，“选择一个基础映像，安装软件包，暴露端口，处理日志记录。这是我在droplet上已经完成的所有内容。我想我可以重来一次。</p><p id="836f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“但是等等，”她的警报响起，“定义一个入口——什么？定义配置方法——真的吗？将您的数据具体化—哎呀！”</p><p id="b31b" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">在她的困惑中，伊万娜走到肯的办公桌前，寻求第二种意见。“Docker真的是正确答案吗？”她问。</p><p id="5c55" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“嗯，可以，”Ken停顿了一下，然后补充道，“但是如果您想要一流的水平可伸缩性，那么Kubernetes就是答案。”肯是该队的库伯内特人。</p><p id="a236" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">Ivana不确定这到底是什么意思，所以她做了一些快速的研究。“哦，我明白了，水平扩展是将服务器添加到一个群集中，并在前端放置一个负载平衡器。”</p><p id="66e6" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">是时候结束一天的工作了，开始在85号公路上漫长的通勤。在回家的路上，她苦思如何继续下去。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="0804" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">第二天早上，伊万娜开始再次考虑如何让火箭科学网站获得更好的性能。由于他们的云提供商是Digital Ocean，她准备在DO论坛上寻求一些建议，这时她偶然发现了一篇关于浮动IP的文章。不知何故，她错过了那一个。</p><p id="4faa" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我想到了一个好主意。为什么不跳过所有关于集装箱化的讨论，直接投入硬件呢？她想尝试这个想法。</p><p id="193c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">她直奔主题。</p><p id="239c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午9:30</em>首先，她去数字海洋联网面板，并预订了一个浮动IP。然后，她将这个浮动IP分配给托管<code class="fe mb mc md me b">rocket-science.com</code>网站的droplet。这只需要几分钟的时间。</p><p id="792c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午9:32</em>接下来，她进入域面板，将<code class="fe mb mc md me b">rocket-science.com</code>的现有DNS记录更改为新分配的浮动IP。更改DNS记录只需要一分钟，但是等待DNS记录传播最终需要大约30分钟(域的TTL记录设置为1800)。</p><p id="8967" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">与此同时，她给火箭科学公司的美智子发短信，告诉她网站将关闭几分钟，她要做一些快速维护。</p><p id="f05f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">她通过检查一些公共DNS服务器来监控DNS传播的进程。</p><pre class="mf mg mh mi gt mj me mk ml aw mm bi"><span id="8846" class="mn mo ji me b gy mp mq l mr ms">[root@rocksci] nslookup rocket-science.com 1.1.1.1<br/>[root@rocksci] nslookup rocket-science.com 8.8.8.8<br/>[root@rocksci] nslookup rocket-science.com 64.6.64.6</span></pre><p id="7ea0" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">然后，她走到星巴克去买她今天的第二杯咖啡。她与陷入一些技术汤争论的Devin和Ken交叉路径，所以她只是礼貌地点点头，并通过了。</p><p id="8665" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午10:00</em>25分钟后，当她回到自己的办公桌时，DNS更改已经完全传播开来。她停止了HTTP/2服务器并关闭了droplet:</p><pre class="mf mg mh mi gt mj me mk ml aw mm bi"><span id="72b2" class="mn mo ji me b gy mp mq l mr ms">[root@rocksci] systemctl stop rwserve<br/>[root@rocksci] shutdown --powerdown now</span></pre><p id="3b63" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午10:02</em>她在droplet关闭时拍摄了一张快照，以创建整个服务器的映像。这只花了几分钟时间(尽管DO指令警告说，根据所使用的磁盘空间大小，可能会花更长时间)。</p><p id="13d8" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午10:06</em>快照一完成，她就以该图像为基础创建了一个液滴。她选择了与现有1GB/1CPU droplet位于同一数据中心的Digital Ocean 1GB/3CPU计划。正如承诺的那样，水滴在大约一分钟内启动并运行。</p><p id="e35d" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午10:07</em>她将<code class="fe mb mc md me b">rocksci</code>水滴的浮动IP重新分配给新的<code class="fe mb mc md me b">rocksci2</code>水滴。</p><p id="2d9b" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午10:08</em>她登录到系统，重新配置HTTP/2服务器以使用新的处理器。她将集群大小从1增加到3。她还了解到，与其监听真实IP地址或浮动IP地址，不如监听0.0.0.0更方便。这是新配置的样子:</p><pre class="mf mg mh mi gt mj me mk ml aw mm bi"><span id="1dad" class="mn mo ji me b gy mp mq l mr ms">server {<br/>    ip-address 0.0.0.0<br/>    port 443<br/>    cluster-size 3<br/>}<br/>host {<br/>    hostname       rocket-science.com<br/>    document-root  `/srv/rocksci/public`<br/>    tls {<br/>        private-key    `/etc/letsencrypt/live/rocksci/privkey.pem`<br/>        certificate    `/etc/letsencrypt/live/rocksci/fullchain.pem`<br/>    }<br/>}</span></pre><p id="a78d" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">上午10点13分，一切都为最后一击做好了准备。实验会成功吗？她启动了服务器。</p><pre class="mf mg mh mi gt mj me mk ml aw mm bi"><span id="9b8a" class="mn mo ji me b gy mp mq l mr ms">[root@rocksci2] systemctl start rwserve</span></pre><p id="17c4" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">上午10点14分</em>一个快速的浏览器测试证实网站已经启动并运行。她的咖啡还是热的。</p><p id="0a3f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">那天下午，伊万娜收到了美智子的短信。</p><p id="39cc" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">“不知道为什么”“孩子说传送门好像更快”“Tks”</em></p><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/6df0c56511e8ee566f71277b7240a7e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9UgoUOEi8xsEdIdONOFw-w.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated">老板的称赞</figcaption></figure><p id="c422" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">第二天早上，在他们的每日脱口秀中，克拉丽莎问道:“那么，我们要对火箭科学做些什么呢？我们需要使用Kubernetes吗，还是Docker就足够了？”</p><p id="be56" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">“其实，都不是。我已经修好了，”伊万娜宣布。</p><p id="b2e5" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">"酷，"克拉丽莎惊呼道，之前德文或肯可以说什么，他们的面部扭曲表示惊讶。</p><p id="6354" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">后来，纠结网络服务公司的创始人克拉丽莎私下对伊万娜说:“谢谢你为美智子解决问题。干得好！从其他人的言论来看，我认为我们将为此奋斗数周，甚至更长时间。”</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="3d22" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">那天晚上，85号公路上的通勤似乎比平时更快。</p><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/3fa0b4084a56a6a4384669ceabfafca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*06cMNthR5uxciFcPBzGhMA.png"/></div></figure><p id="552c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">没有</em> <a class="ae mv" href="https://readwritetools.com/meet-the-team.blue?utm_term=UsingFloatingIpsForEasyCloudScaling" rel="noopener ugc nofollow" target="_blank"> <em class="lt"> minifig人物</em> </a> <em class="lt">在这个纠结的网络服务插曲的制作中受到伤害。</em></p></div></div>    
</body>
</html>