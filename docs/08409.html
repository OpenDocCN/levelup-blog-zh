<html>
<head>
<title>How to Easily Parse and Transform JSON in SQL Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SQL Server中轻松解析和转换JSON</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-easily-parse-and-transform-json-in-sql-server-c0b091a964de?source=collection_archive---------0-----------------------#2021-04-29">https://levelup.gitconnected.com/how-to-easily-parse-and-transform-json-in-sql-server-c0b091a964de?source=collection_archive---------0-----------------------#2021-04-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8499" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在SQL中使用和应用OPENJSON的介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/07d290633559e92d3c059dea73ab56a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jWXAoKSE5U2jctrB"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯蒂娜@ wocintechchat.com在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="28f9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">JSON无处不在！</h1><p id="f55b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">理解如何使用JSON是一项重要的技能。<strong class="lt iu"> JSON，</strong>简称<em class="mn"> JavaScript对象符号</em> <strong class="lt iu">，</strong>是最流行的数据交换格式之一。由于JavaScript是当今使用最广泛的语言，与JSON相关的问题在堆栈溢出方面已经超过了XML和其他流行的格式。只要JavaScript继续被广泛使用，这种趋势很可能会继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/338864b35b45250ca5bb24c579eac2db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EnnYWZYyCbu4FqH5EOfX6w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">深入了解JSON与XML，第1部分:每个标准的历史<a class="ae ky" href="https://www.toptal.com/web/json-vs-xml-part-1" rel="noopener ugc nofollow" target="_blank">https://www.toptal.com/web/json-vs-xml-part-1</a></figcaption></figure><p id="cc2d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">举一个真实的例子，我的团队开发的一个软件工具将JSON保存到SQL Server的一个表中。我们有一些用户询问探索JSON的有效方法。本文涵盖了在Microsoft SQL Server中使用JSON的一些基础知识。</p><p id="bdf6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">有关更多示例，请查看微软官方文档:</p><div class="mu mv gp gr mw mx"><a href="https://docs.microsoft.com/en-us/sql/relational-databases/json/json-data-sql-server?view=sql-server-ver15" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">使用JSON数据- SQL Server</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">SQL Server中的JSON数据</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">docs.microsoft.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ks mx"/></div></div></a></div><p id="a9dc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">注意这些示例使用的功能适用于:</p><ul class=""><li id="76db" class="nm nn it lt b lu mp lx mq ma no me np mi nq mm nr ns nt nu bi translated">SQL Server 2016及更高版本</li><li id="3ffd" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">Azure SQL数据库</li><li id="be2b" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">Azure Synapse分析</li></ul><h1 id="7cc3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">了解JSON</h1><p id="ff2c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">JSON格式利用对象和数组支持分层数据结构。对象是一个键/值对。例如:</p><p id="3b84" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">{"key1 ":"值1 "，" key2 ":"值2"}</p><p id="fba6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">数组是值的列表。例如:</p><p id="c3fc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">["值1 "，"值2 "，"值3"]</p><p id="011f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">在JSON中，对象和数组可以包含其他对象或数组，给数据一个类似于<em class="mn">树的</em>结构。例如:</p><p id="2653" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">{"key1" : [{ "values1" : ["1 "，" 2"]，" values2" : ["3 "，" 4"] }] }</p><p id="3e7b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">注意<strong class="lt iu"> Key1 </strong>是如何与包含对象的数组配对的。每个都有自己的阵列。这些被称为<em class="mn">嵌套分层JSON子数组。</em></p><p id="a2b3" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">格式化JSON使得理解对象层次更容易。我喜欢使用免费的在线格式化工具:</p><div class="mu mv gp gr mw mx"><a href="https://jsonformatter.org/json-pretty-print" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">最佳JSON漂亮打印在线</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">最佳JSON Pretty打印工具，使Pretty JSON和JSON彩色打印，并保存和在线共享。</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">jsonformatter.org</p></div></div><div class="ng l"><div class="oa l ni nj nk ng nl ks mx"/></div></div></a></div><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="b744" class="og la it oc b gy oh oi l oj ok">{<br/>  "key1": [<br/>    {<br/>      "values1": [<br/>        "1",<br/>        "2"<br/>      ],<br/>      "values2": [<br/>        "3",<br/>        "4"<br/>      ]<br/>    }<br/>  ]<br/>}</span></pre><h1 id="0f6c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在SQL Server中使用OPENJSON转换JSON</h1><p id="b614" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要开始探索SQL Server中的JSON，我推荐使用<a class="ae ky" href="https://docs.microsoft.com/en-us/sql/relational-databases/json/json-data-sql-server?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> OPENJSON </strong>函数</a>。如果您需要一些JSON来玩，下面的脚本将创建桌子超级英雄。它有一个主键和一个描述列。一旦表被创建，一个JSON字符串将被插入超级英雄表中。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="8c54" class="og la it oc b gy oh oi l oj ok">CREATE TABLE superHero(<br/> [heroID] [int] PRIMARY KEY CLUSTERED IDENTITY(1,1) NOT NULL,<br/> [description] nvarchar(MAX) NOT NULL,<br/>) ON [PRIMARY]</span><span id="5d94" class="og la it oc b gy ol oi l oj ok">insert into superhero([description])<br/>select '{<br/>  "universe": "dc",<br/>  "characters": [<br/>    {<br/>      "hero": "superman",<br/>      "alias": "clark kent",<br/>      "powers": [<br/>        "x-ray vision",<br/>        "super strength",<br/>        "super speed",<br/>        "laser eyes",<br/>        "bullet proof"<br/>      ],<br/>      "friends": [<br/>        {<br/>          "hero": "batman",<br/>          "alias": "bruce wayne"<br/>        },<br/>        {<br/>          "hero": "cyborg",<br/>          "alias": "victor stone"<br/>        }<br/>      ]<br/>    }<br/>  ]<br/>}'</span></pre><p id="c985" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">请注意，示例JSON深入了几个层次。在层次结构中，注意<strong class="lt iu"> <em class="mn">内的好友</em> </strong>是<strong class="lt iu"> <em class="mn">内的人物</em> </strong>和<strong class="lt iu"> <em class="mn">内的人物</em> </strong>是<strong class="lt iu"> <em class="mn">内的根</em> </strong> <em class="mn">对象</em>。这意味着我需要查询嵌套的分层JSON子数组<em class="mn"> </em>来将所有JSON数据整理成表格格式<em class="mn">。这听起来比实际情况更复杂！</em></p><p id="3fbc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">要查看表格，只需选择*。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="57eb" class="og la it oc b gy oh oi l oj ok">select * from superHero</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b57075011da0f191c5278a3b5db063a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*7wLChPQP7e5GXOYy2gXupQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">超级英雄表格结果</figcaption></figure><p id="a527" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">要打开描述列中的JSON，使用<strong class="lt iu"> OPENJSON </strong>函数:</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="2455" class="og la it oc b gy oh oi l oj ok">select * <br/>from OPENJSON((select description from superHero where heroID = 1))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/0900b19c804acdc8fa67cfefd7f5a3b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*IYKvuFEp3ymvaGLNdOju-Q.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">OPENJSON结果</figcaption></figure><p id="9ccb" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">因为JSON存储在<strong class="lt iu">描述</strong>列中，所以我向OPENJSON函数传递了一个查询，该查询返回heroID 1的描述。查看结果时，请注意它们被放入<strong class="lt iu"> <em class="mn">键</em> </strong>和<strong class="lt iu"> <em class="mn">值</em> </strong>列，以及一个<strong class="lt iu"> <em class="mn">类型</em> </strong>列。类型是指<strong class="lt iu"> <em class="mn">值</em> </strong>列中的数据类型。</p><p id="5fd8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">注意键<strong class="lt iu"> <em class="mn">字符</em> </strong>与一个看起来仍然是JSON的值成对出现。那是因为<strong class="lt iu"> OPENJSON </strong>一次只打开<em class="mn">一个</em>级别。它只开放了包含宇宙和角色的根层。</p><h2 id="9d04" class="og la it bd lb oo op dn lf oq or dp lj ma os ot ll me ou ov ln mi ow ox lp oy bi translated">使用JSON路径</h2><p id="c2fb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要直接查询<strong class="lt iu"> <em class="mn">字符</em> </strong>值，可以将一个<strong class="lt iu"> <em class="mn"> JSON路径</em> </strong>传入<strong class="lt iu"> OPENJSON </strong>函数。路径总是以<strong class="lt iu"> $ </strong>开头。</p><p id="d305" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">记住，JSON数组使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Zero-based_numbering" rel="noopener ugc nofollow" target="_blank">从零开始的数组索引</a>。这意味着它们从0开始，而不是从1开始。因此，如果我想看到<em class="mn">字符对象</em>中的键值对，我需要将位置传递到路径中。既然要看第一个位置，我的路径就是<strong class="lt iu"> '$。字符[0]' </strong></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="2c82" class="og la it oc b gy oh oi l oj ok">select * <br/>from OPENJSON(<br/>    (select description from superHero where heroID = 1),<br/>    '<strong class="oc iu">$.characters[0]</strong>'<br/>  )</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/33d90e8f4e6e8bac5c85db5071cc7c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-clrTeg9TmUAmm-Fvr-0OQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd lb"> $。字符[0]结果</strong></figcaption></figure><p id="be84" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">使用相同的路径模式，如果我想探索第一个<em class="mn">角色的第二个</em>朋友，路径将是<strong class="lt iu"> '$。字符[0]。朋友[1]' </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/bd5e91a040aab2af46ca498c2b8f4ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*wYPZ9OIGKFtog7vZly7P_g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd lb"> $。字符[0]。朋友[1]结果</strong></figcaption></figure><h1 id="1005" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">查询嵌套的分层JSON子数组</h1><p id="1ff0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为OPENJSON提供一个路径对于挖掘单个JSON级别很有用，但是对于一次返回多个嵌套层次结构并不理想。在SQL Server中，<strong class="lt iu">交叉应用</strong>和<strong class="lt iu">外部应用</strong>可以用来展平嵌套的JSON。虽然乍一看可能会令人困惑，但SQL Server使得打开JSON层次结构变得相当直观。</p><p id="a2e0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">要展平超级英雄JSON，首先从超级英雄表中选择。然后在描述字段交叉应用OPENJSON。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="0807" class="og la it oc b gy oh oi l oj ok">select *<br/>from superHero s<br/>CROSS APPLY OPENJSON(s.description)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/e22320db00feece5bd3c12821b4cbb0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*TxvWXQYDK0cijI8DUYQ74A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">交叉应用结果</figcaption></figure><p id="0580" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">交叉应用将每个键值对连接到超级英雄中的行上。由于OPENJSON是打开根对象，所以这两个键是<strong class="lt iu"> <em class="mn">宇宙</em> </strong>和<strong class="lt iu"> <em class="mn">字符</em> </strong>。</p><p id="8d76" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">在SQL查询中使用带有关键字的<strong class="lt iu">，键值对可以透视到一列而不是一行:</strong></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="c44b" class="og la it oc b gy oh oi l oj ok">select *<br/>from superHero s<br/>CROSS APPLY OPENJSON(s.description)<br/>WITH (universe varchar(10))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/d2f1b3bce9344861c6240ce6040ceb44.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*ggVt3S7uzicFkxR48Kgblg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">有结果</figcaption></figure><p id="70ac" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">注意只有一行返回，现在有一个<strong class="lt iu"> universe </strong>列，而不是一个键列和值列。</p><p id="8aeb" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">要打开嵌套的<strong class="lt iu"> <em class="mn">字符</em> </strong>级别，在WITH语句中，将<strong class="lt iu"> <em class="mn">字符</em> </strong>转换为JSON。然后在查询中添加另一个交叉应用OPENJSON，打开JSON。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="8391" class="og la it oc b gy oh oi l oj ok">select *<br/>from superHero s<br/>CROSS APPLY OPENJSON(s.description)<br/>WITH (universe varchar(10), characters nvarchar(max) as JSON) c<br/> CROSS apply OPENJSON(c.characters)</span></pre><p id="80d6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">若要拼合字符，请使用WITH并将键包含在字符中。对朋友对象做同样的事情。</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="ad1e" class="og la it oc b gy oh oi l oj ok">select heroID<br/>, universe<br/>, f.hero<br/>, f.alias<br/>, powers<br/>, g.hero as friendHero<br/>, g.alias as friendAlias<br/>from superHero s<br/>CROSS APPLY OPENJSON(s.description)<br/>WITH (universe varchar(10), characters nvarchar(max) as JSON) c<br/> CROSS apply OPENJSON(c.characters) <br/> WITH (hero varchar(20), alias varchar(20),powers nvarchar(max)as JSON, friends nvarchar(max)as JSON) f<br/>  OUTER APPLY OPENJSON(f.friends)<br/>  WITH(hero varchar(20), alias varchar(20)) g</span></pre><p id="4a1e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">该查询从超级英雄表中选择字段，并将它们与根对象交叉连接。使用WITH运算符，查询知道从提供的键中选择值。在查询中，我从根对象上的OPENJSON调用中选择了<strong class="lt iu"> <em class="mn"> universe </em> </strong>。将<strong class="lt iu"> <em class="mn">字符</em> </strong>值转换为JSON允许它被传递到另一个OPENJSON。通过使用CROSS APPLY和OUTER APPLY将OPENJSON链接在一起，该查询解析每个嵌套层次结构，并以表格格式返回扁平数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/c166ed9bebbe905dc7c7a4ce9869c03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhRu237VCOVaZyUpgmdRNQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">查询嵌套的JSON子数组</figcaption></figure><p id="e397" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">恭喜你！您刚刚将嵌套的JSON转换成了扁平的结果集！</p><h1 id="8f9d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">最终想法</strong></h1><p id="ea36" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">由于JavaScript的流行，JSON的使用越来越多，了解如何使用它是一项了不起的技能。尽管看起来有些吓人，但由于OPENJSON函数的存在，在SQL Server中使用JSON变得相当简单。在几行SQL中，您可以将JSON转换成列和行。要了解更多关于OPENJSON的信息，我建议查看微软官方文档。</p><h1 id="d238" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">谢谢大家！</h1><ul class=""><li id="9f8b" class="nm nn it lt b lu lv lx ly ma pe me pf mi pg mm nr ns nt nu bi translated"><em class="mn">如果你喜欢我的作品，</em> <a class="ae ky" href="https://medium.com/@erickleppen" rel="noopener"> <em class="mn">关注我的中</em> </a> <em class="mn">了解更多！</em></li><li id="d9b0" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated"><a class="ae ky" href="https://erickleppen.medium.com/membership" rel="noopener"> <em class="mn">通过订阅</em> </a>获得完全访问权限并帮助支持我的内容！</li><li id="75c5" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated"><em class="mn">我们来连线一下</em><a class="ae ky" href="https://www.linkedin.com/in/erickleppen01/" rel="noopener ugc nofollow" target="_blank"><em class="mn">LinkedIn</em></a></li><li id="8488" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated"><em class="mn">用Python分析数据？查看我的</em> <a class="ae ky" href="https://pythondashboards.com/" rel="noopener ugc nofollow" target="_blank"> <em class="mn">网站</em> </a>！</li></ul><p id="0c04" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><a class="ae ky" href="http://pythondashboards.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> —埃里克·克莱本</strong> </a></p><div class="mu mv gp gr mw mx"><a href="https://erickleppen.medium.com/the-ultimate-guide-to-erics-articles-d32df8241353" rel="noopener follow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">埃里克文章的终极指南</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">我的所有内容按主题组织…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">erickleppen.medium.com</p></div></div><div class="ng l"><div class="ph l ni nj nk ng nl ks mx"/></div></div></a></div></div></div>    
</body>
</html>