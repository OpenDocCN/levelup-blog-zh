<html>
<head>
<title>Navigate Your Unix Shell History Like a Boss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像老板一样浏览您的Unix Shell历史</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/navigate-your-unix-shell-history-like-a-boss-5722ef45689f?source=collection_archive---------3-----------------------#2020-08-25">https://levelup.gitconnected.com/navigate-your-unix-shell-history-like-a-boss-5722ef45689f?source=collection_archive---------3-----------------------#2020-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f666" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您的shell历史不仅仅是箭头键…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/069328ef5bb4e7307911b1457bb0a80c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CtRc-dweWeVcyp8h"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">马库斯·斯皮斯克在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="143e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您使用Mac或Linux终端，那么您很可能已经与shell历史交互过。我认识的大多数人只是使用向上箭头来查找以前执行过的命令，但是这错过了大量的功能。</p><p id="91ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我将教你如何像老板一样驾驭历史。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="4272" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">历史到底是什么？</h1><p id="a6bb" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">大多数Unix风格的shells都有内置的历史特性。这意味着当您键入一个命令时，shell会记住它，您可以在以后调用它。</p><p id="e1f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">历史不是魔术，命令实际上存储在内存中，随后存储在一个文件中。您可以通过以下方式找到它:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="3754" class="mu ln it mq b gy mv mw l mx my">echo $HISTFILE</span></pre><p id="99a2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我来说，这张照片:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="7c37" class="mu ln it mq b gy mv mw l mx my">/home/dir/.zhistory</span></pre><p id="5242" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要查看文件内容，我们可以运行:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="5259" class="mu ln it mq b gy mv mw l mx my">cat $HISTFILE</span></pre><p id="841e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以看到这只是一个简单的命令列表。存储的命令数量由两个shell变量控制:</p><ul class=""><li id="73d5" class="mz na it js b jt ju jx jy kb nb kf nc kj nd kn ne nf ng nh bi translated"><code class="fe ni nj nk mq b">HISTSIZE</code>，决定会话运行时内存中存储的命令数量</li><li id="1989" class="mz na it js b jt nl jx nm kb nn kf no kj np kn ne nf ng nh bi translated"><code class="fe ni nj nk mq b">HISTFILESIZE</code>，决定历史文件中存储的命令数量。</li></ul><p id="e084" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要保存最后的1000个命令，请将如下内容添加到您的shell配置文件中(通常是<code class="fe ni nj nk mq b">~/.bashrc</code>或<code class="fe ni nj nk mq b">~/.zshrc</code>):</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="b66c" class="mu ln it mq b gy mv mw l mx my">export HISTFILESIZE=1000<br/>export HISTSIZE=1000</span></pre></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="b7f7" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">浏览历史</h1><p id="38ab" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">如前所述，可以使用键盘上的箭头键浏览历史记录，按enter键执行存储的命令。但是还有比这更大的潜力！</p><h2 id="c5b4" class="mu ln it bd lo nq nr dn ls ns nt dp lw kb nu nv ma kf nw nx me kj ny nz mi oa bi translated">编号历史列表</h2><p id="2ff3" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">要获取命令的编号列表，请键入:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="a45b" class="mu ln it mq b gy mv mw l mx my">history</span></pre><p id="a0bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将产生如下输出:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/ab06051007a538c26df6fa873f7868ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_yZ50ekPO1SGOOsaEorCA.png"/></div></div></figure><h2 id="d31b" class="mu ln it bd lo nq nr dn ls ns nt dp lw kb nu nv ma kf nw nx me kj ny nz mi oa bi translated">运行以前的命令</h2><p id="3d52" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">要从我们的历史中运行一个特定的命令，我们可以使用一个<code class="fe ni nj nk mq b">!</code>后跟命令号。例如:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="853f" class="mu ln it mq b gy mv mw l mx my">!504</span></pre><p id="65de" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将执行历史列表中的命令<code class="fe ni nj nk mq b">504</code>。</p><p id="5b81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们还可以重新执行上次运行的命令:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="aa6d" class="mu ln it mq b gy mv mw l mx my">!!</span></pre><p id="bc05" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要通过文本内容而不是数字来运行前面的命令，我们可以使用:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="9fc0" class="mu ln it mq b gy mv mw l mx my">!cat</span></pre><p id="b0d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有上述命令将导致执行相同的命令(504)，给出以下输出:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/9509f59b8e086c65b72d1e1580a70d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B__PedawHaTz5sUpmhe8ig.png"/></div></div></figure><p id="5130" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有时我们想在执行命令之前检查它。为此，我们添加了<code class="fe ni nj nk mq b">:p</code>。例如:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="4dd9" class="mu ln it mq b gy mv mw l mx my">!ssh:p</span></pre><p id="d99e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将打印出如下内容:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/9314e82f52461f1de686ce8739278120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IisUz76UDtr9TIFfkK6c5w.png"/></div></div></figure><p id="a50d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我经常使用<code class="fe ni nj nk mq b">!ssh</code>来恢复我之前的<code class="fe ni nj nk mq b">ssh</code>会话，而不需要输入完整的命令。另一种方法是:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="a0f3" class="mu ln it mq b gy mv mw l mx my">ssh !*</span></pre><p id="d586" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">操作符<code class="fe ni nj nk mq b">!*</code>使用历史中上一次调用该命令的参数。在我们的例子中，<code class="fe ni nj nk mq b">!ssh</code>直接等同于<code class="fe ni nj nk mq b">ssh !*</code>。</p><h2 id="dc7b" class="mu ln it bd lo nq nr dn ls ns nt dp lw kb nu nv ma kf nw nx me kj ny nz mi oa bi translated">“反向I”搜索</h2><p id="179f" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">在shell中键入“ctrl-r”将启动“反向I”搜索。这使得交互式搜索(反向)通过您的命令历史。</p><p id="bc22" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，键入“ctrl-r ”,后跟“ssh ”,会得到以下结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/d83bac32182ba367a337376f06e478e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9zxVmc5wi6Huy_Po2icrew.png"/></div></div></figure><p id="4d67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">再次点击“ctrl-r”会给出包含文本<code class="fe ni nj nk mq b">ssh</code>的下一个命令。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/7c7b85c583820c09cd952ee19a586464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*REvf6KzUCEnklh4mg7O2tw.png"/></div></div></figure><p id="66df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要运行找到的命令，请按enter键。要退出反向搜索，请点击“ctrl-g”。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="3965" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">额外提示:标记历史</h1><p id="4eed" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">因为shell中#字符之后的任何内容都被解释为注释，所以我们可以用它来“标记”某些命令。</p><p id="ebcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="c8ec" class="mu ln it mq b gy mv mw l mx my">ls | grep "some really complicated regex" #mygrep</span></pre><p id="830a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们可以使用reverse-i-search来执行基于标签的命令。我们通过键入以下命令来实现:</p><ul class=""><li id="2e02" class="mz na it js b jt ju jx jy kb nb kf nc kj nd kn ne nf ng nh bi translated">ctrl-r</li><li id="c921" class="mz na it js b jt nl jx nm kb nn kf no kj np kn ne nf ng nh bi translated">#mygrep</li><li id="ec45" class="mz na it js b jt nl jx nm kb nn kf no kj np kn ne nf ng nh bi translated">进入</li></ul><p id="c5a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您正在使用<code class="fe ni nj nk mq b">zsh</code>，您可能还需要在您的<code class="fe ni nj nk mq b">.zshrc</code>中添加下面一行来启用交互式评论，以实现这一功能:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="08e0" class="mu ln it mq b gy mv mw l mx my">setopt interactivecomments</span></pre></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="9086" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读！如果你有任何额外的历史提示，我很乐意在评论中听到。</p></div></div>    
</body>
</html>