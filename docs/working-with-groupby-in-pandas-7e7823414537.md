# å¦‚ä½•å¯¹ç†ŠçŒ«ä¸­çš„åˆ†ç»„æ•°æ®åº”ç”¨å‡½æ•°ï¼Ÿ

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/working-with-groupby-in-pandas-7e7823414537>

## Groupby ä½¿ç”¨åˆ†ç»„æ•°æ®åƒç©çƒä¸€æ ·ç©çš„æç¤ºå’ŒæŠ€å·§

![](img/e86dab9c10de8398479d1fdb96adb62a.png)

ç”± [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ [krakenimages](https://unsplash.com/@krakenimages?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

Groupby å†…ç½®åŠŸèƒ½æœ‰é™ã€‚åœ¨è¿™ç¯‡[æ–‡ç« ](https://medium.com/star-gazers/groupby-in-pandas-5df348e293f8?source=your_stories_page-------------------------------------)ä¸­ï¼Œæˆ‘å±•ç¤ºäº†å¦‚ä½•åœ¨æˆ‘ç”¨ groupby åˆ›å»ºçš„å¯¹è±¡ä¸Šä½¿ç”¨ä¸€äº›å‡½æ•°ï¼Œæ¯”å¦‚ mean å’Œ sumã€‚ä½†æ˜¯ä½¿ç”¨ aggregate æ–¹æ³•ï¼Œæ—¢å¯ä»¥ä½¿ç”¨è‡ªå·±ç¼–å†™çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ groupby å†…ç½®çš„å‡½æ•°ã€‚

æˆ‘è¦è°ˆçš„æ˜¯ä»¥ä¸‹è¯é¢˜:

*   å¦‚ä½•å¯¹åˆ†ç»„æ•°æ®åº”ç”¨å‡½æ•°ï¼Ÿ
*   å¦‚ä½•å°†è‡ªå·±ç¼–å†™çš„å‡½æ•°åº”ç”¨äºåˆ†ç»„æ•°æ®ï¼Ÿ
*   åº”ç”¨å¤šä¸ªåŠŸèƒ½
*   å¦‚ä½•ä¸ºæ¯ä¸ªç»„çš„ç±»åˆ«åº”ç”¨è¯¥åŠŸèƒ½ï¼Ÿ
*   å¤„ç†ç¼ºå¤±æ•°æ®

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ä¸è¦å¿˜è®°è®¢é˜…[æˆ‘çš„ youtube é¢‘é“](https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw)ï¼Œåœ¨é‚£é‡Œæˆ‘åˆ›å»ºäº†å…³äºäººå·¥æ™ºèƒ½ã€æ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„å†…å®¹ã€‚ğŸ‘‡

è®©æˆ‘ä»¬å¼€å§‹å§ï¼

# å¦‚ä½•å¯¹åˆ†ç»„æ•°æ®åº”ç”¨å‡½æ•°ï¼Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥è¿›å£ç†ŠçŒ«å’Œ Numpyã€‚

![](img/e407af5b23e1ecfc9a71bf50a140bff3.png)

ç°åœ¨ï¼Œè®©æˆ‘åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ã€‚

![](img/ca9cde62c60f0a02ba92ec39835f64d1.png)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ•°æ®é›†ã€‚

![](img/42b09b17de6ba86dc49b3691cdb149f3.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æŒ‰é”®åˆ—å¯¹æ•°æ®é›†è¿›è¡Œåˆ†ç»„ã€‚

![](img/e0e6aa6edc042abeb48b5973e815e6a9.png)

å¯¹äº Aã€B å’Œ C ç»„ï¼Œå¯ä»¥ä½¿ç”¨ aggregate æ–¹æ³•åº”ç”¨ minã€np.median å’Œ max å‡½æ•°ã€‚

![](img/1f9ef4dd2cff7a829d16ae37b61a6435.png)

> Y ä½ å¯ä»¥ç”¨ç¼©å†™ agg ä»£æ›¿ aggregateã€‚

é€šè¿‡ä½¿ç”¨å­—å…¸ç»“æ„ï¼Œå¯ä»¥å¯¹æ¯ä¸€åˆ—åº”ç”¨ä¸åŒçš„å‡½æ•°ã€‚è®©æˆ‘å±•ç¤ºè¿™ä¸ªã€‚

![](img/bf18cff1f65710b3729b37cc49897765.png)

# å¦‚ä½•å°†è‡ªå·±ç¼–å†™çš„å‡½æ•°åº”ç”¨äºåˆ†ç»„æ•°æ®ï¼Ÿ

ä½ å¯ä»¥åº”ç”¨ä½ å†™çš„ä¸€ä¸ªå‡½æ•°ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°ã€‚

![](img/4daf263f7357852e56cac7cd4311dd5a.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åº”ç”¨è¿™ä¸ªå‡½æ•°ã€‚

![](img/f525faf5a1e4c11d876a30b0083a28ef.png)

# åº”ç”¨å¤šä¸ªåŠŸèƒ½

ä¸ºäº†å±•ç¤ºå¦‚ä½•åº”ç”¨å¤šä¸ªå‡½æ•°ï¼Œé¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…·æœ‰åˆ†å±‚ç´¢å¼•çš„æ•°æ®é›†ã€‚

![](img/d120c6613d5e363f9debd307cd1e7817.png)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ•°æ®é›†ã€‚

![](img/f566a0064f6770f62c84c63274739f7c.png)

ç°åœ¨è®©æˆ‘åˆ›å»ºç»„å¯¹è±¡ã€‚

![](img/720b7b6098d605c92ec4c83db11e32e9.png)

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä¸º d1 æ•°æ®åˆ›å»ºç»„å¯¹è±¡ã€‚

![](img/a2d2ec1536aa8a7311a00626eb048ed2.png)

è®©æˆ‘æ‰¾å‡ºè¿™ä¸ªå˜é‡çš„å¹³å‡å€¼ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†æŠŠ mean å‡½æ•°ä½œä¸ºå­—ç¬¦ä¸²å†™å…¥ agg å‡½æ•°ã€‚

![](img/d60352bd1cf9d51c752b78f7b678017b.png)

æ‚¨å¯ä»¥å¯¹åˆ†ç»„æ•°æ®åº”ç”¨å¤šä¸ªå‡½æ•°ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦åœ¨åˆ—è¡¨ä¸­ç¼–å†™å‡½æ•°ã€‚

![](img/f6372481c1d32528a71272fd71d35472.png)

è¿˜å¯ä»¥é€šè¿‡åœ¨å…ƒç»„ç»“æ„ä¸­ç¼–å†™åˆ—åå’Œå‡½æ•°æ¥åº”ç”¨å‡½æ•°ã€‚

![](img/0acaf8d711f801e4e2f878d9f6bd8a81.png)

æ‚¨è¿˜å¯ä»¥å¯¹åˆ—åº”ç”¨å•ç‹¬çš„å‡½æ•°ã€‚

![](img/656cf73e6bdc2b66e4a6d2bd99a4752b.png)

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å±‚æ¬¡ç´¢å¼•ã€‚å¦‚æœä¸å¸Œæœ›ç´¢å¼•å…·æœ‰å±‚æ¬¡ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨ as_index = Falseã€‚

![](img/ca88797cb658f1edea1889d892386109.png)

# å¦‚ä½•ä¸ºæ¯ä¸ªç»„çš„ç±»åˆ«åº”ç”¨è¯¥åŠŸèƒ½ï¼Ÿ

æ‚¨å¯ä»¥ä½¿ç”¨ apply æ–¹æ³•æ¥å®ç°æ¯ä¸ªç»„çš„ç±»åˆ«ä¸­çš„ä»»ä½•å‡½æ•°ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬å†æ¥çœ‹çœ‹æˆ‘ä»¬çš„æ•°æ®ã€‚

![](img/dc50ed9f150289ecdeee20f46ee2e8f8.png)

è®©æˆ‘ä»¬æŒ‰å­—æ¯åˆ—å¯¹æ•°æ®é›†è¿›è¡Œåˆ†ç»„ã€‚

![](img/c05f5228a48eaab6d201b961b2d57a13.png)

è®©æˆ‘ä»¬æ‰¾åˆ°ç»„ä¸­æ¯ä¸ªç±»åˆ«çš„ d2 çš„æ±‡æ€»ç»Ÿè®¡æ•°æ®ã€‚

![](img/963db513260b854035456c74a09dc753.png)

ä¸ºäº†å±•ç¤ºå¦ä¸€ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ã€‚

![](img/80d985c715de247a71c0c5e66d8afc63.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ†ç»„ã€‚

![](img/2a24fb562a3f4dc9bb22602281d1cd69.png)

è®©æˆ‘ä»¬æ‰¾å‡ºå„ç»„çš„å¹³å‡å€¼ã€‚

![](img/ee58caadb720409bfbe9d4bd85d6c195.png)

# å¤„ç†ç¼ºå¤±æ•°æ®

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨ç»„å¹³å‡å€¼æ¥ä»£æ›¿ç¼ºå¤±å€¼ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ lambda å…³é”®å­—ç”¨ mean å¡«å……ç¼ºå¤±çš„æ•°æ®ã€‚

![](img/9ad5f64c124b5f721396a9add8cb9063.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°† func å‡½æ•°åº”ç”¨äº group å¯¹è±¡ã€‚

![](img/e540d4e8f55df39aa22e047f43e8af37.png)

æ‚¨å¯ä»¥ä¸ºä¸¢å¤±çš„æ•°æ®ä½¿ç”¨æ‚¨æƒ³è¦çš„å€¼ã€‚ä¸ºäº†å±•ç¤ºè¿™ä¸€ç‚¹ï¼Œè®©æˆ‘åˆ›å»ºå€¼å˜é‡ã€‚

![](img/7f01363cdf261c5a3a3aed0284ac859b.png)

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å‡½æ•°ç”¨è¿™ä¸ªå€¼å˜é‡å¡«å……ç¼ºå¤±çš„æ•°æ®ã€‚

![](img/1d75fa309ea3ceb3ff9c77a4b0c6dbe8.png)

æœ€åï¼Œè®©æˆ‘ä»¬å°†è¿™ä¸ªå‡½æ•°åº”ç”¨äºç”¨ apply åˆ†ç»„çš„æ•°æ®ã€‚

![](img/6b6481e815c12bafecf11ab84bf35417.png)

å°±æ˜¯è¿™æ ·ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»äº†å¦‚ä½•åœ¨ Pandas ä¸­ä½¿ç”¨ groupbyã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ã€‚æ„Ÿè°¢é˜…è¯»ã€‚åœ¨è¿™é‡Œå¯ä»¥æ‰¾åˆ°ç¬”è®°æœ¬[ã€‚](https://github.com/TirendazAcademy/PANDAS-TUTORIAL/blob/main/16-GroupBy.ipynb)

è¯·ä¸è¦å¿˜è®°å…³æ³¨æˆ‘ä»¬çš„[YouTube](http://youtube.com/tirendazacademy)|[Twitter](http://twitter.com/tirendazacademy)|[GitHub](http://github.com/tirendazacademy)|[Linkedin](https://www.linkedin.com/in/tirendaz-academy)|[ka ggle](https://www.kaggle.com/tirendazacademy)

[](https://medium.com/geekculture/8-best-seaborn-visualizations-20143a4b3b2f) [## 8 ä¸ªæœ€å¥½çš„ Seaborn å¯è§†åŒ–

### Python Seaborn ä½¿ç”¨ penguin æ•°æ®é›†å®é™…ç»˜åˆ¶ç»Ÿè®¡å›¾ã€‚

medium.com](https://medium.com/geekculture/8-best-seaborn-visualizations-20143a4b3b2f) [](/practical-data-analysis-with-pandas-c40fbd2955fa) [## ç†ŠçŒ«çš„å®ç”¨æ•°æ®åˆ†æ

### åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æåˆ°äº†åœ¨ç†ŠçŒ«å›¾ä¹¦é¦†ä½¿ç”¨æ•°æ®ã€‚Python æœ€é‡è¦çš„åº“ä¹‹ä¸€æ˜¯ç†ŠçŒ«â€¦

levelup.gitconnected.com](/practical-data-analysis-with-pandas-c40fbd2955fa) 

å¦‚æœè¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»æ‹æ‰‹ğŸ‘æŒ‰é’®å‡ ä¸‹ï¼Œä»¥ç¤ºæ”¯æŒğŸ‘‡