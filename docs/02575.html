<html>
<head>
<title>Creating a Custom VPC in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS中创建自定义VPC</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/creating-a-custom-vpc-in-aws-b4ea7bf4a71?source=collection_archive---------7-----------------------#2020-03-23">https://levelup.gitconnected.com/creating-a-custom-vpc-in-aws-b4ea7bf4a71?source=collection_archive---------7-----------------------#2020-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e50bec55882698ef7b1915b5f75d659a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YcNHxdrbPlV-lWjN_0Ek3g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">亚马逊VPC标志</figcaption></figure><p id="38a6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">大家好，在上一篇文章中，我们讨论了不同的VPC术语。这可能让您对AWS中的VPC有了一个高层次的了解。</p><p id="ffe1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本文中，我们将创建一个带有公共子网和私有子网的自定义VPC。每个子网内部都有一个EC2实例(安装了WordPress)。</p><p id="6ab5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公共子网中的实例可以通过互联网访问，而私有子网中的实例则不能。下面是我们将要构建的架构。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/5625b64c3764eeca072d0b3f456e89fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kt3VXtKzkHqrHNp0tKrhOA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">VPC建筑</figcaption></figure><h1 id="7fb4" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建自定义VPC</h1><p id="b68c" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">登录您的AWS控制台，选择您想要创建VPC的地区(在本例中，我使用的是北弗吉尼亚州),然后选择VPC。</p><p id="2551" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，点击左边栏中的<strong class="ke ir">你的VPCs </strong>，然后点击<strong class="ke ir">创建VPC。</strong></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/99752ca04af547d29fcc1cb179538677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zzpg5wGdLv5WPeSxzfdR8g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建VPC页面</figcaption></figure><p id="9d51" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为您的VPC和IPv4 CIDR块命名。如果您愿意，也可以提供IPv6 CIDR数据块，但在本例中，我将使用默认选择。</p><p id="1b5d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以强制在此VPC中启动的EC2实例的租用。如果您选择<strong class="ke ir">专用</strong>，那么您的所有实例都将在专用租赁实例上启动(成本更高)。如果选择<strong class="ke ir">默认</strong>选项，那么实例将使用启动时选择的租用选项。</p><p id="3a86" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">点击<strong class="ke ir">创建</strong>按钮<strong class="ke ir">创建您的自定义VPC！</strong></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/4dae649ce4be384db23846fb387d014b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhIkEmDIWjNVj4ZuhvpTHg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">你的VPCs</figcaption></figure><p id="9b63" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，您可以看到您的自定义VPC以及默认的VPC。</p><p id="9336" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">创建新的VPC时，默认情况下会创建网络访问控制列表(NACL)和主路由表。</p><h1 id="5f4e" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建子网</h1><p id="40bc" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">现在我们已经创建了我们的自定义VPC，让我们通过从左侧栏中选择<strong class="ke ir">子网</strong>选项卡并单击<strong class="ke ir">创建子网</strong>按钮来创建我们的公共和私有子网。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/a1cb493523c51c2f258dc8ecb83aa8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8b2WqAve6qBFeFw9N-ubVQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建公共子网</figcaption></figure><p id="5dc3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们首先创建公共子网。您可以给它一个容易识别的友好名称，然后为该子网选择自定义VPC和IPv4 CIDR块。这里，我选择<strong class="ke ir"> 10.0.1.0/24 </strong>作为CIDR块。</p><p id="3ba9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您还可以选择要在其中创建该子网的AZ，因为子网总是映射到一个AZ。</p><p id="8c44" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">完成后，单击<strong class="ke ir">创建</strong>按钮创建子网。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/5b2c8ac27a4c21ab219942a9ff430b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJcGzIlR7-ZsCSc013dhhg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建专用子网</figcaption></figure><p id="e43f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以类似的方式，您现在可以创建一个专用子网。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/733c9f0b2c377e94aeaa077757375549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4enDwqFUg1yV5dNvP-Jaew.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">您的子网</figcaption></figure><p id="1072" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">默认情况下，子网的<strong class="ke ir">自动分配公共IP </strong>设置为禁用。让我们为我们的公共子网启用它，方法是选择它并单击顶部的<strong class="ke ir">操作</strong>下拉菜单，然后选择<strong class="ke ir">修改自动分配IP设置。</strong></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/72095dcf97a8cfed3be850817f59aa96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwvOlnPh8lQJt99PMQJUbg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">子网选项</figcaption></figure><p id="460c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，选择复选框并点击<strong class="ke ir">保存</strong>按钮。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/8990d00d9a8ed49edbb579c34152a8d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHYvBMDfJTFVR_kwpHQFfw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">子网自动分配公共IP设置</figcaption></figure><h1 id="ce3b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建互联网网关</h1><p id="94a9" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">如果没有连接internet网关，在该VPC中创建的任何实例都无法通过internet访问。</p><p id="217d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要创建互联网网关，请进入左侧栏的<strong class="ke ir">互联网网关</strong>选项卡，点击顶部的<strong class="ke ir">创建</strong> <strong class="ke ir">互联网网关</strong>。为您的互联网网关命名，然后点击<strong class="ke ir">保存</strong>按钮。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/3ee2dd64bee7c6269b7d9c84aef0d85b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNATRckIZF_BbIvV5mKC4Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">互联网网关</figcaption></figure><p id="d8ca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以看到网关是分离的。您需要将互联网网关与您的自定义VPC连接起来。您可以选择它，点击顶部的<strong class="ke ir">操作</strong>下拉菜单，然后选择<strong class="ke ir">连接到VPC。</strong></p><p id="f2d0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后选择您的定制VPC并点击<strong class="ke ir">连接</strong>按钮。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/1c64eb2538af0d0e613dae3bd0df958d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kvjx5J6V0wOISH9pd7DM4g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">连接互联网网关</figcaption></figure><h1 id="5cee" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">创建路由表</h1><p id="033f" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">出于安全原因，建议保留主路由表不变。因此，我们将为我们的自定义VPC创建一个新的路由表，并允许通过它访问我们的公共子网。</p><p id="90a4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们从左侧栏进入<strong class="ke ir">路由表</strong>选项卡，点击顶部的<strong class="ke ir">创建路由表</strong>按钮。</p><p id="6899" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为您的路由表命名，选择自定义VPC并点击<strong class="ke ir">保存</strong>按钮。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/c12c0a155bce5b1d20f133f5e7c2b3b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4FTD38RcvgVvmgVtpYO4Fw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建路由表页面</figcaption></figure><h2 id="9db0" class="mt lh iq bd li mu mv dn lm mw mx dp lq kn my mz lu kr na nb ly kv nc nd mc ne bi translated">将子网与路由表相关联</h2><p id="b38f" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">默认情况下，所有子网都与主路由表相关联。让我们通过选择公共子网并导航到底部的<strong class="ke ir">子网关联</strong>选项卡，将其与自定义路由表相关联。</p><p id="b038" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">点击<strong class="ke ir">编辑子网关联</strong>，选择公共子网，点击<strong class="ke ir">保存</strong>按钮。</p><h2 id="0a26" class="mt lh iq bd li mu mv dn lm mw mx dp lq kn my mz lu kr na nb ly kv nc nd mc ne bi translated">创建允许internet访问的路由</h2><p id="8865" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">现在，为了允许internet访问我们的公共子网，我们需要为我们的自定义路由表创建一条新路由。</p><p id="191c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">选择自定义路由表并导航至底部的<strong class="ke ir">路线</strong>选项卡。点击<strong class="ke ir">编辑路由</strong>按钮，添加一条目的地为<strong class="ke ir"> 0.0.0.0/0 </strong>的新路由，即互联网，目标为连接的互联网网关。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/b8fa6327091ade9df1b420af51c48c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppUoES71JHp27K1p6wqkKg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">编辑自定义路由表的路由</figcaption></figure><p id="be05" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">保存路由，现在您的公共子网可以访问互联网了。</p><h1 id="35bc" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">启动实例</h1><p id="09cf" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">是时候启动我们的实例了。转到EC2仪表板，点击<strong class="ke ir">启动实例。</strong></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/bdabca7d38d973167eb7869459587fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GsX5aiBOmdvtnC5zsyqDVg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">WordPress AMI</figcaption></figure><p id="8fa4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从AWS Marketplace中选择经Bitnami认证的WordPress和automatic，并选择一个实例类型。我在这里选择t2.micro，因为它在免费层中可用。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/98007eb66d01aaba55c08ad1f12bdceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LX85KmoTwvJdJOCrC4uIyQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">配置公共实例</figcaption></figure><p id="5d57" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在下一步中，选择自定义VPC作为网络，选择公共子网作为子网。现在，在子网正下方的字段中，您可以看到字段<strong class="ke ir">自动分配公共IP </strong>，其值设置为子网设置。</p><p id="d904" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因为在我们的子网中，我们启用了该选项，所以这里的默认选项是<strong class="ke ir"> Enable。</strong></p><p id="cd7f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，添加一些存储空间并给你的实例命名(我给的是<strong class="ke ir"> public-instance </strong>)。</p><h2 id="2742" class="mt lh iq bd li mu mv dn lm mw mx dp lq kn my mz lu kr na nb ly kv nc nd mc ne bi translated">创建安全组</h2><p id="422c" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">现在创建一个安全组，将端口22、80和443向互联网开放。我正在打开端口22，因为我们要从我们的公共实例SSH到我们的私有实例，但是为了更好的安全性，SSH应该只对您的特定IP开放。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/58639fd839d222d2f7491f3fd731b86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ds9pvK-e9C6JkVkmZI8lkQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">创建安全组</figcaption></figure><p id="aeec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">点击<strong class="ke ir">查看并启动</strong>，通过创建一个密钥对来启动实例。</p><p id="0d33" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，要创建私有实例，选择相同的AMI和实例类型。只是这次选择<strong class="ke ir">私有子网</strong>来启动实例。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/781bf80631863fc2e4d1a83db2b50385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2uUMZ33CgJGjB66_3hxhfw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">配置私有实例</figcaption></figure><p id="8556" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以看到，对于专用子网，默认情况下<strong class="ke ir">自动分配公共IP </strong>是禁用的。</p><p id="8360" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，添加一些存储，为实例命名，选择用于公共实例的相同安全组，并使用相同的密钥启动实例。</p><p id="b1e9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦两个实例都在运行，您可以看到只有公共实例有一个<strong class="ke ir"> IPv4公共IP。</strong></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/f9cae806525565c604393d65fa017502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EsuNtKaHIeCNs6YgDZKH6Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">EC2实例</figcaption></figure><p id="5eea" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你在浏览器中打开这个IP，你会看到你的新博客！</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/b4990b9685fb4dcd6be3ba9a083d654e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7bq7M7JnAcy0PhAiEDV-Tg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">公共实例上的WordPress博客</figcaption></figure><p id="2541" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因为你的私有实例没有公开的IP地址，所以你不能从浏览器上看到它的博客。</p><h1 id="1f6b" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">SSH到实例</h1><p id="350a" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">现在是SSH到您的实例的时候了，但是由于您的私有实例没有公共IP地址，您将无法直接从您的系统SSH到它。</p><p id="d548" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以让我们首先将SSH放入公共实例。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/d52cfaae347886f1a40661990aee7d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZvC8eVqRAFw91pwfNuSrkA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">SSH到公共实例</figcaption></figure><p id="2b30" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要确认您的实例可以访问互联网，您可以运行<code class="fe nn no np nq b">sudo apt-get update</code>并查看它是否工作。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/a21a856e50c559695c639df63091ba85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SL35LByPoCPsyDgMspbVtw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">更新公共实例</figcaption></figure><p id="50cc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们在公共子网内，我们应该能够SSH到我们的私有子网，因为默认情况下，VPC内的实例可以相互通信。</p><p id="a1eb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于SSH，我们需要私钥，因此创建一个<code class="fe nn no np nq b">.pem</code>文件，并将下载的PEM文件的内容复制到其中。您可以通过键入以下命令来创建新文件</p><ul class=""><li id="04a8" class="ns nt iq ke b kf kg kj kk kn nu kr nv kv nw kz nx ny nz oa bi translated"><code class="fe nn no np nq b">vi private.pem</code>开启维姆</li><li id="1f2b" class="ns nt iq ke b kf ob kj oc kn od kr oe kv of kz nx ny nz oa bi translated">按<code class="fe nn no np nq b">i</code>进入VIM的插入模式</li><li id="e499" class="ns nt iq ke b kf ob kj oc kn od kr oe kv of kz nx ny nz oa bi translated">使用Mac上的<code class="fe nn no np nq b">Command + V</code>和Linux上的<code class="fe nn no np nq b">Ctrl + Shift + V</code>复制您下载的PEM文件内容并粘贴到终端中</li><li id="4528" class="ns nt iq ke b kf ob kj oc kn od kr oe kv of kz nx ny nz oa bi translated">按Escape键退出插入模式，键入<code class="fe nn no np nq b">:wq</code>保存文件并退出</li><li id="e81f" class="ns nt iq ke b kf ob kj oc kn od kr oe kv of kz nx ny nz oa bi translated">现在，键入<code class="fe nn no np nq b">chmod 600 private.pem</code>来限制文件的权限</li></ul><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/fa680bb4ec217562700cef64054ca249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joFaahVk32ttgg_1xD1QpQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">SSH到私有实例</figcaption></figure><p id="309c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要SSH到私有实例，请键入以下命令</p><p id="c802" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe nn no np nq b">ssh ubuntu@&lt;private-IP-of-private-instance&gt; -i private.pem</code></p><p id="c561" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">选择一个实例后，可以在<strong class="ke ir">描述</strong>页签中找到该实例的私有IP。在我的例子中，私有实例的私有IP是<code class="fe nn no np nq b">10.0.3.171</code></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/fe736f7d307d4daa49cd9ecb4049aa19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_tO2oPG0tfrLyFFeLwl1UA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">私有子网的私有IP</figcaption></figure><p id="f160" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们在我们私人实例的终端。为了确认我们的私有实例不能访问互联网，让我们运行相同的命令<code class="fe nn no np nq b">sudo apt-get update</code></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/16ef319e8fd25f4a2c7d657c31910b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6fGnoYxhys8byort5ULRTw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">无法更新专用子网(无法访问互联网)</figcaption></figure><p id="3166" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您会注意到它要么超时，要么显示一些错误。</p><h1 id="9c22" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">私有子网的应用</h1><p id="3426" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">现在，您已经看到了私有子网，让我们看看您为什么要使用它</p><ol class=""><li id="522a" class="ns nt iq ke b kf kg kj kk kn nu kr nv kv nw kz oj ny nz oa bi translated"><strong class="ke ir">数据库</strong> —最常见的用例之一是将数据库托管在私有子网中，而将web服务器托管在公共子网中。通过这种方式，您可以限制对数据库的互联网访问，从而提供额外的安全保障。</li><li id="e5d8" class="ns nt iq ke b kf ob kj oc kn od kr oe kv of kz oj ny nz oa bi translated"><strong class="ke ir">应用服务器</strong> —假设您有处理逻辑并与数据库交互的应用服务器。现在，您的web服务器可以将作业传递给专用子网中的应用程序服务器。</li></ol><h1 id="f0ec" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">对私有实例的出站Internet访问</h1><p id="5a3a" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">您的私有实例可能需要出站internet访问，以保持系统最新。您可以通过创建NAT网关来做到这一点。它们只允许对您的私有实例进行出站internet访问，而阻止对这些实例的所有入站internet访问。</p><h1 id="a793" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">包裹</h1><p id="13a2" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">现在，您已经学习了如何创建带有公共子网和私有子网的自定义VPC，是时候结束整个设置了。</p><ol class=""><li id="8ef4" class="ns nt iq ke b kf kg kj kk kn nu kr nv kv nw kz oj ny nz oa bi translated">终止您的EC2实例</li><li id="fd32" class="ns nt iq ke b kf ob kj oc kn od kr oe kv of kz oj ny nz oa bi translated">一旦您的实例被终止，转到您的VPC仪表板，选择您的自定义VPC，点击顶部的<strong class="ke ir">操作</strong>按钮，并选择<strong class="ke ir">删除VPC </strong>选项。</li></ol><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/2acd6be3a804a0935e06740dd93b4d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cm-a-P8QLL63DikAQuFldA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">删除自定义VPC</figcaption></figure><p id="e18f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">再次点击<strong class="ke ir">删除VPC </strong>，它将删除你的VPC及其所有资源。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/74732a6a2b21089c47ba5f573dc8789c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhFlaNJJjVUDrueCymOpow.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">删除VPC确认</figcaption></figure></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><p id="de8b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你从这篇文章中学到了一些东西，如果你有疑问或反馈，请在下面评论！</p><p id="b2ff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">非常感谢你阅读这篇文章。如果你喜欢它，请给它一些掌声，让更多的人从中受益！</p></div></div>    
</body>
</html>