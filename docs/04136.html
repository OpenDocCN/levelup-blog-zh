<html>
<head>
<title>How to Set Up Credentials to Send an Email Using the Gmail API (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何设置使用Gmail API发送电子邮件的凭证(第1部分)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-set-up-credentials-to-and-send-an-email-using-the-gmail-api-259145a0a5ec?source=collection_archive---------6-----------------------#2020-06-11">https://levelup.gitconnected.com/how-to-set-up-credentials-to-and-send-an-email-using-the-gmail-api-259145a0a5ec?source=collection_archive---------6-----------------------#2020-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2a2c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过Gmail API自动化您的电子邮件(第1部分)</h2></div><p id="8597" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这一系列文章中，我将带你们了解我使用Gmail API能够实现的一切，从设置凭证开始，发送第一封电子邮件，回复某人，发送后续电子邮件，最后使用Google Analytics设置打开的电子邮件跟踪。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/33b6f84fa24f244e47cc2105bb713cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5bdlKkcy4jY76veELXPyg.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk translated">在<a class="ae lu" href="https://unsplash.com/s/photos/automation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae lu" href="https://unsplash.com/@neonbrand?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> NeONBRAND </a>拍摄的照片</figcaption></figure><p id="56f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个系列中，我们将讨论以下内容:</p><ol class=""><li id="66d6" class="lv lw it kk b kl km ko kp kr lx kv ly kz lz ld ma mb mc md bi translated">获得一个Google开发人员帐户，设置凭证，并发送您的第一封电子邮件(第1部分)。</li><li id="7b13" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">添加附件、图片等，格式化电子邮件(第2部分)。</li><li id="d818" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">回复某人并在同一条线索上发送后续消息(第3部分)。</li><li id="fe18" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">使用Google Analytics设置电子邮件打开跟踪(第4部分)。</li></ol><p id="c13f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一部分的中心是创建一个服务帐户。首先，让我们把它分成几个阶段:</p><ol class=""><li id="4fd9" class="lv lw it kk b kl km ko kp kr lx kv ly kz lz ld ma mb mc md bi translated">打开Gmail API。</li><li id="da8a" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">创建服务帐户。</li><li id="88cb" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">创建OAuth客户端ID。</li><li id="ed43" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">授权服务帐户发送电子邮件。</li><li id="92b1" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">使用Python发送第一封电子邮件。</li></ol><p id="ce4f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">打开Gmail API </strong></p><p id="598e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">访问<a class="ae lu" href="https://console.developers.google.com/start/api?id=gmail" rel="noopener ugc nofollow" target="_blank">该向导</a>在Google开发者控制台中创建一个项目。这不仅会创建一个项目，还会打开Gmail API。</p><p id="420e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">创建服务账户</strong></p><p id="2c45" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一部分要求您遵循几个步骤，但我将带您一步一步地完成它们:</p><ol class=""><li id="5c2d" class="lv lw it kk b kl km ko kp kr lx kv ly kz lz ld ma mb mc md bi translated">访问<a class="ae lu" href="https://console.developers.google.com/iam-admin/serviceaccounts" rel="noopener ugc nofollow" target="_blank">此</a> <strong class="kk iu">服务帐户</strong>页面并创建一个服务帐户。</li><li id="a6d7" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">在表单中，将要求您输入<strong class="kk iu">服务帐户名称</strong>和<strong class="kk iu">描述</strong>(还有一个字段<strong class="kk iu">服务帐户id </strong>，但将自动填写)，输入服务帐户名称和描述(非必填)。完成后点击<strong class="kk iu">创建</strong>。</li><li id="92a0" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">对于<strong class="kk iu">项目角色</strong>，选择<strong class="kk iu">项目&gt;所有者</strong>。然后点击<strong class="kk iu">继续</strong>。</li><li id="0bfb" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">在下一页的<strong class="kk iu">密钥</strong>部分，点击<strong class="kk iu">创建密钥&gt; JSON，</strong>之后，一个JSON文件将被下载并保存在一个安全的位置。点击<strong class="kk iu">完成。</strong></li></ol><p id="051a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一切顺利，你会在<strong class="kk iu">服务账户</strong>部分看到你的服务账户。大概是这样的(下面截图)</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mj"><img src="../Images/5480a0fccbb5f17a2d0a3f9d9eb00e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4CdFR7jVwR8SbRNRDACoIA.png"/></div></div></figure><h2 id="632f" class="mk ml it bd mm mn mo dn mp mq mr dp ms kr mt mu mv kv mw mx my kz mz na nb nc bi translated"><strong class="ak">创建OAuth客户端ID </strong></h2><p id="afae" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">创建<strong class="kk iu"> OAuth凭证</strong>需要我们填写<strong class="kk iu"> OAuth同意屏幕</strong>表单，所以让我们先填写它。单击OAuth同意屏幕，您可以在屏幕左侧的导航窗格中找到该屏幕。</p><p id="4009" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">单击OAuth同意屏幕，您将在您的<strong class="kk iu">应用程序名称</strong>下看到一个表格(如果您愿意，您可以填写该表格中的其余详细信息，但这不是强制性的，也可以在以后完成)，通过单击<strong class="kk iu">保存</strong>继续下一步。</p><p id="9625" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，我们将能够创建<strong class="kk iu"> OAuth凭证。</strong>现在，让我们创建它，</p><ol class=""><li id="29fb" class="lv lw it kk b kl km ko kp kr lx kv ly kz lz ld ma mb mc md bi translated">切换回<a class="ae lu" href="https://console.developers.google.com/apis/credentials" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">凭证页面</strong></a><strong class="kk iu"/>，现在点击<strong class="kk iu">创建凭证&gt; OAuthClient ID。</strong></li><li id="e7d6" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">从下拉菜单中选择应用程序类型(如果您不知道选择什么，则选择<strong class="kk iu">Web</strong>T27】应用程序)。</li><li id="1345" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">现在输入<strong class="kk iu">名称</strong>，在<strong class="kk iu">授权重定向URIs下，</strong>点击<strong class="kk iu">添加URI </strong>，在输入框中添加<code class="fe ni nj nk nl b">http://localhost/</code>(这只是为了添加URI)。从页面下载此凭证文件。将下载一个JSON文件，保存该文件，我们稍后将使用它发送电子邮件。</li></ol><h2 id="347a" class="mk ml it bd mm mn mo dn mp mq mr dp ms kr mt mu mv kv mw mx my kz mz na nb nc bi translated"><strong class="ak">授权创建的app发送邮件</strong></h2><p id="c68a" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">这部分的灵感来自于<a class="ae lu" href="https://developers.google.com/gmail/api/quickstart/python" rel="noopener ugc nofollow" target="_blank"> Gmail API文档</a>。我们将按照本教程进行授权。</p><ol class=""><li id="eba0" class="lv lw it kk b kl km ko kp kr lx kv ly kz lz ld ma mb mc md bi translated"><br/>安装依赖项，<code class="fe ni nj nk nl b">pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</code></li><li id="ebe1" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">运行下面的代码，只需将JSON文件的路径替换为我们在上一步中下载的JSON文件的路径。现在，我们只使用一个scope(发送电子邮件)，我们将在后面的系列中使用更多的scope。你可以在这里阅读关于示波器<a class="ae lu" href="https://developers.google.com/gmail/api/auth/scopes" rel="noopener ugc nofollow" target="_blank">的内容。</a></li></ol><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nm nn l"/></div></figure><ol class=""><li id="1454" class="lv lw it kk b kl km ko kp kr lx kv ly kz lz ld ma mb mc md bi translated">现在，当我们尝试运行<code class="fe ni nj nk nl b">main</code>功能时，您的浏览器将会打开，您将首先进行身份验证，然后授权您创建的应用程序发送电子邮件。</li><li id="d75e" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">授权成功后，您的凭证pickle文件将存储在您的系统中。</li><li id="0a56" class="lv lw it kk b kl me ko mf kr mg kv mh kz mi ld ma mb mc md bi translated">我们将在下一步使用这个pickle文件发送电子邮件。</li></ol><h2 id="cfcf" class="mk ml it bd mm mn mo dn mp mq mr dp ms kr mt mu mv kv mw mx my kz mz na nb nc bi translated"><strong class="ak">使用Python发送第一封电子邮件</strong></h2><p id="4814" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">让我们从最激动人心的部分开始，即。如何发送电子邮件？</p><p id="530b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我们可以通过python发送电子邮件的脚本。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="c965" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的脚本中，您必须用您的数据输入替换某些数据字段，其中最重要的是<code class="fe ni nj nk nl b">path_to_pickle</code>、<code class="fe ni nj nk nl b">sender</code>地址(发件人)和收件人地址(<code class="fe ni nj nk nl b">to</code>)，您现在可以保留其他数据字段。</p><p id="9b5d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行此脚本后，检查收件人邮箱，查看电子邮件是否发出。</p><h1 id="be0b" class="no ml it bd mm np nq nr mp ns nt nu ms jz nv ka mv kc nw kd my kf nx kg nb ny bi translated">脚注</h1><p id="8325" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">这只是本系列的第一部分，我们可以通过使用Gmail API做很多事情，我将在本系列的下一篇文章中介绍一些重要的事情。</p><p id="cbe1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果这在某种程度上有所帮助，请随时按下“鼓掌”按钮。另外，如果你有任何问题，请在下面的评论区告诉我。</p></div></div>    
</body>
</html>