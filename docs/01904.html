<html>
<head>
<title>Learn how to Internationalize (i18n) Angular with ngx-translate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解如何使用ngx-translate国际化(i18n) Angular</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/angular-internationalization-i18n-with-ngx-translate-8f89005cb337?source=collection_archive---------4-----------------------#2020-02-05">https://levelup.gitconnected.com/angular-internationalization-i18n-with-ngx-translate-8f89005cb337?source=collection_archive---------4-----------------------#2020-02-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/7683249a24502f5477e187be5c8fb933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zgbLjQ9-c_LxDUK4d1zoA.png"/></div></div></figure><p id="cb1e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">构建广泛使用的应用程序的主要问题之一是应对国际化(i18n)。这是一个设计和构建软件应用程序的过程，以便它可以适应各种语言和地区，而无需进行显著的工程更改。正如任何其他软件技术或框架一样，Angular在这个问题上也没有什么不同，每个国际化过程的核心都有一个翻译机制。</p><p id="93d4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">翻译机制不仅负责更改或添加新语言，还需要帮助您轻松开发新功能、修复错误或推出新市场。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/15dbe5ea10c77379de28b15b5d2be39c.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*W9Jg_Ep1-78v6Z7CLPXk_w.png"/></div></figure><p id="6199" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们将学习如何:</p><ul class=""><li id="0669" class="le lf it kd b ke kf ki kj km lg kq lh ku li ky lj lk ll lm bi translated">创建角度应用程序</li><li id="38d2" class="le lf it kd b ke ln ki lo km lp kq lq ku lr ky lj lk ll lm bi translated">安装和配置ngx-translate</li><li id="3a5f" class="le lf it kd b ke ln ki lo km lp kq lq ku lr ky lj lk ll lm bi translated">加载开发转换密钥(dev.json)</li><li id="794d" class="le lf it kd b ke ln ki lo km lp kq lq ku lr ky lj lk ll lm bi translated">添加新语言(英语、法语……)</li><li id="0a24" class="le lf it kd b ke ln ki lo km lp kq lq ku lr ky lj lk ll lm bi translated">改变语言</li></ul><h1 id="f4f4" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">创建角度应用程序</h1><p id="3a2e" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">为了初始化、开发、搭建和维护Angular应用程序，我们将使用Angular CLI。</p><p id="92f2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用npm程序包管理器安装CLI:</p><pre class="la lb lc ld gt mv mw mx my aw mz bi"><span id="4010" class="na lt it mw b gy nb nc l nd ne">npm install -g @angular/cli</span></pre><p id="3bb1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要在开发服务器上创建、构建和服务一个新的基本Angular项目，请转到新工作区的父目录，并使用以下命令:</p><pre class="la lb lc ld gt mv mw mx my aw mz bi"><span id="8113" class="na lt it mw b gy nb nc l nd ne">ng new dynamic-translations<br/>cd dynamic-translations<br/>ng serve</span></pre><p id="e65c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当要求选择选项时，您可以使用默认参数或选择下图所示的选项:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/ae42d65a8ceb2fdfc6efac1609ff57eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gi7ia3Q0RiZrIepoTbDPtg.png"/></div></div></figure><p id="4687" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，您需要修改几个文件。为此，您必须打开<strong class="kd iu"><em class="ng"/></strong>，并用以下内容替换:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f1b0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，打开<strong class="kd iu"><em class="ng">app . component . scss</em></strong>或<strong class="kd iu"><em class="ng">app . component . CSS</em></strong>取决于您之前在创建应用程序时选择的类型，并添加以下代码:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="bda0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，您的<strong class="kd iu"><em class="ng">app . component . ts</em></strong>应该是这样的:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="c1b3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">保存所有更改后，假设您的应用程序正在使用<strong class="kd iu"> ng serve </strong>命令，转到您的浏览器，打开<a class="ae nj" href="http://localhost:4200/" rel="noopener ugc nofollow" target="_blank"> localhost:4200 </a>，您应该会看到这个网页:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/5bc1c96d756162c1adccb9a1c3ab28d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfPsHn8y6Em8owo4zidrDw.png"/></div></div></figure><h1 id="4db3" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">安装和配置ngx-translate</h1><p id="4312" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">为了帮助我们国际化，我们将使用<a class="ae nj" href="http://www.ngx-translate.com/" rel="noopener ugc nofollow" target="_blank"> ngx-translate </a> Angular国际化(i18n)库。</p><p id="4c8c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要安装库，请在您的工作区内运行以下命令:</p><pre class="la lb lc ld gt mv mw mx my aw mz bi"><span id="00d5" class="na lt it mw b gy nb nc l nd ne">npm install @ngx-translate/core --save</span></pre><p id="d86e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后在<strong class="kd iu"><em class="ng">app . module . ts</em></strong>中导入<em class="ng"> TranslateModule </em>:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><blockquote class="nl nm nn"><p id="6161" class="kb kc ng kd b ke kf kg kh ki kj kk kl no kn ko kp np kr ks kt nq kv kw kx ky im bi translated">请注意，对于有多个模块的更复杂的项目，通常有共享模块，我们建议您阅读<a class="ae nj" href="https://github.com/ngx-translate/core#sharedmodule" rel="noopener ugc nofollow" target="_blank">ngx-translate shared module setup</a>的文档。</p></blockquote><h1 id="775d" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">加载开发转换密钥(dev.json)</h1><p id="3194" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">拥有一个开发翻译文件(<strong class="kd iu"> dev.json </strong>)有助于开发新特性、修复错误等。该文件主要在开发应用程序时使用，但也可以用作应用程序的默认后备语言。</p><p id="a131" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在您项目的<em class="ng"> src/assets </em>文件夹中创建另一个文件夹i18n并添加文件<strong class="kd iu"> dev.json </strong>:</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/31932a890cb8949b9f9ea42fd171a89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*LhjHcTqt17d1hVD40DNaew.png"/></div></figure><p id="decf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了确保<strong class="kd iu"> dev.json </strong>在任何其他语言文件之前被加载，我们将使用Angular的<em class="ng">APP _ INITIALIZER</em><em class="ng">injection token</em>提供的函数。例如，当您希望在呈现任何模板之前加载必要的语言文件，或者您希望解析提供应用程序运行环境信息的远程API时，可以使用此标记。</p><p id="5afd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我们的例子中，我们将创建<em class="ng"> appInit() </em>函数，它将在<strong class="kd iu"> dev.json </strong>被加载时进行解析。</p><blockquote class="nl nm nn"><p id="9926" class="kb kc ng kd b ke kf kg kh ki kj kk kl no kn ko kp np kr ks kt nq kv kw kx ky im bi translated">只有在appInit函数内部解析了promise之后，应用程序引导过程才会继续。</p></blockquote><p id="cc08" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<strong class="kd iu"><em class="ng">app . module . ts</em></strong>中创建一个<em class="ng"> initApp </em>函数，并如下例所示“提供”它:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="739a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在dev.json中创建新的键/值对:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f837" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将在HTML中使用翻译管道。用新创建的键替换<strong class="kd iu"><em class="ng">app.component.html</em></strong>中的所有静态值:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="347e" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">添加新语言(英语、法语……)</h1><p id="0c9e" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">我们将使用assets文件夹来提供语言文件(<strong class="kd iu"> en.json </strong>，<strong class="kd iu"> fr.json </strong>)。</p><p id="a0ab" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<em class="ng"> assets/i18n </em>文件夹中新建文件夹<em class="ng"> translations </em>并新建两个名为<strong class="kd iu"> en.json </strong>和<strong class="kd iu"> fr.json </strong>的文件。</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/30f6be85f6be48953426fbb4706ad4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*idFvlXMkvU0t3j_UBHzoBw.png"/></div></figure><p id="4c73" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们现在将更新<em class="ng"> initApp() </em>函数，以支持拉取新创建的语言文件:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1456" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们首先加载我们的<strong class="kd iu"> dev.json </strong>文件和基于本地存储中设置的区域设置值的特定语言文件。</p><p id="1ac5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们正在使用TranslateService的<em class="ng"> setTranslation() </em>方法，因为我们比使用简单的ngx-translate httpLoader有更多的控制。<em class="ng"> setTranslation() </em>中的最后一个参数将新添加的翻译与现有的合并，而不是覆盖它们。</p><h1 id="9129" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">改变语言</h1><p id="9788" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">为了能够改变语言，我们需要添加一个函数来处理它。</p><p id="5228" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<strong class="kd iu"><em class="ng">app . component . ts</em></strong>中创建一个类方法来更改单击按钮时调用的语言:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a8ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，在<strong class="kd iu"><em class="ng">【app.component.html】</em></strong>中，我们将添加<em class="ng">英语</em>和<em class="ng">法语</em>按钮的点击事件以及与之关联的<strong class="kd iu"><em class="ng">app . component . ts</em></strong>中的<em class="ng"> changeLanguage() </em>函数:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="e20a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如您所注意到的，我们使用了一种技术来设置localStorage中的变量并重新加载应用程序。我们在<strong class="kd iu"><em class="ng">app . module . ts</em></strong>中的<em class="ng"> appInit </em>函数会使用这个参数来决定加载哪个语言文件。</p><p id="3855" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有多种技术可以使用，如翻译的实时重新加载，重新加载页面和重定向到不同的网址，如somesite.com/fr/等。改变语言的最好方法可能是使用重新加载应用程序并重新引导的方法。这种方法尤其适用于更复杂的应用程序，在这些应用程序中，需要在引导过程中进行更多配置，例如:</p><ul class=""><li id="328c" class="le lf it kd b ke kf ki kj km lg kq lh ku li ky lj lk ll lm bi translated">从CMS中为新的语言环境提取新的内容</li><li id="8f92" class="le lf it kd b ke ln ki lo km lp kq lq ku lr ky lj lk ll lm bi translated">加载和注册用于以本地格式显示日期、数字和百分比的角度区域设置数据</li><li id="8227" class="le lf it kd b ke ln ki lo km lp kq lq ku lr ky lj lk ll lm bi translated">基于区域设置从API获取新数据</li></ul></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="2383" class="ls lt it bd lu lv oa lx ly lz ob mb mc md oc mf mg mh od mj mk ml oe mn mo mp bi translated">试试看！</h1><p id="787e" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">修改<strong class="kd iu"> fr.json </strong>文件以覆盖某些关键字的翻译，以测试翻译更改是否有效:</p><figure class="la lb lc ld gt ju"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8a71" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">保存文件，改变语言，看看会发生什么！</p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/b7647ac79a75780a359ea8d1bad3fb07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gUSGN-GrPF_X2YzpQDv8tg.gif"/></div></div></figure><blockquote class="nl nm nn"><p id="0996" class="kb kc ng kd b ke kf kg kh ki kj kk kl no kn ko kp np kr ks kt nq kv kw kx ky im bi translated">你可以看到我们没有翻译<strong class="kd iu"> fr.json </strong>中的所有键。如前所述，<strong class="kd iu"> dev.json </strong>是默认的后备，这意味着不在<strong class="kd iu"> fr.json </strong>中的所有键都将从<strong class="kd iu"> dev.json </strong>中使用，如果它们在那里的话。</p></blockquote><h1 id="0390" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">结论</h1><p id="96dd" class="pw-post-body-paragraph kb kc it kd b ke mq kg kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky im bi translated">在本文中，我们讨论了如何在ngx-translate库的帮助下设置和翻译Angular应用程序。</p><p id="354e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下一次，我们将讨论Angular 中的<strong class="kd iu">动态翻译，重点关注<strong class="kd iu">从Angular解耦</strong>语言文件，并使用AWS S3和翻译管理系统(TMS)管理、翻译和发布语言文件到AWS S3。通过这样做，我们将能够改变和发布任何翻译，而无需重建和重新部署Angular应用程序。</strong></p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/ccee4e56b80b92c62daa12c6f3a8a379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_OXan_gDl53rLrqhRig9Og.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk translated">使用AWS S3和TMS进行动态翻译</figcaption></figure><p id="79b0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="ng">样例代码可以在</em><a class="ae nj" href="https://github.com/ivanmiletic/angular-dynamic-translations" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu"><em class="ng">GitHub</em></strong></a><strong class="kd iu"><em class="ng">上找到。</em>T45】</strong></p></div></div>    
</body>
</html>