<html>
<head>
<title>The Easy Guide to Python Command Line Arguments 😎</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python命令行参数简易指南😎</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/the-easy-guide-to-python-command-line-arguments-96b4607baea1?source=collection_archive---------0-----------------------#2019-10-07">https://levelup.gitconnected.com/the-easy-guide-to-python-command-line-arguments-96b4607baea1?source=collection_archive---------0-----------------------#2019-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/82583f0c8734deaa99a926fd8b0d8c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_94IlN-yIBdFvn1Ep_xiQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">见见你的新指挥官😎</figcaption></figure><blockquote class="kf kg kh"><p id="b324" class="ki kj kk kl b km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg im bi translated">想获得灵感？快来加入我的<a class="ae lh" href="https://www.superquotes.co/?utm_source=mediumtech&amp;utm_medium=web&amp;utm_campaign=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="kl iu">超级行情快讯</strong> </a>。😎</p></blockquote><p id="5099" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">Python的优势之一是它具有做任何事情的能力。它的标准库提供了足够的特性来编写大量有用的脚本和工具。如果除此之外还需要什么，更多的功能就在眼前。</p><p id="36c3" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">几乎每一种现代编程语言都有从命令行接受参数的能力。这是一个非常重要的特性，因为它允许来自用户的动态输入，无论他们是否编写了程序。</p><p id="7c24" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">Python自带了几个不同的库<a class="ae lh" href="https://www.tutorialspoint.com/python/python_command_line_arguments.htm" rel="noopener ugc nofollow" target="_blank">允许你的Python代码从命令中获取用户输入，包括<code class="fe ll lm ln lo b">sys.argv</code>、<code class="fe ll lm ln lo b">getopt</code>和<code class="fe ll lm ln lo b">argparse</code>。今天，<code class="fe ll lm ln lo b">argparse</code>是迄今为止最好和最常用的。</a></p><p id="c4e8" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated"><a class="ae lh" href="https://docs.python.org/3.3/library/argparse.html" rel="noopener ugc nofollow" target="_blank"> Python argparse库</a>作为Python 3.2标准库的一部分发布。在那个版本之后，由于它的流行，它被集成到Python 2.7和所有未来的Python版本中，很快成为处理命令行参数的黄金标准。它有几个可取的特性，使得在Python中使用命令行参数非常灵活，对我们的程序非常有用:</p><ul class=""><li id="3758" class="lp lq it kl b km kn kq kr li lr lj ls lk lt lg lu lv lw lx bi translated">您可以为命令行参数设置帮助消息和文档</li><li id="9d1d" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg lu lv lw lx bi translated">以清晰易读的方式设置参数的默认值</li><li id="b5d3" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg lu lv lw lx bi translated">对于特定的命令行参数，有一定数量的选项</li><li id="6984" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg lu lv lw lx bi translated">输入时自动类型转换</li><li id="6185" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg lu lv lw lx bi translated">它支持单个参数有可变数量的参数</li><li id="69bb" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg lu lv lw lx bi translated">它可以自动应用一个动作或功能到你的输入，如你所指定的</li></ul><p id="94ad" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">记住所有这些关键特性后，让我们带您参观一下Python的<code class="fe ll lm ln lo b">argparse</code>库。</p><div class="md me gp gr mf mg"><a href="https://gitconnected.com/resume-builder" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">软件工程师简历生成器| gitconnected</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">免费打造不到5分钟的高质量软件工程简历。同步您的个人资料，我们会处理…</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">gitconnected.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jz mg"/></div></div></a></div><h1 id="5421" class="mv mw it bd mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns bi translated">初始设置</h1><p id="ecec" class="pw-post-body-paragraph ki kj it kl b km nt ko kp kq nu ks kt li nv kw kx lj nw la lb lk nx le lf lg im bi translated">首先，打开一个空白的Python脚本。argparse库是Python内置的，所以我们不需要任何安装过程。下面的代码显示了如何为argparse创建初始设置。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="1e12" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">上述代码有3个重要组成部分:</p><ol class=""><li id="d96c" class="lp lq it kl b km kn kq kr li lr lj ls lk lt lg oe lv lw lx bi translated">导入<code class="fe ll lm ln lo b">argparse</code></li><li id="fbfa" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg oe lv lw lx bi translated">创建参数解析器(带描述)</li><li id="fc4a" class="lp lq it kl b km ly kq lz li ma lj mb lk mc lg oe lv lw lx bi translated">解析命令行参数</li></ol><p id="8491" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">第2步是创建解析器对象，通过它我们可以添加命令行参数以及每个参数的一些选项。步骤3运行一个函数，该函数实际上从命令行中提取用户输入的参数。</p><p id="1a3f" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">美妙之处在于,<code class="fe ll lm ln lo b">argparse</code>将通过这个简单的设置自动使用命令行。试着运行末尾带有<code class="fe ll lm ln lo b">--help</code>的程序，看看<code class="fe ll lm ln lo b">argparse</code>如何打印出我们对argparse教程<em class="kk">的描述！</em></p><p id="102e" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">现在让我们添加一个名为“a”的命令行参数，如下面的代码所示。要将命令行参数传递给Python脚本，通过运行<code class="fe ll lm ln lo b">python3 argparse_2.py --a=5</code>来执行它</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="1075" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">注意我们是如何使用<code class="fe ll lm ln lo b">.add_argument()</code>函数将“a”作为命令行参数传递的。为了访问我们从<code class="fe ll lm ln lo b">a</code>得到的变量，我们使用<code class="fe ll lm ln lo b">args.a</code>。</p><p id="85e5" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">需要注意的一点是，如果我们不在命令行为<code class="fe ll lm ln lo b">a</code>指定一个值，那么<code class="fe ll lm ln lo b">args.a</code>将会是<code class="fe ll lm ln lo b">None</code>。解决这个问题的一个方法是在参数解析器中为<code class="fe ll lm ln lo b">a</code>指定一个默认值，如下所示。请注意，我们这次还添加了一个描述。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="2a8e" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">在这种情况下，如果我们不通过命令行为<code class="fe ll lm ln lo b">a</code>传递一个值，那么它的值将默认为1。通过为<code class="fe ll lm ln lo b">help</code>变量添加一个字符串，我们还能够在应用<code class="fe ll lm ln lo b">--help</code>时为每个变量打印出一个更健壮的描述:</p><pre class="ny nz oa ob gt of lo og oh aw oi bi"><span id="f37c" class="oj mw it lo b gy ok ol l om on">usage: run.py [-h] [--a A]</span><span id="77ac" class="oj mw it lo b gy oo ol l om on">A tutorial of argparse!</span><span id="3ed5" class="oj mw it lo b gy oo ol l om on">optional arguments:<br/>  -h, --help  show this help message and exit<br/>  --a A       This is the 'a' variable</span></pre><h1 id="f5a8" class="mv mw it bd mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns bi translated">命令行参数的常规用法</h1><p id="add5" class="pw-post-body-paragraph ki kj it kl b km nt ko kp kq nu ks kt li nv kw kx lj nw la lb lk nx le lf lg im bi translated">让我们用<code class="fe ll lm ln lo b">argparse</code>来探究一些更有趣的选项。首先，我们可以指定每个变量的类型信息，这样就可以在输入时进行类型转换。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="d81f" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">确保用户总是为特定参数传递值的一个好方法是使用<code class="fe ll lm ln lo b">required</code>关键字。当设置为<code class="fe ll lm ln lo b">True</code>时，强制用户输入该值，否则程序将抛出错误并停止。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="fe69" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">如果我们为参数<code class="fe ll lm ln lo b">--name</code>提供一个值，那么一切都好！如果我们不这样做，我们将得到如下错误消息:</p><pre class="ny nz oa ob gt of lo og oh aw oi bi"><span id="fbc1" class="oj mw it lo b gy ok ol l om on">usage: run.py [-h] [--a A] --name NAME<br/>run.py: error: the following arguments are required: --name</span></pre><p id="94e3" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">我们还可以使用<code class="fe ll lm ln lo b">choices</code>参数来限制特定命令行参数的<em class="kk">可能值</em>。当您的代码中有一组基于特定字符串执行特定操作的if-else语句时，这尤其有用。查看以下代码中的示例。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="e120" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">现在，如果我们输入选择列表中的任何值，代码都会正常运行，并接受我们的<code class="fe ll lm ln lo b">education</code>参数。但是如果你给它一些列表中没有的东西，比如说数字<code class="fe ll lm ln lo b">5</code>，那么你会得到一个类似下面的信息，告诉你从列表中选择一个东西！</p><pre class="ny nz oa ob gt of lo og oh aw oi bi"><span id="01be" class="oj mw it lo b gy ok ol l om on">usage: run.py [-h] [--a A] --education {highschool,college,university,other}<br/>run.py: error: argument --education: invalid choice: '5' (choose from 'highschool', 'college', 'university', 'other')</span></pre><h1 id="ac4f" class="mv mw it bd mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns bi translated">高级用法和技巧</h1><p id="02cb" class="pw-post-body-paragraph ki kj it kl b km nt ko kp kq nu ks kt li nv kw kx lj nw la lb lk nx le lf lg im bi translated">现在是时候用一些高级的argparse变得活泼一点了！</p><p id="b0b8" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated"><code class="fe ll lm ln lo b">action</code>参数允许我们指定一些我们希望参数解析器采取的动作。例如，我们可能想要一个参数，如果它存在或者是一个常量，那么它会自动设置为布尔值<code class="fe ll lm ln lo b">True</code>。这两种情况都显示在下面的示例中。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="b8e0" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">在上面的代码中，我们基本上说的是，如果命令行参数<code class="fe ll lm ln lo b">a</code>存在，那么<code class="fe ll lm ln lo b">a</code>将是<code class="fe ll lm ln lo b">True</code>，否则<code class="fe ll lm ln lo b">a</code>将是<code class="fe ll lm ln lo b">False</code>。类似地，如果命令行参数<code class="fe ll lm ln lo b">b</code>存在，那么它应该被设置为值<code class="fe ll lm ln lo b">10</code>，否则它将是<code class="fe ll lm ln lo b">None</code>，因为没有默认值！</p><p id="ed68" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">我们也可以建立所谓的<em class="kk">互斥组。</em>它定义了一组互斥的解析器命令行参数——也就是说，这些命令行参数不能同时传递。</p><p id="0421" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated">以下面的代码为例。</p><figure class="ny nz oa ob gt ju"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="ad1d" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt li kv kw kx lj kz la lb lk ld le lf lg im bi translated"><code class="fe ll lm ln lo b">argparse</code>参数<code class="fe ll lm ln lo b">a</code>和<code class="fe ll lm ln lo b">b</code>被添加到同一个互斥组中。因此，Python不允许你像这个<code class="fe ll lm ln lo b">python3 argparse_8.py --a --b</code>一样同时发送<code class="fe ll lm ln lo b">a</code>和<code class="fe ll lm ln lo b">b</code>，你必须一次传递一个。当您希望确保用户不会同时传递任何冲突的变量时，这很有用，可以避免任何混乱或错误。</p></div><div class="ab cl op oq hx or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="im in io ip iq"><h1 id="e7ec" class="mv mw it bd mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no pa nq nr ns bi translated">喜欢学习？</h1><p id="f085" class="pw-post-body-paragraph ki kj it kl b km nt ko kp kq nu ks kt li nv kw kx lj nw la lb lk nx le lf lg im bi translated">在推特上关注我，我会在这里发布所有最新最棒的人工智能、技术和科学！也在LinkedIn 上与我联系！</p></div></div>    
</body>
</html>