<html>
<head>
<title>Rust: Result Type Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rust:è§£é‡Šçš„ç»“æœç±»å‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/rust-result-type-explained-c0162b363a5f?source=collection_archive---------2-----------------------#2022-12-26">https://levelup.gitconnected.com/rust-result-type-explained-c0162b363a5f?source=collection_archive---------2-----------------------#2022-12-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a995" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç†è§£Rustç»“æœç±»å‹ï¼Œç”¨äºå¤„ç†è®¡ç®—ä¸­çš„æˆåŠŸå’Œé”™è¯¯æƒ…å†µï¼Œå¹¶ä½¿ç”¨å…¶æ–¹æ³•æ¥å¤„ç†å’Œæ“ä½œå€¼ã€‚</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/27f985263bba3747eabc6a34e4ea75cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uJB2qBaaGR1biF82CBOgw.jpeg"/></div></div></figure><h2 id="3e82" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">å®šä¹‰</h2><p id="39ca" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated"><code class="fe ly lz ma mb b">Result</code>ç±»å‹æ˜¯Rustæ ‡å‡†åº“æä¾›çš„é€šç”¨æšä¸¾ã€‚å®ƒè¡¨ç¤ºè®¡ç®—çš„ç»“æœï¼Œå¯ä»¥æ˜¯æˆåŠŸçš„(<code class="fe ly lz ma mb b">Ok</code>å˜é‡)ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸æˆåŠŸçš„(<code class="fe ly lz ma mb b">Err</code>å˜é‡)ã€‚</p><p id="8fe6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ly lz ma mb b">Result</code>ç±»å‹å®šä¹‰å¦‚ä¸‹:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="1d00" class="mg lb it mb b be mh mi l mj mk">enum Result&lt;T, E&gt; {<br/>    Ok(T),<br/>    Err(E),<br/>}</span></pre><p id="ec5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ly lz ma mb b">T</code>å’Œ<code class="fe ly lz ma mb b">E</code>ç±»å‹å‚æ•°åˆ†åˆ«ä»£è¡¨æˆåŠŸå’Œä¸æˆåŠŸç»“æœçš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code class="fe ly lz ma mb b">Result&lt;T, E&gt;</code>æ¥è¡¨ç¤ºä¸€ä¸ªè®¡ç®—ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸€ä¸ªç±»å‹ä¸º<code class="fe ly lz ma mb b">T</code>çš„å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å›ä¸€ä¸ªç±»å‹ä¸º<code class="fe ly lz ma mb b">E</code>çš„é”™è¯¯ã€‚</p><h2 id="0ca9" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">ç”¨æ³•ç¤ºä¾‹</h2><p id="ea87" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨<code class="fe ly lz ma mb b">Result</code>åŒ…è£…å¯èƒ½å¤±è´¥çš„å‡½æ•°çš„ç»“æœçš„ä¾‹å­:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="5fc7" class="mg lb it mb b be mh mi l mj mk">fn parse_int(s: &amp;str) -&gt; Result&lt;i32, std::num::ParseIntError&gt; {<br/>    s.parse::&lt;i32&gt;().map_err(|e| e.into())<br/>}<br/><br/>fn main() {<br/>    let result = parse_int("5");<br/>    match result {<br/>        Ok(n) =&gt; println!("Parsed integer: {}", n),<br/>        Err(e) =&gt; println!("Error parsing integer: {}", e),<br/>    }<br/>}</span></pre><p id="fedf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code class="fe ly lz ma mb b">parse_int</code>å‡½æ•°è¯•å›¾ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è§£æä¸€ä¸ªæ•´æ•°ã€‚å¦‚æœè§£ææˆåŠŸï¼Œè¯¥å‡½æ•°å°†è¿”å›ä¸€ä¸ªåŒ…å«å·²è§£ææ•´æ•°çš„<code class="fe ly lz ma mb b">Ok</code>å˜é‡ã€‚å¦‚æœè§£æå¤±è´¥ï¼Œå‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«å‘ç”Ÿçš„<code class="fe ly lz ma mb b">ParseIntError</code>çš„<code class="fe ly lz ma mb b">Err</code>å˜é‡ã€‚</p><h2 id="bb3d" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">å¤„ç†ç»“æœ</h2><p id="e17c" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">æ‚¨å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥å¤„ç†<code class="fe ly lz ma mb b">Result</code>å€¼ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª<code class="fe ly lz ma mb b">match</code>è¡¨è¾¾å¼æ¥å¤„ç†<code class="fe ly lz ma mb b">Ok</code>å’Œ<code class="fe ly lz ma mb b">Err</code>å˜é‡ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code class="fe ly lz ma mb b">unwrap</code>æ–¹æ³•ä»<code class="fe ly lz ma mb b">Ok</code>å˜é‡ä¸­æå–å€¼ï¼Œä½†æ˜¯å¦‚æœå€¼æ˜¯<code class="fe ly lz ma mb b">Err</code>å˜é‡ï¼Œè¿™å°†ä¼šå‡ºé”™:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="e76d" class="mg lb it mb b be mh mi l mj mk">let result = parse_int("5");<br/>let n = result.unwrap(); // Will panic if result is an Err variant<br/>println!("Parsed integer: {}", n);</span></pre><p id="d20b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç”±äºå¯èƒ½ä¼šå¼•èµ·ææ…Œï¼Œæ‰€ä»¥éå¸¸ä¸é¼“åŠ±åœ¨ç”Ÿäº§ä»£ç ä¸­ä½¿ç”¨<code class="fe ly lz ma mb b">unwrap()</code>ã€‚</p><p id="586f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¤„ç†<code class="fe ly lz ma mb b">Result</code>å€¼çš„å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨<code class="fe ly lz ma mb b">map</code>å’Œ<code class="fe ly lz ma mb b">map_err</code>æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•å…è®¸æ‚¨é€šè¿‡å¯¹å…¶åº”ç”¨å‡½æ•°æ¥è½¬æ¢<code class="fe ly lz ma mb b">Ok</code>æˆ–<code class="fe ly lz ma mb b">Err</code>å˜é‡å†…éƒ¨çš„å€¼ã€‚</p><p id="a754" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æœ‰ä¸€ä¸ªå‡½æ•°<code class="fe ly lz ma mb b">divide</code>ï¼Œå®ƒå°†ä¸¤ä¸ªæ•´æ•°ç›¸é™¤ï¼Œå¹¶è¿”å›ä¸€ä¸ª<code class="fe ly lz ma mb b">Result</code>æ¥æŒ‡ç¤ºç›¸é™¤æ˜¯å¦æˆåŠŸ:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="4f67" class="mg lb it mb b be mh mi l mj mk">fn divide(x: i32, y: i32) -&gt; Result&lt;i32, DivisionError&gt; {<br/>    if y == 0 {<br/>        return Err(DivisionError::DivideByZero);<br/>    }<br/>    Ok(x / y)<br/>}</span></pre><h2 id="33de" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated"><code class="fe ly lz ma mb b">map()</code>å’Œ<code class="fe ly lz ma mb b">map_err()</code></h2><p id="d23b" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe ly lz ma mb b">map</code>æ–¹æ³•å°†é™¤æ³•çš„æˆåŠŸç»“æœè½¬æ¢æˆä¸åŒçš„ç±»å‹ï¼Œæ¯”å¦‚æµ®ç‚¹æ•°:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="ad8e" class="mg lb it mb b be mh mi l mj mk">let result = divide(10, 2);<br/>let f: Result&lt;f32, DivisionError&gt; = result.map(|n| n as f32);</span></pre><p id="a482" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code class="fe ly lz ma mb b">map_err</code>æ–¹æ³•å°†è¯¯å·®å€¼è½¬æ¢æˆä¸åŒçš„ç±»å‹:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="1cf5" class="mg lb it mb b be mh mi l mj mk">let result = divide(10, 0);<br/>let f: Result&lt;i32, &amp;str&gt; = result.map_err(|e| match e {<br/>    DivisionError::DivideByZero =&gt; "Divide by zero",<br/>    DivisionError::Negative =&gt; "Cannot divide by negative number",<br/>});</span></pre><h2 id="fca5" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">æ›´å¤šç»“æœå¤„ç†</h2><p id="80f3" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">é™¤äº†<code class="fe ly lz ma mb b">map</code>å’Œ<code class="fe ly lz ma mb b">map_err</code>æ–¹æ³•ä¹‹å¤–ï¼Œ<code class="fe ly lz ma mb b">Result</code>ç±»å‹è¿˜æä¾›äº†å…¶ä»–å‡ ç§å¤„ç†å’Œæ“ä½œå€¼çš„æ–¹æ³•ã€‚è¿™é‡Œæœ‰å‡ ä¸ªä¾‹å­:</p><pre class="kp kq kr ks gt mc mb md bn me mf bi"><span id="20e4" class="mg lb it mb b be mh mi l mj mk">fn add_one(x: i32) -&gt; Result&lt;i32, &amp;'static str&gt; {<br/>    if x &gt; 100 {<br/>        return Err("Number too large");<br/>    }<br/>    Ok(x + 1)<br/>}<br/><br/>fn add_two(x: i32) -&gt; Result&lt;i32, &amp;'static str&gt; {<br/>    if x &gt; 50 {<br/>        return Err("Number too large");<br/>    }<br/>    Ok(x + 2)<br/>}<br/><br/>fn add_three(x: i32) -&gt; Result&lt;i32, &amp;'static str&gt; {<br/>    if x &gt; 30 {<br/>        return Err("Number too large");<br/>    }<br/>    Ok(x + 3)<br/>}<br/><br/>// Using and_then<br/>let result = add_one(5).and_then(|x| add_two(x)).and_then(|x| add_three(x));<br/>assert_eq!(result, Ok(11));<br/><br/>// Using or_else<br/>let result = add_one(105).or_else(|e| add_two(5)).or_else(|e| add_three(5));<br/>assert_eq!(result, Ok(7));<br/><br/>// Using unwrap_or<br/>let result = add_one(105).unwrap_or(100);<br/>assert_eq!(result, 100);<br/><br/>// Using unwrap_or_else<br/>let result = add_one(105).unwrap_or_else(|e| -1);<br/>assert_eq!(result, -1);</span></pre><p id="2088" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°æ‰§è¡Œä¸€ä¸ªæ“ä½œå¹¶è¿”å›ä¸€ä¸ª<code class="fe ly lz ma mb b">Result</code>å€¼ã€‚<code class="fe ly lz ma mb b">and_then</code>æ–¹æ³•å…è®¸æˆ‘ä»¬å°†è¿™äº›å‡½æ•°é“¾æ¥åœ¨ä¸€èµ·ï¼Œå¦‚æœæ‰€æœ‰çš„è®¡ç®—éƒ½æˆåŠŸï¼Œå°±è¿”å›æœ€ç»ˆçš„æ“ä½œç»“æœã€‚å¦‚æœä»»ä½•è®¡ç®—å¤±è´¥ï¼Œç«‹å³è¿”å›<code class="fe ly lz ma mb b">Err</code>å˜é‡ã€‚</p><p id="7326" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ly lz ma mb b">or_else</code>æ–¹æ³•ä¸<code class="fe ly lz ma mb b">and_then</code>ç›¸ä¼¼ï¼Œä½†å®ƒåº”ç”¨äº<code class="fe ly lz ma mb b">Err</code>å˜ä½“ï¼Œè€Œä¸æ˜¯<code class="fe ly lz ma mb b">Ok</code>å˜ä½“ã€‚å®ƒå…è®¸æˆ‘ä»¬åœ¨åŸå§‹è®¡ç®—å¤±è´¥æ—¶æŒ‡å®šä¸€ä¸ªåå¤‡è®¡ç®—ã€‚</p><p id="13af" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ly lz ma mb b">unwrap_or</code>æ–¹æ³•è¿”å›<code class="fe ly lz ma mb b">Ok</code>å˜é‡å†…éƒ¨çš„å€¼ï¼Œå¦‚æœ<code class="fe ly lz ma mb b">Result</code>æ˜¯<code class="fe ly lz ma mb b">Err</code>å˜é‡ï¼Œåˆ™è¿”å›é»˜è®¤å€¼ã€‚å½“æ‚¨å¸Œæœ›åœ¨å‡ºç°é”™è¯¯æ—¶æä¾›é»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯æ˜¾å¼å¤„ç†é”™è¯¯æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p><p id="d423" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ly lz ma mb b">unwrap_or_else</code>æ–¹æ³•ç±»ä¼¼äº<code class="fe ly lz ma mb b">unwrap_or</code>ï¼Œä½†æ˜¯å®ƒå°†ä¸€ä¸ªé—­åŒ…ä½œä¸ºå‚æ•°åº”ç”¨äº<code class="fe ly lz ma mb b">Err</code>å˜é‡å†…éƒ¨çš„é”™è¯¯å€¼ï¼Œä»¥äº§ç”Ÿä¸€ä¸ªé»˜è®¤å€¼ã€‚å½“æ‚¨éœ€è¦æ ¹æ®è¯¯å·®å€¼è®¡ç®—é»˜è®¤å€¼æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p><p id="edce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘å¸Œæœ›è¿™äº›ä¾‹å­æœ‰åŠ©äºé˜æ˜Rustä¸­å¤„ç†å’Œæ“ä½œ<code class="fe ly lz ma mb b">Result</code>å€¼çš„ä¸åŒå¯ç”¨æ–¹æ³•çš„ç”¨é€”å’ŒåŠŸèƒ½ã€‚</p><h2 id="1daa" class="la lb it bd lc ld le dn lf lg lh dp li kb lj lk ll kf lm ln lo kj lp lq lr ls bi translated">ä½ æƒ³è”ç³»å—ï¼Ÿ</h2><p id="6350" class="pw-post-body-paragraph jq jr it js b jt lt jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj lx kl km kn im bi translated">å¦‚æœä½ æƒ³è”ç³»æˆ‘ï¼Œè¯·é€šè¿‡LinkedIn è”ç³»æˆ‘ã€‚</p><p id="c598" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦å¤–ï¼Œè¯·éšæ„æŸ¥çœ‹æˆ‘çš„ä¹¦ç±æ¨èğŸ“šã€‚</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><div class="kp kq kr ks gt mt"><a href="https://mr-pascal.medium.com/my-book-recommendations-4b9f73bf961b" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">æˆ‘çš„ä¹¦ç±æ¨è</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°æˆ‘å¯¹æ‰€æœ‰æ—¥å¸¸ç”Ÿæ´»è¯é¢˜çš„ä¹¦ç±æ¨èï¼Œå®ƒä»¬å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ã€‚</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ky mt"/></div></div></a></div><div class="ni nj gp gr nk mt"><a href="https://mr-pascal.medium.com/membership" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥Mediumâ€”Pascal Zwikirsch</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">ä½œä¸ºä¸€ä¸ªåª’ä½“ä¼šå‘˜ï¼Œä½ çš„ä¼šå‘˜è´¹çš„ä¸€éƒ¨åˆ†ä¼šç»™ä½ é˜…è¯»çš„ä½œå®¶ï¼Œä½ å¯ä»¥å®Œå…¨æ¥è§¦åˆ°æ¯ä¸€ä¸ªæ•…äº‹â€¦</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">mr-pascal.medium.com</p></div></div><div class="nc l"><div class="nl l ne nf ng nc nh ky mt"/></div></div></a></div></div></div>    
</body>
</html>