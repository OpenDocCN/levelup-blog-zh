<html>
<head>
<title>Deploy React and AWS Amplify</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署React和AWS Amplify</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploy-react-and-aws-amplify-1db36c625d73?source=collection_archive---------4-----------------------#2021-10-18">https://levelup.gitconnected.com/deploy-react-and-aws-amplify-1db36c625d73?source=collection_archive---------4-----------------------#2021-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="057d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">部署React和AWS Amplify</p><p id="9a27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">文章在此:</em><a class="ae kp" href="https://flatteredwithflutter.com/deploy-react-and-aws-amplify/" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://flattered with flutter . com/deploy-react-and-AWS-amplify/</em></a></p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="kv kw l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">部署React和AWS Amplify</figcaption></figure><p id="51ff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将简要介绍:</p><ol class=""><li id="8da2" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn lg lh li lj bi translated">使用AWS Amplify控制台配置React应用程序</li><li id="121b" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">用yml文件配置React应用程序</li><li id="fa2d" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn lg lh li lj bi translated">管理多种环境</li></ol><blockquote class="lp lq lr"><p id="68ff" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">注意:本文假设读者了解React和AWS</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lv"><img src="../Images/b57f9f9ccd77ff9e165fbd67c03f154a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMCYe8anKbk3NHXKCVQDbQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">部署React和AWS Amplify</figcaption></figure><p id="b708" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">点击此处观看演示</p><p id="8fcd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">网址:</em></strong><a class="ae kp" href="https://master.d19tgz4vpyd5.amplifyapp.com/" rel="noopener ugc nofollow" target="_blank"><strong class="js iu"><em class="ko">https://master.d19tgz4vpyd5.amplifyapp.com/</em></strong></a></p><h1 id="e867" class="mc md it bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">使用AWS Amplify控制台配置React应用程序</h1><p id="5645" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">根据<a class="ae kp" href="https://docs.aws.amazon.com/amplify/latest/userguide/getting-started.html" rel="noopener ugc nofollow" target="_blank">文档</a>，AWS Amplify是<strong class="js iu"><em class="ko"/></strong><em class="ko">构建可扩展的移动和网络应用的最快和最简单的方法</em></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nf"><img src="../Images/2b18b55fee62556339ba949d996ae433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SRxqYBm7xD0PELku.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">AWS Amplify简介</figcaption></figure><blockquote class="lp lq lr"><p id="2819" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">从这里开始<a class="ae kp" href="https://console.aws.amazon.com/amplify/home" rel="noopener ugc nofollow" target="_blank">吧</a></p></blockquote><ul class=""><li id="003d" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">如果您是从<strong class="js iu">所有应用</strong>页面开始，选择右上角的<strong class="js iu">新建应用</strong>、<strong class="js iu">主机web应用</strong>。</li><li id="9c98" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">连接您的GitHub、Bitbucket、GitLab或AWS CodeCommit存储库。我们选择Github。</li><li id="97b2" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">连接存储库服务提供者后，选择一个存储库。</li></ul><blockquote class="lp lq lr"><p id="6550" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">注意:如果您的存储库属于某个组织，您将看不到这些存储库，除非该组织的所有者批准了来自AWS Amplify的电子邮件请求</p></blockquote><ul class=""><li id="f976" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">现在，您应该能够看到您的存储库，单击您想要的存储库，选择相应的分支来构建和部署。</li><li id="ae55" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">选择<strong class="js iu">保存并部署</strong>以部署您的web应用程序</li><li id="ae71" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">通过选择分支标题上的进度指示器来访问构建日志屏幕。构建有以下几个阶段:</li></ul><blockquote class="lp lq lr"><p id="5e27" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated"><strong class="js iu">供应- &gt;构建- &gt;部署- &gt;验证</strong></p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nh"><img src="../Images/48e561b91494e0f8a940652e395f75ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4CiVq9XjCwByXAma63jFg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">AWS放大器构建步骤</figcaption></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="865c" class="mc md it bd me mf np mh mi mj nq ml mm mn nr mp mq mr ns mt mu mv nt mx my mz bi translated">使用AWS和yml文件配置React应用程序</h1><p id="6b5c" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">作为一名程序员，您希望控制部署，但不是通过某个控制台(在这种情况下是AWS Amplify控制台)。</p><p id="78b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将通过yml文件配置React部署，该文件由AWS Amplify内部使用。</p><ul class=""><li id="954a" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">前往AWS Amplify控制台并选择您的应用程序。</li><li id="5f5b" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">在左侧，点击<strong class="js iu">构建设置</strong></li><li id="d3fd" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">在应用构建规范中，点击<strong class="js iu">下载。</strong>这应该会下载默认的<strong class="js iu"> amplify.yml </strong>文件</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nu"><img src="../Images/d02b5b18a0841d3f7659db568c17f4ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fST-UCEgyfkRnDcp0TjVBA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">放大yml文件</figcaption></figure><ul class=""><li id="5cb3" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">将这个<a class="ae kp" href="https://github.com/AseemWangoo/expriments_with_react/blob/master/amplify.yml" rel="noopener ugc nofollow" target="_blank">文件</a>添加到您的库的根目录</li></ul><pre class="kq kr ks kt gt nv nw nx ny aw nz bi"><span id="301d" class="oa md it nw b gy ob oc l od oe">version: 1<br/>frontend:<br/>  phases:<br/>    preBuild:<br/>      commands:<br/>        - yarn install<br/>    build:<br/>      commands:<br/>        - yarn run build<br/>  artifacts:<br/>    baseDirectory: build<br/>    files:<br/>      - '**/*'<br/>  cache:<br/>    paths:<br/>      - node_modules/**/*</span></pre></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="1414" class="mc md it bd me mf np mh mi mj nq ml mm mn nr mp mq mr ns mt mu mv nt mx my mz bi translated">管理多种环境</h1><p id="800a" class="pw-post-body-paragraph jq jr it js b jt na jv jw jx nb jz ka kb nc kd ke kf nd kh ki kj ne kl km kn im bi translated">几乎每个react应用程序都有不同的环境，您希望以编程方式部署或管理多个环境。</p><p id="5f17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将配置React应用程序，在AWS Amplify中部署基于环境的配置。</p><ul class=""><li id="21d7" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">为了配置不同的环境，我们使用了<a class="ae kp" href="https://www.npmjs.com/package/env-cmd" rel="noopener ugc nofollow" target="_blank"> env-cmd </a></li><li id="6781" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">使用以下命令安装env-cmd</li></ul><pre class="kq kr ks kt gt nv nw nx ny aw nz bi"><span id="9fc8" class="oa md it nw b gy ob oc l od oe">npm i env-cmd</span></pre><ul class=""><li id="d24b" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">我们有一个单独的生产环境文件<code class="fe of og oh nw b"><a class="ae kp" href="https://github.com/AseemWangoo/expriments_with_react/blob/master/.env.production" rel="noopener ugc nofollow" target="_blank">.env.production</a></code>(可以是任何名称)</li><li id="51e8" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">转到您的<a class="ae kp" href="https://github.com/AseemWangoo/expriments_with_react/blob/master/package.json" rel="noopener ugc nofollow" target="_blank"> package.json </a>并添加一个新脚本</li></ul><pre class="kq kr ks kt gt nv nw nx ny aw nz bi"><span id="91f3" class="oa md it nw b gy ob oc l od oe">"build:prod": "env-cmd -f .env.production react-scripts build"</span></pre><p id="ed27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，当您运行命令<code class="fe of og oh nw b">npm run build:prod</code>时，这将从文件<code class="fe of og oh nw b">.env.production</code>中获取配置</p><ul class=""><li id="55b4" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">通过运行<code class="fe of og oh nw b">npm run build:prod</code>进行本地验证，然后使用<code class="fe of og oh nw b">serve -s build</code>在本地运行生产版本。</li></ul><p id="9730" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果一切正常，我们<strong class="js iu">继续放大部署</strong></p><ul class=""><li id="9032" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">进入AWS Amplify控制台内的应用程序，在左侧点击<strong class="js iu">环境变量</strong></li><li id="e296" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">输入一个名为<strong class="js iu"> BUILD_ENV </strong>的变量，并给出值<strong class="js iu"> prod </strong></li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi oi"><img src="../Images/ae5769a08b6cf89047840872545f9048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xj7cFBfI6Wnk7lVuCCGjPQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">构建环境</figcaption></figure><ul class=""><li id="f2e8" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">在你的<code class="fe of og oh nw b">amplify.yml</code>中编辑<code class="fe of og oh nw b">preBuild</code>阶段来安装<code class="fe of og oh nw b">env-cmd</code></li><li id="9ddb" class="lb lc it js b jt lk jx ll kb lm kf ln kj lo kn ng lh li lj bi translated">现在，编辑构建阶段并将命令改为<code class="fe of og oh nw b">npm run build:$BUILD_ENV</code></li></ul><pre class="kq kr ks kt gt nv nw nx ny aw nz bi"><span id="6f67" class="oa md it nw b gy ob oc l od oe">version: 1<br/>frontend:<br/>  phases:<br/>    preBuild:<br/>      commands:<br/>        - npm install env-cmd<br/>        - npm ci<br/>    build:<br/>      commands:<br/>        - echo "I am running 🏃 on $BUILD_ENV" <br/>        - npm run build:$BUILD_ENV<br/>  artifacts:<br/>    baseDirectory: build<br/>    files:<br/>      - '**/*'<br/>  cache:<br/>    paths:<br/>      - node_modules/**/*</span></pre><blockquote class="lp lq lr"><p id="5bbb" class="jq jr ko js b jt ju jv jw jx jy jz ka ls kc kd ke lt kg kh ki lu kk kl km kn im bi translated">基本上，它从应用程序的环境变量(BUILD_ENV)中获取变量，并用值(prod)替换命令。</p></blockquote><p id="eb9a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，在构建的时候，您的命令变成了<code class="fe of og oh nw b">npm run build:prod</code>,这与您在本地构建时使用的命令相同。</p><ul class=""><li id="664a" class="lb lc it js b jt ju jx jy kb ld kf le kj lf kn ng lh li lj bi translated">您可以更进一步，根据每个分支创建不同的应用程序，并根据您的需求使用BUILD_ENV变量。</li></ul><pre class="kq kr ks kt gt nv nw nx ny aw nz bi"><span id="94a1" class="oa md it nw b gy ob oc l od oe"># Examples<br/>Create app with qa branch and set the BUILD_ENV as qa</span></pre></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="288d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他文章:</p><div class="oj ok gp gr ol om"><a rel="noopener  ugc nofollow" target="_blank" href="/show-push-notifications-in-react-449949e98e01"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">在React中显示推送通知</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">在React中显示推送通知</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">在Reactlevelup.gitconnected.com显示推送通知</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ma om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener  ugc nofollow" target="_blank" href="/fade-in-out-text-in-react-fa8fc7a2a0b1"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">React中的淡入淡出文本</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">如何在react中淡入淡出文本</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa ma om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener  ugc nofollow" target="_blank" href="/deploy-lambda-using-serverless-a44a66f3d603"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">使用无服务器部署lambda</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">使用无服务器部署lambda</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">使用serverlesslevelup.gitconnected.com部署lambda</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa ma om"/></div></div></a></div><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/11d43fbfb6f2fcd213b5757726e55a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*VMCjPYA5Dh1Xbv5p.gif"/></div></figure><pre class="kq kr ks kt gt nv nw nx ny aw nz bi"><span id="d294" class="oa md it nw b gy ob oc l od oe"><a class="ae kp" href="https://github.com/AseemWangoo/expriments_with_react" rel="noopener ugc nofollow" target="_blank">Source Code</a></span></pre></div></div>    
</body>
</html>