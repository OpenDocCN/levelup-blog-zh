<html>
<head>
<title>Lessons I’ve learned after a year of using TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TypeScript一年后我学到的经验</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/lessons-ive-learned-after-a-year-of-using-typescript-1be2853ce6cf?source=collection_archive---------12-----------------------#2020-03-26">https://levelup.gitconnected.com/lessons-ive-learned-after-a-year-of-using-typescript-1be2853ce6cf?source=collection_archive---------12-----------------------#2020-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1d33b0210061524df3a84a2ef18a806d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KLZsBlWktl5MJzw6.png"/></div></div></figure><p id="808d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如题所示，我使用TypeScript大约一年了，我想分享一下我在这一过程中所学到的一些经验。与生活中的大多数事情一样，打字稿需要时间、耐心和经验来真正理解它有多神奇。我仍在不断学习关于TypeScript编译器如何工作的新知识，以及在我的代码中使用类型的更好方法。这些是我希望在使用TypeScript的早期就告诉自己的事情，一旦我熟悉了语法。</p><p id="6b78" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我是一名React开发人员，所以我提到的许多趣闻都是在React上下文中讲述的，但是TypeScript确实适用于所有JavaScript代码！</p><h1 id="cbdb" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">信任编译器</h1><p id="584d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">当我第一次开始使用TypeScript时，我非常勤奋，坦率地说，我对粒度类型化热情过度。我没有让编译器做任何事情——如果定义了变量或函数，我会显式地输入它的每个方面。当然，有人可能会说这是让你熟悉TS的一个好方法，特别是它会承认什么，会对什么嗤之以鼻。我回头看我在6个月前写的<code class="fe lz ma mb mc b">.ts</code>或<code class="fe lz ma mb mc b">.tsx</code>文件，坦率地说，我很害怕，因为我相信我们大多数人对过去的代码都是这样。</p><p id="08c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我举一个具体的例子，说明为什么信任编译器可以减少您必须编写的代码，同时还能给您同等程度的类型安全性。假设您有一个注册表单，用户可以在其中注册您的服务。他们只需输入一封电子邮件和一个确认密码。下面是我刚开始使用TypeScript时会做的事情:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="58da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">事情是这样的，尽管所有的输入看起来~ <em class="mj">很酷</em> ~，但它并没有给我们作为开发者带来任何好处。这是因为TypeScript能够进行<a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/type-inference.html" rel="noopener ugc nofollow" target="_blank">类型推断</a>，这意味着您的显式类型在很大程度上是没有意义的。现在肯定会有TS编译器的推理不尽人意的情况，我只是鼓励你在那之前尽你所能地利用它</p><p id="5ce2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以在不使用<a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/interfaces.html" rel="noopener ugc nofollow" target="_blank">接口</a>的情况下实现与上述完全相同的类型安全:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="9f98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是请注意，React组件道具的情况并非如此。Props应该总是显式类型化的，因为它们是在消费组件的范围之外定义的，因此TS不能对它们进行任何类型推断。</p><h1 id="adcb" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">在考虑他人的情况下定义类型</h1><p id="52fb" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">你使用TypeScript越多，你越会意识到它真的不适合你。我的意思是，你在API或应用程序的不同部分添加类型定义所花费的时间不一定只是为了你的利益。对给定代码库了解不多的其他开发人员将从支持类型定义中受益匪浅。如果一个更熟悉静态类型语言的后端开发人员(不是Node.js dev)正在研究JavaScript代码库，情况尤其如此。作为一种天生的动态语言，JavaScript可能会让那些不熟悉它的人感到厌烦，仅仅因为它缺少使用TypeScript时获得的类型。</p><h1 id="ba2d" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">对你的类型应用干燥的原则</h1><p id="5579" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">如果你不熟悉<strong class="ka ir">干</strong>原理，它代表<strong class="ka ir">D</strong>on<strong class="ka ir">R</strong>EPE at<strong class="ka ir">Y</strong>yourself。这是一个应用于编写代码的概念，它反对在多个地方复制逻辑。当定义你的类型/接口时，应该应用同样的思路——即使只是一两个属性的问题。由于它的<a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/utility-types.html" rel="noopener ugc nofollow" target="_blank">实用程序类型</a>，TypeScript是一个特别灵活的类型系统。我认为，这些是经验丰富的TypeScript开发人员工具箱中的基本工具。</p><p id="213d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看一些例子。</p><p id="038d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设您有一个<code class="fe lz ma mb mc b">User</code>接口，在创建新用户时需要它的所有属性，但是在更新用户的情况下，这些属性中的任何一个都可以被传递——换句话说，没有一个属性是明确需要的。在一个没有<code class="fe lz ma mb mc b">Partial</code>实用程序类型的世界中，这将看起来像这样:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="f486" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<code class="fe lz ma mb mc b">Partial</code>类型也可以达到同样的效果，但是代码要干燥得多。该实用程序类型只是使给定类型的每个属性都是可选的:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="d5b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我更经常使用的另外两个实用程序类型是<a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/utility-types.html#picktk" rel="noopener ugc nofollow" target="_blank">选择</a>和<a class="ae mk" href="https://www.typescriptlang.org/docs/handbook/utility-types.html#omittk" rel="noopener ugc nofollow" target="_blank">省略</a>助手。这些允许您利用已经定义的类型/接口，但是对某些属性更具选择性。例如，假设我有一个类似上面定义的<code class="fe lz ma mb mc b">User</code>接口，但是这个新的<code class="fe lz ma mb mc b">User</code>有一些我的客户端应用程序并不真正关心的元数据:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="e0e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我有一个与用户相关的表单，我可以指向同一个<code class="fe lz ma mb mc b">User</code>界面，同时“忽略”我不关心的属性:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="464d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我将拥有与最初的<code class="fe lz ma mb mc b">User</code>接口相同的类型安全，“省略”了<code class="fe lz ma mb mc b">id</code>和<code class="fe lz ma mb mc b">updated_at</code>属性，这些属性对于前端开发来说毫无用处。当原始界面更新时，我的表单类型也随之更新。使用<code class="fe lz ma mb mc b">Pick</code>可以实现相反的效果，您可以选择希望给定变量遵循的属性子集。</p><h1 id="ecaa" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">打字的成本效益分析</h1><p id="b788" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">有很多次，我试图调试一个“类型”场景，但似乎无法通过。如果你去过那里，你就知道我指的是什么。作为一名开发人员，你<strong class="ka ir">知道</strong>至少可以说应用程序的这个特定部分的类型安全是很好的，但是为什么你的类型声明不起作用却难倒了你，你拒绝向类型怪物屈服！</p><p id="bd4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">相信我，我去过很多次了。然而，我在TypeScript上花的时间越多，我就越愿意放弃这些战斗。毕竟，打字是为了团队的利益，如果编译器拒绝你的类型注释，你的代码可能有问题。我宁愿屈服于编译器，也不愿在我的代码中加入一个<code class="fe lz ma mb mc b">@ts-ignore</code>。这只是我的想法！</p><p id="93ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望这些例子可以帮助其他人在有时相当模糊的打字稿池中找到他们的路！</p></div></div>    
</body>
</html>