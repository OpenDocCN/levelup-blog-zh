<html>
<head>
<title>How to Calculate Cash Flow and Visualize it in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何计算现金流并在Python中可视化</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-calculate-cash-flow-and-visualize-it-in-python-9305c4cb190f?source=collection_archive---------3-----------------------#2022-05-14">https://levelup.gitconnected.com/how-to-calculate-cash-flow-and-visualize-it-in-python-9305c4cb190f?source=collection_archive---------3-----------------------#2022-05-14</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5121" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">计算房地产现金流的Python教程</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj kj"><img src="../Images/0e8244726ada68eb91858e74dafd5c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/0*PLqFVfXc4oJRI_q8.png"/></div><figcaption class="kr ks gk gi gj kt ku bd b be z dk translated"><a class="ae kv" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fzaitoon.com.pk%2Fwhy-to-invest-in-property%2F&amp;psig=AOvVaw0_iTaOqIVY-7LZGc90WQy6&amp;ust=1649283625952000&amp;source=images&amp;cd=vfe&amp;ved=0CAoQjRxqFwoTCPi567v6_fYCFQAAAAAdAAAAABAw" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="63a3" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di"> H </span>如何计算一个楼盘是否会成功？房地产投资者用来判断投资是否合理的最重要指标之一是现金流<strong class="ky iv"/>。本文将讨论如何计算现金流，以及如何在Python中将其可视化。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj mb"><img src="../Images/3b56b30f310c7f7407e9f98850db86a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q-XXAbvf3gqU9Wzg.jpg"/></div></div></figure><h2 id="f2c6" class="mg mh iu bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">什么是现金流？</h2><blockquote class="mz na nb"><p id="d2d9" class="kw kx nc ky b kz la jv lb lc ld jy le nd lg lh li ne lk ll lm nf lo lp lq lr in bi translated"><a class="ae kv" href="https://learn.roofstock.com/blog/real-estate-cash-flow" rel="noopener ugc nofollow" target="_blank">现金流</a>描述了资金在租赁物业中的流动方式，类似于水流过瀑布的方式。— <a class="ae kv" href="https://learn.roofstock.com/blog/rental-property-cash-flow-analysis" rel="noopener ugc nofollow" target="_blank">车顶支架</a></p></blockquote><p id="cdcd" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">简单来说现金流就是<strong class="ky iv">月收入——月支出</strong>。剩余金额是你每月获利的数目。</p><h2 id="17e0" class="mg mh iu bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">为什么我们想要正的现金流？</h2><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj ng"><img src="../Images/afa65c750d8ee08aae7134ab4ce2670e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C0Qq6RJCOoHPfiEU.jpg"/></div></div></figure><p id="a944" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">为了让你的投资产生效益，它需要<strong class="ky iv">为你产生回报</strong>。每月现金流通过创造一个被动收入流来做到这一点。</p><p id="eacf" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">以下是现金流的好处:</p><ul class=""><li id="e03c" class="nh ni iu ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated"><strong class="ky iv"> <em class="nc">现金流创造更多机会。</em> </strong>将一项投资的利润再投资到另一项投资中是成倍增加你财务状况的好方法。</li><li id="e265" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky iv"> <em class="nc">现金流创造安全</em>。你每月的额外收入可以帮助你建立一个更大的储蓄储备，以保护你不被意外的生活开支(如医疗账单、汽车保养等)所困扰。).</strong></li></ul><h2 id="95ca" class="mg mh iu bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">如何计算现金流？</h2><p id="6bb1" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">让我们从等式开始:</p><p id="a004" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated"><strong class="ky iv">现金流</strong> <strong class="ky iv"> =总租金收入——所有费用和现金储备</strong></p><p id="ca8f" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">这里有一个现实生活中的例子，如何计算我在佛罗里达州河景市拥有的一处房产的每月现金流。</p><p id="7336" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated"><strong class="ky iv">月收入:</strong></p><ul class=""><li id="b284" class="nh ni iu ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">租金:2300美元</li><li id="d5ce" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">宠物费:50美元</li><li id="aa18" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">月总收入:2350美元</li></ul><p id="2275" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated"><strong class="ky iv">月费用:</strong></p><ul class=""><li id="5491" class="nh ni iu ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">抵押贷款:1120美元(本金和利息)</li><li id="e7fb" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">财产税:430美元</li><li id="accc" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">保险:75美元</li><li id="a4b3" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">采购经理人指数:100美元</li><li id="5573" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">HOA:100美元</li><li id="2778" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">物业管理:0美元</li><li id="8253" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">空置储备:115美元(我租金收入的5%，可根据风险承受能力调整)</li><li id="a0fc" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">维修储备金:115美元(我租金收入的5%，可根据风险承受能力调整)</li><li id="7e99" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">每月总支出:2055美元</li></ul><p id="158b" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated"><strong class="ky iv">月现金流= 2，350美元—2，055美元= 295美元</strong></p><p id="24d2" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">我的目标是每月300美元的现金流。目标月现金流没有神奇的数字。然而，我想说的是，每月至少要有100美元的现金流。</p><p id="15d7" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">好了，我们来回顾一下如何使用Python<em class="nc">可视化</em>现金流！</p></div><div class="ab cl oa ob hy oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="in io ip iq ir"><h2 id="c992" class="mg mh iu bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">先决条件</h2><p id="b085" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">你自己的Python环境或者谷歌账户。</p><h2 id="5342" class="mg mh iu bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">支持视频</h2><p id="1f5b" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">请跟随我的Python教程来计算和可视化现金流。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="oh oi l"/></div><figcaption class="kr ks gk gi gj kt ku bd b be z dk translated"><a class="ae kv" href="https://www.youtube.com/channel/UCKkUCaKNlfYBJAm-OGBRyYw" rel="noopener ugc nofollow" target="_blank"> YouTube AnalyticsAriel </a></figcaption></figure><h1 id="78f9" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">Python教程</h1><p id="59d6" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">如果你没有现有的Python环境，那么我强烈建议首先用<strong class="ky iv">克隆笔记本</strong>(在文章的底部)。</p><p id="2066" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">这将允许您在Google Colab中运行Python代码(免费！).它是一个基于云的环境，让您无需在本地安装Python就可以运行代码。</p><h1 id="f0a3" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">一.安装包</h1><p id="2b7a" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">第一步是安装必要的软件包:</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="7694" class="mg mh iu ov b gz oz pa l pb pc">!pip install plotly <strong class="ov iv">-</strong>q</span></pre><ul class=""><li id="2a4f" class="nh ni iu ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated"><strong class="ky iv"> plotly </strong>允许我们交互图表——参见基本图表<a class="ae kv" href="https://plotly.com/python/basic-charts/" rel="noopener ugc nofollow" target="_blank">此处</a>。</li></ul><h1 id="2054" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">二。导入包</h1><p id="fe1e" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">接下来，导入必要的包。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="d1ca" class="mg mh iu ov b gz oz pa l pb pc"><strong class="ov iv">import</strong> plotly.graph_objects <strong class="ov iv">as</strong> go<br/><strong class="ov iv">import</strong> pandas <strong class="ov iv">as</strong> pd</span></pre><h1 id="22d9" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">三。数据加载</h1><p id="15ad" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">让我们读入样本属性的数据。这些数据是CSV格式的，在Github上公开发布。</p><p id="e5e1" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">我们可以用熊猫读入CSV文件。这将把我们的CSV文件转换成dataframe(包含行和列的表格)。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="e72c" class="mg mh iu ov b gz oz pa l pb pc">df <strong class="ov iv">= </strong>pd<strong class="ov iv">.</strong>read_csv(<br/>'https://raw.githubusercontent.com/analyticsariel/public-data/main/cash_flow_data.csv')<br/>df<strong class="ov iv">.</strong>head()</span></pre><p id="8489" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">该数据集包含月收入和支出的信息。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj pd"><img src="../Images/f9368e6ec8c713c133696904d41a145b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9m8RHJqIxkLtIwV3WDXXg.png"/></div></div><figcaption class="kr ks gk gi gj kt ku bd b be z dk translated"><a class="ae kv" href="https://github.com/analyticsariel/projects/blob/master/REICalculations_CashFlow.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a></figcaption></figure><p id="5492" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">接下来，我们将每个收入和支出值赋给一个变量。我们选择数据帧中的列并定位第一个值(第一行)。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="0738" class="mg mh iu ov b gz oz pa l pb pc"><em class="nc"># assign variables to values in table</em><br/>property_address <strong class="ov iv">=</strong> df['property_address']<strong class="ov iv">.</strong>iloc[0]<br/>rent <strong class="ov iv">=</strong> df['rent']<strong class="ov iv">.</strong>iloc[0]<br/>additional_income <strong class="ov iv">=</strong> df['additional_income']<strong class="ov iv">.</strong>iloc[0]<br/>principal_and_interest <strong class="ov iv">=</strong> df['principal_and_interest']<strong class="ov iv">.</strong>iloc[0]<br/>taxes <strong class="ov iv">=</strong> df['taxes']<strong class="ov iv">.</strong>iloc[0]<br/>insurance <strong class="ov iv">=</strong> df['insurance']<strong class="ov iv">.</strong>iloc[0]<br/>property_management <strong class="ov iv">=</strong> df['property_management']<strong class="ov iv">.</strong>iloc[0]<br/>cap_ex <strong class="ov iv">=</strong> df['cap_ex']<strong class="ov iv">.</strong>iloc[0]<br/>vacancy <strong class="ov iv">=</strong> df['vacancy']<strong class="ov iv">.</strong>iloc[0]<br/>utilities <strong class="ov iv">=</strong> df['utilities']<strong class="ov iv">.</strong>iloc[0]<br/>additional_expenses <strong class="ov iv">=</strong> df['additional_expenses']<strong class="ov iv">.</strong>iloc[0]</span></pre><p id="dee2" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">我们可以创建<strong class="ky iv">总</strong>收入和支出变量。比如<strong class="ky iv">总收入</strong>就是房租+附加_收入。</p><p id="3c6a" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">这些新变量将允许我们查看支出和收入的<em class="nc">流程</em>。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="22ff" class="mg mh iu ov b gz oz pa l pb pc"><em class="nc"># summary variables</em><br/>total_income <strong class="ov iv">=</strong> rent <strong class="ov iv">+</strong> additional_income<br/>fixed_expense <strong class="ov iv">=</strong> principal_and_interest <strong class="ov iv">+</strong> taxes <strong class="ov iv">+</strong> insurance<br/>variable_expense <strong class="ov iv">=</strong> property_management <strong class="ov iv">+</strong> cap_ex <strong class="ov iv">+</strong> vacancy <strong class="ov iv">+</strong> utilities <strong class="ov iv">+</strong> additional_expenses<br/>total_expense <strong class="ov iv">=</strong> fixed_expense <strong class="ov iv">+</strong> variable_expense</span></pre><h1 id="ff4a" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">四。转换</h1><p id="ae51" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">我们想要创建一个Sankey图来可视化我们的收入和支出，类似于下面的<a class="ae kv" href="https://plotly.com/python/sankey-diagram/" rel="noopener ugc nofollow" target="_blank"> Plotly示例</a>:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj pe"><img src="../Images/9ac3e93625f17d160e9d610ea431ed40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4MVPqd8diYGA7NXDth3Ixw.png"/></div></div><figcaption class="kr ks gk gi gj kt ku bd b be z dk translated"><a class="ae kv" href="https://plotly.com/python/sankey-diagram/" rel="noopener ugc nofollow" target="_blank">阴谋地</a></figcaption></figure><p id="da35" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">相对于其他<a class="ae kv" href="https://plotly.com/python/plotly-express/" rel="noopener ugc nofollow" target="_blank">图形表达</a>可视化而言，桑基图是一种复杂程度更高的图表。</p><blockquote class="mz na nb"><p id="56f1" class="kw kx nc ky b kz la jv lb lc ld jy le nd lg lh li ne lk ll lm nf lo lp lq lr in bi translated">桑基图通过定义<a class="ae kv" href="https://plotly.com/python/reference/sankey/#sankey-link-source" rel="noopener ugc nofollow" target="_blank"> source </a>来表示源节点，定义<a class="ae kv" href="https://plotly.com/python/reference/sankey/#sankey-link-target" rel="noopener ugc nofollow" target="_blank"> target </a>来表示目标节点，定义<a class="ae kv" href="https://plotly.com/python/reference/sankey/#sankey-link-value" rel="noopener ugc nofollow" target="_blank">值</a>来设置流量，定义<a class="ae kv" href="https://plotly.com/python/reference/sankey/#sankey-node-label" rel="noopener ugc nofollow" target="_blank">标签</a>来显示节点名称。— <a class="ae kv" href="https://plotly.com/python/sankey-diagram/" rel="noopener ugc nofollow" target="_blank"> Plotly Express Sankey描述</a></p></blockquote><p id="0dd3" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">我们需要三个组件来创建我们的桑基图-</p><ol class=""><li id="dac2" class="nh ni iu ky b kz la lc ld lf nj lj nk ln nl lr pf nn no np bi translated"><strong class="ky iv">节点</strong> —起点(即收入)</li><li id="3399" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr pf nn no np bi translated"><strong class="ky iv">目标</strong> —结束点，节点的子组件(即租金)</li><li id="5580" class="nh ni iu ky b kz nq lc nr lf ns lj nt ln nu lr pf nn no np bi translated"><strong class="ky iv">值</strong> —流量之间的值(即2600美元)</li></ol><p id="af01" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">让我们从创建所有标签的列表开始。然后，我们将把每个标签分配给一个整数，我们将在流程中引用它。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="7783" class="mg mh iu ov b gz oz pa l pb pc"><em class="nc"># create list of labels for the chart</em><br/>label_list <strong class="ov iv">=</strong> [ "Income",<br/>               "Rent", <br/>               "Additional Income",<br/>               "Expense", <br/>               "Fixed",<br/>               "Variable",<br/>               "Principal &amp; Interest",<br/>               "Taxes",<br/>               "Insurance", <br/>               "Property Management", <br/>               "CapEx",<br/>               "Vacancy",<br/>               "Utilities",<br/>               "Additional Expenses",<br/>               ]<br/><em class="nc"># append an index number to each element in the list</em><br/>label_dict <strong class="ov iv">=</strong> {}<br/><strong class="ov iv">for</strong> i <strong class="ov iv">in</strong> range(len(label_list)):<br/>  label_dict[label_list[i]] <strong class="ov iv">=</strong> i<br/>label_dict</span></pre><p id="f63b" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">输出:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj pg"><img src="../Images/b1a60378538a1f8c93160fe328058c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*6imdZqFRuYZ41cJ_OxEVnQ.png"/></div></figure><p id="3b08" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">接下来，我们创建一个<em class="nc">嵌套列表</em>来定义我们的节点- &gt;目标- &gt;价值流。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="5459" class="mg mh iu ov b gz oz pa l pb pc"><em class="nc"># create sub list for each node -&gt; target -&gt; value</em><br/>sankey_list <strong class="ov iv">=</strong> [<br/>  <em class="nc"># income</em><br/>  ["Income", "Rent", rent], <br/>  ["Income", "Additional Income", additional_income], <br/>  <em class="nc"># expenses [fixed]</em><br/>  ["Expense", "Fixed", fixed_expense], <br/>  ["Fixed", "Principal &amp; Interest", principal_and_interest], <br/>  ["Fixed", "Taxes", taxes], <br/>  ["Fixed", "Insurance", insurance],<br/>  <em class="nc"># expenses [variable]</em><br/>  ["Expense", "Variable", variable_expense], <br/>  ["Variable", "Property Management", property_management], <br/>  ["Variable", "CapEx", cap_ex], <br/>  ["Variable", "Vacancy", vacancy], <br/>  ["Variable", "Utilities", utilities], <br/>  ["Variable", "Additional Expenses", additional_expenses],<br/>]</span></pre><p id="d061" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">为了绘制我们的数据，我们需要传递三个列表。</p><p id="f3de" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">对于<em class="nc">源</em>和<em class="nc">目标</em>列表，我们需要传递分配给每个标签的整数值。值列表检索嵌套列表中的最后一个元素。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="528b" class="mg mh iu ov b gz oz pa l pb pc"><em class="nc"># create sublists from the sankey list</em><br/>source_list <strong class="ov iv">=</strong> [label_dict[x[0]] <strong class="ov iv">for</strong> x <strong class="ov iv">in</strong> sankey_list]<br/>target_list <strong class="ov iv">=</strong> [label_dict[x[1]] <strong class="ov iv">for</strong> x <strong class="ov iv">in</strong> sankey_list]<br/>value_list <strong class="ov iv">=</strong> [x[2] <strong class="ov iv">for</strong> x <strong class="ov iv">in</strong> sankey_list]<br/><br/>print('Source list:', source_list)<br/>print('Target list:', target_list)<br/>print('Value list:', value_list)</span></pre><p id="e9ae" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">输出:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj ph"><img src="../Images/f2611ab7073a91ee916247fad426973a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmcpjdlXghBE9c4X-eG5_g.png"/></div></div></figure><h1 id="25d9" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">动词 （verb的缩写）形象化</h1><p id="a62c" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">我们可以使用<a class="ae kv" href="https://plotly.com/python/indicator/" rel="noopener ugc nofollow" target="_blank"> Plotly指标</a>来可视化现金流</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="ae65" class="mg mh iu ov b gz oz pa l pb pc">fig <strong class="ov iv">=</strong> go<strong class="ov iv">.</strong>Figure(go<strong class="ov iv">.</strong>Indicator(<br/>    mode <strong class="ov iv">=</strong> "number+delta",<br/>    value <strong class="ov iv">=</strong> total_income <strong class="ov iv">-</strong> total_expense,<br/>    number <strong class="ov iv">=</strong> {'prefix': "Cash Flow - $"},<br/>    domain <strong class="ov iv">=</strong> {'x': [0, 1], 'y': [0, 1]})<br/>)<br/><br/>fig<strong class="ov iv">.</strong>update_layout(height<strong class="ov iv">=</strong>300)<br/><br/>fig<strong class="ov iv">.</strong>show()</span></pre><p id="b0ae" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">输出:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj pi"><img src="../Images/be1b1a065812a5230053411925580477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*13WgBhaYu0n_672l2TvZrw.png"/></div></div></figure><p id="25eb" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">接下来，我们通过绘制源、目标和值列表来创建Sankey图。</p><pre class="kk kl km kn gu ou ov ow ox aw oy bi"><span id="cd8b" class="mg mh iu ov b gz oz pa l pb pc"><em class="nc"># create figure</em><br/>fig <strong class="ov iv">=</strong> go<strong class="ov iv">.</strong>Figure(data<strong class="ov iv">=</strong>[go<strong class="ov iv">.</strong>Sankey(<br/>    <em class="nc"># nodes</em><br/>    node <strong class="ov iv">=</strong> dict(<br/>      pad <strong class="ov iv">=</strong> 15,<br/>      thickness <strong class="ov iv">=</strong> 20,<br/>      line <strong class="ov iv">=</strong> dict(color <strong class="ov iv">=</strong> "black", width <strong class="ov iv">=</strong> 0.5),<br/>      label <strong class="ov iv">=</strong> label_list, <em class="nc"># cash flow parameters</em><br/>      hovertemplate<strong class="ov iv">=</strong>'%{label} has total value $%{value}',<br/>    ),<br/>    <em class="nc"># links</em><br/>    link <strong class="ov iv">=</strong> dict(<br/>      source <strong class="ov iv">=</strong> source_list, <em class="nc"># start node</em><br/>      target <strong class="ov iv">=</strong> target_list, <em class="nc"># end node</em><br/>      value <strong class="ov iv">=</strong> value_list <em class="nc"># value of end node</em><br/>  ))])<br/><br/>fig<strong class="ov iv">.</strong>update_layout(<br/>    hovermode <strong class="ov iv">=</strong> 'x',<br/>    title<strong class="ov iv">=</strong>"Income &amp; Expenses&lt;br&gt;Property Address: {}"<strong class="ov iv">.</strong>format(property_address),<br/>    <em class="nc"># optional for black background</em><br/>    font<strong class="ov iv">=</strong>dict(size <strong class="ov iv">=</strong> 10, color <strong class="ov iv">=</strong> 'white'),<br/>    plot_bgcolor<strong class="ov iv">=</strong>'black',<br/>    paper_bgcolor<strong class="ov iv">=</strong>'black'<br/>)<br/><br/>fig<strong class="ov iv">.</strong>show()</span></pre><p id="3ed2" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">输出:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gi gj pi"><img src="../Images/8e72106275d480d6e75eb22c9efbef78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UQ6VciuB9z3D5xlAS6RrIQ.png"/></div></div></figure><h1 id="d84b" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">结论</h1><p id="c907" class="pw-post-body-paragraph kw kx iu ky b kz nv jv lb lc nw jy le lf nx lh li lj ny ll lm ln nz lp lq lr in bi translated">桑基图是可视化多流(如现金流)的好方法。这可以帮助个人快速发现增加收入或减少现金流支出的机会。</p><p id="265d" class="pw-post-body-paragraph kw kx iu ky b kz la jv lb lc ld jy le lf lg lh li lj lk ll lm ln lo lp lq lr in bi translated">查看我的<a class="ae kv" href="https://youtube.com/c/analyticsariel" rel="noopener ugc nofollow" target="_blank"> YouTube频道——AnalyticsAriel</a>,了解更多关于房地产数据来源和数据分析的见解！</p><h1 id="9333" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">克隆笔记本</h1><div class="pj pk gq gs pl pm"><a href="https://github.com/analyticsariel/projects/blob/master/calculators/cash_flow_calculator.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab fp"><div class="po ab pp cl cj pq"><h2 class="bd iv gz z fq pr fs ft ps fv fx it bi translated">projects/cash _ flow _ calculator . ipynb at master analytics Ariel/projects</h2><div class="pt l"><h3 class="bd b gz z fq pr fs ft ps fv fx dk translated">https://analyticsariel.com/.通过在GitHub上创建帐户，为analyticsariel/projects开发做出贡献。</h3></div><div class="pu l"><p class="bd b dl z fq pr fs ft ps fv fx dk translated">github.com</p></div></div><div class="pv l"><div class="pw l px py pz pv qa kp pm"/></div></div></a></div><h1 id="98f5" class="oj mh iu bd mi ok ol om ml on oo op mo ka oq kb mr kd or ke mu kg os kh mx ot bi translated">来源</h1><div class="pj pk gq gs pl pm"><a href="https://plotly.com/python/sankey-diagram/" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab fp"><div class="po ab pp cl cj pq"><h2 class="bd iv gz z fq pr fs ft ps fv fx it bi translated">桑基</h2><div class="pt l"><h3 class="bd b gz z fq pr fs ft ps fv fx dk translated">链接和节点有自己的hovertemplate，其中可以显示特定于链接或节点的属性。要添加更多…</h3></div><div class="pu l"><p class="bd b dl z fq pr fs ft ps fv fx dk translated">plotly.com</p></div></div><div class="pv l"><div class="qb l px py pz pv qa kp pm"/></div></div></a></div><div class="pj pk gq gs pl pm"><a href="https://sparkrental.com/visualizing-rental-cash-flow-4-graphs-showing-how-landlords-money-moves/" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab fp"><div class="po ab pp cl cj pq"><h2 class="bd iv gz z fq pr fs ft ps fv fx it bi translated">房地产现金流- 3幅图片展示了租赁利润的实际运作方式</h2><div class="pt l"><h3 class="bd b gz z fq pr fs ft ps fv fx dk translated">房地产现金流与“正常”月份发生的事情无关。在一个“正常”的月份里，你的花费可能会…</h3></div><div class="pu l"><p class="bd b dl z fq pr fs ft ps fv fx dk translated">sparkrental.com</p></div></div><div class="pv l"><div class="qc l px py pz pv qa kp pm"/></div></div></a></div></div></div>    
</body>
</html>