<html>
<head>
<title>Dependency Injection Lifetimes in .NET</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">中的依赖项注入生存期。网</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/cdependency-injection-lifetimes-in-net-566830a633ca?source=collection_archive---------12-----------------------#2022-05-24">https://levelup.gitconnected.com/cdependency-injection-lifetimes-in-net-566830a633ca?source=collection_archive---------12-----------------------#2022-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="731d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">单例、作用域和瞬态之间有什么区别</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5860a391b7017a6683b98c52bb0cb9f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cK5Zo2IvM_A14vS1cPLGZA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/photos/d_3EKbSg1tg" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@hdbernd" rel="noopener ugc nofollow" target="_blank"> Bernd Dittrich </a>拍摄的照片</figcaption></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="4751" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">介绍</h2><p id="9c44" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">在这篇文章中，我们将看看单例服务、作用域服务和瞬态服务之间的区别，以及它们如何影响我们的应用程序。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="c45d" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">短暂的</h2><p id="0da5" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">瞬态服务将在每次从服务容器请求它们时创建一个新的服务实例，然后在请求结束时被释放。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/7dff162764f1cc292117467bc354d5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ffImTe3AFabg1B9kI3QMAg.jpeg"/></div></div></figure><p id="2027" class="pw-post-body-paragraph mc md it me b mf mw ju mh mi mx jx mk lp my mm mn lt mz mp mq lx na ms mt mu im bi translated">所以，假设我们想要一个系统状态服务来跟踪CPU性能等等。我们希望将它添加为transient，因为理想情况下，我们希望能够通过这样的请求在每一点检查系统的状态。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="d43a" class="pw-post-body-paragraph mc md it me b mf mw ju mh mi mx jx mk lp my mm mn lt mz mp mq lx na ms mt mu im bi translated">Transient在轻量级、无状态的服务中也能很好地工作，但在其他地方就不那么好了，因为它使用了大量的内存和资源，影响了性能。瞬态服务对于多线程和内存泄漏也有好处，因为每次都会创建一个新的实例。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="c0fc" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">审视</h2><p id="3cc9" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">另一方面，作用域服务为每个请求创建一次，并在请求结束时再次被释放。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/aec0be85d2efade86cef578fbacbb97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ma2QqHmqhu6j2ri079A7RA.jpeg"/></div></div></figure><p id="4907" class="pw-post-body-paragraph mc md it me b mf mw ju mh mi mx jx mk lp my mm mn lt mz mp mq lx na ms mt mu im bi translated">当您希望维护请求中的状态时，您希望使用scoped。一个很好的例子是，如果您有一些关于识别发送请求的用户的逻辑，那么您可以跟踪哪个用户更新了什么数据。例如:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="e5a1" class="pw-post-body-paragraph mc md it me b mf mw ju mh mi mx jx mk lp my mm mn lt mz mp mq lx na ms mt mu im bi translated">在你的类中，你会有一个逻辑，根据你已经设置好的认证返回给你<em class="nd">用户标识</em>。但是您希望保持服务的作用域，因为在请求的最后，您希望记录那个<em class="nd"> userId </em>，这样您就可以回顾更改以及谁做了更改。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="f579" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一个</h2><p id="e131" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">顾名思义，单元集服务在被请求时被创建一次。从那时起，每个请求都将使用该服务的同一个实例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/d6765b5e222e425c43b4418a3b8cb824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xgd6nQFd8vw-VsqtRmwH3w.jpeg"/></div></div></figure><p id="233e" class="pw-post-body-paragraph mc md it me b mf mw ju mh mi mx jx mk lp my mm mn lt mz mp mq lx na ms mt mu im bi translated">单例服务的内存效率很高，因为它们只创建一次，然后就可以重用，但另一方面，内存泄漏可能会随着时间的推移而增加。当您需要一个应用程序范围的状态，比如日志记录、缓存等等时，您可以将服务作为一个单独的服务来添加。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="9792" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h2><p id="166d" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">依赖注射真的很好知道，一旦你把它们包起来，它们就没那么可怕了。如果你有任何问题，请留下评论，我希望你喜欢这篇短文。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><div class="kj kk kl km gt nf"><a href="https://medium.com/@ivan.zstoev/membership" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">通过我的推荐链接加入Medium-Ivan Stoev</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt ks nf"/></div></div></a></div></div></div>    
</body>
</html>