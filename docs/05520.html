<html>
<head>
<title>Sparklines with Angular and D3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带角度和D3的迷你图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/sparklines-with-angular-and-d3-d279dbac0c38?source=collection_archive---------3-----------------------#2020-09-06">https://levelup.gitconnected.com/sparklines-with-angular-and-d3-d279dbac0c38?source=collection_archive---------3-----------------------#2020-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9c3c4d9268bd479502418a28d629ee69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Bv6OU6FBKr6tpq7YI5UyA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">带图表的平板电脑</figcaption></figure><p id="9d76" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以你想显示迷你图？没有必要使用庞大的库，尤其是那些构建在D3之上的库(不要误解我，它们中的许多都很棒)，或者在这里购买一个商业组件。为了让枯燥的数字变得生动，我们可以很容易地做出一个。</p><p id="c61b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了解决这个问题，我们<strong class="ke ir"> <em class="la">将</em> </strong>使用<a class="ae lb" href="https://d3js.org/" rel="noopener ugc nofollow" target="_blank"> D3.js </a>，在维基百科上描述为:</p><blockquote class="lc ld le"><p id="439e" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated">D3.js(也称为D3，是数据驱动文档的缩写)是一个JavaScript库，用于在web浏览器中生成动态、交互式数据可视化。它利用了广泛实现的可缩放矢量图形(SVG)、HTML5和级联样式表(CSS)标准。</p></blockquote><h1 id="1af4" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">先决条件</h1><p id="fb1a" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">最近我看到的大多数Angular目标教程都喜欢带你安装Angular并创建一个全新的项目。我不打算这么做，因为我坚信在你到达这里之前，你应该有框架的基础知识。不过，我会提供一个如何开始使用Angular的链接，所以如果你是新手，请浏览教程(英雄之旅),然后回来和我们一起制作迷你图！<a class="ae lb" href="https://angular.io/tutorial" rel="noopener ugc nofollow" target="_blank">角斗士之旅</a></p><p id="e2d1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您需要安装D3库，这可以在提示符下完成:<code class="fe ml mm mn mo b"><strong class="ke ir">npm install d3 --save</strong></code></p><p id="65c9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后，为了确保我们在实现D3时不会发疯，我们需要键入:<code class="fe ml mm mn mo b"><strong class="ke ir">npm install @types/d3 --save-dev</strong></code></p><p id="89ac" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好了，我们现在有了库，让我们开始处理数据。在处理D3的数据时，<a class="ae lb" href="https://observablehq.com/@d3/gallery" rel="noopener ugc nofollow" target="_blank"> Observable HQ </a>上的许多示例使用csv或tsv数据(分别为逗号或制表符分隔的数据)。这些都很好，但是大多数API倾向于返回JSON数据，所以我们需要在开始创建实际的迷你图之前做一些准备工作。</p><h2 id="7419" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">tsconfig.json</h2><p id="c8f7" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">在我们继续之前，我喜欢在构建Angular应用程序时使用路径快捷方式。这样我只需用<strong class="ke ir">~ app/feature/demo/demo . component</strong>就可以访问<strong class="ke ir">src/app/feature/demo/demo . component . ts</strong>。为此，您需要打开根目录中的<strong class="ke ir"> tsconfig.json </strong>文件，并将以下内容添加到compilerOptions部分，我通常将它插入到moduleResolution的正下方和importHelpers的前面。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="ea11" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">"paths": {<br/>      "~app/*": ["src/app/*"],<br/>      "~assets/*": ["src/assets/*"],<br/>      "~environment/*": ["src/environments/*"]<br/>},</strong></span></pre><h2 id="543f" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">图表模型</h2><p id="6bc5" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">图表模型是我们数据的结构，并防止我们与我们选择的打字稿冲突。让我们用以下内容来创建它:</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="0cd2" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">ng generate class feature/chart/chart</strong></span></pre><p id="45b5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这应该会在<strong class="ke ir">应用程序/功能/图表</strong>目录中创建一个<strong class="ke ir"> chart.ts </strong>文件。对于这个实现，我们只需要创建一个名为“ChartSeries”的类来保存x和y轴数据。</p><p id="b0c2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">图表系列</strong></p><ul class=""><li id="edc3" class="nn no iq ke b kf kg kj kk kn np kr nq kv nr kz ns nt nu nv bi translated"><strong class="ke ir">x轴</strong>—x轴数据</li><li id="7b13" class="nn no iq ke b kf nw kj nx kn ny kr nz kv oa kz ns nt nu nv bi translated"><strong class="ke ir">y轴数据</strong></li></ul><p id="df19" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以下是完整的图表文件:</p><p id="11e3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">图表. ts </strong></p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="f6f3" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">export <em class="la">class</em> ChartSeries {<br/>    public xAxis: any;<br/>    public yAxis: any;<br/>}</strong></span></pre><h1 id="fbf2" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">图表组件</h1><p id="7aac" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们需要一个组件来实际显示迷你图。我们将通过使用:<code class="fe ml mm mn mo b"><strong class="ke ir">ng generate component feature/chart</strong></code>生成一个图表组件来实现</p><p id="a9b6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">创建完成后，我们打开:<strong class="ke ir">app/feature/chart/chart . component . ts</strong></p><h2 id="5343" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">图表.组件. ts</h2><p id="62a4" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们将利用相当多的核心角度接口，包括<strong class="ke ir"><em class="la">AfterViewInit</em></strong>，<strong class="ke ir"> <em class="la"> ElementRef </em> </strong>，<strong class="ke ir"> <em class="la"> HostListener </em> </strong>，<strong class="ke ir"> <em class="la"> Input </em> </strong>，以及<strong class="ke ir"> <em class="la"> ViewChild </em> </strong>。我们通过导入来做到这一点。<br/>替换现有的:<code class="fe ml mm mn mo b"><strong class="ke ir">import { Component, OnInit } from '@angular/core';</strong></code></p><p id="4449" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">同:<code class="fe ml mm mn mo b"><strong class="ke ir">import { AfterViewInit, Component, ElementRef, HostListener, Input, ViewChild } from '@angular/core';</strong></code></p><p id="6f1b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦完成，让我们导入D3库:<code class="fe ml mm mn mo b"><strong class="ke ir">import * as d3 from 'd3';</strong></code></p><p id="d10b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后但同样重要的是，我们之前创建的ChartSeries类:<code class="fe ml mm mn mo b"><strong class="ke ir">import { ChartSeries } from './chart';</strong></code></p><p id="6fd5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好的，这应该能让我们成功！</p><p id="ee69" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里可能会有一个错误，因为我们实现的是OnInit而不是AfterViewInit，所以我们需要做两处调整:</p><p id="257e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">替换包含<code class="fe ml mm mn mo b"><strong class="ke ir">export class ChartComponent implements OnInit {</strong></code>的第10行或其附近的导出语句</p><p id="c0f4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">用<code class="fe ml mm mn mo b"><strong class="ke ir">export class ChartComponent implements AfterViewInit {</strong></code></p><p id="45ad" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们还需要用<strong class="ke ir">ngafterviewit()</strong>替换<strong class="ke ir"> ngOnInit() </strong>方法。在第14行或其周围更换<code class="fe ml mm mn mo b"><strong class="ke ir">ngOnInit(): void {}</strong></code></p><p id="0134" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">用<code class="fe ml mm mn mo b"><strong class="ke ir">ngAfterViewInit(): void {}</strong></code></p><p id="26b6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为什么这很重要？如果你对<a class="ae lb" href="https://angular.io/guide/lifecycle-hooks" rel="noopener ugc nofollow" target="_blank">Angular Component life cycle</a>不太熟悉，它本质上是一种在组件生命周期中的特定事件(创建、更新和销毁)将代码“注入”到组件中的方法。来自官方的Angular文档:</p><blockquote class="lc ld le"><p id="4cf4" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated">组件实例的生命周期始于Angular实例化组件类并呈现组件视图及其子视图。生命周期继续进行更改检测，Angular检查数据绑定属性何时更改，并根据需要更新视图和组件实例。当Angular销毁组件实例并从DOM中删除其呈现模板时，生命周期结束。指令也有类似的生命周期，Angular在执行过程中创建、更新和销毁实例。</p></blockquote><p id="6703" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，在尝试绘制任何东西之前，我们希望等到组件尽可能初始化。这一点尤其重要，因为我们将利用<strong class="ke ir"> ViewChild </strong>装饰器，根据Angular文档，该装饰器设置在调用<strong class="ke ir">ngafterviewit()</strong>之前，但在其他初始化生命周期挂钩之后。</p><blockquote class="lc ld le"><p id="c9e4" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated">视图查询是在调用<code class="fe ml mm mn mo b">ngAfterViewInit</code>回调之前设置的。</p></blockquote><p id="408a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">主持听众<br/> </strong>好吧！现在，我们还想确保当调整窗口大小时，我们的图表也随之调整大小。我们希望捕获任何窗口大小调整事件，以便在其容器内适当地重新绘制图表。最简单的方法是通过Angular host listener——我们捕获任何'<strong class="ke ir"> window:resize </strong>'事件，然后执行我们的re-draw方法<strong class="ke ir"> this.resize() </strong>,我们将在本文中进一步实现该方法。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="5ee6" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">@HostListener('window:resize', ['$event'])<br/>onResize() {<br/>    this.resize();<br/>}</strong></span></pre><p id="99de" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Input </strong> <br/>我们还需要来自调用组件的一些信息来初始化图表并适当地调整大小。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="b1e4" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">@Input() data: ChartSeries[]; // The data to plot on the sparkline<br/>@Input() lineColor: number[] = [70, 130, 180, 1]; // The RGBA value representing the color of the sparkline<br/>@Input() margin: number = 0; // The margin to apply to sizing calculations - default to 0 but will typically be 20-24 pixels.</strong></span></pre><p id="7793" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">请记住，如果您不想使用RGBA值，您可以简单地将<strong class="ke ir"> lineColor </strong>变成一个字符串，并使用十六进制代码，如“<strong class="ke ir"># 4682 B4”</strong>，但我喜欢允许自己自由的不透明度(RGBA数组中的第四个数字，范围在0-完全透明和1-不透明之间，如0.4)</p><p id="da9f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">观子</strong></p><p id="bea6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">继续前进！我们还希望利用Angular的<strong class="ke ir"> ViewChild </strong>来轻松地(并且不生成或不需要特定的元素id，这在显示多个图表时会非常麻烦)引用容器和图表DOM元素。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="8694" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">@ViewChild('chart', {static: false}) chart: ElementRef&lt;SVGElement&gt;;<br/>@ViewChild('container', {static: false}) container: ElementRef&lt;HTMLDivElement&gt;;</strong></span></pre><p id="7081" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">其他变量</strong> <br/>最后，我们需要存储一些在整个组件中使用的全局值，比如高度、宽度和一个全局svg组件，以便以后引用。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="0d88" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">private height: number;<br/>private svg: any;<br/>private width: number;</strong></span></pre><h2 id="6dd3" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">快速回顾</h2><p id="a41c" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">到目前为止，我们的<strong class="ke ir"> chart.component.ts </strong>文件看起来应该与此非常相似:</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="4162" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">import { AfterViewInit, Component, ElementRef, HostListener, Input, ViewChild } from '@angular/core';<br/>import * as d3 from 'd3';<br/>import { ChartSeries } from './chart';</strong></span><span id="d4c5" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">@Component({<br/>    selector: 'app-chart',<br/>    templateUrl: './chart.component.html',<br/>    styleUrls: ['./chart.component.scss']<br/>})<br/>export class ChartComponent implements AfterViewInit {</strong></span><span id="e0a2" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    @HostListener('window:resize', ['$event'])<br/>    onResize() {<br/>        this.resize();<br/>    }<br/>    <br/>    @Input() data: ChartSeries[] = []; // The data to plot on the sparkline<br/>    @Input() lineColor: <em class="la">number</em>[] = [70, 130, 180, 1]; // The RGBA value representing the color of the sparkline<br/>    @Input() margin: <em class="la">number</em> = 0; // The margin to apply to sizing calculations - default to 0 but will typically be 20-24 pixels.</strong></span><span id="c5a6" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    @ViewChild('chart', {static: false}) chart: ElementRef&lt;SVGElement&gt;;<br/>    @ViewChild('container', {static: false}) container: ElementRef&lt;HTMLDivElement&gt;;</strong></span><span id="12e4" class="mp lj iq mo b gy ob nk l nl nm">    <strong class="mo ir">private height: <em class="la">number</em>;<br/>    private svg: <em class="la">any</em>;<br/>    private width: <em class="la">number</em>;</strong></span><span id="b0a2" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    constructor() { }</strong></span><span id="296f" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    ngAfterViewInit(): void {<br/>    }<br/>}</strong></span></pre><h2 id="655e" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated"><strong class="ak">调整大小</strong></h2><p id="0d8c" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们想要实现的第一个方法是resize。这将允许我们在触发resize事件时修改图表的高度和宽度，并允许我们执行初始大小设置。我们将使用<strong class="ke ir"> ViewChild </strong>对<strong class="ke ir"> this.container </strong>和<strong class="ke ir"> this.chart </strong>的定义，然后访问它们的<strong class="ke ir"> nativeElement </strong>属性。</p><blockquote class="lc ld le"><p id="bdb0" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated"><strong class="ke ir">注意</strong> : <br/>如果你不熟悉你在代码示例中看到的反斜杠<code class="fe ml mm mn mo b"><strong class="ke ir">`</strong></code>，这不是一个粗心的错误！使用反斜线代替引号<code class="fe ml mm mn mo b"><strong class="ke ir">'</strong></code>或双引号<code class="fe ml mm mn mo b"><strong class="ke ir">"</strong></code>就是JavaScript中的插值或模板文字。MDN Web Docs将模板文字描述为:<strong class="ke ir">模板文字是用反斜杠(</strong> <code class="fe ml mm mn mo b"><strong class="ke ir">`</strong></code> <strong class="ke ir">)分隔的文字，允许被称为<em class="iq">替换</em>的嵌入表达式。你可以在这里找到更多信息:<a class="ae lb" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Template _ literals</a></strong></p></blockquote><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="8b88" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">private resize(): void {<br/>    // We know how big we should be based on our parent element - and its offsetHeight/offsetWidth properties<br/>    this.height = this.container.nativeElement.parentElement.offsetHeight;<br/>    this.width = this.container.nativeElement.parentElement.offsetWidth;</strong></span><span id="a6e3" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    this.chart.nativeElement.style.height = `${this.height}px`;<br/>    this.chart.nativeElement.style.maxHeight = `${this.height}px`;<br/>    this.chart.nativeElement.style.maxWidth = `${this.width}px`;<br/>    this.chart.nativeElement.style.minHeight = `${this.height}px`;<br/>    this.chart.nativeElement.style.minWidth = `${this.width}px`;<br/>    this.chart.nativeElement.style.width = `${this.width}px`;</strong></span><span id="337c" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    this.container.nativeElement.style.height = `${this.height}px`;<br/>    this.container.nativeElement.style.maxHeight = `${this.height}px`;<br/>    this.container.nativeElement.style.maxWidth = `${this.width}px`;<br/>    this.container.nativeElement.style.minHeight = `${this.height}px`;<br/>    this.container.nativeElement.style.minWidth = `${this.width}px`;<br/>    this.container.nativeElement.style.width = `${this.width}px`;<br/>}</strong></span></pre><p id="449b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们有了resize事件，让我们将它添加到我们的<strong class="ke ir">ngafterview it</strong>方法中，以便在初始化时设置我们的高度和宽度。此外，让我们稍后用一个<strong class="ke ir"> d3.select() </strong>更容易地引用我们的实际图表。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="3f12" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">ngAfterViewInit(): <em class="la">void</em> {<br/>    this.resize();<br/>    this.svg = d3.select(this.chart.nativeElement);<br/>}</strong></span></pre><h2 id="8417" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">构建迷你图</h2><p id="2a73" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">现在我们开始讨论事情的实质。我们需要生成并绘制迷你图。</p><p id="4c31" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> X和Y刻度<br/> </strong>刻度允许d3沿轴缩放数据。根据d3文件:</p><blockquote class="lc ld le"><p id="d412" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated">比例函数是JavaScript函数，它:</p><p id="a6c3" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated">-接受一个输入(通常是数字、日期或类别)，然后<br/> -返回一个值(如坐标、颜色、长度或半径)</p><p id="5ca6" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated">它们通常用于将数据值转换(或“映射”)为可视变量(如位置、长度和颜色)。</p></blockquote><p id="b5e8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将假设我们的x轴是时间(水平轴——例如左右), y轴是数值(垂直轴——例如上下)。我们从x轴的零范围(最左边的值)开始，到组件的宽度结束。在y轴上，我们从组件的高度范围(最底部的值)开始，以0结束。对于这些域，我们使用<strong class="ke ir"> d3.extent() </strong>来确定x轴上<strong class="ke ir"> this.data </strong>内的最小和最大时间范围—对于y轴，我们有一个从零开始并在<strong class="ke ir"> this.data </strong>的<strong class="ke ir"> yAxis </strong>中的最大值处结束的域。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="9045" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">const xScale = d3.scaleTime()<br/>    .domain(d3.extent(this.data, (d) =&gt; d.xAxis))<br/>    .range([0, this.width]);<br/>const yScale = d3.scaleLinear()<br/>    .domain([0, d3.max(this.data, (d) =&gt; d.yAxis)])<br/>    .range([this.height, 0]);</strong></span></pre><p id="97bd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">线<br/>线</strong>是的，这是实际的迷你图。我们简单地创建一个<strong class="ke ir"> d3.line </strong>并将它的x和y轴分别设置为<strong class="ke ir"> xScale </strong>和<strong class="ke ir"> yScale </strong>方法的返回。我们也用<strong class="ke ir">D3 . line</strong>T22】curve方法用<strong class="ke ir"> d3.curveCardinal. </strong>给线条设置一条漂亮的曲线(而不是锯齿状的边缘)</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="9bac" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">const line: any = d3.line&lt;ChartSeries&gt;()<br/>      .curve(d3.curveCardinal)<br/>      .x((d) =&gt; xScale(d.xAxis))<br/>      .y((d) =&gt; yScale(d.yAxis));</strong></span></pre><p id="6245" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">绘制它<br/> </strong>现在我们将我们的线写入一个SVG路径，以便在画布上绘制迷你图。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="3fbb" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">this.svg.append('path')<br/>      .datum(this.data)<br/>      .attr('d', line)<br/>      .style('fill', 'none')<br/>      .style('stroke', `rgba(${this.lineColor[0]},${this.lineColor[1]},${this.lineColor[2]},${this.lineColor[3]})`)<br/>      .style('stroke-width', '2')<br/>      .style('width', `${this.width}px`);</strong></span></pre><p id="e4f4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">初始化它<br/></strong></p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="f842" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">ngAfterViewInit(): void {<br/>    this.resize();<br/>    this.svg = d3.select(this.chart.nativeElement);<br/>    this.buildSparkline();<br/>}</strong></span></pre><p id="95c3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">总结<br/> </strong>在所有这些有趣的事情之后，我们应该得到一个如下所示的chart.component.ts文件:</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="e35d" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">import { AfterViewInit, Component, ElementRef, HostListener, Input, ViewChild } from '</strong><a class="ae lb" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank"><strong class="mo ir">@angular/core</strong></a><strong class="mo ir">';<br/>import * as d3 from 'd3';<br/>import { ChartSeries } from './chart';</strong></span><span id="6180" class="mp lj iq mo b gy ob nk l nl nm"><a class="ae lb" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank"><strong class="mo ir">@Component</strong></a><strong class="mo ir">({<br/>  selector: 'app-chart',<br/>  templateUrl: './chart.component.html',<br/>  styleUrls: ['./chart.component.scss']<br/>})<br/>export class ChartComponent implements AfterViewInit {</strong></span><span id="7910" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    @HostListener('window:resize', ['$event'])<br/>    onResize() {<br/>      this.resize();<br/>    }</strong></span><span id="fd7e" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    @Input() data: ChartSeries[]; // The data to plot on the sparkline<br/>    @Input() lineColor: number[] = [70, 130, 180, 1]; // The RGBA value representing the color of the sparkline<br/>    @Input() margin: number = 0; // The margin to apply to sizing calculations - default to 0 but will typically be 20-24 pixels.</strong></span><span id="5283" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    @ViewChild('chart', {static: false}) chart: ElementRef&lt;SVGElement&gt;;<br/>    @ViewChild('container', {static: false}) container: ElementRef&lt;HTMLDivElement&gt;;</strong></span><span id="f283" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    private height: number;<br/>    private svg: any;<br/>    private width: number;</strong></span><span id="e154" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    constructor() { }</strong></span><span id="8334" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    ngAfterViewInit(): void {<br/>        this.resize();<br/>        this.svg = d3.select(this.chart.nativeElement);<br/>        this.buildSparkline();<br/>      }</strong></span><span id="8b1f" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    private buildSparkline(): void {</strong></span><span id="bf03" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">        const xScale: any = d3.scaleTime()<br/>          .domain(d3.extent(this.data, (d) =&gt; d.xAxis))<br/>          .range([0, this.width]);</strong></span><span id="61d4" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">        const yScale: any = d3.scaleLinear()<br/>          .domain([0, d3.max(this.data, (d) =&gt; d.yAxis)])<br/>          .range([this.height, 0]);</strong></span><span id="244a" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">        const line: any = d3.line&lt;ChartSeries&gt;()<br/>          .curve(d3.curveCardinal)<br/>          .x((d) =&gt; xScale(d.xAxis))<br/>          .y((d) =&gt; yScale(d.yAxis));</strong></span><span id="cd8b" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">        this.svg.append('path')<br/>          .datum(this.data)<br/>          .attr('d', line)<br/>          .style('fill', 'none')<br/>          .style('stroke', `rgba(${this.lineColor[0]},${this.lineColor[1]},${this.lineColor[2]},${this.lineColor[3]})`)<br/>          .style('stroke-width', '2')<br/>          .style('width', `${this.width}px`);<br/>    }</strong></span><span id="87e1" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    private resize(): void {<br/>        // We know how big we should be based on our parent element - and its offsetHeight/offsetWidth properties<br/>        this.height = this.container.nativeElement.parentElement.offsetHeight;<br/>        this.width = this.container.nativeElement.parentElement.offsetWidth;</strong></span><span id="58f5" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">        this.chart.nativeElement.style.height = `${this.height}px`;<br/>        this.chart.nativeElement.style.maxHeight = `${this.height}px`;<br/>        this.chart.nativeElement.style.maxWidth = `${this.width}px`;<br/>        this.chart.nativeElement.style.minHeight = `${this.height}px`;<br/>        this.chart.nativeElement.style.minWidth = `${this.width}px`;<br/>        this.chart.nativeElement.style.width = `${this.width}px`;</strong></span><span id="fc65" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">this.container.nativeElement.style.height = `${this.height}px`;<br/>        this.container.nativeElement.style.maxHeight = `${this.height}px`;<br/>        this.container.nativeElement.style.maxWidth = `${this.width}px`;<br/>        this.container.nativeElement.style.minHeight = `${this.height}px`;<br/>        this.container.nativeElement.style.minWidth = `${this.width}px`;<br/>        this.container.nativeElement.style.width = `${this.width}px`;<br/>    }<br/>}</strong></span></pre><h2 id="fa37" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">chart.component.html</h2><p id="8d83" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们的组件很棒，但是我们还没有显示任何东西。让我们在chart.component.html用以下内容快速替换Angular中的占位符:</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="6a42" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">&lt;div #container style="height: 100%; width: 100%;"&gt;<br/>  &lt;svg #chart height="100%" style="overflow: visible;" width="100%"&gt;<br/>  &lt;/svg&gt;<br/>&lt;/div&gt;</strong></span></pre><p id="d9f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你应该认识上面的<strong class="ke ir">#容器</strong>和<strong class="ke ir">#图表</strong>标识符——这些是我们在<strong class="ke ir">图表.组件. ts </strong>中用<strong class="ke ir">视图子</strong>引用的</p><h1 id="45fe" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">演示组件</h1><p id="fcc9" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">图表组件现在已经完成，但是我们没有使用它。让我们以使用它为目的创建一个新组件。<code class="fe ml mm mn mo b"><strong class="ke ir">ng generate component feature/demo</strong></code></p><h2 id="cf9b" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">data.ts</h2><p id="f5fa" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">要加载这个组件，我们需要一些数据。让我们在<strong class="ke ir"> app/feature/demo目录</strong>中创建一个名为“<strong class="ke ir"> data.ts </strong>”的文件(手动完成，无需Angular CLI)。我们将在这里使用静态数据，但它也可以很容易地从外部来源引入。这超出了本文的范围，所以我们现在使用静态数据。在这里，我使用的是来自瑞典的最新(截至撰写本文时)每日新冠肺炎死亡数据。随意使用你选择的任何x和y轴！</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="6c1f" class="mp lj iq mo b gy nj nk l nl nm">import { ChartSeries } from '~app/feature/chart/chart';</span><span id="11ca" class="mp lj iq mo b gy ob nk l nl nm">export const DATA: ChartSeries[] = [{xAxis: new Date('3/01/2020'), yAxis: 0},{xAxis: new Date('3/02/2020'), yAxis: 0},{xAxis: new Date('3/03/2020'), yAxis: 0},{xAxis: new Date('3/04/2020'), yAxis: 0},{xAxis: new Date('3/05/2020'), yAxis: 0},{xAxis: new Date('3/06/2020'), yAxis: 0},{xAxis: new Date('3/07/2020'), yAxis: 0},{xAxis: new Date('3/08/2020'), yAxis: 0},{xAxis: new Date('3/09/2020'), yAxis: 0},{xAxis: new Date('3/10/2020'), yAxis: 0},{xAxis: new Date('3/11/2020'), yAxis: 0},{xAxis: new Date('3/12/2020'), yAxis: 6},{xAxis: new Date('3/13/2020'), yAxis: 0},{xAxis: new Date('3/14/2020'), yAxis: 1},{xAxis: new Date('3/15/2020'), yAxis: 1},{xAxis: new Date('3/16/2020'), yAxis: 2},{xAxis: new Date('3/17/2020'), yAxis: 2},{xAxis: new Date('3/18/2020'), yAxis: 1},{xAxis: new Date('3/19/2020'), yAxis: 6},{xAxis: new Date('3/20/2020'), yAxis: 7},{xAxis: new Date('3/21/2020'), yAxis: 9},{xAxis: new Date('3/22/2020'), yAxis: 8},{xAxis: new Date('3/23/2020'), yAxis: 11},{xAxis: new Date('3/24/2020'), yAxis: 11},{xAxis: new Date('3/25/2020'), yAxis: 21},{xAxis: new Date('3/26/2020'), yAxis: 22},{xAxis: new Date('3/27/2020'), yAxis: 31},{xAxis: new Date('3/28/2020'), yAxis: 32},{xAxis: new Date('3/29/2020'), yAxis: 35},{xAxis: new Date('3/30/2020'), yAxis: 38},{xAxis: new Date('3/31/2020'), yAxis: 45},{xAxis: new Date('4/01/2020'), yAxis: 48},{xAxis: new Date('4/02/2020'), yAxis: 53},{xAxis: new Date('4/03/2020'), yAxis: 70},{xAxis: new Date('4/04/2020'), yAxis: 80},{xAxis: new Date('4/05/2020'), yAxis: 70},{xAxis: new Date('4/06/2020'), yAxis: 85},{xAxis: new Date('4/07/2020'), yAxis: 90},{xAxis: new Date('4/08/2020'), yAxis: 84},{xAxis: new Date('4/09/2020'), yAxis: 115},{xAxis: new Date('4/10/2020'), yAxis: 86},{xAxis: new Date('4/11/2020'), yAxis: 90},{xAxis: new Date('4/12/2020'), yAxis: 103},{xAxis: new Date('4/13/2020'), yAxis: 97},{xAxis: new Date('4/14/2020'), yAxis: 85},{xAxis: new Date('4/15/2020'), yAxis: 91},{xAxis: new Date('4/16/2020'), yAxis: 115},{xAxis: new Date('4/17/2020'), yAxis: 111},{xAxis: new Date('4/18/2020'), yAxis: 82},{xAxis: new Date('4/19/2020'), yAxis: 86},{xAxis: new Date('4/20/2020'), yAxis: 88},{xAxis: new Date('4/21/2020'), yAxis: 84},{xAxis: new Date('4/22/2020'), yAxis: 62},{xAxis: new Date('4/23/2020'), yAxis: 77},{xAxis: new Date('4/24/2020'), yAxis: 86},{xAxis: new Date('4/25/2020'), yAxis: 89},{xAxis: new Date('4/26/2020'), yAxis: 73},{xAxis: new Date('4/27/2020'), yAxis: 75},{xAxis: new Date('4/28/2020'), yAxis: 73},{xAxis: new Date('4/29/2020'), yAxis: 82},{xAxis: new Date('4/30/2020'), yAxis: 84},{xAxis: new Date('5/01/2020'), yAxis: 78},{xAxis: new Date('5/02/2020'), yAxis: 78},{xAxis: new Date('5/03/2020'), yAxis: 73},{xAxis: new Date('5/04/2020'), yAxis: 75},{xAxis: new Date('5/05/2020'), yAxis: 84},{xAxis: new Date('5/06/2020'), yAxis: 72},{xAxis: new Date('5/07/2020'), yAxis: 73},{xAxis: new Date('5/08/2020'), yAxis: 80},{xAxis: new Date('5/09/2020'), yAxis: 60},{xAxis: new Date('5/10/2020'), yAxis: 69},{xAxis: new Date('5/11/2020'), yAxis: 74},{xAxis: new Date('5/12/2020'), yAxis: 64},{xAxis: new Date('5/13/2020'), yAxis: 61},{xAxis: new Date('5/14/2020'), yAxis: 50},{xAxis: new Date('5/15/2020'), yAxis: 46},{xAxis: new Date('5/16/2020'), yAxis: 58},{xAxis: new Date('5/17/2020'), yAxis: 49},{xAxis: new Date('5/18/2020'), yAxis: 53},{xAxis: new Date('5/19/2020'), yAxis: 61},{xAxis: new Date('5/20/2020'), yAxis: 40},{xAxis: new Date('5/21/2020'), yAxis: 54},{xAxis: new Date('5/22/2020'), yAxis: 54},{xAxis: new Date('5/23/2020'), yAxis: 56},{xAxis: new Date('5/24/2020'), yAxis: 56},{xAxis: new Date('5/25/2020'), yAxis: 44},{xAxis: new Date('5/26/2020'), yAxis: 42},{xAxis: new Date('5/27/2020'), yAxis: 28},{xAxis: new Date('5/28/2020'), yAxis: 39},{xAxis: new Date('5/29/2020'), yAxis: 40},{xAxis: new Date('5/30/2020'), yAxis: 40},{xAxis: new Date('5/31/2020'), yAxis: 39},{xAxis: new Date('6/01/2020'), yAxis: 45},{xAxis: new Date('6/02/2020'), yAxis: 40},{xAxis: new Date('6/03/2020'), yAxis: 37},{xAxis: new Date('6/04/2020'), yAxis: 26},{xAxis: new Date('6/05/2020'), yAxis: 45},{xAxis: new Date('6/06/2020'), yAxis: 38},{xAxis: new Date('6/07/2020'), yAxis: 31},{xAxis: new Date('6/08/2020'), yAxis: 33},{xAxis: new Date('6/09/2020'), yAxis: 38},{xAxis: new Date('6/10/2020'), yAxis: 33},{xAxis: new Date('6/11/2020'), yAxis: 40},{xAxis: new Date('6/12/2020'), yAxis: 36},{xAxis: new Date('6/13/2020'), yAxis: 30},{xAxis: new Date('6/14/2020'), yAxis: 33},{xAxis: new Date('6/15/2020'), yAxis: 27},{xAxis: new Date('6/16/2020'), yAxis: 31},{xAxis: new Date('6/17/2020'), yAxis: 28},{xAxis: new Date('6/18/2020'), yAxis: 33},{xAxis: new Date('6/19/2020'), yAxis: 29},{xAxis: new Date('6/20/2020'), yAxis: 29},{xAxis: new Date('6/21/2020'), yAxis: 29},{xAxis: new Date('6/22/2020'), yAxis: 21},{xAxis: new Date('6/23/2020'), yAxis: 21},{xAxis: new Date('6/24/2020'), yAxis: 25},{xAxis: new Date('6/25/2020'), yAxis: 22},{xAxis: new Date('6/26/2020'), yAxis: 24},{xAxis: new Date('6/27/2020'), yAxis: 12},{xAxis: new Date('6/28/2020'), yAxis: 14},{xAxis: new Date('6/29/2020'), yAxis: 22},{xAxis: new Date('6/30/2020'), yAxis: 18},{xAxis: new Date('7/01/2020'), yAxis: 20},{xAxis: new Date('7/02/2020'), yAxis: 17},{xAxis: new Date('7/03/2020'), yAxis: 15},{xAxis: new Date('7/04/2020'), yAxis: 8},{xAxis: new Date('7/05/2020'), yAxis: 15},{xAxis: new Date('7/06/2020'), yAxis: 9},{xAxis: new Date('7/07/2020'), yAxis: 16},{xAxis: new Date('7/08/2020'), yAxis: 12},{xAxis: new Date('7/09/2020'), yAxis: 11},{xAxis: new Date('7/10/2020'), yAxis: 15},{xAxis: new Date('7/11/2020'), yAxis: 14},{xAxis: new Date('7/12/2020'), yAxis: 10},{xAxis: new Date('7/13/2020'), yAxis: 9},{xAxis: new Date('7/14/2020'), yAxis: 14},{xAxis: new Date('7/15/2020'), yAxis: 8},{xAxis: new Date('7/16/2020'), yAxis: 6},{xAxis: new Date('7/17/2020'), yAxis: 7},{xAxis: new Date('7/18/2020'), yAxis: 7},{xAxis: new Date('7/19/2020'), yAxis: 11},{xAxis: new Date('7/20/2020'), yAxis: 8},{xAxis: new Date('7/21/2020'), yAxis: 7},{xAxis: new Date('7/22/2020'), yAxis: 7},{xAxis: new Date('7/23/2020'), yAxis: 6},{xAxis: new Date('7/24/2020'), yAxis: 5},{xAxis: new Date('7/25/2020'), yAxis: 3},{xAxis: new Date('7/26/2020'), yAxis: 1},{xAxis: new Date('7/27/2020'), yAxis: 2},{xAxis: new Date('7/28/2020'), yAxis: 6},{xAxis: new Date('7/29/2020'), yAxis: 5},{xAxis: new Date('7/30/2020'), yAxis: 2},{xAxis: new Date('7/31/2020'), yAxis: 0},{xAxis: new Date('8/01/2020'), yAxis: 3},{xAxis: new Date('8/02/2020'), yAxis: 3},{xAxis: new Date('8/03/2020'), yAxis: 1},{xAxis: new Date('8/04/2020'), yAxis: 4},{xAxis: new Date('8/05/2020'), yAxis: 2},{xAxis: new Date('8/06/2020'), yAxis: 3},{xAxis: new Date('8/07/2020'), yAxis: 4},{xAxis: new Date('8/08/2020'), yAxis: 3},{xAxis: new Date('8/09/2020'), yAxis: 1},{xAxis: new Date('8/10/2020'), yAxis: 4},{xAxis: new Date('8/11/2020'), yAxis: 2},{xAxis: new Date('8/12/2020'), yAxis: 4},{xAxis: new Date('8/13/2020'), yAxis: 3},{xAxis: new Date('8/14/2020'), yAxis: 6},{xAxis: new Date('8/15/2020'), yAxis: 1},{xAxis: new Date('8/16/2020'), yAxis: 1},{xAxis: new Date('8/17/2020'), yAxis: 0},{xAxis: new Date('8/18/2020'), yAxis: 3},{xAxis: new Date('8/19/2020'), yAxis: 5},{xAxis: new Date('8/20/2020'), yAxis: 1},{xAxis: new Date('8/21/2020'), yAxis: 2},{xAxis: new Date('8/22/2020'), yAxis: 5},{xAxis: new Date('8/23/2020'), yAxis: 1},{xAxis: new Date('8/24/2020'), yAxis: 3},{xAxis: new Date('8/25/2020'), yAxis: 1},{xAxis: new Date('8/26/2020'), yAxis: 1},{xAxis: new Date('8/27/2020'), yAxis: 2},{xAxis: new Date('8/28/2020'), yAxis: 0},{xAxis: new Date('8/29/2020'), yAxis: 1},{xAxis: new Date('8/30/2020'), yAxis: 1},{xAxis: new Date('8/31/2020'), yAxis: 2},{xAxis: new Date('9/01/2020'), yAxis: 1},{xAxis: new Date('9/02/2020'), yAxis: 1},{xAxis: new Date('9/03/2020'), yAxis: 1},{xAxis: new Date('9/04/2020'), yAxis: 0},{xAxis: new Date('9/05/2020'), yAxis: 0},{xAxis: new Date('9/06/2020'), yAxis: 0}<br/>];</span></pre><h2 id="28e9" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">演示组件</h2><p id="bb6c" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们只需要从<strong class="ke ir"> data.ts </strong>中提取数据，然后让它可以被我们的<strong class="ke ir">demo.component.html</strong>文件访问，该文件实际上调用了我们的图表组件。打开<strong class="ke ir"> demo.component.ts </strong>并用以下内容替换内容:</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="44d0" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">import { Component, OnInit } from '@angular/core';<br/>import { ChartSeries } from '~app/feature/chart/chart';<br/>import { DATA } from './data';</strong></span><span id="1081" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">@Component({<br/>  selector: 'app-demo',<br/>  templateUrl: './demo.component.html',<br/>  styleUrls: ['./demo.component.scss']<br/>})<br/>export class DemoComponent implements OnInit {</strong></span><span id="acd4" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    public data: ChartSeries[] = DATA;</strong></span><span id="fc2e" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    constructor() { }</strong></span><span id="8fce" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">    ngOnInit(): void {}</strong></span><span id="11cc" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">}</strong></span></pre><h2 id="7d85" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">demo.component.html</h2><p id="576d" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">现在让我们来显示迷你图。我们会把它包起来，让它更显眼。我们将在下一节中设计这些样式。注意我们是如何将<strong class="ke ir"> [data]="data" </strong>发送到app-chart组件的。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="4f16" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">&lt;div class="card"&gt;<br/>  &lt;div class="card-content"&gt;<br/>    &lt;h1&gt;5,835&lt;/h1&gt;<br/>    &lt;h4 class="color-grey"&gt;COVID-19 Related Deaths in Sweden&lt;/h4&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="card-footer"&gt;<br/>    &lt;div class="sparkline-wrapper"&gt;<br/>      &lt;app-chart [data]="data"&gt;&lt;/app-chart&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</strong></span></pre><h1 id="877e" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">风格</h1><p id="8dea" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">所有这些工作都很棒，但是除非它们看起来很吸引人，否则我们为什么会在这里？我说的对吗？让我们在<strong class="ke ir"> src </strong>目录的根目录下打开<strong class="ke ir"> styles.scss </strong>文件。</p><blockquote class="lc ld le"><p id="c0a6" class="kc kd la ke b kf kg kh ki kj kk kl km lf ko kp kq lg ks kt ku lh kw kx ky kz ij bi translated"><strong class="ke ir">抬头！</strong> <br/>如果您在生成Angular项目时没有指定<code class="fe ml mm mn mo b"><strong class="ke ir">--style scss</strong></code>，那么您将根据您在那里的选择来查找<strong class="ke ir"> styles.css、styles.less或styles.sass </strong>。如果您根本没有指定<code class="fe ml mm mn mo b"><strong class="ke ir">--style</strong></code>，那么您将会寻找<strong class="ke ir"> styles.css </strong></p></blockquote><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="1385" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">@import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;800&amp;display=swap');</strong></span><span id="ae9a" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">:root {<br/>  font-family: 'Open Sans', sans-serif;<br/>  font-size: 12px;<br/>}</strong></span><span id="6440" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">h1, h2, h3, h4, h5, h6 {<br/>  margin: 0px;<br/>  padding: 0px;<br/>}</strong></span><span id="b99b" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">h1 {<br/>  font-size: 3.4em;<br/>}</strong></span><span id="d887" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">h4 {<br/>  font-weight: 600;<br/>}</strong></span><span id="675a" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">.card {<br/>  align-content: flex-start;<br/>  align-items: flex-start;<br/>  border-radius: 8px;<br/>  box-shadow: 0 0 8px 0 rgba(40, 40, 40, .3);<br/>  display: flex;<br/>  flex: 1 0 300px;<br/>  flex-flow: row wrap;<br/>  height: auto;<br/>  justify-content: flex-start;<br/>  padding: 16px;<br/>  position: relative;<br/>  width: 300px;<br/>}</strong></span><span id="b523" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">.card-content {<br/>  width: 100%;<br/>}</strong></span><span id="ee52" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">.card-footer {<br/>  margin-top: 16px;<br/>  width: 100%;<br/>}</strong></span><span id="955f" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">.color-grey {<br/>  color: rgba(140, 140, 140, 1);<br/>}</strong></span><span id="2c97" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">.sparkline-wrapper {<br/>  align-self: flex-end;<br/>  display: flex;<br/>  height: 50px;<br/>  min-height: 50px;<br/>  width: 100%;<br/>}</strong></span></pre><h1 id="db5f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">应用</h1><p id="50db" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">最后，我们需要设置更多的项目，如样式和路由(这样我们就可以进入我们的演示组件)。</p><h2 id="57f4" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">app-routing.module.ts</h2><p id="25ba" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">让我们打开位于<strong class="ke ir">app/app-routing . module . ts</strong>的<strong class="ke ir"> app-routing.module.ts </strong>文件，设置我们的路线并默认为演示组件。路由超出了本文的范围，所以如果您不确定这里发生了什么，我建议您阅读Angular Router。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="4f1e" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">import { NgModule } from '@angular/core';<br/>import { Routes, RouterModule } from '@angular/router';</strong></span><span id="e247" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">import { DemoComponent } from '~app/feature/demo/demo.component';</strong></span><span id="788f" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">const routes: Routes = [<br/>  {<br/>    path: '',<br/>    pathMatch: 'full',<br/>    redirectTo: 'demo',<br/>  },<br/>  {<br/>    component: DemoComponent,<br/>    path: 'demo'<br/>  }<br/>];</strong></span><span id="eaa7" class="mp lj iq mo b gy ob nk l nl nm"><strong class="mo ir">@NgModule({<br/>  imports: [RouterModule.forRoot(routes)],<br/>  exports: [RouterModule]<br/>})<br/>export class AppRoutingModule { }</strong></span></pre><h2 id="483e" class="mp lj iq bd lk mq mr dn lo ms mt dp ls kn mu mv lw kr mw mx ma kv my mz me na bi translated">app.component.html</h2><p id="d51f" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">我们将清除我们的<strong class="ke ir"> app/app.component.html </strong>文件中的所有无意义内容，并用一个简单的liner替换它。不，真的，这就是我们想要的文件。</p><pre class="nb nc nd ne gt nf mo ng nh aw ni bi"><span id="c064" class="mp lj iq mo b gy nj nk l nl nm"><strong class="mo ir">&lt;router-outlet&gt;&lt;/router-outlet&gt;</strong></span></pre><h1 id="85be" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">成品</h1><p id="c36c" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">如果一切顺利，当你加载你的应用程序时，你会看到一个漂亮的带迷你图的小卡片(通常是<a class="ae lb" href="http://localhost:4200)." rel="noopener ugc nofollow" target="_blank"><strong class="ke ir">http://localhost:4200</strong>)。</a></p><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/f12e4a2c4778bedd4058a659656cfa93.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*d7nbXbBDGzTZcrZCJbbitg.png"/></div></figure><h1 id="f0b3" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">Git储存库</h1><p id="89bd" class="pw-post-body-paragraph kc kd iq ke b kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz ij bi translated">你可以在github这里访问完整的项目:<a class="ae lb" href="https://github.com/johnathanesanders/angular-d3-sparkline" rel="noopener ugc nofollow" target="_blank">https://github.com/johnathanesanders/angular-d3-sparkline</a></p><p id="0d2a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">感谢阅读！</strong></p><p id="e1f3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="la">写字板配图表照片由</em> <a class="ae lb" href="https://www.pexels.com/@wdnet?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <em class="la"> PhotoMIX公司</em> </a> <em class="la">从</em> <a class="ae lb" href="https://www.pexels.com/photo/black-samsung-tablet-computer-106344/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <em class="la"> Pexels </em> </a></p></div></div>    
</body>
</html>