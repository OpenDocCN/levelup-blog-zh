<html>
<head>
<title>CSS variables and web components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CSS变量和web组件</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/css-variables-and-web-components-7aaae8d4c6ab?source=collection_archive---------5-----------------------#2020-02-24">https://levelup.gitconnected.com/css-variables-and-web-components-7aaae8d4c6ab?source=collection_archive---------5-----------------------#2020-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/821949747baea441ceec92080417d0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fensSvh0xlMa4HMkL2hBw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@pankajpatel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">潘卡杰·帕特尔</a>在<a class="ae kf" href="https://unsplash.com/s/photos/css?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="6dc0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CSS变量或自定义属性是由CSS开发人员定义的值，包含将在整个文档中重用的特定值。</p><p id="d841" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们是使用自定义属性表示法设置的。</p><p id="1efd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b"><strong class="ki iu">--primary-text-color: black;</strong></code></p><p id="10b2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并使用<code class="fe le lf lg lh b"><a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/CSS/var" rel="noopener ugc nofollow" target="_blank">var()</a></code>函数进行访问。</p><p id="6bff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">color: <strong class="ki iu">var(--primary-text-color, #333333)</strong>;</code></p><p id="1ca4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">var()</code>的第二个输入是默认值，如果变量未定义或浏览器不支持CSS变量，则考虑该值。</p><p id="b085" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们一直在使用web组件开发一个遵循微前端架构的应用程序。有一个主shell应用程序在运行时处理路由和提取正确的微应用程序。微应用程序是独立的，用Angular、Vue和Polymer(使用web组件构建Web应用程序的开源JavaScript库)开发。</p><p id="dcca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，每个微应用程序都使用一个核心库，其中包含各种可重用的web组件，如Alerts、Spinner、Card、Datatable等。</p><p id="f6e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有一个特性是从主题列表中设置整个应用程序的主题。此外，用户可以创建自己的主题。主要的挑战是如何从shell应用程序或任何微应用程序中改变web组件的样式，因为web组件有自己的影子DOM。影子DOM用于封装。它允许组件拥有自己的“影子”DOM树，不能从主文档中访问，可能有本地样式规则，等等。</p><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi li"><img src="../Images/c59cd9eac8daf18aaf296605d3847441.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*BTxZ6x84QCQhalEfiuo9qQ.png"/></div></figure><p id="2566" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对我来说，CSS变量成了救星，因为它们可以穿透影子DOM，可以应用于Web组件中的节点。</p><p id="eb99" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我们如何实现它的一个例子。</p><p id="a500" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经在shell应用程序中定义了各种CSS变量。</p><pre class="lj lk ll lm gt ln lh lo lp aw lq bi"><span id="0cac" class="lr ls it lh b gy lt lu l lv lw">:root {</span><span id="e63d" class="lr ls it lh b gy lx lu l lv lw">--primary-text-color: #fff;<br/>--primary-background-color: #ededed;<br/>--secondary-text-color: #53565;<br/>--secondary-background-color:   #cccbcb;</span><span id="05f5" class="lr ls it lh b gy lx lu l lv lw">}</span></pre><p id="ca96" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在web组件中(使用<a class="ae kf" href="https://github.com/vuejs/vue-web-component-wrapper" rel="noopener ugc nofollow" target="_blank">@ Vue/we B- component-wrapper</a>库将Vue类包装到web组件中)。</p><p id="52f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">具有两个属性type和label的按钮组件。</p><pre class="lj lk ll lm gt ln lh lo lp aw lq bi"><span id="bda4" class="lr ls it lh b gy lt lu l lv lw"><strong class="lh iu">//Button.vue</strong></span><span id="f933" class="lr ls it lh b gy lx lu l lv lw">&lt;template&gt;</span><span id="c63a" class="lr ls it lh b gy lx lu l lv lw">  &lt;button class="btn" :class="[type]"&gt;{{label}}&lt;/button&gt;</span><span id="9045" class="lr ls it lh b gy lx lu l lv lw">&lt;/template&gt;</span><span id="75c0" class="lr ls it lh b gy lx lu l lv lw">&lt;script&gt;<br/>  export default {</span><span id="56bf" class="lr ls it lh b gy lx lu l lv lw">    props:{<br/>      label:String,<br/>      type: String,<br/>  }<br/>}</span><span id="b4e9" class="lr ls it lh b gy lx lu l lv lw">&lt;/script&gt;</span><span id="e784" class="lr ls it lh b gy lx lu l lv lw">&lt;style&gt;<br/>.btn {<br/>  display: inline-block;<br/>  font-weight: 400;<br/>  text-align: center;<br/>  white-space: nowrap;<br/>  vertical-align: middle;<br/>  border: 1px solid transparent;<br/>  padding: .375rem .75rem;<br/>  font-size: 1rem;<br/>  line-height: 1.5;<br/>  border-radius: .15rem;<br/>  transition: color .15s ease-in-out,background-color .15s ease-in-  out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;<br/>  margin: 0;<br/>  overflow: visible;<br/>}</span><span id="5163" class="lr ls it lh b gy lx lu l lv lw">.primary {<br/>  color: var(--primary-text-color,#f4f4f4);<br/>  background-color: var(--primary-background-color,#49d597);<br/>  border-color:  var(--primary-background-color,#49d597);<br/>}</span><span id="df5f" class="lr ls it lh b gy lx lu l lv lw">.secondary {<br/>  color: var(--secondary-text-color,#f1f1f1);<br/>  background-color: var(--secondary-background-color,#32c547);<br/>  border-color:  var(--secondary-background-color,#32c547);<br/>}</span></pre><p id="d128" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<strong class="ki iu">@ Vue/we B- component-wrapper</strong>将Vue按钮组件包装并注册为自定义元素。</p><pre class="lj lk ll lm gt ln lh lo lp aw lq bi"><span id="c4a9" class="lr ls it lh b gy lt lu l lv lw">import Vue from 'vue';<br/>import wrap from ‘@vue/web-component-wrapper’;<br/>import Button from './components/Button.vue';</span><span id="1858" class="lr ls it lh b gy lx lu l lv lw">const button = wrap(Vue, Button);<br/>window.customElements.define('wc-button', button);</span></pre><p id="0845" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">按钮web组件的用法如下:</p><pre class="lj lk ll lm gt ln lh lo lp aw lq bi"><span id="6152" class="lr ls it lh b gy lt lu l lv lw">//In Vue app<br/>&lt;wc-button type="primary" @click="save()" label="Save"&gt;&lt;/wc-button&gt;<br/>&lt;wc-button type="secondary" @click="reset()" label="Reset"&gt;&lt;/wc-button&gt;</span><span id="2aeb" class="lr ls it lh b gy lx lu l lv lw">//In angular app<br/>&lt;wc-button type="primary" (click)="save()" label="Save"&gt;&lt;/wc-button&gt;<br/>&lt;wc-button type="secondary" (click)="reset()" label="Reset"&gt;&lt;/wc-button&gt;</span><span id="d22b" class="lr ls it lh b gy lx lu l lv lw">//In plain JS<br/>&lt;wc-button type="primary" onclick="save()" label="Save"&gt;&lt;/wc-button&gt;<br/>&lt;wc-button type="secondary" onclick="reset()" label="Reset"&gt;&lt;/wc-button&gt;</span></pre><p id="8c67" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我们如何根据用户选择的主题改变CSS变量的代码。这里我们选择文档的根元素，并使用样式的<code class="fe le lf lg lh b">setProperty()</code>方法更改变量值。</p><p id="d345" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们更改变量的值时，它会应用于文档中使用该特定自定义属性的所有DOM元素。</p><pre class="lj lk ll lm gt ln lh lo lp aw lq bi"><span id="541c" class="lr ls it lh b gy lt lu l lv lw">userSelectedtheme = {<br/> name : "Navy Blue",<br/> properties: [<br/>    { key: "--primary-background-color", value: "#d2c5ce" },<br/>    { key: "--primary-text-color", value: "#3e3a3a" },<br/>    { key: "--secondary-background-color", value: "#504d4d" },<br/>    { key: "--secondary-text-color", value: "#4c3b3a" },<br/>]}</span><span id="9bed" class="lr ls it lh b gy lx lu l lv lw">userSelectedtheme.properties.forEach(property =&gt; {<br/>  document.documentElement.style.setProperty (<br/>    property.key,<br/>    property.value<br/>  );<br/>});</span></pre><p id="f72e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嘣，就这些了，我们完成了…谢谢你的时间…:)</p></div></div>    
</body>
</html>