<html>
<head>
<title>How to Print on a Bluetooth Printer Using Your Ionic Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Ionic应用程序在蓝牙打印机上打印</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-print-on-a-bluetooth-printer-using-your-ionic-application-ceabc45abf75?source=collection_archive---------1-----------------------#2020-01-30">https://levelup.gitconnected.com/how-to-print-on-a-bluetooth-printer-using-your-ionic-application-ceabc45abf75?source=collection_archive---------1-----------------------#2020-01-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/57f440469fcbe0907494e507564a8f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*rf_TyFtf8azHM8GTYDaX1w.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">Ionic +蓝牙收据打印机</figcaption></figure><p id="7efb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你有一个蓝牙收据打印机，你想知道，我如何使用我的Ionic应用程序？</p><p id="3375" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我搜遍了万维网，寻找如何不走运地做到这一点的答案。这里的方法适用于几乎所有类型的蓝牙收据打印机。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="961d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我假设你是Ionic开发人员，所以我将跳过安装Ionic的部分。如果你想知道如何安装Ionic，我推荐你去Ionic网站<a class="ae lg" href="https://www.ionicframework.com" rel="noopener ugc nofollow" target="_blank">看看。</a></p><p id="b724" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">请注意:</strong>在撰写本文时，这应该对Ionic 4和Ionic 5都有效。</p><h2 id="c8f9" class="lh li it bd lj lk ll dn lm ln lo dp lp km lq lr ls kq lt lu lv ku lw lx ly lz bi translated"><strong class="ak">启动和设置</strong></h2><ol class=""><li id="8f59" class="ma mb it kd b ke mc ki md km me kq mf ku mg ky mh mi mj mk bi translated">开始一个离子项目</li></ol><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="6572" class="lh li it mq b gy mu mv l mw mx">ionic start myPrintApp</span></pre><p id="df27" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2.选择角度</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4d85" class="lh li it mq b gy mu mv l mw mx"><strong class="mq iu">Pick a framework! 😁</strong></span><span id="b34f" class="lh li it mq b gy my mv l mw mx">Please select the JavaScript framework to use for your new app. To bypass this</span><span id="1a53" class="lh li it mq b gy my mv l mw mx">prompt next time, supply a value for the --type option.</span><span id="398c" class="lh li it mq b gy my mv l mw mx">? <strong class="mq iu">Framework:</strong> (Use arrow keys)</span><span id="c494" class="lh li it mq b gy my mv l mw mx">❯ Angular | https://angular.io</span><span id="341f" class="lh li it mq b gy my mv l mw mx">React   | https://reactjs.org</span></pre><p id="ddde" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">选择您想要的任何模板</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="7190" class="lh li it mq b gy mu mv l mw mx">? <strong class="mq iu">Framework:</strong> Angular</span><span id="3d28" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">Let's pick the perfect starter template! 💪</strong></span><span id="5ab5" class="lh li it mq b gy my mv l mw mx">Starter templates are ready-to-go Ionic apps that come packed with everything you need to build your</span><span id="3c49" class="lh li it mq b gy my mv l mw mx">app. To bypass this prompt next time, supply template, the second argument to ionic start.</span><span id="792f" class="lh li it mq b gy my mv l mw mx">? <strong class="mq iu">Starter template:</strong> (Use arrow keys)</span><span id="4255" class="lh li it mq b gy my mv l mw mx">❯ tabs         | A starting project with a simple tabbed interface</span><span id="b1b8" class="lh li it mq b gy my mv l mw mx">sidemenu     | A starting project with a side menu with navigation in the content area</span><span id="d6af" class="lh li it mq b gy my mv l mw mx">blank        | A blank starter project</span><span id="7579" class="lh li it mq b gy my mv l mw mx">my-first-app | An example application that builds a camera with gallery</span><span id="c2ba" class="lh li it mq b gy my mv l mw mx">conference   | A kitchen-sink application that shows off all Ionic has to offer</span></pre><p id="2e82" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">3.创建应用程序后，<code class="fe mz na nb mq b">cd</code>进入目录并创建新服务。姑且称之为‘打印’:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="b3ce" class="lh li it mq b gy mu mv l mw mx">ionic g service services/print</span></pre><p id="ef8c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">4.您还需要安装科尔多瓦蓝牙系列。</p><p id="381f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">运行此行:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4632" class="lh li it mq b gy mu mv l mw mx">ionic cordova plugin add cordova-plugin-bluetooth-serial</span></pre><p id="7193" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">….然后这一行:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="5310" class="lh li it mq b gy mu mv l mw mx">npm install @ionic-native/bluetooth-serial</span></pre><p id="82cf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">像这样将<code class="fe mz na nb mq b">BluetoothSerial </code>添加到<code class="fe mz na nb mq b">app.module.ts</code>的提供者中(我添加的内容以<strong class="kd iu">粗体显示</strong>):</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="5dbe" class="lh li it mq b gy mu mv l mw mx">import {BluetoothSerial} from '@ionic-native/bluetooth-serial/ngx';</span><span id="08b6" class="lh li it mq b gy my mv l mw mx">@NgModule({<br/>  declarations: [AppComponent],<br/>  entryComponents: [],<br/>  imports: [...],<br/>  providers: [<br/>    StatusBar,<br/>    SplashScreen,<br/>    { provide: RouteReuseStrategy, useClass: IonicRouteStrategy },<br/>    <strong class="mq iu">BluetoothSerial</strong><br/>  ],<br/>  bootstrap: [AppComponent]</span></pre><p id="935c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">设置完成！现在进入下一部分，在你的“打印”服务中编写代码来处理所有的蓝牙连接。</p><h2 id="9ab0" class="lh li it bd lj lk ll dn lm ln lo dp lp km lq lr ls kq lt lu lv ku lw lx ly lz bi translated"><strong class="ak">准备您的“打印”服务</strong></h2><ol class=""><li id="f5bf" class="ma mb it kd b ke mc ki md km me kq mf ku mg ky mh mi mj mk bi translated">打开您的IDE并找到“打印”服务文件，它应该在service文件夹中。这里您要做的是首先将蓝牙串口导入到您的代码中:</li></ol><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="2560" class="lh li it mq b gy mu mv l mw mx">import { BluetoothSerial } from '@ionic-native/bluetooth-serial/ngx';</span></pre><p id="3ab1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您还需要在您的构造函数中添加<code class="fe mz na nb mq b">BluetoothSerial</code>，如下所示:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="c429" class="lh li it mq b gy mu mv l mw mx">constructor(public btSerial:BluetoothSerial){</span><span id="6ff3" class="lh li it mq b gy my mv l mw mx">}</span></pre><p id="98b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2.接下来，您需要创建4个不同的函数来:</p><blockquote class="nc nd ne"><p id="6f21" class="kb kc nf kd b ke kf kg kh ki kj kk kl ng kn ko kp nh kr ks kt ni kv kw kx ky im bi translated">a.搜索蓝牙打印机</p><p id="9270" class="kb kc nf kd b ke kf kg kh ki kj kk kl ng kn ko kp nh kr ks kt ni kv kw kx ky im bi translated">b.连接到蓝牙打印机</p><p id="8d5c" class="kb kc nf kd b ke kf kg kh ki kj kk kl ng kn ko kp nh kr ks kt ni kv kw kx ky im bi translated">c.向蓝牙打印机发送数据</p><p id="cd8c" class="kb kc nf kd b ke kf kg kh ki kj kk kl ng kn ko kp nh kr ks kt ni kv kw kx ky im bi translated">d.断开蓝牙打印机</p></blockquote><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="85ee" class="lh li it mq b gy mu mv l mw mx">searchBluetoothPrinter()<br/>{</span><span id="e105" class="lh li it mq b gy my mv l mw mx">//This will return a list of bluetooth devices</span><span id="b3c5" class="lh li it mq b gy my mv l mw mx">   return this.btSerial.list(); <br/>}</span><span id="a438" class="lh li it mq b gy my mv l mw mx">connectToBluetoothPrinter(macAddress)<br/>{<br/>//This will connect to bluetooth printer via the mac address provided</span><span id="a79d" class="lh li it mq b gy my mv l mw mx">   return this.btSerial.connect(macAddress)</span><span id="2367" class="lh li it mq b gy my mv l mw mx">}</span><span id="9054" class="lh li it mq b gy my mv l mw mx">disconnectBluetoothPrinter()<br/>{<br/>//This will disconnect the current bluetooth connection</span><span id="76fe" class="lh li it mq b gy my mv l mw mx">   return this.btSerial.disconnect();</span><span id="c4e3" class="lh li it mq b gy my mv l mw mx">}</span><span id="f22a" class="lh li it mq b gy my mv l mw mx">//macAddress-&gt;the device's mac address <br/>//data_string-&gt; string to be printer</span><span id="4f71" class="lh li it mq b gy my mv l mw mx">sendToBluetoothPrinter(macAddress,data_string)<br/>{<br/>   //1. Try connecting to bluetooth printer</span><span id="a719" class="lh li it mq b gy my mv l mw mx">   this.connectToBluetoothPrinter(macAddress)<br/>   .subscribe(_=&gt;{</span><span id="5382" class="lh li it mq b gy my mv l mw mx">      //2. Connected successfully<br/>      this.btSerial.write(data_string)<br/>      .then(_=&gt;{</span><span id="4b1a" class="lh li it mq b gy my mv l mw mx">       //3. Print successful<br/>       //If you want to tell user print is successful,<br/>       //handle it here</span><span id="351b" class="lh li it mq b gy my mv l mw mx">       //4. IMPORTANT! Disconnect bluetooth after printing</span><span id="2ff7" class="lh li it mq b gy my mv l mw mx">       this.disconnectBluetoothPrinter()</span><span id="2b32" class="lh li it mq b gy my mv l mw mx">       },err=&gt;{</span><span id="6c4a" class="lh li it mq b gy my mv l mw mx">         //If there is an error printing to bluetooth printer<br/>         //handle it here</span><span id="2c14" class="lh li it mq b gy my mv l mw mx">       })</span><span id="0e58" class="lh li it mq b gy my mv l mw mx">   },err=&gt;{<br/>     <br/>     //If there is an error connecting to bluetooth printer<br/>     //handle it here</span><span id="bc51" class="lh li it mq b gy my mv l mw mx">   })</span><span id="4f0f" class="lh li it mq b gy my mv l mw mx">}</span></pre><p id="9dca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">3.在将上述四个功能都插入到您的“打印”服务中之后，下一步就是对其进行测试。我建议在您的home.page.ts和home.page.ts上试用一下，看看效果如何:</p><p id="2da4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在home.page.ts中，增加了<strong class="kd iu">粗体</strong>的行:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="1dfe" class="lh li it mq b gy mu mv l mw mx">import { Component } from '@angular/core';</span><span id="bdb2" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">import { PrintService } from '../service/print/print.service';</strong></span><span id="b8aa" class="lh li it mq b gy my mv l mw mx">@Component({</span><span id="28b5" class="lh li it mq b gy my mv l mw mx">  selector: 'app-home',</span><span id="5870" class="lh li it mq b gy my mv l mw mx">  templateUrl: 'home.page.html',</span><span id="8387" class="lh li it mq b gy my mv l mw mx">  styleUrls: ['home.page.scss'],</span><span id="66f6" class="lh li it mq b gy my mv l mw mx">})</span><span id="fbc1" class="lh li it mq b gy my mv l mw mx">export class HomePage {</span><span id="0c74" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">  bluetoothList:any=[];<br/>  selectedPrinter:any;</strong></span><span id="1c52" class="lh li it mq b gy my mv l mw mx">  constructor(<strong class="mq iu">private print:PrintService</strong>) {}</span><span id="05ab" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">    //This will list all of your bluetooth devices<br/>    listPrinter() { <br/>      this.print.searchBluetoothPrinter()<br/>       .then(resp=&gt;{<br/>   <br/><em class="nf">        //List of bluetooth device list<br/></em>        this.bluetoothList=resp;</strong></span><span id="c15e" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">    });</strong></span><span id="87f2" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">}<br/></strong></span><span id="8067" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">//This will store selected bluetooth device mac address<br/>selectPrinter(macAddress)<br/>{<br/>  <em class="nf">//Selected printer macAddress stored here<br/>  </em>this.selectedPrinter=macAddress;<br/>}<br/></strong></span><span id="a246" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu"><br/>//This will print<br/>printStuff()<br/>{  </strong></span><span id="4ad7" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu"><em class="nf">   //The text that you want to print<br/></em>   var myText="Hello hello hello \n\n\n This is a test \n\n\n";</strong></span><span id="13fc" class="lh li it mq b gy my mv l mw mx"><strong class="mq iu">   this.print.sendToBluetoothPrinter(this.selectedPrinter,myText);<br/>}</strong></span><span id="4f23" class="lh li it mq b gy my mv l mw mx">}</span></pre><p id="2e31" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">home.page.html内部<code class="fe mz na nb mq b">&lt;ion-content&gt;</code></p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4111" class="lh li it mq b gy mu mv l mw mx">&lt;ion-list&gt;</span><span id="c48c" class="lh li it mq b gy my mv l mw mx">&lt;ion-item *ngFor="let item of bluetoothList" (click)="selectPrinter(item.id)"&gt;</span><span id="481d" class="lh li it mq b gy my mv l mw mx">    {{item.name}} {{item.id}}</span><span id="cda8" class="lh li it mq b gy my mv l mw mx">&lt;/ion-item&gt;</span><span id="ccee" class="lh li it mq b gy my mv l mw mx">&lt;/ion-list&gt;</span><span id="532e" class="lh li it mq b gy my mv l mw mx">&lt;div&gt;</span><span id="844a" class="lh li it mq b gy my mv l mw mx">    Selected Printer: {{selectedPrinter}}</span><span id="7ec6" class="lh li it mq b gy my mv l mw mx">&lt;/div&gt;</span><span id="735c" class="lh li it mq b gy my mv l mw mx">&lt;ion-button expand="full" color="danger" *ngIf='selectedPrinter' (click)="printStuff()"&gt;</span><span id="fbe8" class="lh li it mq b gy my mv l mw mx">PRINT!</span><span id="fcd7" class="lh li it mq b gy my mv l mw mx">&lt;/ion-button&gt;</span></pre><p id="0600" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您的应用程序应该如下所示:</p><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi nj"><img src="../Images/fa100e3ee8af8ae2f80bf538f11718ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BcuJtm--tQ6PCUBNrs7Nww.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">你的home.page.html应该是什么样子</figcaption></figure><p id="5edd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">4.显然，您不能在浏览器中尝试这段代码。你需要把这变成一个完整的Android或iOS应用程序。或者，您也可以使用Ionic DevApp。要使用Ionic DevApp，请确保您的设备上安装了<a class="ae lg" href="https://ionicframework.com/docs/appflow/devapp" rel="noopener ugc nofollow" target="_blank"> Ionic DevApp </a>。要使用Ionic DevApp运行它，请执行以下命令，并确保您的设备和开发计算机在同一个网络上:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4558" class="lh li it mq b gy mu mv l mw mx">ionic serve --devapp</span></pre><p id="1d2c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">5.你现在需要做的就是选择你的打印机，然后按“打印”。你应该可以在你的蓝牙打印机上打印。</p><p id="0485" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">给你。这就是你如何用Ionic编写一个通过蓝牙打印机打印的应用程序。要了解更多信息，请查看我的Github(尽管是一个过时的版本)，那里有这段代码的存储库:</p><div class="no np gp gr nq nr"><a href="http://github.com/razmans" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">拉兹曼斯-概述</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">在GitHub上注册你自己的个人资料，这是托管代码、管理项目和构建软件的最佳地方…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of jv nr"/></div></div></a></div><p id="6f76" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">* *注意:更新后在app.module.ts 中添加了<strong class="kd iu">提供程序，我忽略了这一点，对此表示歉意。特别感谢<a class="og oh ep" href="https://medium.com/u/303db23a7989?source=post_page-----ceabc45abf75--------------------------------" rel="noopener" target="_blank">伊曼纽·贝内代蒂</a>指出这一点。作为对她第二点的回应，home.page.html境内的打印机列表在上面的*ngFor中。</strong></p></div></div>    
</body>
</html>