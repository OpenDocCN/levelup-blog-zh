<html>
<head>
<title>How to make HTTP requests with Flutter and parse JSON result data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Flutter发出HTTP请求并解析JSON结果数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-make-http-requests-with-flutter-and-parse-json-result-data-ae1f5794f53?source=collection_archive---------4-----------------------#2022-03-18">https://levelup.gitconnected.com/how-to-make-http-requests-with-flutter-and-parse-json-result-data-ae1f5794f53?source=collection_archive---------4-----------------------#2022-03-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5581" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">利用REST APIs</h2><div class=""/><div class=""><h2 id="b33f" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">这篇短文展示了如何从Flutter应用程序中执行HTTP请求。我们来看看最常见的请求类型GET、POST、PUT和DELETE。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/da6f8ac8f567bae8de718a3bb5021d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRpWBnsGBTXFASmQmk7UHA.png"/></div></div></figure><p id="2759" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">执行HTTP请求是现在每个app的必备。在本文中，我将向您展示如何将这一功能添加到您的Flutter应用程序中。我们将看一下完成这个任务的两个包:http包和dio包。它们非常相似，你可以使用你更喜欢的任何东西。最后，我们将重点放在解析来自请求的JSON结果，以便数据可以在我们的应用程序中使用。</p><p id="24c8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果你对安装第三方软件包不熟悉，可以看看我写的关于这个主题的文章。</p><div class="ma mb gp gr mc md"><a href="https://xeladu.medium.com/how-to-install-packages-in-your-flutter-app-e7f7e62711ee" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">如何在你的Flutter应用中安装包</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">这篇短文展示了如何将包添加到一个Flutter应用程序中，这样你就可以使用现有的代码并加速…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">xeladu.medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr lb md"/></div></div></a></div><h2 id="1e25" class="ms mt it bd mu mv mw dn mx my mz dp na lm nb nc nd lq ne nf ng lu nh ni nj iz bi translated">HTTP包</h2><p id="eec5" class="pw-post-body-paragraph ld le it lf b lg nk kd li lj nl kg ll lm nm lo lp lq nn ls lt lu no lw lx ly im bi translated">使用http包非常简单。通过在顶部添加<br/> <code class="fe np nq nr ns b">import 'package:http/http.dart'</code>将其导入到您的文件中。然后您可以访问所有需要的http函数。参见下面的用法示例。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="41e2" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您可以看到方法<code class="fe np nq nr ns b">GET</code>、<code class="fe np nq nr ns b">POST</code>、<code class="fe np nq nr ns b">PUT</code>和<code class="fe np nq nr ns b">DELETE</code>的例子。这些是最常见的，所以我们将重点放在他们身上。</p><p id="6f8f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">每个调用都返回一个包含请求执行细节的<code class="fe np nq nr ns b">Response</code>对象。它包含类似<code class="fe np nq nr ns b">statusCode</code>、<code class="fe np nq nr ns b">contentLength,</code>或<code class="fe np nq nr ns b">reasonPhrase</code>的属性，以防出现故障。关于状态代码的细节将在下一节讨论。</p><p id="9d2b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe np nq nr ns b">response.body</code>包含一个带有请求返回值的字符串。要用它做一个镖<code class="fe np nq nr ns b">Map&lt;String, dynamic&gt;</code>，使用<code class="fe np nq nr ns b">jsonDecode</code>功能。</p><h2 id="0cd7" class="ms mt it bd mu mv mw dn mx my mz dp na lm nb nc nd lq ne nf ng lu nh ni nj iz bi translated">DIO套餐</h2><p id="62b5" class="pw-post-body-paragraph ld le it lf b lg nk kd li lj nl kg ll lm nm lo lp lq nn ls lt lu no lw lx ly im bi translated">Dio非常类似于http包。首先用<code class="fe np nq nr ns b">import 'package:dio/dio.dart'</code>导入。然后你可以访问</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="05db" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">每个调用都返回一个带有请求执行细节的<code class="fe np nq nr ns b">Response</code>对象。包含<code class="fe np nq nr ns b">statusCode</code>、<code class="fe np nq nr ns b">headers,</code>或<code class="fe np nq nr ns b">statusMessage</code>等属性，以备故障时使用。关于状态代码的细节将在下一节讨论。</p><p id="315f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><code class="fe np nq nr ns b">response.data</code>包含一个带有请求返回值的动态对象。要用它做一个飞镖<code class="fe np nq nr ns b">Map&lt;String, dynamic&gt;</code>，你只需要用<code class="fe np nq nr ns b">as</code>操作符把它转换成那个类型。</p><h2 id="84b5" class="ms mt it bd mu mv mw dn mx my mz dp na lm nb nc nd lq ne nf ng lu nh ni nj iz bi translated">HTTP状态代码</h2><p id="28a3" class="pw-post-body-paragraph ld le it lf b lg nk kd li lj nl kg ll lm nm lo lp lq nn ls lt lu no lw lx ly im bi translated">为了验证请求的正确执行，您可以评估返回响应的状态代码。在调试应用程序时，这给了你一个很好的提示(有时甚至是确切的错误)。所有状态代码的完整列表可以在<a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" rel="noopener ugc nofollow" target="_blank"> Mozilla开发者网络</a>找到。我来介绍一下最常见的。</p><p id="fed2" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">简单规则:200–299✅，其他都是❌</p><p id="6112" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd">200 OK</strong>T12】请求成功。任何方法都可以返回这个代码。</p><p id="89d1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 201创建</strong> <br/>请求成功，新的资源被创建。通常由<code class="fe np nq nr ns b">POST</code>或<code class="fe np nq nr ns b">PUT</code>请求返回。</p><p id="d134" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 204无内容<br/> </strong>请求未返回数据，但表示执行成功。</p><p id="9c17" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 400错误请求<br/> </strong>服务器无法处理客户端数据。如果数据以错误的格式发送或者所需的数据丢失，这种情况通常会发生。有关详细信息，请查看错误消息。</p><p id="e53c" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 401未授权</strong> <br/>在服务器处理请求之前，客户端需要对自己进行身份验证。请求中可能缺少带有标识符的头字段。</p><p id="fd3e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 403禁止</strong> <br/>客户端无权执行此操作。</p><p id="0499" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 404找不到</strong> <br/>服务器找不到请求的资源。</p><p id="d5ad" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jd"> 500内部服务器错误</strong> <br/>出现一种情况，服务器无法处理。这通常是由于服务器端的编程错误造成的。</p><h2 id="661d" class="ms mt it bd mu mv mw dn mx my mz dp na lm nb nc nd lq ne nf ng lu nh ni nj iz bi translated">解析JSON结果</h2><p id="1be3" class="pw-post-body-paragraph ld le it lf b lg nk kd li lj nl kg ll lm nm lo lp lq nn ls lt lu no lw lx ly im bi translated">如果您想使用定制对象而不是<code class="fe np nq nr ns b">Map&lt;String, dynamic&gt;</code>，您可以用一种快速简单的方式转换JSON。让我们假设，被查询的API返回以下JSON:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8eee" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">成功映射数据需要创建的类如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="6a4e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这可能非常讨厌和无聊，当然，还有更复杂的场景，如对象列表或嵌套对象。如果您想深入解析这个主题，可以查看这篇详细解释了所有内容的文章。</p><div class="ma mb gp gr mc md"><a href="https://medium.com/flutter-community/parsing-complex-json-in-flutter-747c46655f51" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">在Flutter中解析复杂的JSON</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">在Flutter中使用内置的dart:convert库解析不同类型的简单和复杂JSON结构</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="nv l mo mp mq mm mr lb md"/></div></div></a></div><p id="d180" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">💡但是，快速的方法是使用<a class="ae lz" href="https://app.quicktype.io/" rel="noopener ugc nofollow" target="_blank"> quicktype </a>。这是一个从JSON输入自动创建数据类的在线工具。只需将JSON结果粘贴到编辑器中，选择Dart作为语言，并复制创建的代码。不需要手动编写数据类！</p><h2 id="a2c1" class="ms mt it bd mu mv mw dn mx my mz dp na lm nb nc nd lq ne nf ng lu nh ni nj iz bi translated">结论</h2><p id="3f17" class="pw-post-body-paragraph ld le it lf b lg nk kd li lj nl kg ll lm nm lo lp lq nn ls lt lu no lw lx ly im bi translated">有了这个指南，您应该能够从您的Flutter应用程序执行HTTP请求并解析响应数据。</p><p id="5907" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果你喜欢这篇文章，我会很高兴得到掌声👏(你知道可以拍几次吗？😎)另外，如果你还没有跟上我，我也很感激。</p><p id="ffda" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">🌲<a class="ae lz" href="https://linktr.ee/xeladu" rel="noopener ugc nofollow" target="_blank"> linktr.ee </a> |☕ <a class="ae lz" href="https://www.buymeacoffee.com/xeladu" rel="noopener ugc nofollow" target="_blank">咖啡</a>🎁<a class="ae lz" href="https://www.paypal.com/donate/?hosted_button_id=JPWK39GGPAAFQ" rel="noopener ugc nofollow" target="_blank">捐赠</a> |💻GitHub  |🔔<a class="ae lz" href="https://xeladu.medium.com/subscribe" rel="noopener">订阅</a></p><p id="6576" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">顺便说一句:如果你还没有Medium会员，我推荐你使用<a class="ae lz" href="https://medium.com/@xeladu/membership" rel="noopener">│我的推荐链接◀ </a> <strong class="lf jd"> <em class="nw"> </em> </strong>，因为它会让你访问Medium上的所有内容，并以一小部分费用支持我，而不会为你带来任何额外费用。谢谢大家！✨</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h2 id="9678" class="ms mt it bd mu mv mw dn mx my mz dp na lm nb nc nd lq ne nf ng lu nh ni nj iz bi translated">相关故事</h2><div class="ma mb gp gr mc md"><a href="https://xeladu.medium.com/flutter-unit-test-basics-a8c6815f7712" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">颤振单元测试基础</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">我们涵盖了一个基本的例子，单元测试在一个颤振项目中会是什么样子。包括解释的代码示例。</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">xeladu.medium.com</p></div></div><div class="mm l"><div class="oe l mo mp mq mm mr lb md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://xeladu.medium.com/create-a-new-flutter-project-in-three-different-ways-a5ace80195b9" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">用三种不同的方式创建一个新的颤振项目</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">这篇短文展示了如何创建一个新的Flutter项目，这样您就可以开始开发您的应用程序了。</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">xeladu.medium.com</p></div></div><div class="mm l"><div class="of l mo mp mq mm mr lb md"/></div></div></a></div><div class="ma mb gp gr mc md"><a rel="noopener  ugc nofollow" target="_blank" href="/flutter-app-from-scratch-part-1-planned-features-app-design-app-skeleton-c87f2c21f47a"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">Flutter app从零开始第1部分—规划的功能、应用设计、应用框架</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">本文涵盖了计划中的应用程序特性、环境设置以及一个新的Flutter应用程序的第一个应用程序框架。</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="mm l"><div class="og l mo mp mq mm mr lb md"/></div></div></a></div></div></div>    
</body>
</html>