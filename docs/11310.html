<html>
<head>
<title>Make Your Python Program Speak!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您的Python程序说话！</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/make-your-python-program-speak-310766534fbf?source=collection_archive---------10-----------------------#2022-03-07">https://levelup.gitconnected.com/make-your-python-program-speak-310766534fbf?source=collection_archive---------10-----------------------#2022-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="46ff" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用谷歌的gTTS库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/18d9a88ef8db4719e363623702c32d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0Edque-Uy__Eb4V_"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@agk42?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚历山大·奈特</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="bc42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你有没有想过如何创造一个会说话的程序？乍一看，这似乎是一项非常困难的任务。然而，谷歌已经为我们做了大部分工作，现在我们可以使用他们的库非常容易地从文本创建音频文件。</p><h1 id="ee62" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">安装库</h1><p id="59a2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，我们需要安装gTTS库。</p><p id="a11c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我建议你为这个项目创建一个新的虚拟环境(如果你不知道怎么做，可以查看<a class="ae kv" href="https://python.plainenglish.io/how-to-create-and-manage-virtual-environments-in-python-706bf22fc1b" rel="noopener ugc nofollow" target="_blank"> <em class="mp">这篇文章</em> </a>)。然后，我们可以使用pip安装该库:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="8d37" class="mv lt iq mr b gy mw mx l my mz">pip install gtts</span></pre><h1 id="eaf8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建mp3文件</h1><p id="03a3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用这个库最简单的方法是创建一个mp3文件，然后执行它。</p><p id="4875" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先要做的是创建一个<code class="fe na nb nc mr b">gTTS</code>对象。这有许多参数，但现在让我们只关注最重要的一个:我们想要阅读的文本。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="70bf" class="mv lt iq mr b gy mw mx l my mz">from gtts import gTTS</span><span id="3144" class="mv lt iq mr b gy nd mx l my mz">tts = gTTS("Hello world")</span></pre><p id="007d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然我们已经指定了想要阅读的单词，我们可以将音频保存到一个<code class="fe na nb nc mr b">mp3</code>文件中:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="4704" class="mv lt iq mr b gy mw mx l my mz">tts.save('hello.mp3')</span></pre><p id="030c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是你开始创建mp3文件所需要的一切。很简单，对吧？</p><p id="ca4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我们还可以做更多的事情:改变语言，添加特殊的口音，甚至直接用Python播放声音！</p><h1 id="1772" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">一些可选参数</h1><p id="4886" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们知道了基本知识，让我们看看<code class="fe na nb nc mr b">gTTS</code>对象的更多参数。</p><h2 id="f872" class="mv lt iq bd lu ne nf dn ly ng nh dp mc lf ni nj me lj nk nl mg ln nm nn mi no bi translated">语言和口音</h2><p id="5743" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，你可能想使用一种不同于英语的语言，或者甚至是一种特殊的口音(例如，澳大利亚口音、美国口音、英国口音)。为此，我们使用两个可选参数:</p><ul class=""><li id="cb2b" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated"><code class="fe na nb nc mr b">tId</code>指定用于创建音频的翻译API的域。这是谷歌翻译网站的域名:<em class="mp">https://translate . Google .&lt;tId&gt;。</em>默认值是<code class="fe na nb nc mr b">com</code>，但是你可以指定任何有效的域，这将使用(在大多数情况下)本地口音。比如<code class="fe na nb nc mr b">co.uk</code>是英国口音，<code class="fe na nb nc mr b">com.au</code>是澳洲口音。</li><li id="0b70" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated"><code class="fe na nb nc mr b">lang</code>用于指定文本的语言，使用两个字母的代码:<code class="fe na nb nc mr b">en</code>(默认值)表示英语，<code class="fe na nb nc mr b">fr</code>表示法语，<code class="fe na nb nc mr b">es</code>表示西班牙语，以此类推。如果您想要检索所有可用语言的列表，请使用以下代码:</li></ul><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="c407" class="mv lt iq mr b gy mw mx l my mz"><strong class="mr ir">from </strong>gtts <strong class="mr ir">import </strong>lang</span><span id="505f" class="mv lt iq mr b gy nd mx l my mz">print(lang.tts_langs())</span></pre><p id="29b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里<code class="fe na nb nc mr b">lang.tts_langs()</code>返回一个字典，其中键是语言的名称，值是相应的代码。</p><h2 id="4137" class="mv lt iq bd lu ne nf dn ly ng nh dp mc lf ni nj me lj nk nl mg ln nm nn mi no bi translated">慢慢说</h2><p id="3b40" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">还有一个让程序说话更慢的参数:<code class="fe na nb nc mr b">slow</code>。这是默认的<code class="fe na nb nc mr b">False</code>，但是如果你需要，你可以改变它。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="0e3d" class="mv lt iq mr b gy mw mx l my mz">tts = gTTS("Hello world", slow=True)</span></pre><h2 id="4c83" class="mv lt iq bd lu ne nf dn ly ng nh dp mc lf ni nj me lj nk nl mg ln nm nn mi no bi translated">预处理</h2><p id="87af" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您想在文本转换成音频之前对其进行一些修改，您可以使用<code class="fe na nb nc mr b">pre_processor_funcs</code>参数。这需要一个函数列表，取自函数库的<code class="fe na nb nc mr b">gtts.tokenixer.pre_processors</code>子模块。一些比较常见的是:</p><ul class=""><li id="e056" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated"><code class="fe na nb nc mr b">abbreviations</code>用于将已知的缩写替换为完整的单词。</li><li id="95fd" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated"><code class="fe na nb nc mr b">end_of_line</code>修改在一行结束和下一行开始之间分开的单词。</li></ul><p id="b935" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mp">注:</em> </strong> <em class="mp">库的官方文档中有一些更复杂的预处理程序。</em></p><p id="04c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是一个使用预处理器的示例:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="9b95" class="mv lt iq mr b gy mw mx l my mz"><strong class="mr ir">from </strong>gtts.tokenizer.pre_processors <strong class="mr ir">import </strong>abbreviations, end_of_line</span><span id="2cac" class="mv lt iq mr b gy nd mx l my mz">tts = gTTS("Hello world", pre_processor_funcs = [abbreiations, end_of_line])</span></pre><h1 id="d95b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">直接播放音频</h1><p id="90b3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们知道了如何创建mp3音频，但是我们仍然想在Python程序中播放它。</p><p id="4dab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们需要安装一个库来播放<code class="fe na nb nc mr b">mp3</code>文件。在本教程中，我们将使用<code class="fe na nb nc mr b">pygame</code>，但你可以选择任何你想要的。</p><p id="d31e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们来安装Pygame:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="ab21" class="mv lt iq mr b gy mw mx l my mz">pip install pygame</span></pre><p id="9ea2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，要播放我们创建的mp3文件，您可以使用以下代码:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="1582" class="mv lt iq mr b gy mw mx l my mz"><strong class="mr ir">from </strong>pygame <strong class="mr ir">import </strong>mixer<br/><strong class="mr ir">import </strong>time</span><span id="5d99" class="mv lt iq mr b gy nd mx l my mz">mixer.init()<br/>mixer.music.load("hello.mp3")<br/>mixer.music.play()<br/>time.sleep(2)</span></pre><p id="4e69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们从Pygame初始化混音器，加载音频，然后播放。</p><p id="86c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们添加了<code class="fe na nb nc mr b">time.sleep</code>命令，这一点很重要:这可以确保程序不会在音频播放之前终止。</p><h1 id="864b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">完整的代码</h1><p id="28dc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这里，您可以找到我们在本文中使用的完整代码:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="cb17" class="mv lt iq mr b gy mw mx l my mz"><strong class="mr ir">from </strong>gtts <strong class="mr ir">import </strong>gTTS<br/><strong class="mr ir">from </strong>gtts.tokenizer.pre_processors <strong class="mr ir">import </strong>abbreviations, end_of_line<br/><strong class="mr ir">from </strong>pygame <strong class="mr ir">import </strong>mixer<br/><strong class="mr ir">import </strong>time</span><span id="ee95" class="mv lt iq mr b gy nd mx l my mz"><em class="mp"># Create the text<br/></em>text = "Hello World!"<br/>tts = gTTS(text, slow=False, pre_processor_funcs = [abbreviations, end_of_line]) </span><span id="73a3" class="mv lt iq mr b gy nd mx l my mz"><em class="mp"># Save the audio in a mp3 file<br/></em>tts.save('hello.mp3')</span><span id="f3f5" class="mv lt iq mr b gy nd mx l my mz"><em class="mp"># Play the audio<br/></em>mixer.init()<br/>mixer.music.load("hello.mp3")<br/>mixer.music.play()</span><span id="0301" class="mv lt iq mr b gy nd mx l my mz"><em class="mp"># Wait for the audio to be played<br/></em>time.sleep(2)</span></pre><h1 id="d473" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="1ccc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">感谢您阅读本文！如果您需要更多信息，请查看以下资源:</p><ul class=""><li id="4d94" class="np nq iq ky b kz la lc ld lf nr lj ns ln nt lr nu nv nw nx bi translated"><a class="ae kv" href="https://gtts.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> gTTS文档</a></li><li id="d18c" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated"><a class="ae kv" href="https://coderslegacy.com/python/pygame-mixer/" rel="noopener ugc nofollow" target="_blank">如何使用pygame混音器</a></li></ul></div></div>    
</body>
</html>