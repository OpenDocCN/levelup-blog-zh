<html>
<head>
<title>📸 Taking a picture and selecting from gallery in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">📸在Flutter中拍照并从图库中选择</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/taking-a-picture-and-selecting-from-gallery-in-flutter-908e75108d93?source=collection_archive---------11-----------------------#2020-03-05">https://levelup.gitconnected.com/taking-a-picture-and-selecting-from-gallery-in-flutter-908e75108d93?source=collection_archive---------11-----------------------#2020-03-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fa24ad9c8943acf7dec9beb4f59be3db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhE2EZReP5ozW3deEXZT7Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@wbayreuther?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">威廉·拜罗伊特</a>在<a class="ae kc" href="https://unsplash.com/@gvetri/likes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="e63b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你好。我一直在一个应用程序中工作，要求从应用程序中拍照或从画廊中挑选照片。使用相机拍照有很多种方式。这次我们将使用ImagePicker插件。</p><p id="3e5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为第一步，我们需要添加新的插件到我们的依赖项中。在我们的<strong class="kf ir"> pubspec.yaml </strong>中，我们将添加下一个插件:</p><ul class=""><li id="d039" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><strong class="kf ir">摄像头</strong>帮助我们使用设备的摄像头。</li><li id="010f" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir"> path_provider </strong>为我们提供了在设备中存储图像的正确路径。</li><li id="1ba2" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir"> image_picker </strong>帮助我们从图库中选择照片。</li></ul><p id="1420" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们将它添加到我们的<strong class="kf ir"> pubspec.yaml </strong>之后，它将看起来像这样。</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h1 id="1c95" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">添加一个最小的Android SDK。</h1><p id="b04e" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">Flutter相机插件只适用于Android中的SDK 21或更高版本。所以我们需要打开位于<code class="fe my mz na nb b">android/app/build.gradle</code>的build.gradle文件并搜索行<code class="fe my mz na nb b">minSdkVersion</code>。最后，我们需要将我们的min SDK版本从16升级到21。如果你对android开发一无所知，这使得该应用程序只能在Android OS Lollipop或更高版本上使用。</p><p id="a671" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是做了更改后的样子。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/17960d023f28f58eda8b7a6b23491850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JMkuC-dXjylFoJNB.png"/></div></div></figure><h1 id="fbd0" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">让我们创建我们的第一个屏幕！</h1><p id="b1db" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">让我们创建我们的<strong class="kf ir"> PhotoPreviewScreen </strong>，这是一个StatefulWidget。一开始，它应该是这样的。</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="67cc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们将创建一个带有居中列的<strong class="kf ir">脚手架</strong>，在我们从图库中选择图像或从相机中拍照后，它将显示我们的图像预览。最后一步，我们将添加一个<strong class="kf ir">浮动操作按钮</strong>，它将显示选择对话框。</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="7b57" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太好了！现在你可能会问<strong class="kf ir"> _setImageView() </strong>和<strong class="kf ir">_ showSelectionDialog(context)</strong>是做什么的。<strong class="kf ir"> _setImageView() </strong>是一个方法，当我们从图库中选取或从相机中获取的图像为空时，它会返回一个小部件。我们正在返回一个文本小部件，它有以下文本“请选择一张图片。”</p><p id="e4d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">_ showSelectionDialog(context)</strong>将显示一个带有两个选项的对话框，从图库或相机拍摄图像。让我们开始创建这个。此方法应使用函数showDialog()并向其传递上下文和一个生成器，该生成器将创建一个带有标题和两个选项的AlertDialog。</p><p id="38d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<strong class="kf ir"> AlertDialog </strong>构造函数中，我们将传递一个<strong class="kf ir"> SingleChildScrollView </strong>作为内容，这是一个帮助我们滚动列表的小部件，作为这个小部件的子部件，我们将传递一个带有两个子部件的<strong class="kf ir"> ListBody </strong>，这些子部件必须是一个<strong class="kf ir"> GestureDetector </strong>来检测用户何时触摸文本。</p><p id="fdbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个<strong class="kf ir"> GestureDetector </strong>子控件都将是一个文本小部件，分别包含“Gallery”文本和“Camera”文本，每个onTap()方法都将是<strong class="kf ir"> _openGallery() </strong>和<strong class="kf ir"> _openCamera() </strong>。我们一会儿要创建的方法。你的<strong class="kf ir">_ showSelectionDialog(context)</strong>应该是这样的。</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="1318" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在你的应用程序应该会显示这样一个对话框。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/36d570219c882fd98d8f8f4145e6f8dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q7E_gdgK_vkI7yIz.png"/></div></div></figure><h1 id="9e69" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">让我们使用那个插件。</h1><p id="c0ca" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">现在让我们将逻辑添加到我们的<strong class="kf ir"> _openGallery(context) </strong>方法中。我们首先要做的是创建一个名为imageFile的字段，它将是我们的<strong class="kf ir"> _LandingScreenState </strong>类中的一个文件对象。创建之后，我们将使用ImagePicker函数<strong class="kf ir">image picker . pick image()</strong>向其传递枚举<code class="fe my mz na nb b"><strong class="kf ir">ImageSource.gallery</strong></code>该函数是异步的，因此我们将添加保留关键字async和await，稍后我们将保存该变量并将其分配给我们的属性。作为我们的最后一步，我们将调用<strong class="kf ir"> setState() </strong>方法来通知状态已经改变。</p><p id="c877" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">函数<strong class="kf ir"> _openGallery(context) </strong>应该是这样的</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="65a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">_openCamera(context)函数几乎是一样的。我们唯一需要改变的是源代码，而不是ImageSource.gallery。我们将使用ImageSource.camera。这种简单性是我最喜欢这个插件的地方，非常简单。</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h1 id="a818" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">显示预览</h1><p id="5d33" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">还记得当初那个<strong class="kf ir"> _setImageView() </strong>吗？我们将验证imageField字段不为空，以返回一个<strong class="kf ir"> Image </strong>小部件。如果图像字段为空，我们将返回一个<strong class="kf ir">文本</strong>小部件。</p><p id="fb67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是结果。</p><figure class="lp lq lr ls gt jr"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="ee1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是你从图库中选择一张图片后，你的应用程序应该呈现的样子。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/baf027e0b551404e6b46456ed35096c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jIv1hT9vhgA1yVS7.png"/></div></div></figure><h1 id="78f2" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">好了</h1><p id="e70f" class="pw-post-body-paragraph kd ke iq kf b kg mt ki kj kk mu km kn ko mv kq kr ks mw ku kv kw mx ky kz la ij bi translated">我希望你喜欢它！如果你对更多扑/镖文章感兴趣，可以在社交上关注我，打个招呼！。</p><p id="c1e3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="http://www.instagram.com/codingpizza" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> Instagram。</strong> </a></p><p id="c389" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://twitter.com/coding__pizza" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">碎碎念。</strong> </a></p><h1 id="fe2b" class="lv lw iq bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated"><a class="ae kc" href="http://eepurl.com/gcIboL" rel="noopener ugc nofollow" target="_blank">点击这里加入codingpizza简讯</a></h1></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="989e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nl">原载于2020年3月5日</em><a class="ae kc" href="https://www.codingpizza.com/en/taking-a-picture-and-selecting-from-gallery-in-flutter/" rel="noopener ugc nofollow" target="_blank"><em class="nl">【https://www.codingpizza.com】</em></a><em class="nl">。</em></p></div></div>    
</body>
</html>