<html>
<head>
<title>Example of a telegram bot in python without using specific libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不使用特定库的python电报机器人示例</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/example-of-a-telegram-bot-in-python-without-using-specific-libraries-ac14db4c9ade?source=collection_archive---------2-----------------------#2021-07-12">https://levelup.gitconnected.com/example-of-a-telegram-bot-in-python-without-using-specific-libraries-ac14db4c9ade?source=collection_archive---------2-----------------------#2021-07-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1b4170ce898fe6f94969ea87ca61db77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pfNzIEJHoqEqUqpG"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kf" href="https://unsplash.com/@ademay?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Adem may</a>拍摄的照片</figcaption></figure><p id="2a1a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要制作一个电报机器人，有很多库允许你这样做。<br/>然而，如果你想在不使用特定库的情况下用python制作一个机器人，这篇文章正适合你。</p><p id="310d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用的库有:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a8c6" class="ln lo it lj b gy lp lq l lr ls">import json<br/>import requests<br/>import urllib</span></pre><p id="c8c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先你必须使用机器人父亲(<a class="ae kf" href="https://t.me/BotFather" rel="noopener ugc nofollow" target="_blank">https://t.me/BotFather</a>)创建机器人</p><p id="393a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要检查某人是否联系过机器人:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="cdf8" class="ln lo it lj b gy lp lq l lr ls">def get_updates(offset=None):<br/>    url = URL + "getUpdates?timeout=100"<br/>    if offset:<br/>        url += "&amp;offset={}".format(offset)<br/>        js = get_json_from_url(url)<br/>    return js</span></pre><p id="8c5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要处理向bot发出的请求:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a1cc" class="ln lo it lj b gy lp lq l lr ls">def echo_all(updates):<br/>    for update in updates["result"]:<br/>    if update.get("message") != None:<br/>        if update.get("message", {}).get("text") != None:<br/>            text = update["message"]["text"]<br/>            chat = update["message"]["chat"]["id"]<br/>            print(text)<br/>            if text == "/test" or text == "/test@" + USERNAME_BOT:<br/>                text = "test response"<br/>                send_message(text, chat)<br/>            elif text == "/start" or text == "/start@" + USERNAME_BOT:<br/>                send_message("/test for test the bot", chat)</span></pre><p id="e5f5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个示例，它在接收到<strong class="ki iu"> /text </strong>命令时发送响应“<strong class="ki iu"> test response </strong>”，并且在<strong class="ki iu"> /start </strong>命令响应“<strong class="ki iu"> /test以测试机器人</strong></p><p id="74af" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是发送短信的功能:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="fdaf" class="ln lo it lj b gy lp lq l lr ls">def send_message(text, chat_id):<br/>    tot = urllib.parse.quote_plus(text)<br/>    url = URL + "sendMessage?text={}&amp;chat_id={}".format(tot, chat_id)<br/>    get_url(url)</span></pre><p id="3344" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是发送带有文档的消息的函数(变量“doc”表示文件的路径):</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="287a" class="ln lo it lj b gy lp lq l lr ls">def send_document(doc, chat_id):<br/>    files = {'document': open(doc, 'rb')}<br/>    requests.post(URL + "sendDocument?chat_id={}".format(chat_id), files=files)</span></pre><p id="50db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是发送带有图像的消息的函数(变量“doc”表示文件的路径):</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="cda6" class="ln lo it lj b gy lp lq l lr ls">def send_image(doc, chat_id):<br/>    files = {'photo': open(doc, 'rb')}<br/>    requests.post(URL + "sendPhoto?chat_id={}".format(chat_id), files=files)</span></pre><p id="9a97" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里你可以找到所有的代码:</p><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="5bd4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有任何问题或者你已经用其他方式解决了它们，不要犹豫，在评论中写下它们！</p><p id="3dc4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了获得无限的故事，你也可以考虑只花5美元注册成为媒体会员。如果你使用我的 <a class="ae kf" href="https://pietrocolombo.medium.com/membership" rel="noopener"> <em class="lv">链接</em> </a> <em class="lv">注册，我会收到一小笔佣金。</em></p></div></div>    
</body>
</html>