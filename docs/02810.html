<html>
<head>
<title>Can it be done in Flutter?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在颤振中能做到吗？</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/can-it-be-done-in-flutter-2e5a8fe966f8?source=collection_archive---------15-----------------------#2020-04-05">https://levelup.gitconnected.com/can-it-be-done-in-flutter-2e5a8fe966f8?source=collection_archive---------15-----------------------#2020-04-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="ada7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最近我遇到了这个动画挑战，有人在twitter上发布了这个挑战，是用SwiftUI制作的。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="kt ku l"/></div></figure><p id="63e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个挑战在React Native中已经由<a class="ae kv" href="https://www.youtube.com/watch?v=_s8JbxZx4aA" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">威廉·坎迪隆</strong> </a> <strong class="js iu"> </strong> ( <a class="kw kx ep" href="https://medium.com/u/4bdbd6b3a30a?source=post_page-----2e5a8fe966f8--------------------------------" rel="noopener" target="_blank">威廉·坎迪隆</a> ) <strong class="js iu"> </strong>完成了。所以我从他那里得到了灵感，在Flutter中也这么做了。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/eb04ec5c950660adcbd382648d3ba21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/1*QHmLBhEYZU4uRf2m7A7nhg.gif"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">最终动画</figcaption></figure><p id="844d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里发生的事情不多，对吧？长按的话，一些小工具就是这么简单的动画。让我们快速分解一下动画在改变什么。</p><ol class=""><li id="61d0" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">圆形尺寸</li><li id="0df9" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">圆形进度条</li><li id="095f" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">指纹图标进度</li></ol><p id="640f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有的动画在这里同时发生——这些动画的真实的单一来源，控制器在每一帧上提供新的值，我们的小部件得到重建。让我们找出密码。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="lt ku l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">动画控制器</figcaption></figure><p id="5572" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于动画，我们要扩展<strong class="js iu">SingleTickerProviderStateMixin</strong>哪个AnimationController <strong class="js iu"> vsync:这个</strong>引用它。补间&lt;双&gt;动画在制作动画时，在400毫秒的持续时间内提供值0…0.2…0.5…1。<strong class="js iu"> AnimationStatusListner </strong>将在动画运行、结束或丢弃时监听状态。现在让我们看看真正的部分。</p><h1 id="c183" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">手势检测器和动画生成器</h1><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="lt ku l"/></div></figure><p id="f16f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们用手势检测器部件包装容器。长按时，将调用手势<strong class="js iu">_ onlongpresstart</strong>方法。我们从calling _controller.forward()运行动画，反之亦然，用于<strong class="js iu"> _onLongPressEnd </strong>。</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="c62f" class="mx lv it mt b gy my mz l na nb"><em class="nc">//checks animation is already running. <br/></em>if (!_controller.isAnimating) {      <br/>_controller.forward();    <br/>} <br/>else {      <br/>_controller.forward(from: _controller.value); <br/><em class="nc">//animation runs from last value<br/></em>}</span></pre><p id="0858" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您仔细观察动画，如果动画已经开始但尚未结束，则动画将再次从长按上一个值开始。</p><blockquote class="nd ne nf"><p id="d83f" class="jq jr nc js b jt ju jv jw jx jy jz ka ng kc kd ke nh kg kh ki ni kk kl km kn im bi translated"><strong class="js iu">注意</strong>:试着将持续时间减少到3000毫秒进行观察。</p></blockquote><p id="c89b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> AnimationBuilder </strong>小部件获取控制器参数，并在值改变时让子部件重建。至少在这种情况下，这种方法比在动画监听器上调用setState(){}要好。</p><h1 id="e618" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">动画小部件</h1><ol class=""><li id="2f7d" class="lf lg it js b jt nj jx nk kb nl kf nm kj nn kn lk ll lm ln bi translated"><strong class="js iu">圆形比例动画</strong></li></ol><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="510b" class="mx lv it mt b gy my mz l na nb">Transform.scale(<br/> scale: ((_controller.value * 0.2) + 1),<br/>  child: Container(<br/>      width: 100,<br/>    height: 100,<br/>  )<br/> )</span></pre><p id="44c4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这非常简单，只需包装容器来转换小部件。将比例值设置为1意味着圆的原始大小，当值改变时，它将开始逐渐增加。</p><p id="4a10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2。</strong> <strong class="js iu">圆形进度条</strong></p><p id="da5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">比以前更棘手…嗯！在颤动盒中找到合适的工具。嗯…我们可以用Flutter创建一个自定义的。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="lt ku l"/></div></figure><p id="7778" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">CustomPaint允许我们使用绘画风格和已经定义的形状在画布上绘制任何东西。</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="00e3" class="mx lv it mt b gy my mz l na nb">//let use draw only stroke instead filling whole circle<br/>..style = PaintingStyle.stroke</span><span id="bcb1" class="mx lv it mt b gy no mz l na nb">startAngle =-pi/2 (clockwise 12 o'lock)<br/>endAngle = (pi * 2 * _conroller.value);</span><span id="3949" class="mx lv it mt b gy no mz l na nb">canvas.drawArc(Rect.fromCircle(center: offset, radius: radius) ,startAngle,endAngle, false, p);</span></pre><p id="5a75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Rect.fromCircle()将根据我们提供的偏移量从中心绘制半径为n的圆形。这里的startAngle和endAngle会形成一个顺时针方向的弧线。最后一个对象p将在画布上绘制。</p><p id="291a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 3。指纹进度动画</strong></p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="lt ku l"/></div></figure><p id="9db7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我们做的一点小改动！我们将两个图标叠放在堆栈中，随着动画的进展动态地改变高度。通过定位小部件包装ClipRect，并在中心设置第二个图标。</p><blockquote class="nd ne nf"><p id="3037" class="jq jr nc js b jt ju jv jw jx jy jz ka ng kc kd ke nh kg kh ki ni kk kl km kn im bi translated">为什么是ClipRect而不仅仅是容器？</p></blockquote><p id="b87e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，ClipRect小部件做的是<strong class="js iu">裁剪出他们孩子的矩形部分。这意味着在这里，我们可以从零高度到完整的图标高度逐渐显示图标。有了容器，就不可能成为不受父约束约束的子对象。</strong></p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="6d78" class="mx lv it mt b gy my mz l na nb">// icon will visible from bottom to top <br/>alignment: Alignment.bottomCenter</span><span id="1f5f" class="mx lv it mt b gy no mz l na nb">//from zero height to full icon height       <br/>heightFactor: _controller.value,</span></pre><p id="dfee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就是这样！我们已经完成了所有部件的动画制作。现在只需为我们的动画挑战画龙点睛。</p><h1 id="cdcc" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">动画状态列表器</h1><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="8796" class="mx lv it mt b gy my mz l na nb">..addStatusListener((AnimationStatus status) {<br/>        switch (status) {<br/>          case AnimationStatus.forward:<br/>            break;<br/>          case AnimationStatus.completed:<br/>            isAnimationCompleted = true;<br/>            _controller.reverse();<br/>            break;<br/>          case AnimationStatus.reverse:<br/>            break;<br/>          case AnimationStatus.dismissed:<br/>            if (isAnimationCompleted) {<br/>              setState(() {<br/>                showFingerPrint = !showFingerPrint;<br/>              });<br/>              isAnimationCompleted = false;<br/>            }<br/>            break;<br/>        }</span></pre><p id="1211" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要做的就是当动画结束时，我们调用_controller.reverse()来反转动画并显示复选图标。就是这样！</p><p id="dfce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">想在里面多加点吗？像在SwiftUI挑战赛中一样加入新形态设计动画。</p><blockquote class="nd ne nf"><p id="a99b" class="jq jr nc js b jt ju jv jw jx jy jz ka ng kc kd ke nh kg kh ki ni kk kl km kn im bi translated">欲查看完整源代码，请点击此处</p><p id="f0e7" class="jq jr nc js b jt ju jv jw jx jy jz ka ng kc kd ke nh kg kh ki ni kk kl km kn im bi translated">【https://github.com/gurupatel107/fingerprint_animation.git T4】</p></blockquote></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><div class="ko kp kq kr gt nw"><a href="https://skilled.dev" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">编写面试问题</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">一个完整的平台，在这里我会教你找到下一份工作所需的一切，以及…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">技术开发</p></div></div><div class="of l"><div class="og l oh oi oj of ok kz nw"/></div></div></a></div></div></div>    
</body>
</html>