<html>
<head>
<title>How to Debug ASP.NET Core Source Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何调试ASP.NET核心源代码</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-debug-asp-net-core-source-code-448544c16473?source=collection_archive---------6-----------------------#2020-12-28">https://levelup.gitconnected.com/how-to-debug-asp-net-core-source-code-448544c16473?source=collection_archive---------6-----------------------#2020-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="88a6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解引擎盖下发生了什么</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5c8e3664969a62f56dab58176862830e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DSIKZN9XJmVvL-iu"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/photos/jz8-BDbVobc" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@mecdjino" rel="noopener ugc nofollow" target="_blank"> mecdjino </a>拍摄的照片</figcaption></figure><p id="771c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我花了很长时间才学会的，而且互联网上也没有太多的帮助。</p><p id="b36f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我写这篇文章是想给你一些帮助，这是我在试图解决这个问题时所希望的。</p><h1 id="060c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">为什么？</h1><p id="e54e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">也许你只是好奇事情在幕后是如何工作的，或者你发现了一个bug，或者需要一些你无法访问的代码。不管你的理由是什么，这篇文章将帮助你跳过我遇到的所有问题。</p><h1 id="abdc" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">怎么会？</h1><p id="8da0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">调试源代码的方法有很多。这里有三种流行的方法:</p><ol class=""><li id="9b43" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><a class="ae ky" href="https://marketplace.visualstudio.com/items?itemName=vs-publisher-306627.NETReflectorVisualStudioExtension" rel="noopener ugc nofollow" target="_blank">。网状反射器</a></li><li id="222d" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><a class="ae ky" href="https://docs.microsoft.com/en-us/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger?view=vs-2019" rel="noopener ugc nofollow" target="_blank">微软符号服务器</a></li><li id="d7e2" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">参考<a class="ae ky" href="https://github.com/dotnet/aspnetcore/blob/master/docs/BuildFromSource.md" rel="noopener ugc nofollow" target="_blank">源代码</a></li></ol><p id="5c01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前两者的问题是它们很慢，并且很难在“监视”窗口中查看局部变量的值。</p><p id="f046" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为即使您选择“取消JIT优化”并在调试模式下生成，代码也是优化的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/afa6f8dc00cb8673e18a188eb9ffb67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sm0Edi0MQyFKDIFj-8glDw.png"/></div></div></figure><p id="458e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您展示如何通过引用源代码来进行调试。</p><h1 id="e6f0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">你需要什么版本？</h1><p id="c1f5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">第一件事是考虑你要调试什么版本的ASP.NET核心。</strong></p><p id="d5c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不假思索地下载/构建了具有. net6.0代码的master分支，并想知道为什么它不能与我的ASP.NET Core 5项目一起工作。</p><p id="f95f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一步中，您需要检查正确的分支，该分支具有与您在应用程序中使用的ASP.NET核心相同的版本。</p><h1 id="17ad" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">签出并构建</h1><p id="b977" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在继续之前，请确保您<strong class="lb iu">直接在c盘</strong>中创建一个文件夹来克隆源代码。否则你会得到文件路径太长的错误。</p><p id="20ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">然后按照这些</strong> <a class="ae ky" href="https://github.com/dotnet/aspnetcore/blob/master/docs/BuildFromSource.md" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">指令</strong> </a> <strong class="lb iu">(或者</strong> <a class="ae ky" href="https://github.com/dotnet/runtime/blob/main/docs/workflow/README.md" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">这些</strong> </a> <strong class="lb iu">如果你想调试运行时)。</strong></p><p id="4de6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保你<strong class="lb iu">阅读了整篇文章</strong>。我怎么强调都不为过。我冲进去，试图从Visual Studio中构建解决方案。您需要从命令行进行构建。如果你仓促行事，这只是许多可能出错的事情之一。</p><p id="405d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您遇到错误，请在使用谷歌之前阅读<a class="ae ky" href="https://github.com/dotnet/aspnetcore/blob/master/docs/BuildErrors.md" rel="noopener ugc nofollow" target="_blank">故障排除</a>部分。</p><h1 id="e82a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">将所需的项目/dll添加到解决方案中</h1><h2 id="524c" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">添加项目</h2><p id="a816" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在VS中右键单击您的解决方案，并选择Add -&gt; Existing Project。</p><p id="9dd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后选择。您希望调试的代码的csproj文件。</p><p id="c88a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的例子中，我需要调试防伪代码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/97aabc5c599bfac3e7a32c4b9fd9e546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KuV6gj5dUXxUNtFithL8fA.png"/></div></div></figure><p id="18da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以在解决方案中看到该项目:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/637984fe6a84f05d4a5a7bf58412e16a.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*AEa8Nwf_PqKMrVLYv6LlhA.png"/></div></figure><h2 id="377e" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">添加dll</h2><p id="b114" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">除了上一步之外，还必须添加dll。</p><p id="0531" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果将项目引用添加到。csproj，而不是添加dll，当你调试时，你将不能查看一些局部变量的值。</p><p id="5358" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将看到以下错误:</p><blockquote class="nv nw nx"><p id="b692" class="kz la ny lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">无法获取局部变量或参数的值，因为它在此指令指针处不可用，可能是因为它已被优化掉了</p></blockquote><p id="d8ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了确保您可以在监视窗口中查看这些值，您需要<strong class="lb iu">添加dll而不是引用项目</strong>。</p><p id="5ced" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该dll将位于以下文件夹中:</p><p id="32e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oc od oe of b">C:\aspnetcore\artifacts\bin\&lt;ProjectOfInterestHere&gt;\Debug\&lt;Version&gt;</code></p><p id="3c04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:</p><p id="6d86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oc od oe of b">C:\aspnetcore\artifacts\bin\Microsoft.AspNetCore.Antiforgery\Debug\net5.0</code></p><p id="0487" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过右击您的主项目，并选择Add -&gt; Project Reference -&gt; Browse来添加dll。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/0530315116be996381c3cbb795983169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5gjq31Lk9v14QGSGA93Qw.png"/></div></div></figure><h1 id="42b2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">添加断点，享受调试！</h1><p id="c1c1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在你已经准备好了。添加断点，运行应用程序，并在"监视"窗口中查看变量值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3a1a5730a66fdfe54f4e099cfe84ae0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*dZmRzhw1Vbw9ZmLdbmBchw.png"/></div></figure><p id="5e96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有所帮助。如果你需要帮助，请留言。</p><h1 id="dfb3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">运行时间</h1><p id="ad28" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果你想用。NET Core运行时repo，这里的指令是<a class="ae ky" href="https://github.com/dotnet/runtime/blob/main/docs/workflow/README.md" rel="noopener ugc nofollow" target="_blank">这里的</a>。</p><h1 id="3b09" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">资源</h1><div class="oi oj gp gr ok ol"><a href="https://marketplace.visualstudio.com/items?itemName=vs-publisher-306627.NETReflectorVisualStudioExtension" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">。NET Reflector Visual Studio扩展- Visual Studio市场</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">NET Reflector VSPro允许您直接在Visual Studio中单步调试任何第三方代码和程序集，甚至…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">marketplace.visualstudio.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ks ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://docs.microsoft.com/en-us/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger?view=vs-2019" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">设置符号(。pdb)和调试器中的源文件- Visual Studio</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">程序数据库(。pdb)文件，也称为符号文件、地图标识符和项目源代码中的语句…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">docs.microsoft.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz ks ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://github.com/dotnet/aspnetcore/blob/master/docs/BuildFromSource.md" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">点网/aspnetcore</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">本文档概述了如何在aspnetcore repo中本地构建源代码以用于开发目的。有关更多信息…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="pb l ow ox oy ou oz ks ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://github.com/dotnet/aspnetcore/blob/master/docs/BuildErrors.md" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">点网/aspnetcore</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">本文档介绍常见的构建错误以及如何解决这些错误。警告BUILD001:对“...”的引用已被移除…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="pc l ow ox oy ou oz ks ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://stackoverflow.com/questions/65264454/how-to-force-asp-net-5-source-code-to-not-be-optimized" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">如何强制ASP.NET 5源代码不优化</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">stackoverflow.com</p></div></div><div class="ou l"><div class="pd l ow ox oy ou oz ks ol"/></div></div></a></div></div></div>    
</body>
</html>