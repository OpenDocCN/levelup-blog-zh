# React ä¸Šä¸‹æ–‡ API:æœ€å¿«çš„çŠ¶æ€ç®¡ç†å®ç°

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/react-context-api-quickest-state-management-implementation-f9abd6658e66>

![](img/8ceb6ea7720cb8f772bc89d7902c79bf.png)

Redux æ˜¯åœ¨ä¸­å°å‹åº”ç”¨ç¨‹åºä¸­å®ç°å…¨å±€çŠ¶æ€ç®¡ç†çš„æœ‰æ•ˆæ–¹æ³•ã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šçœ‹åˆ°åœ¨ä½ çš„åº”ç”¨ä¸­å®ç°çŠ¶æ€ç®¡ç†çš„æœ€ç®€æ´ã€æœ€å¿«ã€æœ€ç®€å•çš„æ–¹æ³•ï¼è¿™äº›ç®€å•çš„æ­¥éª¤å°†èŠ±è´¹æ‚¨ä¸åˆ°äº”åˆ†é’Ÿçš„æ—¶é—´ï¼Œå¹¶ä¸”æ‚¨å°†å¯åŠ¨å¹¶è¿è¡Œæ‚¨è‡ªå·±çš„å…¨å±€çŠ¶æ€ç®¡ç†ç³»ç»Ÿã€‚

æˆ‘ä»¬å°†ä½¿ç”¨ React ä¸Šä¸‹æ–‡ APIï¼Œå®ƒå·²ç»åŒ…å«åœ¨ React ä¸­ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…ä¸ºè¿™ä¸ªé¡¹ç›®å®‰è£…ä»»ä½•é¢å¤–çš„åŒ…ã€‚

```
npx create-react-app contextpractice
```

æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«åˆå§‹é€»è¾‘çš„å°æ–‡ä»¶`state.js`ã€‚ä»£ç å°†åœ¨å¹•åä¸ºæ‚¨å¤„ç†ä¸€åˆ‡ï¼Œæ‰€ä»¥ç°åœ¨ä¸è¦æ‹…å¿ƒç†è§£å®ƒã€‚

ç„¶åå°†è¿™ä¸ªæ–‡ä»¶å¯¼å…¥åˆ°`App.js`ä¸­ã€‚

```
import { StateProvider } from "./state"
```

æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºå°†æ˜¯ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„å…¨å±€çŠ¶æ€æ¥å¢åŠ å’Œå‡å°‘ã€‚

åœ¨ App.js ä¸­ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä¸‰ä¸ªç®€å•çš„æ­¥éª¤:

1)åˆ›å»ºåˆå§‹çŠ¶æ€:

```
const initialState = {
   counter: 0
}
```

2)åˆ›å»ºä¸€ä¸ªå…·æœ‰å¢å‡åŠŸèƒ½çš„å‡é€Ÿå™¨:

```
const reducer = (state, action) => {
   switch (action.type) {
      case "increaseCounter":
         return {
            ...state,
            counter: state.counter + 1
         };
      case "decreaseCounter":
         return {
            ...state,
            counter: state.counter - 1
         };
      default:
         return state;
      }
};
```

3)ç”¨æˆ‘ä»¬åˆšåˆšå¯¼å…¥çš„`StateProvider`åŒ…è£…æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚

```
return (
   <StateProvider initialState={initialState} reducer={reducer}>
      <Counter />
   <StateProvider>
   )
}
```

æ‚¨çš„`App.js`æ–‡ä»¶åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

è¿™å°±æ˜¯æˆ‘ä»¬çš„å…¨çƒçŠ¶æ€ç®¡ç†ï¼æˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­åŒ…å«çš„ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨æˆ‘ä»¬çš„çŠ¶æ€ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è®¿é—®å’Œæ›´æ–°ç±»ç»„ä»¶ä¸­çš„çŠ¶æ€ã€‚

é¦–å…ˆåˆ›å»ºä¸€ä¸ª`Counter.js`æ–‡ä»¶ã€‚

ä»ä»»ä½•ç»„ä»¶è®¿é—®æˆ‘ä»¬çš„çŠ¶æ€åªéœ€ä¸‰ä¸ªç®€å•çš„æ­¥éª¤:

1.  å¯¼å…¥çŠ¶æ€ä¸Šä¸‹æ–‡:`import { StateContext } from ".state"`
2.  æ¸²æŸ“å‰åŠŸèƒ½:`static contextType = StateContext`
3.  æ¸²æŸ“å‡½æ•°ä¹‹åï¼Œè¿”å›ä¹‹å‰:`const [{ counter }, dispatch] = this.context`

æˆ‘ä»¬ç°åœ¨å¯ä»¥è®¿é—®`counter`çŠ¶æ€å˜é‡ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`dispatch`æ¥æ›´æ–°çŠ¶æ€:

ä¸åˆ° 5 åˆ†é’Ÿï¼Œæˆ‘ä»¬å°±åœ¨åº”ç”¨ç¨‹åºä¸­å®ç°äº†å…¨å±€çŠ¶æ€ç®¡ç†ï¼ğŸ‰

è®©æˆ‘ä»¬ç»ƒä¹ æ·»åŠ å¦ä¸€å—åˆ°æˆ‘ä»¬çš„çŠ¶æ€ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç»™æˆ‘ä»¬çš„`increaseCounter`å‡½æ•°ä¼ é€’ä¸€ä¸ªå‚æ•°å‘¢ï¼Ÿæ¯”å¦‚è¦é€’å¢çš„é‡ï¼Ÿè®©æˆ‘ä»¬åœ¨ App.js ä¸­åˆ›å»ºå¦ä¸€ä¸ªè®¡æ•°å™¨`counter2`ï¼Œä»¥åŠä¸€ä¸ªæ–°çš„`increase` / `decrease`è®¡æ•°å™¨å‡½æ•°:

æ³¨æ„ï¼Œåœ¨`increaseCounter2`ä¸­ï¼Œæˆ‘ä»¬è¯´:

```
counter: state.counter + action.increment
```

æˆ‘ä»¬å°†æŠŠä¸€ä¸ªåä¸º`increment`çš„å‚æ•°ä¼ é€’ç»™`Counter.js`ä¸­çš„`dispatch`å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ä¿å­˜æˆ‘ä»¬å¸Œæœ›è®¡æ•°å™¨å¢åŠ çš„å€¼ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„:

æˆ‘ä»¬çš„è°ƒåº¦å‡½æ•°ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·:

```
dispatch({type: "increaseCounter2", increment: 10})
```

å¢é‡å‚æ•°ç„¶åä½œä¸º`action.increment`ä¼ é€’ç»™æˆ‘ä»¬çš„ç¼©å‡å™¨ã€‚

æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œç•™ä¸‹ä¸€ç‚¹æŒå£°ï¼Œå¦‚æœè¿™ä¸ªè¿‡ç¨‹çš„ä»»ä½•éƒ¨åˆ†è®©ä½ æ„Ÿåˆ°å›°æƒ‘ï¼Œç•™ä¸‹è¯„è®ºğŸ‰

Github åº“:[https://github.com/deeayeen/mediumcontextpractice](https://github.com/deeayeen/medium-context)