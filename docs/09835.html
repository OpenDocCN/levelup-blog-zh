<html>
<head>
<title>Ionic React: Sharing data between views using Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ionic React:使用Redux在视图之间共享数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ionic-react-sharing-data-between-views-using-redux-1aca169a4cf2?source=collection_archive---------9-----------------------#2021-09-20">https://levelup.gitconnected.com/ionic-react-sharing-data-between-views-using-redux-1aca169a4cf2?source=collection_archive---------9-----------------------#2021-09-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5d8602998139930cc6cce44402c87726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jTpJQlqMn24lXdjC"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com/@cytngl?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡耶塔诺·吉尔</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="e01e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">React类似于狂野的西部。</p><p id="fe67" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以自由选择多个用户界面选项、路由方法选项，甚至状态存储选项。</p><p id="4481" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Ionic为其<strong class="ki iu">用户界面</strong>和<strong class="ki iu">路由器</strong>提供了一套现成的设置。这提供了两件事情，对于试图开始构建应用程序的开发者来说，通过提供健壮和严格的路由以及一整套可供选择的用户界面组件，在某种程度上减少了担心。两部分，完成了，不用担心。</p><p id="4bef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是如何在视图之间共享数据呢？我们如何确保数据从一个视图持续到另一个视图？在视图A和视图b之间共享数据肯定有更简单的方法。</p><p id="e5ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有几种简单的方法来实现这一点。在本指南中，我将重点介绍一种易于实现的持久化数据的方法，即使用React-Redux。</p><p id="a446" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">什么是React Redux？</strong></p><blockquote class="le lf lg"><p id="dd4a" class="kg kh lh ki b kj kk kl km kn ko kp kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">Redux是一个用于管理和集中应用程序状态的开源JavaScript库。</p></blockquote><p id="e22f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">——来自<a class="ae kf" href="https://en.wikipedia.org/wiki/Redux_(JavaScript_library)" rel="noopener ugc nofollow" target="_blank">维基百科</a></p><p id="82e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">这是另一个实施React Redux的指南吗？</strong></p><p id="f12b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一个有一个关键的区别…</p><p id="3700" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本指南基于在Ionic React上实现React Redux，以便创建持久数据状态。没有使用典型的Create React应用程序样板。</p><p id="94d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是基于在<a class="ae kf" href="https://react-redux.js.org/tutorials/quick-start" rel="noopener ugc nofollow" target="_blank"> React-Redux </a>网站上提供的快速入门指南，重点是使用Ionic React内置组件。</p><p id="608d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将建立一个Ionic应用程序，具有持久的名称状态，将在2个不同的视图中使用。</p><p id="345d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文中使用的版本</p><blockquote class="le lf lg"><p id="f50f" class="kg kh lh ki b kj kk kl km kn ko kp kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">Ionic CLI版本6.17.1</p></blockquote><h2 id="4e44" class="ll lm it bd ln lo lp dn lq lr ls dp lt kr lu lv lw kv lx ly lz kz ma mb mc md bi translated"><strong class="ak">步骤0。设置离子项目</strong></h2><p id="1212" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">要启动一个Ionic项目，从<code class="fe mj mk ml mm b">ionic start</code>开始。欲了解更多信息，请访问:</p><div class="mn mo gp gr mp mq"><a href="https://www.ionicframework.com" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">跨平台移动应用开发:Ionic框架</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">Ionic Framework的应用程序开发平台构建了令人惊叹的跨平台移动、web和桌面应用程序，只需一个…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">www.ionicframework.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne jz mq"/></div></div></a></div><p id="e6bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要忘记在项目类型选项中选择Ionic React项目。然后你可以选择任何项目类型，我推荐选择<em class="lh">空白</em>。</p><h2 id="3246" class="ll lm it bd ln lo lp dn lq lr ls dp lt kr lu lv lw kv lx ly lz kz ma mb mc md bi translated"><strong class="ak">第一步:安装React-Redux库和工具包</strong></h2><p id="f378" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">在命令行中运行以下命令，安装reduxjs工具包和React Redux库:</p><pre class="nf ng nh ni gt nj mm nk nl aw nm bi"><span id="3f93" class="ll lm it mm b gy nn no l np nq">npm install @reduxjs/toolkit react-redux</span></pre><h2 id="b2ec" class="ll lm it bd ln lo lp dn lq lr ls dp lt kr lu lv lw kv lx ly lz kz ma mb mc md bi translated"><strong class="ak">步骤2:设置功能并存储</strong></h2><p id="40db" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">创建两个文件，并将它们放在相应的文件夹中:</p><blockquote class="le lf lg"><p id="eb76" class="kg kh lh ki b kj kk kl km kn ko kp kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">1.app/store.tsx</p><p id="79aa" class="kg kh lh ki b kj kk kl km kn ko kp kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated">2.features/name.tsx</p></blockquote><p id="1563" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于name.tsx和store.tsx，文件内容如下:</p><p id="acf0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于name.tsx:</p><figure class="nf ng nh ni gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="62a2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第4行:这是我们给变量命名的地方，在这里，我们把它命名为‘name’</p><p id="6112" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第9行</strong>:是“reducers”或者可以用来修改“name”状态的动作类型。在这种情况下，我们希望它能够使用“changeValue”来更改值</p><p id="ec47" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于store.tsx:</p><figure class="nf ng nh ni gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="d2f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第6行</strong>:我们添加了state这个名称，因为这是我们希望在所有视图中保持的状态。</p><h2 id="0fac" class="ll lm it bd ln lo lp dn lq lr ls dp lt kr lu lv lw kv lx ly lz kz ma mb mc md bi translated"><strong class="ak">第三步:在视图或组件中实现</strong></h2><p id="b774" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">我们现在可以在相应的视图中实现上面的“名称”状态。我们可以创建一个新的组件，或者在我的例子中，我将使用Home.tsx视图并创建一个名为Next.tsx的新视图来显示持久数据。</p><p id="9c09" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">默认情况下，Home.tsx已经可用。在<em class="lh"> /pages/Next.tsx </em>处创建一个新文件</p><p id="40b9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Home.tsx中:</p><figure class="nf ng nh ni gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9285" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第6行和第7行:</strong>我们正在导入<em class="lh"> useState </em>用于钩子。与此同时，在第7行中，我们正在导入<em class="lh">used dispatch</em>和<em class="lh"> useSelector </em></p><p id="8144" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第12行和第14行:</strong>这就是神奇发生的地方！这在我们的应用程序中用来获取状态(<em class="lh"> useSelector </em>)并对状态进行更改(<em class="lh"> useDispatch </em>)。如果您注意到了，我们还通过设置状态<em class="lh">名称</em>初始化了将在第15行中使用的来自当前“名称”状态的值</p><p id="ca5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第25行到第29行</strong>:这是IonItem，我们在其中分派要存储在状态中的值，这个值稍后可以在Next.tsx中调用。这里的想法是当用户在IonInput中输入一个输入，然后按下Change Name按钮，这会将用户的输入分派并存储到状态中。相当简单，对吗？</p><p id="9085" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同时，在Next.tsx中</p><figure class="nf ng nh ni gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6d55" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第6行</strong>:使用<em class="lh">使用选择器，</em>我们将<em class="lh">名称</em>状态从要初始化的变量名称中取出。</p><p id="39bf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第20行</strong>:这里我们使用了前面提到的变量<em class="lh"> name </em>来显示状态中存储的内容。这是基于用户在<em class="lh"> Home.tsx </em>中输入的持久化数据</p><h2 id="2091" class="ll lm it bd ln lo lp dn lq lr ls dp lt kr lu lv lw kv lx ly lz kz ma mb mc md bi translated"><strong class="ak">第四步:将Next添加到App.tsx中</strong></h2><figure class="nf ng nh ni gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="cbee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第5行:</strong>导入Next.tsx</p><p id="4f59" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">第38–40行</strong>:在IonReactRouter下添加Next.tsx</p><p id="8dcd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将使我们能够使用<em class="lh"> /next </em>导航到<strong class="ki iu"> Next.tsx </strong>页面</p><p id="a720" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样！完成了。您现在可以更改名称值，并在整个Ionic React应用程序中持续使用。</p><ul class=""><li id="d580" class="nt nu it ki b kj kk kn ko kr nv kv nw kz nx ld ny nz oa ob bi translated">更正:</li></ul><p id="2691" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢乔纳森·阿斯伯里指出这一点。我忘记在应用程序中添加提供者和商店来实现这个功能。我们需要修改App.tsx以包含Provider和store，如下所示:</p><pre class="nf ng nh ni gt nj mm nk nl aw nm bi"><span id="a347" class="ll lm it mm b gy nn no l np nq">import { Provider } from 'react-redux'; //Add to line 1<br/>import store from './app/store'; //Add to line 2</span><span id="e4e6" class="ll lm it mm b gy oe no l np nq">...</span><span id="b029" class="ll lm it mm b gy oe no l np nq">&lt;Provider store={store}&gt; </span><span id="1816" class="ll lm it mm b gy oe no l np nq">//Add the above provider in between existing line 29-30 after //&lt;IonApp&gt;</span></pre><h2 id="a1b8" class="ll lm it bd ln lo lp dn lq lr ls dp lt kr lu lv lw kv lx ly lz kz ma mb mc md bi translated">结论</h2><p id="b169" class="pw-post-body-paragraph kg kh it ki b kj me kl km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">使用持久数据很重要，因为它会让你更容易构建一个应用程序。React Redux是NPM最流行的用于此目的的库之一。</p><p id="10f5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在以前的文章中做过的一个类似的方法是在Ionic Angular项目中使用NGXS。你可以在这里阅读:</p><div class="mn mo gp gr mp mq"><a href="https://javascript.plainenglish.io/the-easy-guide-using-state-management-with-ngxs-in-an-ionic-app-4d4e61c4e78" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">简单指南:在Ionic应用程序中使用NGXS的状态管理</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">把一个变量或一个对象的一部分保存在某个地方不是很容易吗，它可以在任何时候被调用…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mz l"><div class="of l nb nc nd mz ne jz mq"/></div></div></a></div><p id="a249" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一定要看一看。</p><p id="afab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这次到此为止。祝你愉快</p><p id="4ac5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lh">塞拉马特·孟加图拉</em></p></div></div>    
</body>
</html>