<html>
<head>
<title>Implementing JSON-RPC in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Pythonå®ç°JSON-RPC</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://levelup.gitconnected.com/implementing-json-rpc-in-python-6ff3ff84cb45?source=collection_archive---------3-----------------------#2022-08-03">https://levelup.gitconnected.com/implementing-json-rpc-in-python-6ff3ff84cb45?source=collection_archive---------3-----------------------#2022-08-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3d63" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">äº†è§£å¦‚ä½•ä½¿ç”¨HTTPå’ŒWebSocketså®ç°JSON-RPC</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/f32e742a238a9bf8adb39798049d5f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g-p1KH74IH0w_0AJ"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae le" href="https://unsplash.com/@hishahadat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">æ²™å“ˆè¾¾ç‰¹Â·æ‹‰èµ«æ›¼</a>åœ¨<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><p id="833e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¤§å¤šæ•°å…¨æ ˆå¼€å‘äººå‘˜éƒ½ç†Ÿæ‚‰webæœåŠ¡çš„æ¦‚å¿µåŠå…¶æ¶æ„é£æ ¼ï¼Œå°¤å…¶æ˜¯REST APIsã€‚é™¤äº†REST APIsï¼Œå¦ä¸€ç§åŒæ ·å¸¸è§çš„æ¶æ„é£æ ¼æ˜¯JSON-RPCã€‚</p><p id="ffeb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è§£é‡ŠJSON-RPCæ˜¯ä»€ä¹ˆï¼Œå®ƒä¸RESTç›¸æ¯”å¦‚ä½•ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå¦‚ä½•ä½¿ç”¨Pythonå®ç°å®ƒã€‚æˆ‘å°†å‘æ‚¨å±•ç¤ºJSON-RPCçš„ä¸¤ä¸ªç‰¹å®šå®ç°â€”â€”ç¬¬ä¸€ä¸ªä½¿ç”¨HTTPå®ç°ï¼Œç¬¬äºŒä¸ªä½¿ç”¨WebSocketså®ç°ã€‚</p><h1 id="517f" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">ä»€ä¹ˆæ˜¯JSON-RPC</h1><p id="3dd8" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated"><strong class="js iu"> JSON-RPC </strong>æ˜¯ä¸€ä¸ªä½¿ç”¨JSONè¿›è¡Œç¼–ç çš„è¿œç¨‹è¿‡ç¨‹åè®®ã€‚å¦‚æœæ‚¨ç†Ÿæ‚‰REST APIsï¼Œæ‚¨ä¼šçŸ¥é“ä¸ºäº†è®©å®¢æˆ·æœºä¸æœåŠ¡å™¨é€šä¿¡ï¼Œå®ƒä½¿ç”¨HTTPåŠ¨è¯æ¥è¡¨æ˜å…¶æ„å›¾:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/1ade89b690e31e7f34890ce81e700831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ANdkfXweavbBkKn7e5JoPA.png"/></div></div></figure><p id="b8f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¾‹å¦‚ï¼Œæ‚¨æƒ³é€šè¿‡REST APIå‘æœåŠ¡å™¨æ·»åŠ ä¸€ä¸ªæ–°é¡¹ç›®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PUTæˆ–POSTåŠ¨è¯æ¥æŒ‡ç¤ºæ­¤æ“ä½œã€‚åŒæ ·ï¼Œå¦‚æœæ‚¨æƒ³ä»æœåŠ¡å™¨æ£€ç´¢ä¸€äº›å€¼ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨GETåŠ¨è¯ã€‚ä½œä¸ºå›æŠ¥ï¼ŒREST APIå°†ä»¥JSONæˆ–XMLå­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ç»“æœã€‚</p><p id="44d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">JSON-RPCçš„å·¥ä½œæ–¹å¼ä¸REST APIséå¸¸ç›¸ä¼¼â€”â€”JSON-RPCå¯ä»¥ä½¿ç”¨HTTPæˆ–WebSocketsæ¥å®ç°ã€‚ä½†æ˜¯åœ¨JSON-RPCä¸­ï¼Œæ‚¨ä¸å¿…ä½¿ç”¨HTTPåŠ¨è¯æ¥æŒ‡ç¤ºæ‚¨æƒ³è¦çš„åŠ¨ä½œã€‚ç›¸åï¼Œæ‚¨åªéœ€åœ¨æœåŠ¡å™¨ç«¯è°ƒç”¨æ‚¨æƒ³è¦è°ƒç”¨çš„å‡½æ•°:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mj"><img src="../Images/e10ad76362d437e853331571dea01b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6NQUXL3Q5kiQcbCz1PpOg.png"/></div></div></figure><p id="6ba5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å‘JSON-RPCæœåŠ¡å™¨å‘å‡ºçš„è¯·æ±‚ç”±ä¸‰ä¸ªæˆå‘˜ç»„æˆ:</p><ul class=""><li id="2a6c" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated"><code class="fe mt mu mv mw b"><strong class="js iu">method</strong></code> â€”è¦åœ¨æœåŠ¡å™¨ä¸Šè°ƒç”¨çš„å‡½æ•°çš„åç§°</li><li id="e8bd" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated"><code class="fe mt mu mv mw b"><strong class="js iu">params</strong></code> <strong class="js iu"> </strong> â€”è¦ä¼ é€’ç»™æ­£åœ¨è°ƒç”¨çš„å‡½æ•°ä¸­çš„å‚æ•°çš„è‡ªå˜é‡</li><li id="e3a7" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated"><code class="fe mt mu mv mw b"><strong class="js iu">id</strong></code> â€”æœåŠ¡å™¨å›å¤æ—¶å‚è€ƒçš„å­—ç¬¦ä¸²æˆ–æ•°å­—</li></ul><p id="e2c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœåŠ¡å™¨åœ¨è°ƒç”¨è¢«è°ƒç”¨çš„å‡½æ•°æ—¶ï¼Œå°†åœ¨JSONä¸­è¿”å›åŒ…å«ä»¥ä¸‹å†…å®¹çš„ç»“æœ:</p><ul class=""><li id="3756" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated"><code class="fe mt mu mv mw b"><strong class="js iu">result</strong></code> <strong class="js iu"> / </strong> <code class="fe mt mu mv mw b"><strong class="js iu">error</strong></code> â€”è¦ä¹ˆæ˜¯æ–¹æ³•æ‰§è¡Œçš„ç»“æœï¼Œè¦ä¹ˆæ˜¯è°ƒç”¨å‡½æ•°å‡ºé”™æ—¶çš„é”™è¯¯</li><li id="1302" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated"><code class="fe mt mu mv mw b"><strong class="js iu">id</strong></code> â€”å¯¹åº”äºæœåŠ¡å™¨æ­£åœ¨å“åº”çš„è¯·æ±‚çš„å­—ç¬¦ä¸²æˆ–æ•°å­—</li></ul><p id="7e49" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸‹å›¾æ€»ç»“äº†ä¸Šè¿°ç»„ä»¶:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nc"><img src="../Images/00f5b6e6e7d547d952ac88443364e3f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dsuldZp-oVJVVyaq0r07mQ.png"/></div></div></figure><p id="086c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¯·æ³¨æ„ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯åªæ˜¯æƒ³å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œè€Œä¸è¦æ±‚æœåŠ¡å™¨è¿”å›ç»“æœã€‚è¿™è¢«ç§°ä¸º<em class="nd">é€šçŸ¥</em>ã€‚åœ¨é€šçŸ¥çš„æƒ…å†µä¸‹ï¼Œ<strong class="js iu"> id </strong>ç»„ä»¶ä¸éœ€è¦å‡ºç°ã€‚</p><p id="53e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœ‰å…³JSON-RPCçš„æ›´å¤šç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹æœ€æ–°çš„2.0è§„èŒƒ:</p><div class="ne nf gp gr ng nh"><a href="https://www.jsonrpc.org/specification" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">JSON-RPC 2.0è§„èŒƒ</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">èµ·æºæ—¥æœŸ:2010â€“03â€“26(åŸºäº2009â€“05â€“24ç‰ˆæœ¬)JSON-RPCæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„è½»é‡çº§è¿œç¨‹è¿‡ç¨‹è°ƒç”¨â€¦</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">www.jsonrpc.org</p></div></div></div></a></div><h1 id="c038" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">ä½¿ç”¨HTTPå®ç°JSON-RPC</h1><p id="0b42" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">æ—¢ç„¶æ‚¨å·²ç»å¯¹ä»€ä¹ˆæ˜¯JSON-RPCæœ‰äº†æ›´æ¸…æ™°çš„æ¦‚å¿µï¼Œé‚£ä¹ˆç°åœ¨æ˜¯æ—¶å€™è‡ªå·±å®ç°ä¸€ä¸ªJSON-RPCäº†ã€‚æˆ‘ä»¬å°†é¦–å…ˆä½¿ç”¨HTTPå®ç°ä¸€ä¸ªã€‚</p><h2 id="59a7" class="nq lg it bd lh nr ns dn ll nt nu dp lp kb nv nw lt kf nx ny lx kj nz oa mb ob bi translated">ä½¿ç”¨jsonrpcserverå®ç°æœåŠ¡å™¨</h2><p id="d7a7" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">ä¸ºäº†å¸®åŠ©æˆ‘ä»¬å®ç°JSON-RPCæœåŠ¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong class="js iu"> jsonrpcserver </strong>æ¨¡å—:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="6137" class="nq lg it mw b gy og oh l oi oj">$ pip install jsonrpcserver</span></pre><p id="75f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<strong class="js iu"> server.py </strong>çš„æ–°æ–‡ä»¶ï¼Œå¹¶ç”¨ä»¥ä¸‹å†…å®¹å¡«å……å®ƒ:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="d57a" class="nq lg it mw b gy og oh l oi oj">from jsonrpcserver import Success, method, serve, <br/>    InvalidParams, Result, Error<br/>import re</span><span id="9204" class="nq lg it mw b gy ok oh l oi oj">@method<a class="ae le" href="http://twitter.com/method" rel="noopener ugc nofollow" target="_blank"><br/></a>def validEmail(email) -&gt; Result:    <br/>    if email == "":<br/>        return Error(code=123, message="Empty email provided")<br/>    if re.match("^[a-zA-Z0-9-_]+@[a-zA-Z0-9]+\.[a-z]{1,3}$", email):    <br/>        return Success(True)<br/>    else:<br/>        return Success(False)</span><span id="c127" class="nq lg it mw b gy ok oh l oi oj">@method<br/>def validZipCode(zip) -&gt; Result: <br/>    if zip == "":<br/>        return InvalidParams("Null value")<br/>    if re.match("^[0-9]{5}(?:-[0-9]{4})?$", zip):<br/>        result = { "zip": zip, "result" : "Valid Zipcode" }<br/>    else:<br/>        result = { "zip": zip, "result" : "Invalid Zipcode" }<br/>    return Success(result)</span><span id="686f" class="nq lg it mw b gy ok oh l oi oj">if __name__ == "__main__":<br/>    serve('localhost', 5001)</span></pre><p id="d796" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘:</p><ul class=""><li id="f881" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">å®ç°äº†ä¸¤ä¸ªå‡½æ•°(åœ¨JSON-RPCä¸­ç§°ä¸º<em class="nd">è¿‡ç¨‹</em>)â€”<code class="fe mt mu mv mw b">validEmail()</code>å’Œ<code class="fe mt mu mv mw b">validZipCode()</code>ã€‚</li><li id="6492" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated">è¿™äº›å‡½æ•°ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ¥å—ä¸€ä¸ªå‚æ•°(å¦‚æœéœ€è¦ï¼Œå¯ä»¥æ¥å—å¤šä¸ªå‚æ•°)å¹¶äº§ç”Ÿä¸€ä¸ª<code class="fe mt mu mv mw b">Result</code>å¯¹è±¡ã€‚</li><li id="ec20" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated">è¿™ä¸¤ä¸ªå‡½æ•°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯ç”µå­é‚®ä»¶å’Œé‚®æ”¿ç¼–ç ã€‚</li><li id="0cd6" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated">ä¸ºäº†å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ª<code class="fe mt mu mv mw b">Success</code>ã€<code class="fe mt mu mv mw b">Error</code>æˆ–<code class="fe mt mu mv mw b">InvalidParams</code>å¯¹è±¡ã€‚<code class="fe mt mu mv mw b">Error</code>å¯¹è±¡å…è®¸æ‚¨æŒ‡å®šè‡ªå·±çš„åº”ç”¨ç¨‹åºå®šä¹‰çš„é”™è¯¯ä»£ç å’Œæ¶ˆæ¯ã€‚<code class="fe mt mu mv mw b">InvalidParams</code>å¯¹è±¡æ˜¯<code class="fe mt mu mv mw b">Error</code>å¯¹è±¡çš„å¿«æ·æ–¹å¼ï¼Œé€šå¸¸åœ¨æ‚¨æƒ³è¦é€šçŸ¥å®¢æˆ·ç«¯å‘é€çš„å‚æ•°æ— æ•ˆ(ä¾‹å¦‚è¶…å‡ºèŒƒå›´)æ—¶ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ<code class="fe mt mu mv mw b">validZipCode()</code>å‡½æ•°æ”¶åˆ°ä¸€ä¸ªç©ºçš„é‚®æ”¿ç¼–ç ï¼Œè€Œä¸æ˜¯è¯´:</li></ul><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="3a3f" class="nq lg it mw b gy og oh l oi oj">return Error(-32602, "Invalid params", "Null value")</span></pre><p id="0697" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä½ å¯ä»¥ç®€å•åœ°ä½¿ç”¨<code class="fe mt mu mv mw b">InvalidParams</code>å¯¹è±¡:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="5544" class="nq lg it mw b gy og oh l oi oj">return InvalidParams("Null value")</span></pre><blockquote class="ol om on"><p id="5d58" class="jq jr nd js b jt ju jv jw jx jy jz ka oo kc kd ke op kg kh ki oq kk kl km kn im bi translated">æ¨èçš„JSON-RPCé”™è¯¯ä»£ç åˆ—è¡¨å¯ä»¥ä»<a class="ae le" href="https://www.jsonrpc.org/specification" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> JSON-RPC 2.0è§„èŒƒ</strong> </a> <strong class="js iu">ä¸­æ‰¾åˆ°ã€‚</strong></p></blockquote><ul class=""><li id="7b83" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">å‡½æ•°è¿”å›çš„ç»“æœä½¿ç”¨JSONè‡ªåŠ¨ç¼–ç ã€‚</li><li id="3fa3" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated">æœ€åï¼Œè¯¥æœåŠ¡ä¾¦å¬æœ¬åœ°è®¡ç®—æœºä¸Šçš„ç«¯å£5001ã€‚</li></ul><h2 id="72d2" class="nq lg it bd lh nr ns dn ll nt nu dp lp kb nv nw lt kf nx ny lx kj nz oa mb ob bi translated">æµ‹è¯•æœåŠ¡å™¨</h2><p id="35e9" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">è¦æµ‹è¯•æœåŠ¡å™¨ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­è¿è¡Œåº”ç”¨ç¨‹åº:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="6d72" class="nq lg it mw b gy og oh l oi oj">$ <strong class="mw iu">python server.py</strong></span></pre><p id="9d91" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æµ‹è¯•æœåŠ¡æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨<strong class="js iu"> curl </strong>:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="a8e7" class="nq lg it mw b gy og oh l oi oj">$ <strong class="mw iu">curl -X POST http://localhost:5001 -d '{"jsonrpc": "2.0", "method": "validEmail", "params": {"email": ""}, "id": 1}'</strong></span></pre><p id="1a1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸Šé¢çš„å‘½ä»¤è°ƒç”¨<code class="fe mt mu mv mw b">validEmail()</code>å‡½æ•°ï¼Œå¹¶ä¸º<code class="fe mt mu mv mw b">email</code>å‚æ•°ä¼ é€’ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚æœåŠ¡å™¨çš„å“åº”æ˜¯:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="6e78" class="nq lg it mw b gy og oh l oi oj">{"jsonrpc": "2.0", "error": {"code": 123, "message": "Empty email provided"}, "id": 1}</span></pre><p id="2643" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç°åœ¨è®©æˆ‘ä»¬å°è¯•å‘é€ä¸€å°æœ‰æ•ˆçš„ç”µå­é‚®ä»¶:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="f058" class="nq lg it mw b gy og oh l oi oj">$ curl -X POST http://localhost:5001 -d '{"jsonrpc": "2.0", "method": "validEmail", "params": <strong class="mw iu">{"email": "weimenglee@gmail.com"}</strong>, "id": 1}'</span></pre><p id="2e5f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å›åº”æ˜¯:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="f57c" class="nq lg it mw b gy og oh l oi oj">{"jsonrpc": "2.0", "result": true, "id": 1}</span></pre><p id="cc26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœä½ è¯•å›¾ç”¨é”™è¯¯çš„å‚æ•°åè°ƒç”¨<code class="fe mt mu mv mw b">validEmail()</code>å‡½æ•°:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="22f4" class="nq lg it mw b gy og oh l oi oj">curl -X POST http://localhost:5001 -d '{"jsonrpc": "2.0", "method": "<strong class="mw iu">validEmail</strong>", "params": {"<strong class="mw iu">zip</strong>": "weimenglee@gmail"}, "id": 1}'</span></pre><p id="2f9c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ‚¨å°†å¾—åˆ°<em class="nd">æ— æ•ˆå‚æ•°</em>é”™è¯¯:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="07e1" class="nq lg it mw b gy og oh l oi oj">{"jsonrpc": "2.0", "error": {"code": -32602, "message": "Invalid params", "data": "missing a required argument: 'email'"}, "id": 1}</span></pre><p id="cdda" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åŒæ ·ï¼Œå¦‚æœæ‚¨è°ƒç”¨<code class="fe mt mu mv mw b">validZipCode()</code>å‡½æ•°å¹¶ä¸º<code class="fe mt mu mv mw b">zip</code>å‚æ•°å‘é€ä¸€ä¸ªç©ºå€¼:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="2ca5" class="nq lg it mw b gy og oh l oi oj">curl -X POST http://localhost:5001 -d '{"jsonrpc": "2.0", "method": "validZipCode", "params": {"zip": ""}, "id": 1}'</span></pre><p id="d644" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ‚¨å°†å¾—åˆ°<em class="nd">æ— æ•ˆå‚æ•°</em>é”™è¯¯ï¼Œä½†æ˜¯åœ¨<code class="fe mt mu mv mw b">data</code>ä¸­æœ‰è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="4cd0" class="nq lg it mw b gy og oh l oi oj">{"jsonrpc": "2.0", "error": {"code": -32602, "message": "Invalid params", <strong class="mw iu">"data": "Null value"</strong>}, "id": 1}</span></pre><h2 id="12d2" class="nq lg it bd lh nr ns dn ll nt nu dp lp kb nv nw lt kf nx ny lx kj nz oa mb ob bi translated">ä½¿ç”¨jsonrpclibå®ç°å®¢æˆ·ç«¯</h2><p id="12b1" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">æ˜¾ç„¶ï¼Œä½¿ç”¨<em class="nd"> curl </em>è¿›è¡Œæµ‹è¯•ä»…ç”¨äºå¼€å‘é˜¶æ®µã€‚åœ¨ç”Ÿäº§ä¸­ï¼Œæ‚¨éœ€è¦ç¼–å†™ä¸€ä¸ªå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ¥è°ƒç”¨æœåŠ¡å™¨ä¸­çš„å‡½æ•°ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<strong class="js iu"> jsonrpclib </strong>æ¨¡å—:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="f1b3" class="nq lg it mw b gy og oh l oi oj">$ pip install jsonrpclib</span></pre><p id="50c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸€æ—¦æ¨¡å—å®‰è£…å®Œæ¯•ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º<strong class="js iu"> client.py </strong>çš„æ–°æ–‡ä»¶ï¼Œå¹¶åœ¨å…¶ä¸­å¡«å…¥ä»¥ä¸‹å†…å®¹:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="f27d" class="nq lg it mw b gy og oh l oi oj">from jsonrpclib import Server<br/>import sys</span><span id="4377" class="nq lg it mw b gy ok oh l oi oj">def main():<br/>    server = Server('<a class="ae le" href="http://localhost:5001'" rel="noopener ugc nofollow" target="_blank">http://localhost:5001'</a>)<br/>    try:<br/>        print(server.validEmail("<a class="ae le" href="mailto:weimenglee@gmail.com" rel="noopener ugc nofollow" target="_blank">weimenglee@gmail.com</a>"))<br/>        print(server.validZipCode("12345"))<br/>    except:<br/>        print("Error: ", sys.exc_info())</span><span id="3482" class="nq lg it mw b gy ok oh l oi oj">if __name__ == '__main__':<br/>    main()</span></pre><p id="4cbe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸Šé¢çš„ä»£ç è¿æ¥åˆ°æœåŠ¡å™¨çš„ç«¯å£5001ã€‚ç„¶åå®ƒè¿œç¨‹è°ƒç”¨<code class="fe mt mu mv mw b">validEmail()</code>å’Œ<code class="fe mt mu mv mw b">validZipCode()</code>å‡½æ•°ã€‚</p><p id="5dae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¦è¿è¡Œå®¢æˆ·ç«¯ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­é”®å…¥ä»¥ä¸‹å‘½ä»¤:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="a8c6" class="nq lg it mw b gy og oh l oi oj">$ <strong class="mw iu">python client.py</strong></span></pre><p id="b3fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡º:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="43ca" class="nq lg it mw b gy og oh l oi oj">True<br/>{'zip': '12345', 'result': 'Valid Zipcode'}</span></pre><h1 id="3901" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">ä½¿ç”¨WebSocketså®ç°JSON-RPC</h1><p id="21b7" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»ä½¿ç”¨HTTPå®ç°äº†ä¸€ä¸ªJSON-RPCæœåŠ¡ï¼Œæ˜¯æ—¶å€™çœ‹çœ‹å¦‚ä½•ä½¿ç”¨<strong class="js iu"> WebSockets </strong>å®ç°å®ƒäº†ã€‚</p><blockquote class="ol om on"><p id="15c6" class="jq jr nd js b jt ju jv jw jx jy jz ka oo kc kd ke op kg kh ki oq kk kl km kn im bi translated">WebSocketæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œé€šè¿‡å•ä¸€TCPè¿æ¥æä¾›å…¨åŒå·¥é€šä¿¡é€šé“ã€‚</p></blockquote><h2 id="d18e" class="nq lg it bd lh nr ns dn ll nt nu dp lp kb nv nw lt kf nx ny lx kj nz oa mb ob bi translated">ä½¿ç”¨jsonrpcserverå®ç°æœåŠ¡å™¨</h2><p id="0f8d" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ä¸æˆ‘ä»¬ä¹‹å‰åœ¨å½“å‰WebSocketså®ç°ä¸­ä½¿ç”¨çš„ç›¸åŒçš„<strong class="js iu"> jsonrpcserver </strong>æ¨¡å—ã€‚</p><p id="5911" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<strong class="js iu"> server_ws.py </strong>çš„æ–‡ä»¶ï¼Œå¹¶ç”¨ä»¥ä¸‹å†…å®¹å¡«å……å®ƒ:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="9e21" class="nq lg it mw b gy og oh l oi oj">from jsonrpcserver import method, Success, Result, Error, <br/>    InvalidParams, async_dispatch<br/>import websockets<br/>import asyncio<br/>import re</span><span id="f7e8" class="nq lg it mw b gy ok oh l oi oj">@method<br/>async def validEmail(email) -&gt; Result:<br/>    if email == "":        <br/>        return Error(code=123, message="Empty email provided")<br/>    if re.match("^[a-zA-Z0-9-_]+@[a-zA-Z0-9]+\.[a-z]{1,3}$", email):    <br/>        return Success("Valid Email")<br/>    else:<br/>        return Success("Invalid Email")</span><span id="6c2e" class="nq lg it mw b gy ok oh l oi oj">@method<br/>async def validZipCode(zip) -&gt; Result:<br/>    if zip == "":<br/>        return InvalidParams("Null value")<br/>    if re.match("^[0-9]{5}(?:-[0-9]{4})?$", zip):<br/>        result = { "zip": zip, "result" : "Valid Zipcode" }<br/>    else:<br/>        result = { "zip": zip, "result" : "Invalid Zipcode" }<br/>    return Success(result)</span><span id="6d56" class="nq lg it mw b gy ok oh l oi oj">async def main(websocket, path):<br/>    if response := await async_dispatch(await websocket.recv()):<br/>        await websocket.send(response)</span><span id="e405" class="nq lg it mw b gy ok oh l oi oj">start_server = websockets.serve(main, "localhost", 5002)<br/>asyncio.get_event_loop().run_until_complete(start_server)<br/>asyncio.get_event_loop().run_forever()</span></pre><p id="4a8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šï¼ŒJSON-RPCéƒ¨åˆ†ç±»ä¼¼äºä½¿ç”¨HTTPçš„éƒ¨åˆ†ã€‚å€¼å¾—æ³¨æ„çš„å˜åŒ–æ˜¯ä½¿ç”¨WebSocketså¼‚æ­¥ç›‘å¬ä¼ å…¥è¿æ¥çš„éƒ¨åˆ†ã€‚</p><p id="6398" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¦è¿è¡ŒæœåŠ¡å™¨ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­é”®å…¥ä»¥ä¸‹å‘½ä»¤:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="de88" class="nq lg it mw b gy og oh l oi oj">$ <strong class="mw iu">python server_ws.py</strong></span></pre><h2 id="5ab9" class="nq lg it bd lh nr ns dn ll nt nu dp lp kb nv nw lt kf nx ny lx kj nz oa mb ob bi translated">ä½¿ç”¨jsonrpcclientå®ç°å®¢æˆ·ç«¯</h2><p id="8059" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">ä¸ºäº†ä½¿ç”¨åœ¨WebSocketsä¸­å®ç°çš„JSON-RPCï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong class="js iu"> jsonrpcclient </strong>æ¨¡å—:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="725b" class="nq lg it mw b gy og oh l oi oj">$ pip install jsonrpcclient</span></pre><blockquote class="ol om on"><p id="f7ea" class="jq jr nd js b jt ju jv jw jx jy jz ka oo kc kd ke op kg kh ki oq kk kl km kn im bi translated">jsonrpcclientæ¨¡å—åŒ…å«å¸®åŠ©å‡½æ•°ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å°†å‡½æ•°å‚æ•°è½¬æ¢æˆJSON-RPCå…¼å®¹çš„JSONå­—ç¬¦ä¸²ã€‚å®ƒè¿˜å¸®åŠ©æ‚¨è§£ç JSON-RPCå‡½æ•°è¿”å›çš„å“åº”ã€‚</p></blockquote><p id="ebe8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åˆ›å»ºä¸€ä¸ªåä¸º<strong class="js iu"> client_ws.py </strong>çš„æ–‡ä»¶ï¼Œå¹¶ç”¨ä»¥ä¸‹å†…å®¹å¡«å……å®ƒ(æˆ‘ç”¨ç²—ä½“æ˜¾ç¤ºäº†å‘é€åˆ°æœåŠ¡å™¨çš„JSONå’ŒæœåŠ¡å™¨è¿”å›çš„å“åº”):</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="c938" class="nq lg it mw b gy og oh l oi oj">import asyncio<br/>import logging</span><span id="2ebc" class="nq lg it mw b gy ok oh l oi oj">from jsonrpcclient import Ok, parse_json, request_json<br/>import websockets</span><span id="079d" class="nq lg it mw b gy ok oh l oi oj">async def main():<br/>    async with websockets.connect("ws://localhost:5002") as ws:        <br/>        req = request_json("validZipCode", {"zip":"12345"})<br/><strong class="mw iu">        print(req) </strong><br/>        await ws.send(req)<br/>        result = await ws.recv()<br/><strong class="mw iu">        print(result)</strong>  <br/>        response = parse_json(result)</span><span id="c4ab" class="nq lg it mw b gy ok oh l oi oj">    if isinstance(response, Ok):<br/>        print(response.result)<br/>    else:        <br/>        logging.error(response.message)</span><span id="27c3" class="nq lg it mw b gy ok oh l oi oj">asyncio.get_event_loop().run_until_complete(main())</span></pre><p id="3c0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¦è¿è¡Œå®¢æˆ·ç«¯ï¼Œè¯·åœ¨ç»ˆç«¯ä¸­é”®å…¥ä»¥ä¸‹å†…å®¹:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="cc83" class="nq lg it mw b gy og oh l oi oj">$ <strong class="mw iu">python client_ws.py</strong></span></pre><p id="918b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">é¦–å…ˆï¼Œæ‚¨å°†çœ‹åˆ°ç”±<code class="fe mt mu mv mw b">request_json()</code>å‡½æ•°ç”Ÿæˆçš„JSONå­—ç¬¦ä¸²(æ¥è‡ª<strong class="js iu"> jsonrpcclient </strong>æ¨¡å—):</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="e58c" class="nq lg it mw b gy og oh l oi oj">{"jsonrpc": "2.0", "method": "validZipCode", "params": {"zip": "12345"}, "id": 1}</span></pre><p id="2b4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ¥ä¸‹æ¥ï¼Œæ‚¨å°†çœ‹åˆ°æœåŠ¡å™¨è¿”å›çš„ç»“æœ:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="8d6a" class="nq lg it mw b gy og oh l oi oj">{"jsonrpc": "2.0", "result": {"zip": "12345", "result": "Valid Zipcode"}, "id": 1}</span></pre><p id="a471" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœ€åï¼Œå®¢æˆ·æœºå°†æ‰“å°å‡º<code class="fe mt mu mv mw b">result</code>é”®çš„å€¼:</p><pre class="kp kq kr ks gt oc mw od oe aw of bi"><span id="74bf" class="nq lg it mw b gy og oh l oi oj">{'zip': '12345', 'result': 'Valid Zipcode'}</span></pre><div class="ne nf gp gr ng nh"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">åŠ å…¥åª’ä»‹ä¸æˆ‘çš„ä»‹ç»é“¾æ¥-æä¼Ÿå­Ÿ</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">é˜…è¯»æç»´å­Ÿ(ä»¥åŠåª’ä½“ä¸Šæˆåƒä¸Šä¸‡çš„å…¶ä»–ä½œå®¶)çš„æ¯ä¸€ä¸ªæ•…äº‹ã€‚æ‚¨çš„ä¼šå‘˜è´¹ç›´æ¥æ”¯æŒâ€¦</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">weimenglee.medium.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow ky nh"/></div></div></a></div><h1 id="1969" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak">æ€»ç»“</strong></h1><p id="c543" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å·²ç»æ¸…æ¥šåœ°è§£é‡Šäº†ä»€ä¹ˆæ˜¯JSON-RPCæœåŠ¡ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨HTTPæˆ–WebSocketså®ç°å®ƒã€‚å¦‚æœæ‚¨ç›®å‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨JSON-RPCï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ã€‚</p></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><p id="aa14" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼åœ¨ä½ ç¦»å¼€ä¹‹å‰:</p><ul class=""><li id="c3ca" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">ğŸ‘ä¸ºæ•…äº‹é¼“æŒï¼Œè·Ÿç€ä½œè€…èµ°ğŸ‘‰</li><li id="06a6" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated">ğŸ“°æŸ¥çœ‹<a class="ae le" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">å‡çº§ç¼–ç å‡ºç‰ˆç‰©</a>ä¸­çš„æ›´å¤šå†…å®¹</li><li id="8257" class="mk ml it js b jt mx jx my kb mz kf na kj nb kn mp mq mr ms bi translated">ğŸ””å…³æ³¨æˆ‘ä»¬:<a class="ae le" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae le" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae le" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">æ—¶äº‹é€šè®¯</a></li></ul><p id="4e88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ğŸš€ğŸ‘‰<a class="ae le" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">åŠ å…¥å‡çº§äººæ‰é›†ä½“ï¼Œæ‰¾åˆ°ä¸€ä»½ç¥å¥‡çš„å·¥ä½œ</strong> </a></p></div></div>    
</body>
</html>