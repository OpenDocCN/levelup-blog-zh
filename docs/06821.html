<html>
<head>
<title>filter: Learn JavaScript’s Array Methods by Building Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">过滤器:通过构建来学习JavaScript的数组方法</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/filter-learn-javascripts-array-methods-by-building-them-6ed9b1a10033?source=collection_archive---------15-----------------------#2021-01-04">https://levelup.gitconnected.com/filter-learn-javascripts-array-methods-by-building-them-6ed9b1a10033?source=collection_archive---------15-----------------------#2021-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ef4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本系列的第四篇文章中，我们将探索filter方法，以及如何使用它来获取大型数组的子集。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/3b26e9e31af74a8c1fcf66ea6b24edcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tvh6VDAdwcUxikYoXtcuMw.png"/></div></div></figure><h1 id="2d11" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h1><p id="dcba" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">正如我们在<code class="fe ma mb mc md b">map</code>的实现中看到的，创建数组的子集是JavaScript中非常常见的任务。使用<code class="fe ma mb mc md b">map</code>，我们转换数组中的每一项。使用<code class="fe ma mb mc md b">filter</code>，我们可以根据某种条件得到数组的子集。</p><p id="e96c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我解释JavaScript内置数组方法的系列文章中的第四篇，特别关注它们如何工作以及如何构建自己的数组方法。在我花了4年时间教数百人如何编码的过程中，我发现思考这些数组方法是如何工作的，最终会让他们为学习JavaScript的人所接受。<code class="fe ma mb mc md b">filter</code>是您工具箱中的一个强大方法，所以让我们来探索一下它是如何工作的。</p><h1 id="73cb" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">它是如何工作的</h1><p id="87c6" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><code class="fe ma mb mc md b">filter</code>方法接受一个回调并对数组中的每一项调用它。然后它测试回调的返回值是否真实。如果是，那么它会将值添加到一个新数组中。如果返回值不真实，则跳过该值。最后，我们剩下的是传递给回调函数时返回true的所有值。</p><p id="71a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">举个简单的例子，让我们从一个数组中获取所有的偶数。在JavaScript中，我们知道一个数是偶数，即使它除以2的余数是0(使用模运算符):</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="1cc1" class="mi ky iq md b gy mj mk l ml mm">// Even numbers<br/>let num = 6<br/>if (num % 2 === 0) {<br/>	console.log(num + " is even!")<br/>}</span></pre><p id="490b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以在函数中使用它来测试参数是否是偶数:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="fee2" class="mi ky iq md b gy mj mk l ml mm">function isEven(num) {<br/>	if (num % 2 === 0) {<br/>		return true<br/>	} else {<br/>		return false<br/>	}<br/>}</span><span id="e171" class="mi ky iq md b gy mn mk l ml mm">isEven(6) // true<br/>isEven(7) // false</span></pre><p id="a629" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了一个测试数字是偶数还是奇数的函数，我们可以用它来测试数组中的每个数字，方法是将它传递给<code class="fe ma mb mc md b">.filter()</code>:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="4e16" class="mi ky iq md b gy mj mk l ml mm">let nums = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]</span><span id="564d" class="mi ky iq md b gy mn mk l ml mm">let evens = nums.filter(isEven)</span><span id="9495" class="mi ky iq md b gy mn mk l ml mm">console.log(evens) // [ 2, 4, 6, 8, 10 ]</span></pre><p id="8443" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ma mb mc md b">.filter()</code>方法接受我们的<code class="fe ma mb mc md b">isEven</code>函数(作为回调)并在数组中的每一项上调用它。如果<code class="fe ma mb mc md b">isEven</code>返回<code class="fe ma mb mc md b">true</code>，那么我们将当前项添加到一个新数组中；如果它返回<code class="fe ma mb mc md b">false</code>，那么我们跳过当前项。当<code class="fe ma mb mc md b">filter()</code>结束对<code class="fe ma mb mc md b">nums</code>数组的循环时，它返回一个新的数组，该数组包含所有在传递给<code class="fe ma mb mc md b">isEven</code>时返回<code class="fe ma mb mc md b">true</code>的项目。</p><p id="6d9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能有点难以理解。所以与其多解释，不如实现自己的。看到代码会帮助你理解<code class="fe ma mb mc md b">filter</code>做得比其他任何事情都好。</p><h1 id="9893" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">实现我们自己的</h1><p id="18f9" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">为了实现我们自己版本的<code class="fe ma mb mc md b">filter</code>方法，我们需要定义一个函数来执行以下操作:</p><ul class=""><li id="9d3f" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated">接受数组和回调函数作为参数</li><li id="8e75" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">创建一个新的空数组，我们将在最后返回</li><li id="f8a9" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">循环遍历数组，对每一项调用回调</li><li id="0aed" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">如果回调返回一个真值，那么将当前项添加到新数组中</li><li id="832d" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">如果回调返回falsey值，则跳过将当前项添加到新数组的步骤</li><li id="e845" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated">当循环结束时，返回新数组</li></ul><p id="57d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将一步一步地完成这个过程，首先创建一个名为<code class="fe ma mb mc md b">filter</code>的函数，它接受一个数组和一个回调作为参数:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="1f8d" class="mi ky iq md b gy mj mk l ml mm">function filter(items, cb) {<br/>	// More to come here ...<br/>}</span></pre><p id="43cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的第一个参数，<code class="fe ma mb mc md b">items</code>，将是传入数组。第二个项目，<code class="fe ma mb mc md b">cb</code>，将是回调。(作为旁注，<code class="fe ma mb mc md b">cb</code>是JavaScript中<em class="nc">回调</em>的常见简写。)</p><p id="d28e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们需要创建一个空数组，我们将在函数结束时返回该数组:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="e456" class="mi ky iq md b gy mj mk l ml mm">function filter(items, cb) {<br/>	let final = []</span><span id="2136" class="mi ky iq md b gy mn mk l ml mm">	// More to come here ...</span><span id="6f82" class="mi ky iq md b gy mn mk l ml mm">	return final<br/>}</span></pre><p id="05a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以给这个数组起任何你喜欢的名字，只要它是有意义的。调用这个数组<code class="fe ma mb mc md b">final</code>，因为它将是这个函数的最终结果，在这种情况下是一个相当常见的名字。</p><p id="f15f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了<code class="fe ma mb mc md b">final</code>数组，我们需要创建一个循环来遍历<code class="fe ma mb mc md b">items</code>数组中的每一项。我们将使用这个外观将<code class="fe ma mb mc md b">items</code>数组中的每一项传递到我们的<code class="fe ma mb mc md b">cb</code>回调中。</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="00eb" class="mi ky iq md b gy mj mk l ml mm">function filter(items, cb) {<br/>	let final = []</span><span id="47ca" class="mi ky iq md b gy mn mk l ml mm">	for (let i = 0; i &lt; items.length; i++) {<br/>		// More to come here ...<br/>	}</span><span id="9359" class="mi ky iq md b gy mn mk l ml mm">	return final<br/>}</span></pre><p id="cee9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个循环中，我们希望对循环中的当前项调用回调函数(<code class="fe ma mb mc md b">cb</code>):</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="1780" class="mi ky iq md b gy mj mk l ml mm">function filter(items, cb) {<br/>	let final = []</span><span id="a9ce" class="mi ky iq md b gy mn mk l ml mm">	for (let i = 0; i &lt; items.length; i++) {<br/>		// Get the current item<br/>		let currentItem = items[i]</span><span id="90cb" class="mi ky iq md b gy mn mk l ml mm">		// Pass it into `cb`<br/>		let res = cb(currentItem)</span><span id="e4fe" class="mi ky iq md b gy mn mk l ml mm">		// More to come here ...<br/>	}</span><span id="7138" class="mi ky iq md b gy mn mk l ml mm">	return final<br/>}</span></pre><p id="015e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在从<code class="fe ma mb mc md b">items</code>数组中获取当前项(基于<code class="fe ma mb mc md b">i</code>的索引值)并将其传递给回调函数(<code class="fe ma mb mc md b">cb</code>)。我们在变量<code class="fe ma mb mc md b">res</code>中捕获<code class="fe ma mb mc md b">cb</code>的返回值。你也可以把这个变量叫做任何东西，尽管<code class="fe ma mb mc md b">res</code>在这里也很常见(它是<em class="nc">结果</em>的简称)。</p><p id="0721" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们快完成了。剩下的就是测试返回值(<code class="fe ma mb mc md b">res</code>)看它是否真实。如果是，我们将它添加到<code class="fe ma mb mc md b">final</code>数组，如果是falsey，我们将跳过它:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="5920" class="mi ky iq md b gy mj mk l ml mm">function filter(items, cb) {<br/>	let final = []</span><span id="4b6e" class="mi ky iq md b gy mn mk l ml mm">	for (let i = 0; i &lt; items.length; i++) {<br/>		let currentItem = items[i]<br/>		let res = cb(currentItem)</span><span id="9942" class="mi ky iq md b gy mn mk l ml mm">		if (res) {<br/>			final.push(currentItem)<br/>		}<br/>	}</span><span id="3bea" class="mi ky iq md b gy mn mk l ml mm">	return final<br/>}</span></pre><p id="8ef0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！这就是我们需要做的。我们不需要一个<code class="fe ma mb mc md b">else</code>，因为如果<code class="fe ma mb mc md b">res</code>为假，我们不想做任何事情。我们没有任何东西可以放在一个<code class="fe ma mb mc md b">else</code>块中！</p><p id="3db2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以使用上面定义的<code class="fe ma mb mc md b">isEven</code>函数来测试我们自己的<code class="fe ma mb mc md b">filter</code>方法:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="53cb" class="mi ky iq md b gy mj mk l ml mm">let nums = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]</span><span id="e451" class="mi ky iq md b gy mn mk l ml mm">let evens = filter(nums, isEven)</span><span id="e581" class="mi ky iq md b gy mn mk l ml mm">console.log(evens) // [ 2, 4, 6, 8, 10 ]</span></pre><p id="c2d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到同样的结果。让我们用一个获取奇数的函数来测试一下:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="7cbc" class="mi ky iq md b gy mj mk l ml mm">function isOdd(num) {<br/>	if (num % 2 !== 0) {<br/>		return true<br/>	} else {<br/>		return false<br/>	}<br/>}</span><span id="34ea" class="mi ky iq md b gy mn mk l ml mm">let odds = filter(nums, isOdd)</span><span id="6009" class="mi ky iq md b gy mn mk l ml mm">console.log(odds) // [ 1, 3, 5, 7, 9 ]</span></pre><p id="768d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在这里看到它也与我们的<code class="fe ma mb mc md b">isOdds</code>函数一起工作。</p><h1 id="4e21" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><code class="fe ma mb mc md b">filter</code>在行动</h1><p id="aa94" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><code class="fe ma mb mc md b">filter</code>方法无疑是获取列表子集的最佳方式，这是JavaScript开发中相当常见的任务。我经常使用它的一个地方是获取API响应的一部分。</p><p id="0f86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看一个例子。假设我们正在构建一个管理求职者的应用程序。为了做到这一点，我们希望能够在用户界面中为具有一定经验水平和技能的开发人员进行筛选。我们在应用程序中可能会有一个类似这样的页面:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/1fd379e20e81f2ff2a629d84a0c0df20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lkbMo2NRhkuLwzf-.png"/></div></div></figure><p id="9647" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">左侧栏有一些过滤器(在这里是经验和编程语言)。当有人点击这些过滤器中的一个时，屏幕主要区域的内容应该只改变为与这些过滤器匹配的内容。我们可以使用<code class="fe ma mb mc md b">filter</code>方法。</p><p id="ceaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们从API返回的数据如下所示:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="c07b" class="mi ky iq md b gy mj mk l ml mm">const developers = [<br/>  {<br/>    name: "Antonio",<br/>    experience: "Junior",<br/>    language: "JavaScript"<br/>  },<br/>  {<br/>    name: "José",<br/>    experience: "Senior",<br/>    language: "JavaScript"<br/>  },<br/>    {<br/>    name: "Carmen",<br/>    experience: "Junior",<br/>    language: "Python"<br/>  },<br/>    {<br/>    name: "Mercedes",<br/>    experience: "Junior",<br/>    language: "JavaScript"<br/>  },<br/>    {<br/>    name: "Ana",<br/>    experience: "Junior",<br/>    language: "JavaScript"<br/>  },<br/>]</span></pre><p id="9a5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们可以像这样筛选所有初级开发人员:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="60b8" class="mi ky iq md b gy mj mk l ml mm">function isJunior(developer) {<br/>	if (developer.experience === "Junior") {<br/>		return true<br/>	}<br/>	<br/>	return false<br/>}<br/>const juniorDevelopers = developers.filter(isJunior)</span></pre><p id="a607" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这会给我们安东尼奥，卡门，奔驰和安娜。</p><p id="43dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以为JavaScript开发人员做类似的事情:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="3060" class="mi ky iq md b gy mj mk l ml mm">function knowsJavaScript(developer) {<br/>	if (developer.language === "JavaScript") {<br/>		return true<br/>	}</span><span id="4942" class="mi ky iq md b gy mn mk l ml mm">	return false<br/>}</span><span id="9552" class="mi ky iq md b gy mn mk l ml mm">const javascriptDevelopers = developers.filter(knowsJavaScript)</span></pre><p id="158d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的<code class="fe ma mb mc md b">javascriptDevelopers</code>数组中现在有安东尼奥、何塞、梅塞德斯和安娜。</p><p id="abd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们想为初级开发人员和JavaScript开发人员提供<code class="fe ma mb mc md b">filter</code>，我们也可以这样做:</p><pre class="km kn ko kp gt me md mf mg aw mh bi"><span id="3e17" class="mi ky iq md b gy mj mk l ml mm">const currentDevelopers = developers.filter(function (developer) {<br/>	if (<br/>		developer.language === "JavaScript" &amp;&amp;<br/>		developer.experience === "Junior<br/>	) {<br/>		return true<br/>	}</span><span id="fb26" class="mi ky iq md b gy mn mk l ml mm">	return false<br/>})</span></pre><p id="3123" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在候选人跟踪应用程序中构建我们的页面所要做的就是将这些开发人员呈现在屏幕上！</p><h1 id="52a1" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="a2fd" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我已经介绍了JavaScript的四个内置数组方法。如果您还没有看过，一定要看看本系列的其他文章:</p><ul class=""><li id="fa60" class="mo mp iq jp b jq jr ju jv jy mq kc mr kg ms kk mt mu mv mw bi translated"><code class="fe ma mb mc md b"><a class="ae ne" href="https://zkf.io/js-array-methods-foreach/" rel="noopener ugc nofollow" target="_blank">forEach</a></code></li><li id="8ed0" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><code class="fe ma mb mc md b"><a class="ae ne" href="https://zkf.io/js-array-methods-map/" rel="noopener ugc nofollow" target="_blank">map</a></code></li><li id="5eb1" class="mo mp iq jp b jq mx ju my jy mz kc na kg nb kk mt mu mv mw bi translated"><code class="fe ma mb mc md b"><a class="ae ne" href="https://zkf.io/js-array-methods-concat/" rel="noopener ugc nofollow" target="_blank">concat</a></code></li></ul><p id="060c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将解释并实现每一个内置数组方法。如果你正在努力学习它们，或者只是想学习更多关于JavaScript的知识，那么一定要注册我的<a class="ae ne" href="https://hawthorne.substack.com" rel="noopener ugc nofollow" target="_blank">时事通讯</a>并在<a class="ae ne" href="https://twitter.com/ZFleischmann" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我。</p></div></div>    
</body>
</html>