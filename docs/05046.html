<html>
<head>
<title>Text blocks in Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Java中的文本块</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/new-kid-in-the-block-text-blocks-in-java-e8a273b34b4e?source=collection_archive---------10-----------------------#2020-07-31">https://levelup.gitconnected.com/new-kid-in-the-block-text-blocks-in-java-e8a273b34b4e?source=collection_archive---------10-----------------------#2020-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="9886" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">Java基础</h2><div class=""/><div class=""><h2 id="2ee4" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">创建多行字符串的更好方法，无需添加冗长的代码</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3832e4189fb191f5a7792decc715ad5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NKANHrPGMc8yo5z1"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">萨法尔·萨法罗夫在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9535" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">与其他编程语言相比，Java有点冗长。许多人和公司喜欢在他们的生产环境中使用Java，因为有可用的支持和技能。尽管如此，它仍然是一种较老的编程语言，Java在最近几年加快了它的步伐。除了提高性能，它还增加了一些通常与Java无关的特性，比如lambdas。有了这些新特性，它试图让程序员的工作变得更容易，同时减少冗长的代码。其中一个尝试是引入“文本块”，在JDK 13和14中作为预览功能推出。计划在2015年JDK发布预览版，将于9月20日发布，OpenJDK将于3月21日发布。尽管如此，如果你使用的是JDK 13或14，你仍然可以使用这个功能。</p><h1 id="e0df" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">多行字符串</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mt"><img src="../Images/bcfc7f033ff1823c86777ae3953335ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J8naFC5ft0LIotRC"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@brucemars?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁斯·马尔斯</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="7a97" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">多行字符串是跨越多行的文本块。为此，您需要在文本中添加行分隔符，这样编译器就能理解如何呈现该字符串。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="db0d" class="mz mc iq mv b gy na nb l nc nd">String myMultiLineText = "This is first line of my multi-line string.\nI'm on second line now";</span></pre><p id="cd6e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将产生以下输出:</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="4614" class="mz mc iq mv b gy na nb l nc nd">This is first line of my multi-line string.<br/>I'm on second line now!</span></pre><p id="db7d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这里，通过添加“\n”，我在字符串中添加了一个新行。但是，实际上，行分隔符依赖于操作系统。因此，如果您使用的是Windows/Mac OS 9或更早版本，您可能必须使用“\r”或“\r\n”作为转义序列。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="7771" class="mz mc iq mv b gy na nb l nc nd">Windows: '\r\n'<br/>Mac (OS 9-): '\r'<br/>Mac (OS 10+): '\n'<br/>Unix/Linux: '\n'</span></pre><p id="2909" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，为了使我的代码更加通用，我必须考虑这样的情况。Java有一种从系统属性中获取行分隔符的方法。这是更新后的代码-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="4287" class="mz mc iq mv b gy na nb l nc nd">String newLineChar = System.getProperty("line.separator");<br/>String myMultiLineText = "This is first line of my multi-line string."+newLineChar+"I'm on second line now";</span></pre><p id="d2de" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">好的，很快，我的简单代码变得更加冗长，看起来混乱不堪。想象一下多行字符串有多行(&gt; 5行)！对眼睛不太好，对吧。我们可以使用像concat，join这样的字符串方法，或者使用像StringBuilder，Guava Joiner这样的库来使它变得更简洁。</p><h2 id="9a4c" class="mz mc iq bd md ne nf dn mh ng nh dp ml lo ni nj mn ls nk nl mp lw nm nn mr iw bi translated">使用字符串连接/联接</h2><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="ae80" class="mz mc iq mv b gy na nb l nc nd">String myMultiLineTextUsingConcat = "first line"<br/>.concat(newLineChar)<br/>.concat("second line");</span><span id="c7e3" class="mz mc iq mv b gy no nb l nc nd">String myMultiLineTextUsingJoin = String.join(newLineChar, "first line", "second line");</span></pre><h2 id="2465" class="mz mc iq bd md ne nf dn mh ng nh dp ml lo ni nj mn ls nk nl mp lw nm nn mr iw bi translated">使用StringBuilder</h2><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="130a" class="mz mc iq mv b gy na nb l nc nd">StringBuilder myMultiLineStringBuilder = new StringBuilder()<br/>.append("first line")<br/>.append(newLineChar)<br/>.append("second line")<br/>.toString();</span></pre><h2 id="4633" class="mz mc iq bd md ne nf dn mh ng nh dp ml lo ni nj mn ls nk nl mp lw nm nn mr iw bi translated">使用番石榴连接器</h2><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="d5f7" class="mz mc iq mv b gy na nb l nc nd">String myMultiLineTextUsingGuavaJoiner = Joiner.on(newLineChar)<br/>.join(ImmutableList.of("first line", "second line"));</span></pre><p id="1e2f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因此，有许多方法可以创建这样的多行字符串，其中取决于用例，一种可能比另一种更好。但是，你可以看到，这些看起来干净或者易读的东西，都不会导致更容易出错的代码。</p><h1 id="577d" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">文本块</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi np"><img src="../Images/7e20d0b746cd63f28b91e0448540a5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RjsDtmK8R2u4sDay"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@rvignes?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Romain Vignes </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4435" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">文本块功能允许您以一种直观的方式创建多行字符串，这是它应该有的方式。</p><blockquote class="nq"><p id="605c" class="nr ns iq bd nt nu nv nw nx ny nz ma dk translated">文本块是多行字符串文字，它避免了对大多数转义序列的需要，以可预测的方式自动格式化字符串，并在需要时让开发人员控制格式。</p></blockquote><p id="d23e" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">我们的多行字符串现在变成了-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="c891" class="mz mc iq mv b gy na nb l nc nd">String myMultiLineText = """<br/>                         first line<br/>                         second line<br/>                         """;</span></pre><p id="6870" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这使得它更简单，非常容易阅读和理解。您只需要将您的字符串括在分隔符<em class="of">s内，这是一个由三个双引号字符(<code class="fe og oh oi mv b">"""</code>)组成的序列。</em></p><p id="83b7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">与字符串中的字符不同，内容可以直接包含双引号字符。允许在文本块中使用<code class="fe og oh oi mv b">\"</code>,但这不是必需的，也不推荐使用。选择厚分隔符(<code class="fe og oh oi mv b">"""</code>)是为了让<code class="fe og oh oi mv b">"</code>字符可以不转义，也是为了在视觉上区分文本块和字符串文字。</p><p id="85b8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在运行时，文本块被评估为<code class="fe og oh oi mv b">String</code>的实例，就像字符串一样。从文本块派生的<code class="fe og oh oi mv b">String</code>实例与从字符串派生的实例无法区分。</p><h2 id="8c23" class="mz mc iq bd md ne nf dn mh ng nh dp ml lo ni nj mn ls nk nl mp lw nm nn mr iw bi translated">刻痕</h2><p id="ecd1" class="pw-post-body-paragraph lf lg iq lh b li oj ka lk ll ok kd ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated">请注意缩进，我缩进了字符串，这样我就可以在输出中得到想要的间距。这会产生以下输出-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="3d94" class="mz mc iq mv b gy na nb l nc nd">first line<br/>second line</span></pre><p id="6d6b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是，如果我想在第二行加一个空格。我可以通过-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="a534" class="mz mc iq mv b gy na nb l nc nd">String myMultiLineText = """<br/>                         first line<br/>                          second line<br/>                         """;</span></pre><p id="729c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">根据开始定界的位置，编译器试图理解间距的意图，以便您可以正确地缩进代码，并向文本块添加空格。想象你在字符串中创建HTML代码-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="df32" class="mz mc iq mv b gy na nb l nc nd">String html = """<br/>              &lt;html&gt;<br/>                  &lt;body&gt;<br/>                      &lt;p&gt;Hello, world&lt;/p&gt;<br/>                  &lt;/body&gt;<br/>              &lt;/html&gt;<br/>              """;</span></pre><p id="08ad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">输出的开头没有多余的空格，代码也正确地缩进了。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="57cf" class="mz mc iq mv b gy na nb l nc nd">&lt;html&gt;<br/>    &lt;body&gt;<br/>        &lt;p&gt;Hello, world&lt;/p&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="8169" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面是一个HTML示例，使用点来可视化为缩进添加的空格:</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="09be" class="mz mc iq mv b gy na nb l nc nd">String html = """<br/>..............&lt;html&gt;<br/>..............    &lt;body&gt;<br/>..............        &lt;p&gt;Hello, world&lt;/p&gt;<br/>..............    &lt;/body&gt;<br/>..............&lt;/html&gt;<br/>..............""";</span></pre><p id="9a3b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所有这些点在编译时处理过程中都被删除了，编译器认为你添加这些点是为了缩进你的代码。</p><h2 id="8ce8" class="mz mc iq bd md ne nf dn mh ng nh dp ml lo ni nj mn ls nk nl mp lw nm nn mr iw bi translated">格式化</h2><p id="1e3f" class="pw-post-body-paragraph lf lg iq lh b li oj ka lk ll ok kd ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated">通常，你会想在字符串中插入运行时间值，比如-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="ca18" class="mz mc iq mv b gy na nb l nc nd">String welcomeText = String.format("Welcome, %s !", name);</span></pre><p id="80ef" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您仍然可以使用字符串格式方法来格式化文本块-</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="d89a" class="mz mc iq mv b gy na nb l nc nd">String welcomeText = String.format("""<br/>                                   Welcome, %s !<br/>                                   """, name);</span></pre><p id="267d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了避免这种冗长的构造，有一个新的方法<em class="of">格式化</em>可以帮助解决这个问题。</p><pre class="kp kq kr ks gt mu mv mw mx aw my bi"><span id="cca8" class="mz mc iq mv b gy na nb l nc nd">String welcomeText = """<br/>                     Welcome, %s !<br/>                     """.formatted(name);</span></pre><p id="8ae0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">好多了，对！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/98323196e48f07cd4ced09aab30fb021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OYcfeL7xh4TjvzM-"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰米街</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="1e42" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">结论</h1><p id="11d8" class="pw-post-body-paragraph lf lg iq lh b li oj ka lk ll ok kd ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated">总的来说，文本块是Java中一个很棒的特性，它提供了很多创建多行字符串的功能。将这一点添加到您的代码中，肯定会使您的代码更易读、更干净。开始尝试，享受乐趣！</p></div></div>    
</body>
</html>