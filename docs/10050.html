<html>
<head>
<title>How to Retrieve MySQL Last Insert ID in CodeIgniter 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在CodeIgniter 4中检索MySQL最后插入ID</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-retrieve-mysql-last-insert-id-in-codeigniter-4-c727e68b3efb?source=collection_archive---------6-----------------------#2021-10-20">https://levelup.gitconnected.com/how-to-retrieve-mysql-last-insert-id-in-codeigniter-4-c727e68b3efb?source=collection_archive---------6-----------------------#2021-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="98a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在学习、个人项目和应用程序开发中大量使用CodeIgniter 4。在这篇文章中，我将介绍两种不同的方法，在CodeIgniter中执行了一个<strong class="js iu"> INSERT </strong>语句后，您可以使用这两种方法来检索MySQL最后插入的ID值。继续阅读了解更多信息…</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/479edd9a0f51f2c9a753fbfcba2ca08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*WgMIj4vD7NnfSv9a.jpg"/></div></figure><p id="128e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">自我推销:</p><p id="be27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这里写的内容，尽一切办法，把这个博客和你最喜欢的帖子分享给其他可能从中受益或喜欢它的人。<a class="ae kw" href="http://ko-fi.com/joshlovescoffee" rel="noopener ugc nofollow" target="_blank">因为咖啡是我最喜欢的饮料，如果你愿意，你甚至可以给我买一杯！</a></p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><h2 id="2369" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">模型设置</h2><p id="4625" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">首先，我使用<a class="ae kw" href="https://codeigniter4.github.io/userguide/cli/cli_generators.html" rel="noopener ugc nofollow" target="_blank"> CLI生成器</a>特性，并通过在项目根目录的终端中执行以下代码来创建一个模型:</p><pre class="kp kq kr ks gt mc md me mf aw mg bi"><span id="8041" class="le lf it md b gy mh mi l mj mk">php spark make:model user --suffix</span></pre><p id="c85b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我已经删除了大部分<em class="ml">样板</em>代码，保留了这个<em class="ml">基本的</em>用户模型。我将根据需要添加更多功能:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="04ac" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">创建Home Controller users()方法</h2><p id="2955" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">访问URL <strong class="js iu"> /cicrud/home/users，</strong>在默认的<strong class="js iu"> Home </strong>控制器文件中执行这个<strong class="js iu"> users() </strong>方法:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="6470" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">重要！假设<strong class="js iu"> $data </strong>关联数组在被传递给Model <strong class="js iu"> insert() </strong>方法之前已经过验证和清理。始终验证和整理您的数据！</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="3e4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你是<a class="ae kw" href="http://medium.com/" rel="noopener">中</a>成员吗？如果是这样的话，<a class="ae kw" href="https://parabollus.medium.com/subscribe" rel="noopener">每次我发表一篇博客文章时都会收到一封电子邮件通知</a>如果你更喜欢中型平台的话。不是会员？别担心！使用<a class="ae kw" href="https://parabollus.medium.com/membership" rel="noopener">我的注册链接</a>(我会向你收取佣金，无需额外费用)并加入。我真的很喜欢阅读所有伟大的内容，我知道你也会！！！</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="353f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">检查<strong class="js iu">用户的</strong>表中的数据，我们可以看到已经添加了一行:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/4d26cd92a7052849c7a8b3e1ecdb23cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*FrnVf0HepCzyoCpi"/></div></figure></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="02a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">作为开发人员，有时您需要从用<strong class="js iu"> AUTO_INCREMENT </strong>属性定义的MySQL表列中捕获最后一个插入ID值。MySQL有一个<em class="ml">本机</em> <a class="ae kw" href="https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_last-insert-id" rel="noopener ugc nofollow" target="_blank"> LAST_INSERT_ID() </a>信息函数，您可以在查询中使用它并检索这个值。</p><p id="f1aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您使用CodeIgniter 4，根据您插入数据的方式，有几种不同的方法可以利用，允许您检索最后插入的ID值。我将在这篇文章中讨论这两个问题。</p><h2 id="f22b" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">CodeIgniter 4模型getInsertID()方法</h2><p id="196e" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">CodeIgniter 4模型有内置的方法来处理应用程序中需要的大多数CRUD操作。</p><p id="6004" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我已经在这篇<a class="ae kw" href="https://parabollus.medium.com/membership" rel="noopener">中型</a>帖子中写了关于CodeIgniter 4 Model<strong class="js iu">insert()</strong>方法的文章，<a class="ae kw" href="https://link.medium.com/J26yFkx0Ajb" rel="noopener"> CodeIgniter 4 CRUD系列与MySQL: Create </a>。</p><p id="5af8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您已经使用Model <strong class="js iu"> insert() </strong>方法插入了一个新行，并且需要最后一个插入ID值，那么如何获得它呢？</p><p id="4cfa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在当前模型实例上调用Model <strong class="js iu"> getInsertID() </strong>方法并检索值。</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="76d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">截至撰写本文时，我还没有找到关于这种方法的官方文档。出于这篇博文的目的，我借用了我在Stackoverflow上找到的这篇文章。请在下面的评论中为这个CodeIgniter 4方法提供相关的资源或链接。</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="8aa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请参见下面更新的<strong class="js iu"> users() </strong>方法和代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/1a8fb51bfbbc4b93981cda1f9a5b61e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/0*Kvml6mjdtG6f6Bzm"/></div></figure><p id="36b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">重新访问<strong class="js iu">用户的</strong>表也显示了该值:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/224ccc8b91b1cb456a6d1e365d3c5823.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*k0aKzrM_jdeSQ0Zr"/></div></figure></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="4fd0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我每周写一封关于我正在研究、学习和感兴趣的SQL/PHP的电子邮件。如果这听起来像是你想参与的事情，<a class="ae kw" href="https://digitalowlsprose.ck.page/1b35a06295" rel="noopener ugc nofollow" target="_blank">点击这里</a>了解更多信息。谢谢大家！</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><h2 id="e6ce" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">CodeIgniter 4查询生成器insertID()</h2><p id="c703" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">在UserModel模型文件中，我创建了这个<strong class="js iu"> dataInsert() </strong>方法:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="3f0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<a class="ae kw" href="https://codeigniter.com/user_guide/database/query_builder.html" rel="noopener ugc nofollow" target="_blank">查询构建器类</a>，我们可以利用内置的<strong class="js iu"> $builder insertID() </strong>方法<strong class="js iu">插入</strong>并检索最后的插入ID值，该方法在<strong class="js iu"> $db </strong>连接实例上调用。</p><p id="f0a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在家庭控制器中，我已经编辑了<strong class="js iu"> users() </strong>方法，以使用该代码片段中所示的UserModel <strong class="js iu"> dataInsert() </strong>方法</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="45f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">再次访问URL，/ <strong class="js iu"> cicrud/home/users，</strong>执行<strong class="js iu"> users() </strong> Home控制器方法。然而，在这个实例中，查询构建器<strong class="js iu"> insertID() </strong>方法检索最后一个插入ID值，而不是模型<strong class="js iu"> getInsertID() </strong>方法。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/1c234fd65892c6d747f6079b3fc63c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/0*p0EivdmXiBcqrNN5"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/8d8d792aa44f51e42db9b85b281d2fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*H3wjyE4WCUSn-Eo7"/></div></figure><p id="af23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在你知道了。在CodeIgniter 4中检索最后一个插入ID值的两种方法。如果你知道任何其他的，请在下面的评论中分享，这样我和其他读者也会知道。谢谢大家！</p><h2 id="4d49" class="le lf it bd lg lh li dn lj lk ll dp lm kb ln lo lp kf lq lr ls kj lt lu lv lw bi translated">类似的最后插入ID博客帖子</h2><p id="e47f" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">我已经写了几篇关于MySQL Last Insert ID的博文，涵盖了几种不同的环境/语言，希望在下面与任何感兴趣的读者分享。也请一起分享吧！谢谢大家！</p><ul class=""><li id="73ad" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated"><a class="ae kw" href="https://joshuaotwell.com/mysqls-auto_increment-attribute/" rel="noopener ugc nofollow" target="_blank"> MySQL的AUTO_INCREMENT属性</a></li><li id="925b" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><a class="ae kw" href="https://joshuaotwell.com/mysql-shell-get_auto_increment_value-method-python-mode/" rel="noopener ugc nofollow" target="_blank">MySQL Shell get _ auto _ increment _ value()方法— Python模式</a></li><li id="eaea" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><a class="ae kw" href="https://joshuaotwell.com/php-pdo-lastinsertid-method-with-examples-in-mysql/" rel="noopener ugc nofollow" target="_blank"> PHP PDO lastInsertId()方法</a></li><li id="9992" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><a class="ae kw" href="https://wordpress.com/posts/joshuaotwell.com?s=mysql+auto+increment" rel="noopener ugc nofollow" target="_blank">MySQL中的AUTO_INCREMENT列属性—一个开始透视图</a></li></ul><p id="ea41" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您有任何问题或看到代码中的任何错误，请通过评论让我知道。建设性的意见有助于我提供准确的博客帖子，我非常感激。感谢您的阅读！</p><p id="998e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">喜欢你读过的？看到什么不正确的吗？请在下面评论，感谢阅读！！！</p><h1 id="f540" class="ni lf it bd lg nj nk nl lj nm nn no lm np nq nr lp ns nt nu ls nv nw nx lv ny bi translated">行动的号召！</h1><p id="68b0" class="pw-post-body-paragraph jq jr it js b jt lx jv jw jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn im bi translated">感谢你花时间阅读这篇文章。我真心希望你发现了一些有趣和有启发性的东西。请在这里与你认识的其他人分享你的发现，他们也会从中获得同样的价值。</p><p id="c96a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">访问<a class="ae kw" href="https://wp.me/P28ctb-3KD" rel="noopener ugc nofollow" target="_blank"> Portfolio-Projects页面</a>查看我为客户完成的博客帖子/技术写作。</p><p id="14a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae kw" href="https://ko-fi.com/joshlovescoffee" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">如果你喜欢我制作的内容，用一杯咖啡表达你的欣赏。</strong>T13】</a></p><p id="f784" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要在最新的博客文章发表时收到来自本博客(“数字猫头鹰散文”)的电子邮件通知(绝不是垃圾邮件)，请点击“点击订阅！”按钮在首页的侧边栏！(如有任何问题，请随时查看<a class="ae kw" href="https://wp.me/P28ctb-3gI" rel="noopener ugc nofollow" target="_blank"> Digital Owl的散文隐私政策页面</a>:电子邮件更新、选择加入、选择退出、联系表格等……)</p><p id="61ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请务必访问<a class="ae kw" href="https://joshuaotwell.com/where-blog_post-in-digital-owls-prose-best-of/" rel="noopener ugc nofollow" target="_blank">“最佳”</a>页面，收集我的最佳博文。</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="e232" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">作为一名SQL开发人员和博客作者，Josh Otwell 热衷于学习和成长。其他最喜欢的活动是让他埋头于一本好书、一篇文章或Linux命令行。其中，他喜欢桌面RPG游戏，阅读奇幻小说，并与妻子和两个女儿共度时光。</p><p id="9d12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">免责声明:本文中的例子是关于如何实现类似结果的假设。它们不是最好的解决方案。所提供的大多数(如果不是全部)示例都是在个人发展/学习工作站环境中执行的，不应被视为生产质量或就绪。您的特定目标和需求可能会有所不同。使用那些最有利于你的需求和目标的实践。观点是我自己的。</p></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="2f30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ml">原载于2021年10月20日</em><a class="ae kw" href="https://joshuaotwell.com/how-to-retrieve-mysql-last-insert-id-in-codeigniter-4/" rel="noopener ugc nofollow" target="_blank"><em class="ml">【https://joshuaotwell.com】</em></a><em class="ml">。</em></p></div></div>    
</body>
</html>