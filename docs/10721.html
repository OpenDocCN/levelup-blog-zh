<html>
<head>
<title>Speech Recognition with Sentiment Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有情感分析的语音识别</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/speech-recognition-with-sentiment-analysis-894e6a321112?source=collection_archive---------8-----------------------#2022-01-04">https://levelup.gitconnected.com/speech-recognition-with-sentiment-analysis-894e6a321112?source=collection_archive---------8-----------------------#2022-01-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="fbff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将言语分为积极的、消极的或中性的</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/e628489c8674ce62fe86377c0ee69777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCI_30GVirCkiuBsJyJmvA.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@tengyart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">腾雅特</a>在<a class="ae le" href="https://unsplash.com/s/photos/emotion?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="de33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天的主题是语音数据的情感分析。供您参考，情绪分析是一种识别、提取和量化积极、消极或中立数据的技术。它主要用于文本数据，以获得有用的见解，帮助企业监控客户反馈中的产品情绪。</p><p id="6c25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">语音数据情感分析的使用案例包括:</p><ul class=""><li id="1bf5" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">识别客户和代理对话的情绪，以促进更好的客户服务体验</li><li id="e80b" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">在虚拟会议中获得更好的洞察力，用于产品开发和营销目的</li><li id="fb88" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">在新闻报道或采访中定义言语的本质及其情感</li></ul><p id="3c2c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">尽管情感分析通常依赖于文本数据，但是您也可以利用两阶段管道对语音数据执行情感分析:</p><ul class=""><li id="01c3" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">运行自动语音识别以获得相应的转录</li><li id="98db" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">从转录文本中获得情感</li></ul><p id="dd0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与其麻烦地设置管道，不如让我们探索一下如何通过调用AssemblyAI提供的外部<a class="ae le" href="https://www.assemblyai.com/" rel="noopener ugc nofollow" target="_blank">语音转文本API </a>来轻松完成。最新版本带有情绪分析功能，帮助你一举两得。</p><p id="4c56" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们继续下一部分，开始安装必要的模块。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="5c23" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">设置</h1><h2 id="bc36" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">要求</h2><p id="548d" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">这个项目使用<code class="fe np nq nr ns b">requests</code>包进行HTTP API调用。默认情况下，它是随您的环境一起预安装的。如果不是这样，请按如下方式安装:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="e3a1" class="my mb it ns b gy nx ny l nz oa">pip install requests</span></pre><h2 id="38aa" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">API密钥</h2><p id="dd68" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">除此之外，您还需要在此注册一个<a class="ae le" href="https://app.assemblyai.com/signup" rel="noopener ugc nofollow" target="_blank">新的免费试用账户。试用帐户附带每月3小时的转录，这对于本教程来说已经足够了。</a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/38bbdb0f000ead04df1db8afd5ac03bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hdNVzGsrcm4yxjRJ"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</figcaption></figure><p id="ace8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请记住记下API键，因为稍后以编程方式调用API时会用到它。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="84c6" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">履行</h1><p id="b7bb" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">转录过程包括以下步骤:</p><ul class=""><li id="c65e" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">上传一个本地音频文件到AssemblyAI的服务器。它将为您返回一个可访问的URL</li><li id="16e8" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">用<code class="fe np nq nr ns b">audio_url</code>和<code class="fe np nq nr ns b">sentiment_analysis</code>参数调用转录API (POST call)</li><li id="d374" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">调用转录API (GET call)来获得最终的转录结果</li></ul><h2 id="5018" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">上传本地音频文件(可选)</h2><p id="616c" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">这一步是可选的，主要用于上传本地音频文件以获得可访问的URL。如果你已经有一个网址，请跳到下一节。</p><p id="b36a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在工作目录中创建一个名为<code class="fe np nq nr ns b">upload_file.py</code>的新文件。在其中追加以下代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="d7ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用你项目中的变量替换掉<code class="fe np nq nr ns b">api_key</code>和<code class="fe np nq nr ns b">filename</code>变量。</p><p id="6e1d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行以下命令将音频文件上传到服务器:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="9e93" class="my mb it ns b gy nx ny l nz oa">python upload_file.py</span></pre><p id="6429" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它将返回一个JSON输出，表示音频文件的可访问URL:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="2911" class="my mb it ns b gy nx ny l nz oa">{“upload_url”: “https://cdn.assemblyai.com/upload/ccbbbfaf-f319-4455-9556-272d48faaf7f"}</span></pre><h2 id="36dd" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">对脚本API进行POST调用</h2><p id="f96a" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">完成后，创建一个名为<code class="fe np nq nr ns b">transcribe.py.</code>的文件，我们将用下面的代码调用<a class="ae le" href="https://docs.assemblyai.com/api-ref/v2-transcript" rel="noopener ugc nofollow" target="_blank">官方脚本API </a>:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="028e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保在调用API之前已经将<code class="fe np nq nr ns b">sentiment_analysis</code>参数设置为<code class="fe np nq nr ns b">True</code>。此外，您可以为<code class="fe np nq nr ns b">audio_url</code>使用自己的可访问URL，如上面的示例代码所示。</p><p id="6517" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行以下命令来触发转录过程:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="b99f" class="my mb it ns b gy nx ny l nz oa">python transcribe.py</span></pre><p id="e86e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出是JSON格式的，包含相当多的键值对。最重要的关键字如下:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="21cf" class="my mb it ns b gy nx ny l nz oa">{"id": "oe9eg384ft-4f9e-4151-81f8-0697a9d128f0", ...<br/>"status": "queued" ...}</span></pre><ul class=""><li id="7c14" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">id</code> —代表流程的唯一标识符。您将在稍后调用GET API时使用它</li><li id="6ae1" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">status</code> —表示您的转录进度</li></ul><p id="aa9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您收到的状态为<code class="fe np nq nr ns b">error</code>，可能是由于以下原因之一:</p><ul class=""><li id="4609" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">不支持的音频文件格式</li><li id="a62a" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">音频文件不包含音频数据</li><li id="a920" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">音频文件太短(&lt; 200毫秒)</li><li id="934f" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">无法访问音频文件的URL</li><li id="1882" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">API端的错误</li></ul><h2 id="6400" class="my mb it bd mc mz na dn mg nb nc dp mk kb nd ne mo kf nf ng ms kj nh ni mw nj bi translated">对脚本API进行GET调用</h2><p id="30fd" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">为了获得情绪分析附带的转录文本，您需要进行另一个API调用。请注意，根据文件的长度，转录可能需要10分钟。</p><p id="c162" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用以下代码创建一个名为<code class="fe np nq nr ns b">transcribe_file.py</code>的新Python文件:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="c7f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像往常一样，相应地更换<code class="fe np nq nr ns b">api_key</code>和<code class="fe np nq nr ns b">id</code>变量。接下来，运行以下命令:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="fb77" class="my mb it ns b gy nx ny l nz oa">python transcribe_file.py</span></pre><p id="8a97" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">输出JSON包含一个额外的<code class="fe np nq nr ns b">sentiment_analysis_results</code>键，它表示对应于语音的情感分析输出。该键包含具有以下项目的字典列表:</p><ul class=""><li id="716c" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">text</code> —正在分析的句子的转录文本</li><li id="829d" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">start</code> —抄本中文本的开始时间戳(以毫秒为单位)</li><li id="8f41" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">end</code> —抄本中文本的结束时间戳(以毫秒为单位)</li><li id="9b13" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">sentiment</code> —检测到的情绪<code class="fe np nq nr ns b">POSITIVE</code>、<code class="fe np nq nr ns b">NEGATIVE</code>或<code class="fe np nq nr ns b">NEUTRAL</code></li><li id="7f78" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe np nq nr ns b">confidence </code> —检测到的情感的置信度得分</li></ul><p id="6ffa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看看下面的输出示例:</p><pre class="kp kq kr ks gt nt ns nu nv aw nw bi"><span id="cfc3" class="my mb it ns b gy nx ny l nz oa">...<br/>{<br/>      "text": "And and for people to expose themselves to being rejected on TV.",<br/>      "start": 2372,<br/>      "end": 6574,<br/>      "sentiment": "NEGATIVE",<br/>      "confidence": 0.7591296434402466<br/>},</span></pre></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="e76f" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">结论</h1><p id="e3e5" class="pw-post-body-paragraph jq jr it js b jt nk jv jw jx nl jz ka kb nm kd ke kf nn kh ki kj no kl km kn im bi translated">让我们回顾一下你今天所学的内容。</p><p id="1aa5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本教程涵盖了情感分析及其用例背后的基本概念。</p><p id="26ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，它提供了安装必要模块的分步指南，以及在AssemblyAI平台中设置新的免费试用帐户以获取api密钥。</p><p id="f0c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">随后，它解释了上传音频文件以获得可访问的URL。当调用转录后API时，URL是参数的一部分。最后，调用转录GET API来获得最终结果，该结果伴随着演讲的情绪。</p><p id="bfff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢你阅读这篇文章。祝你有美好的一天！</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="c781" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">参考</h1><ol class=""><li id="da67" class="lf lg it js b jt nk jx nl kb oe kf of kj og kn oh ll lm ln bi translated"><a class="ae le" href="https://www.assemblyai.com/blog/introducing-sentiment-analysis/" rel="noopener ugc nofollow" target="_blank"> AssemblyAI —引入情感分析</a></li><li id="d8de" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn oh ll lm ln bi translated"><a class="ae le" href="https://docs.assemblyai.com/audio-intelligence#sentiment-analysis" rel="noopener ugc nofollow" target="_blank"> AssemblyAI —文档(情感分析)</a></li></ol></div></div>    
</body>
</html>