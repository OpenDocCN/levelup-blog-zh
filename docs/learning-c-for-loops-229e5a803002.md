# 学习 C++:对于循环

> 原文：<https://levelup.gitconnected.com/learning-c-for-loops-229e5a803002>

![](img/45488cc868d5ee8e09ad509a002d8d3b.png)

由[伊莎贝拉和路易莎·菲舍尔](https://unsplash.com/@twinsfisch?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

C++中有两种循环结构。其中之一是`while`循环，我将在另一篇文章中介绍它。另一个循环结构，也是我想在本文中讨论的，是`for`循环。

当您想要迭代或循环一组语句特定的次数时，可以使用`for` 循环。如果你正在处理一个容器的元素，比如一个数组或者一个向量，你会想要使用一个`for`循环。如果你正在处理从程序用户那里收到的 10 条数据，你会想要使用一个`for`循环。

不希望使用`for`循环的情况有:当您处理文件中的数据时，您不知道文件中有多少条数据，或者当您处理来自用户的数据时，您不知道将输入多少个数据元素。

# 对于循环类型

有两种类型的`for`循环。第一种我称之为变量控制。这意味着在`for`循环中，你初始化一个变量，该变量的值决定了`for`循环迭代的次数。

另一种类型的`for`循环是范围`for`循环。这种类型的`for`循环遍历一个容器的所有元素，比如一个向量或一个数组。当您想要处理容器的每个元素时，可以使用这种类型的循环，从第一个元素开始，一直到最后一个元素。使用 range `for`循环可以阻止任何类型的逻辑错误，这些错误可能是由于试图访问容器边界之外的元素而导致的。

# 可变控制 for 循环

最常见的`for`回路类型是可变控制`for` 回路。变量在循环体内初始化，以控制循环迭代的次数。我称之为*循环控制变量*。您可以在循环体之外初始化循环控制变量，但这样一来，变量的作用域就不在循环的本地了，这可能是您不想要的。

以下是定义变量控制 for 循环结构的语法模板:

*for(变量-初始化；条件；变量-修改){
循环体；
}*

一个`for`循环有四个部分:1)变量初始化，你给一个变量赋值来控制循环(循环控制变量)；2)正在测试的停止循环的条件；3)变量修改，修改循环控制变量的值，使条件最终为真；以及 4)循环体——执行循环工作的地方。

让我们看一个简单的例子，演示变量控制的`for`循环是如何工作的。下面的程序显示“Hello，world！”对着屏幕 5 次:

```
int main()
{
  for (int i = 1; i <= 5; i++) {
    cout << "Hello, world!" << endl;
  }
  return 0;
}
```

本例中的循环控制变量是`i`。虽然通常使用单个单词的变量名不是一个好主意，但是使用`for` 循环这样做是很常见的。这样做的原因是因为`for`循环通常足够短，所以扫描循环以查看变量在哪里声明是很容易做到的。

这个程序的输出是:

```
Hello, world!
Hello, world!
Hello, world!
Hello, world!
Hello, world!
```

我将通过对循环控制变量— `i`进行变量跟踪来演示循环是如何工作的。

i: 1 输出:你好，世界！
i: 2 输出:你好，世界！
i: 3 输出:你好，世界！
i: 4 输出:你好，世界！
i: 5 输出:你好，世界！
i: 6 输出:

`i`的值达到 6，但是因为现在条件为假，循环停止并且不再有输出。

变量控制的`for`循环的一个常见用途是访问数组或向量的元素。我将通过创建一个 10 个元素的数组并使用一个变量控制的`for`循环来对数组的元素求和，以找到元素的平均值来演示这一点。程序如下:

```
int main () {
  const int numElements = 10;
  int grades[numElements] =
    {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  int total = 0;
  for (int i = 0; i < numElements; i++) {
    total += grades[i];
  }
  double average = static_cast<double>(total)/numElements;
  cout << "The average value of the grades is: "
       << average << endl;
  return 0;
}
```

这个程序的输出是:

```
The average value of the grades is: 83.7
```

我们也可以使用这种技术以相反的顺序显示数组的值。下面是实现这一点的程序:

```
int main () {
  const int numElements = 10;
  int grades[numElements] =
    {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  for (int i = numElements -1; i >= 0; i--) {
    cout << grades[i] << " ";
  }
  return 0;
}
```

这个程序的输出是:

```
84 98 68 92 89 75 82 91 77 81
```

变量控制的 for 循环是访问数组或向量元素的常规方式，在大多数情况下非常实用。然而，随着 C++11 中 range `for`循环的引入，这种新的`for`循环类型是在访问所有元素时访问数组的首选方式。在下一节中，我将介绍范围`for`循环是如何工作的。

# 循环的范围

在 C++11 中引入的 range `for`循环提供了一种更简单的方法来访问数组或向量的所有元素，以及其他一些 C++容器类型。range `for`循环使用迭代器从第一个元素到最后一个元素访问容器的元素。关于迭代器的概述，你可以在这里阅读我关于迭代器的文章。

以下是循环范围的语法模板:

*for(数据类型变量名:容器){
循环体；
}*

range `for`循环通过初始化一个与目标容器中的元素类型相同的数据类型的变量来工作。然后迭代器访问容器中的每个元素，将元素的值放入变量中。

让我们看看 range `for`循环如何与我们在上一个例子中使用的数组一起工作:

```
int main () {
  const int numElements = 10;
  int grades[numElements] =
    {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  for (int grade : grades) {
    cout << grade << " ";
  }
  return 0;
}
```

这个程序的输出是:

```
81 77 91 82 75 89 92 68 98 84
```

现在让我们从数组切换到向量:

```
#include <iostream>
#include <vector>
using namespace std;int main () {
  vector<int> grades = {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  for (int grade : grades) {
    cout << grade << " ";
  }
  return 0;
}
```

这段代码产生的输出与前面的示例相同。

让我再说一次 T4 循环的例子。每当你需要访问一个兼容容器的所有元素时，你应该在一个变量控制的`for`循环上使用一个范围`for` 循环。范围`for`循环更安全，同样高效。真的就这么简单。

# 对于循环滥用

你偶尔会看到下面这个使用`for`循环的例子:

```
int main () {
  const int numElements = 10;
  int grades[numElements] =
    {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  int i;
  for (i = 0; i < numElements; i++) {
    cout << grades[i] << " ";
  }
  return 0;
}
```

如果看不出区别，循环控制变量在`for`循环外声明，在循环内初始化。这使得变量`i`成为`main`函数的局部变量，这在大多数情况下是不需要的，并且会导致问题。

几乎在每种情况下，循环控制变量都应该在循环内部声明和初始化，这样变量的作用域就局限于`for`循环，而不是`main`函数。如果你像这样在本地声明它，你可以在程序的其他地方使用同一个变量而不会有任何冲突。

你偶尔甚至会看到这个:

```
int main () {
  const int numElements = 10;
  int grades[numElements] =
    {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  int i = 0;
  for (; i < numElements; i++) {
    cout << grades[i] << " ";
  }
  return 0;
}
```

将`for` 循环的第一部分写成空语句在语法上是正确的，但比上一个在循环外声明的例子更令人困惑。请不要像这样编写`for`循环，也不要将修改语句放在循环体内，如下例所示:

```
int main () {
  const int numElements = 10;
  int grades[numElements] =
    {81, 77, 91, 82, 75, 89, 92, 68, 98, 84};
  int i;
  for (i = 0; i < numElements;) {
    cout << grades[i] << " ";
    i++;
  }
  return 0;
}
```

同样，语法很好，但是用法不标准，应该避免。

# 尽可能使用 for 循环

我想用一个建议来结束这篇文章——尽可能使用`for`循环。它们比其他循环类型更容易阅读，通常也更容易调试。当然，有些情况下必须选择不同的循环类型，但这种情况可能不像您想象的那样常见。编程语言 Go 连`while`循环都没有。你必须使用一个`for`循环来完成你想在围棋中做的任何循环。我倾向于在 C++中采纳他们的建议，尽可能使用`for`循环。

感谢您阅读这篇文章，请给我发电子邮件，提出您的意见和建议。