# Python ä¸­çš„ç®€å• URL shortener åº”ç”¨ç¨‹åºï¼Œé€‚åˆåˆå­¦è€…(ğŸ”¥FastAPI æ¼”ç¤º)

> åŸæ–‡ï¼š<https://levelup.gitconnected.com/simple-url-shortener-app-in-python-for-beginners-fastapi-demo-7978049f3532>

![](img/5f4aa9cf4942c3545e4b2c18b1810f4f.png)

fastapi-url-shortener-app

# ä»‹ç»

è¿™æ˜¯ä¸€ä¸ªç”¨ Python FastAPI å¼€å‘çš„ç®€å•çš„ url ç¼©å†™åº”ç”¨ç¨‹åºã€‚
[ç‚¹å‡»æ­¤å¤„](https://github.com/rahul-yr/learn-fastapi-simple-url-shortner)è¿›å…¥ Github repoã€‚
[ç‚¹å‡»æ­¤å¤„](https://www.postman.com/rahul-public/workspace/fastapi-simple-url-shortner-crud/collection/8974578-e4dd76aa-0334-47c3-ba64-c84e27ff58f6)è®¿é—® Postman API é›†åˆã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¸»è¦å…³æ³¨ 3 ä»¶äº‹

*   å®ƒæ˜¯åˆå­¦è€…å‹å¥½çš„ã€‚
*   ä¸“æ³¨äºè¡Œä¸šæœ€ä½³å®è·µã€‚
*   éƒ¨ç½²åˆ°äº‘ã€‚

æœ¬æ•™ç¨‹çš„èŒƒå›´ä¸»è¦é›†ä¸­åœ¨æ„å»º API ä¸Šï¼Œè€Œä¸æ˜¯ Python åŸºç¡€ã€‚å¦‚æœä½ å¯¹ Python å®Œå…¨é™Œç”Ÿï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰ï¼Œå¯¹ Python çš„åŸºç¡€çŸ¥è¯†æœ‰ä¸€ä¸ªå¾ˆå¥½çš„äº†è§£ã€‚

# å…ˆå†³æ¡ä»¶

*   ä»[è¿™é‡Œ](https://code.visualstudio.com/download)ä¸‹è½½å¹¶å®‰è£… VS ä»£ç 
*   ä»[è¿™é‡Œ](https://www.python.org/downloads/)ä¸‹è½½å¹¶å®‰è£… Python

## ä»€ä¹ˆæ˜¯è™šæ‹Ÿç¯å¢ƒï¼Ÿ

è™šæ‹Ÿç¯å¢ƒæ˜¯ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œç”¨äºä¿æŒæ‚¨çš„é¡¹ç›®ä¾èµ–å…³ç³»ç‹¬ç«‹äºä»»ä½•å…¶ä»–é¡¹ç›®æˆ–ç³»ç»Ÿé…ç½®ã€‚è¿™æœ‰åŠ©äºé¿å…ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„ä¾èµ–å†²çªã€‚

# ç°åœºæ¼”ç¤º

ç‚¹å‡»æ­¤å¤„æµ‹è¯•[å®æ—¶ç«¯ç‚¹](https://learn-fastapi-url-shortener.herokuapp.com/url-shortener/list)

# å¼€å‘ URL ç¼©å†™ API

## è®¾ç½®

*   æ‰“å¼€ VS ä»£ç ï¼Œåœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`main.py`çš„æ–°æ–‡ä»¶ã€‚
*   è¿™ä¸ª`main.py`æ–‡ä»¶è´Ÿè´£è¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä½œä¸ºåº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚
*   ä½¿ç”¨è¿™ä¸ªå‘½ä»¤`python -m venv virtual_env_name`åˆ›å»ºä¸€ä¸ª Python è™šæ‹Ÿç¯å¢ƒ
*   ä½¿ç”¨å„è‡ªçš„æ“ä½œç³»ç»Ÿå‘½ä»¤æ¿€æ´»æ‚¨çš„è™šæ‹Ÿç¯å¢ƒã€‚

```
# Linux
source virtual_env_name/bin/activate# Windows
virtual_env_name\Scripts\activate.bat#Mac
source virtual_env_name/bin/activate
```

*   åœ¨ Python è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…æ‰€æœ‰å¿…éœ€çš„ä¾èµ–é¡¹ã€‚

```
# add fast api package
pip install fastapi# add web server for running fast api
pip install "uvicorn[standard]"# add package for cleaning cache files
pip install pyclean
```

å°†ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ·»åŠ åˆ°`main.py`æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªä»£ç ç‰‡æ®µæœ‰ä¸¤ä¸ª GET è¯·æ±‚æ–¹æ³•ç±»å‹çš„ç«¯ç‚¹ã€‚ä¸€ä¸ªç«¯ç‚¹è¿”å›`{"hello" : "world"}` json å“åº”ï¼Œå¦ä¸€ä¸ªè¿”å›æ‚¨ä½œä¸º`item_id`ä¼ é€’çš„åŠ¨æ€å‚æ•°

*   ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿è¡Œåº”ç”¨ç¨‹åºã€‚é»˜è®¤çš„ä¸»æœº url æ˜¯`[http://localhost:8000](http://localhost:8000)`

```
uvicorn main:app --reload
```

æ‰“å¼€é»˜è®¤ç«¯ç‚¹ï¼Œå¦‚æœæ‚¨çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼Œé‚£ä¹ˆæ‚¨å·²ç»æˆåŠŸåœ°ğŸ”¥åœ¨æœ¬åœ°éƒ¨ç½²æ‚¨çš„åº”ç”¨ç¨‹åºã€‚

![](img/4c5d74328bfa2fa98a91f0c46acff923.png)

ç¤ºä¾‹-fast API-ç«¯ç‚¹

*   ä¸ GET æ–¹æ³•ç±»ä¼¼ï¼Œæ‚¨å¯ä»¥å®šä¹‰æ‚¨éœ€è¦çš„ä»»ä½•æ”¯æŒçš„è¯·æ±‚æ–¹æ³•ã€‚
*   åˆ é™¤æ‚¨æ·»åŠ çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå³`read_root`ã€`read_item`ï¼Œç°åœ¨æ˜¯å®ç°çœŸæ­£çš„ url ç¼©çŸ­ç«¯ç‚¹çš„æ—¶å€™äº†ã€‚

## åˆ›å»º URL ç¼©å†™ç«¯ç‚¹ã€‚

*   åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä»¥ä¸‹æ–‡ä»¶å’Œç›®å½•ã€‚

```
# folder : 
url_shortener# files
url_shortener/__init__.py
url_shortener/database.py
url_shortener/router.py
url_shortener/models.py
```

*   `__init__.py` file ç”¨äºå°†å½“å‰æ–‡ä»¶å¤¹è¡¨ç¤ºä¸ºä¸€ä¸ªåŒ…ã€‚ä»¥ä¾¿å®ƒå¯ä»¥åœ¨å…¶ä»–åŒ…ä¸­è¢«å¼•ç”¨ã€‚
*   `router.py`æ–‡ä»¶è´Ÿè´£å¤„ç† url æ·å¾„è·¯ç”±ã€‚
*   `models.py`æ˜¯ä¸€ä¸ªé€šç”¨æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰æ‰€æœ‰å¿…è¦çš„ url ç¼©å†™æ¨¡å‹ã€‚
*   `database.py`æ–‡ä»¶è´Ÿè´£å¤„ç†æ•°æ®åº“æ“ä½œã€‚ç”±äºäº’è”ç½‘ä¸Šæœ‰æ•°ç™¾ç§æ•°æ®åº“é€‰é¡¹ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ sleep å‘½ä»¤æ¨¡æ‹Ÿæ•°æ®åº“æ“ä½œï¼Œå¹¶å°†æ•°æ®å­˜å‚¨åœ¨å†…å­˜å˜é‡ä¸­ã€‚

## å®šä¹‰æ¨¡å‹

*   ä¸‹é¢æ˜¯`models.py`çš„ç‰‡æ®µã€‚æ­£å¦‚æ‚¨åœ¨ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ¨¡å‹ã€‚
*   `CreateUrlShortener`æ¨¡å‹è´Ÿè´£éªŒè¯çŸ­ URL çš„åˆ›å»ºã€‚
*   `CreateUrlShortenerResponse`æ¨¡å‹è¢«ç”¨ä½œ json å“åº”æ¨¡å‹ã€‚

## å®šä¹‰æ•°æ®åº“æ“ä½œ

*   ä¸‹é¢æ˜¯`database.py`æ–‡ä»¶çš„ä»£ç ç‰‡æ®µã€‚å®ƒæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡`all_data`ï¼Œå°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥å®šä¹‰å„è‡ªçš„æ•°æ®åº“å®ä¾‹ï¼Œè€Œä¸æ˜¯`in memory`å˜é‡ã€‚ä»¥åŠå®ƒæœ‰ 3 ä¸ªåŠŸèƒ½ï¼Œåˆ›å»ºä¸€ä¸ªçŸ­ç½‘å€ï¼Œåˆ é™¤ä¸€ä¸ªçŸ­ç½‘å€å’Œè·å–æ‰€æœ‰çš„çŸ­ç½‘å€ã€‚
*   è¿™ä¸ªä»£ç ç‰‡æ®µæœ‰å®šä¹‰æ˜ç¡®çš„æ³¨é‡Šï¼Œå¯ä»¥å¸®åŠ©æ‚¨è¯¦ç»†ç†è§£é€»è¾‘ã€‚

## åˆ›å»ºç«¯ç‚¹

*   ä¸‹é¢æ˜¯`router.py`æ–‡ä»¶çš„ä»£ç ç‰‡æ®µã€‚
*   åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º`url_shortener`çš„ api è·¯ç”±å™¨å’Œä¸€ä¸ªåä¸º`mock_db_operations`çš„æ•°æ®åº“å®ä¾‹ã€‚
*   `url_shortener`ç”¨äºå°†è¿™äº›ç«¯ç‚¹å®‰è£…åˆ°ä¸»è·¯ç”±å™¨ä¸Šã€‚
*   `mock_db_operations`ç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚
*   å®ƒä¸ºåˆ›å»ºã€åˆ é™¤ã€åˆ—å‡ºç«¯ç‚¹å®šä¹‰äº† 3 ä¸ªæ–¹æ³•ï¼Œä¸ºæµ‹è¯• url é‡å®šå‘å®šä¹‰äº† 1 ä¸ªæ–¹æ³•ã€‚ä½¿ç”¨è¡Œå†…æ³¨é‡Šæ¥è¯¦ç»†ç†è§£é€»è¾‘ã€‚

## æ›´æ–°ä¸»æ–‡ä»¶

*   ä¸‹é¢æ˜¯å®‰è£…äº† url è·¯ç”±å™¨çš„`main.py`æ–‡ä»¶ç‰‡æ®µï¼Œå³`url_shortener`ã€‚

# ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨æœ¬åœ°è¿è¡Œåº”ç”¨ç¨‹åº

```
uvicorn main:app --reload
```

*   ä½¿ç”¨[è¿™ä¸ª postman é›†åˆ](https://www.postman.com/rahul-public/workspace/fastapi-simple-url-shortner-crud/collection/8974578-e4dd76aa-0334-47c3-ba64-c84e27ff58f6)ä½œä¸º API è§„èŒƒå¹¶æµ‹è¯•ç«¯ç‚¹ã€‚
*   ä¸‹é¢æ˜¯ä½¿ç”¨ Postman çš„ API è¯·æ±‚å’Œå“åº”çš„ä¸€äº›å¿«ç…§ã€‚

## åˆ›å»º URL ç¼©å†™å¿«ç…§

![](img/e24327414506f219815c43a0529c489f.png)

åˆ›å»ºçŸ­ç½‘å€

## åˆ—å‡ºæ‰€æœ‰çŸ­ URL

![](img/89c63785e17bb4757d4f4edf1ea1d91c.png)

åˆ—è¡¨-çŸ­ç½‘å€

## å®é™…æµ‹è¯•é‡å®šå‘

![](img/40795067befd44aa5442ee9031f5d27d.png)

æµ‹è¯•-é‡å®šå‘-URL

## åˆ é™¤çŸ­ç½‘å€

![](img/44a11282051ff17d61373efcb3048906.png)

åˆ é™¤çŸ­ç½‘å€

# éƒ¨ç½²åˆ°äº‘

çŸ¥é“å¦‚ä½•å°†è¿™ä¸ªå›è´­éƒ¨ç½²åˆ° Heroku å—ï¼Ÿ[ç‚¹å‡»è¿™é‡Œæ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•](https://blog.devgenius.io/how-to-deploy-any-backend-to-heroku-easily-3194d48dd810)

# æ‘˜è¦

å¯æ€•çš„ğŸ”¥ï¼Œæ‚¨å·²ç»æˆåŠŸå®Œæˆäº†æœ¬æ•™ç¨‹ã€‚æˆ‘ä¼šğŸ’å¬å¬ä½ çš„åé¦ˆå’Œæ„è§ï¼Œçœ‹çœ‹ä½ èƒ½ç”¨å®ƒåšäº›ä»€ä¹ˆã€‚å¦‚æœä½ è¢«å›°åœ¨æŸä¸ªåœ°æ–¹ï¼Œè¯·éšæ„è¯„è®ºã€‚æˆ‘éšæ—¶éƒ½æœ‰ç©ºã€‚

è¯·åœ¨ [github](https://github.com/rahul-yr/learn-fastapi-simple-url-shortner) æ‰¾åˆ°å®Œæ•´çš„ä»£ç 

# åˆ†çº§ç¼–ç 

æ„Ÿè°¢æ‚¨æˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼æ›´å¤šå†…å®¹è¯·å‚è§[å‡çº§ç¼–ç å‡ºç‰ˆç‰©](https://levelup.gitconnected.com/)ã€‚
è·Ÿéš:[æ¨ç‰¹](https://twitter.com/gitconnected)ï¼Œ[é¢†è‹±](https://www.linkedin.com/company/gitconnected)ï¼Œ[é€šè¿…](https://newsletter.levelup.dev/)
**å‡ä¸€çº§æ­£åœ¨æ”¹é€ ç†å·¥å¤§æ‹›è˜â¡ï¸** [**åŠ å…¥æˆ‘ä»¬çš„äººæ‰é›†ä½“**](https://jobs.levelup.dev/talent/welcome?referral=true)