<html>
<head>
<title>Blood Spectroscopy to Image Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">血液光谱图像分类</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/blood-spectroscopy-to-image-classification-a3c39e61c4f1?source=collection_archive---------6-----------------------#2022-03-12">https://levelup.gitconnected.com/blood-spectroscopy-to-image-classification-a3c39e61c4f1?source=collection_archive---------6-----------------------#2022-03-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/2628ba1d4e80c8f5ee38b183ad82657e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*0xAl2hkvZmASrFUoc5Ipuw.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">资料来源:津迪。非洲</figcaption></figure><p id="ff7a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">临床环境中的血液分析是通过从不同患者收集血液样本，然后进行不同的血液测试来完成的。使用NIR光谱学，给定波长范围内的光束被导向样品。根据样品的化学成分(分子结构)，光会被不同程度地衰减，部分被吸收或反射。光谱吸收强度数据可以在表征生物样品化学组成的不同波长(生物窗口)上获得。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/f88739a9cd223d5999f52e4a854c5e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*iNqy6pRQQniANu0QTCfMtQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">未处理的光谱</figcaption></figure><h1 id="ec62" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">津迪问题定义</strong></h1><blockquote class="lz ma mb"><p id="0b70" class="jy jz mc ka b kb kc kd ke kf kg kh ki md kk kl km me ko kp kq mf ks kt ku kv ij bi translated">“为此，你可以建立机器学习模型，根据光谱数据对样品中特定化学化合物的水平进行分类。”~津迪</p></blockquote><h1 id="87b3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">数据处理管道</strong></h1><p id="444c" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">这类问题中的一个关键挑战是除了光谱读数的高特征维度之外的重复读数。</p><p id="a7d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了节省计算资源，吸光度强度的中值在所有样本捐赠id中进行聚合。这样可以消除重复读数，从而减少样本量(训练+测试)。</p><p id="1a0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实验结果表明，中值聚合方法优于均值聚合技术(我的假设是，这可能是由于数据中存在异常值和高方差)。</p><h1 id="0095" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">数据准备和光谱预处理</strong></h1><p id="c2ac" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">使用纯化合物的化学特征，通过计算所有纯化学特征与全谱读数的相关性，从全谱读数中提取特征化学模式。</p><p id="8a7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于血红蛋白是血液中大多数化学化合物的主要载体，因此与感兴趣的化学成分相比，在化合物中观察到的信号强度更高。</p><p id="6741" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，在特定波长观察到高度的信号重叠，使得波长选择和成分隔离的问题更加棘手。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/196818309be552450acb7e27ee59c436.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*xrAzBiUTjZWCHRtzQVYmfg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">样品预处理光谱</figcaption></figure><blockquote class="lz ma mb"><p id="e92e" class="jy jz mc ka b kb kc kd ke kf kg kh ki md kk kl km me ko kp kq mf ks kt ku kv ij bi translated"><strong class="ka ir">化学成分模式信息</strong></p></blockquote><p id="3127" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用其相应的纯化学信号分离单个化学成分的方法包括计算并从血红蛋白(主要载体)的相关信号中减去干扰化合物的相关信号信息</p><pre class="kx ky kz la gt ml mm mn mo aw mp bi"><span id="a025" class="mq lc iq mm b gy mr ms l mt mu">from scipy import signal</span><span id="3466" class="mq lc iq mm b gy mv ms l mt mu">def compute_correlation(whole, sub):<br/>  """ compute correlation matrix <br/>      whole : spectral reading<br/>      sub : pure chemical signature</span><span id="93a0" class="mq lc iq mm b gy mv ms l mt mu">  """</span><span id="6ee2" class="mq lc iq mm b gy mv ms l mt mu">  whole_mean = whole.mean()</span><span id="3f32" class="mq lc iq mm b gy mv ms l mt mu">  whole = whole - whole_mean</span><span id="f5b0" class="mq lc iq mm b gy mv ms l mt mu">  sub   = sub - whole_mean</span><span id="95b1" class="mq lc iq mm b gy mv ms l mt mu">  corr = signal.correlate(whole, sub, mode = 'same')</span><span id="8b5d" class="mq lc iq mm b gy mv ms l mt mu">  return corr</span></pre><p id="3dbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了获得具有高信噪比的有效代谢物信息，在计算中利用了针对读数的所有纯化学信号相关信息。</p><p id="b296" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mc">高密度脂蛋白胆固醇(HDL-C)信号</em> </strong>:为了获得净HDL-C信号强度信息，从每次读取的血红蛋白相关矩阵中减去葡萄糖和脂肪相关信号。</p><pre class="kx ky kz la gt ml mm mn mo aw mp bi"><span id="e9a6" class="mq lc iq mm b gy mr ms l mt mu">net_hdl_corr = hgb_corr - (fat_corr + glu_corr)</span></pre><p id="ae09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mc">【低密度脂蛋白胆固醇(LDL-C信号)</em> </strong>:为了获得净LDL-C信号强度信息，每次读取时，仅从血红蛋白相关矩阵中去除葡萄糖相关。在这种情况下，脂肪被区别对待，因为高脂肪含量与高LDL-C高度相关。脂肪(甘油三酯)可被视为LDL-C合成的必要前体。</p><pre class="kx ky kz la gt ml mm mn mo aw mp bi"><span id="452c" class="mq lc iq mm b gy mr ms l mt mu">net_ldl_corr = ldl_corr  - glu_corr</span></pre><p id="4d73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="mc">血红蛋白(HGB)信号</em> </strong>:为了获得净HGB-C信号强度信息，从每次读取的全局血红蛋白相关矩阵中去除葡萄糖和脂肪(类似于HDL-C)</p><pre class="kx ky kz la gt ml mm mn mo aw mp bi"><span id="64b8" class="mq lc iq mm b gy mr ms l mt mu">net_hgb_corr = hgb_corr  - (fat_corr + glu_corr)</span></pre><blockquote class="lz ma mb"><p id="2385" class="jy jz mc ka b kb kc kd ke kf kg kh ki md kk kl km me ko kp kq mf ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="iq">实验光谱预处理总结和一些要点</em> </strong></p></blockquote><ul class=""><li id="20e0" class="mw mx iq ka b kb kc kf kg kj my kn mz kr na kv nb nc nd ne bi translated"><em class="mc">选择应用于数据的信号预处理效果的“正确”顺序</em></li></ul><p id="4054" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">—实验结果表明，执行一系列标准正态变量(SNV)缩放，然后执行扩展平均散射校正(EMSC)缩放，可以获得更好的结果。</p><ul class=""><li id="436b" class="mw mx iq ka b kb kc kf kg kj my kn mz kr na kv nb nc nd ne bi translated"><em class="mc">将一阶导数Savitsky-Golay(SG)平滑应用于预处理信号提供了最佳结果。</em></li></ul><p id="5949" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">—实验结果表明，二阶SG平滑引入了过多的噪声，因此导致性能比一阶SG平滑更差</p><p id="fd6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">—基本平滑效果(无导数)和原始光谱信息没有提供改进。</p><p id="4085" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">—使用偏最小二乘回归(PLSR)的波长选择没有增加改进</p><p id="d7e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">—最后，数据扩充(在转换为图像数据之前)并没有提高模型性能。</p><h1 id="50db" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">将光谱信息转换成图像</strong></h1><p id="2302" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">经过处理的信号信息被编码为不同类型的图像，即，格拉米角和场(GASF)和格拉米角差场(GADF)以及马尔可夫转移场(MTF)</p><p id="dcda" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些成像技术包括在极坐标系统而不是经典的笛卡尔系统中表示净信号信息</p><p id="99f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从处理后的信号计算的3个不同的图像被连接以形成3通道复合图像</p><p id="e074" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">-如需详细解释，请考虑阅读本文。</p><h1 id="dadc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">模型建筑</strong></h1><ul class=""><li id="7c3b" class="mw mx iq ka b kb mg kf mh kj ng kn nh kr ni kv nb nc nd ne bi translated">模型由一个VGG风格的模型架构组成，它接受两个输入——图像和元特征</li><li id="1133" class="mw mx iq ka b kb nj kf nk kj nl kn nm kr nn kv nb nc nd ne bi translated">元特征包括扫描仪环境变量(温度+湿度),以及工程特征——聚类、主成分和一阶SG平滑光谱的标准差。</li><li id="ca0b" class="mw mx iq ka b kb nj kf nk kj nl kn nm kr nn kv nb nc nd ne bi translated">Softmax是跨所有卷积隐藏层使用的激活函数。</li></ul><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/0e46cf0208d29e6619db727935c8fe92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*seCeSIAGmm9kin1WmrX1Jw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">模型摘要</figcaption></figure><h1 id="c096" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">培训</strong></h1><ul class=""><li id="2cdf" class="mw mx iq ka b kb mg kf mh kj ng kn nh kr ni kv nb nc nd ne bi translated">在3个不同数据集的训练阶段，保持统一的模型架构设计。</li><li id="0b59" class="mw mx iq ka b kb nj kf nk kj nl kn nm kr nn kv nb nc nd ne bi translated">每个模型的每个数据集类型使用10重分层交叉验证方案。</li></ul><h1 id="f1dc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">总之</strong></h1><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/00c19945e063783e7c5983011c69e8a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*Jf1ukEGj2w1wolHgIckofw.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">方法概述</figcaption></figure><blockquote class="lz ma mb"><p id="5920" class="jy jz mc ka b kb kc kd ke kf kg kh ki md kk kl km me ko kp kq mf ks kt ku kv ij bi translated">最后备注:血液样本的NIR光谱数据的预处理和图像的光谱变换的适当组合可以受益于使用二维卷积神经网络的图像识别的优点。这种方法产生了0.6095的最佳准确度分数，比0.5616的基准准确度提高了大约8.5%。</p></blockquote><h1 id="1284" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">参考文献</strong></h1><p id="61e6" class="pw-post-body-paragraph jy jz iq ka b kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv ij bi translated">[1]我的知识库—(<a class="ae nf" href="https://github.com/DrCod/Blood-Spectroscopy-Classification-using-Deep-Learning" rel="noopener ugc nofollow" target="_blank">https://github . com/dr cod/Blood-Spectroscopy-class ification-using-Deep-Learning</a>)。点击找到完整解决方案<a class="ae nf" href="https://github.com/DrCod/Blood-Spectroscopy-Classification-using-Deep-Learning/blob/main/Final%20Solution%20Implementation.ipynb" rel="noopener ugc nofollow" target="_blank">的链接。</a></p><p id="ebdc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[2]改进分类和插补的成像时间序列(<a class="ae nf" href="https://www.ijcai.org/Proceedings/15/Papers/553.pdf" rel="noopener ugc nofollow" target="_blank">https://www.ijcai.org/Proceedings/15/Papers/553.pdf</a>)—我强烈推荐阅读这篇论文。</p><p id="2466" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[3] <a class="ae nf" href="https://github.com/johannfaouzi/pyts.git" rel="noopener ugc nofollow" target="_blank"> pyts </a> —一个用于时间序列分类的开源python包。</p><p id="326d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[4] <a class="ae nf" href="https://github.com/EBjerrum/Deep-Chemometrics/blob/master/ChemUtils.py" rel="noopener ugc nofollow" target="_blank"> ChemUtils </a> —一个用于化学计量学数据预处理和分析的开源python工具。</p><p id="dc70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[5]罗翰(<a class="ae nf" href="https://www.kaggle.com/ubitquitin/tsc-exploration" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/ubitquitin/tsc-exploration</a>)利用LSTMs和卷积神经网络(CNN)进行时间序列分类(TSC)探索</p><p id="eebc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[6]扩展乘法信号增强(EMSA) —模型实现结构改编自VGG风格的架构，见<a class="ae nf" href="https://github.com/BioSpecNorway/EMSA/blob/fce4a35fd8dc58687096130bc2794e63e1719b9f/src/spectra_vgg.py" rel="noopener ugc nofollow" target="_blank">此处</a></p><p id="81a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[7]基于近红外光谱的软骨完整性分类(<a class="ae nf" href="https://github.com/ioafara/ML-DL-NIR-spectral-analysis/" rel="noopener ugc nofollow" target="_blank">https://github.com/ioafara/ML-DL-NIR-spectral-analysis</a></p><p id="9a56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[8] bloods.ai血液光谱分类挑战赛(<a class="ae nf" href="https://zindi.africa/competitions/bloodsai-blood-spectroscopy-classification-challenge" rel="noopener ugc nofollow" target="_blank">https://zindi . Africa/competitions/bloods ai-Blood-Spectroscopy-class ification-Challenge</a>)</p></div></div>    
</body>
</html>