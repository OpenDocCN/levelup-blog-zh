# 角度动态路由

> 原文：<https://levelup.gitconnected.com/angular-dynamic-routing-299c04ca75b1>

![](img/490dc054b1dbc4ed40f19db4080ad29b.png)

布鲁诺·凯尔泽在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

此时，您可能已经听说过动态组件，它对于创建更加动态的应用程序非常有用。它们允许我们在运行时根据一些定制的逻辑动态地加载组件，而不必创建一个被 ngIf 的负载所膨胀的组件。

如果你还没有听说过动态元件，我建议你看看 Angular Connect 的 Shmuela Jacobs 的演讲:

在我的日常工作中，我正在构建一个类似于 CRM 的系统，管理各种不同的产品，这些产品都有一个共同的核心部分，但也有一些特定于产品的东西。为了使组件更加可重用，我到处引入了动态组件，这些组件根据指定当前活动产品的 InjectionToken 加载正确的特定于产品的组件。一切都很好，直到我试图重构一个步骤流，它有一些通用步骤，但也有一些特定于产品的步骤。这是一个问题，因为分步流程不仅基于组件，还依赖于路线。这意味着产品的步骤流可以有一些与其他步骤不同的附加步骤，即路线。步骤的数量也可以变化。

一种不太好的解决方法是创建固定数量的路由，命名为:step1、step2、step3，然后在每个步骤中动态加载组件，但是由于步骤的数量不同，这是不可能的。正确的解决方案是使用**动态路由**。

通常，我们在路由模块中非常静态地定义模块的路由，如下所示:

一旦模块被加载，就没有任何逻辑可以干扰路由的静态分配，所以总是会有本地路由，除此之外什么也没有。

# 例子

让我们来看一个非常简单的例子，这个例子可能没什么意义，但它的目的是演示动态路由的工作原理:

我们希望创建一个具有以下路径的应用程序:

*   **首页** *(静态)*
*   **404 未找到** *(静态)*
*   **日** *(动态；仅在早上 6 点到下午 6 点之间提供)*
*   **夜晚** *(动态；仅在下午 6 点—早上 6 点之间提供)*
*   **秘密** *(动态；50/50 的机会)*

动态路由意味着模块的路由配置可以根据您为加载定义的逻辑在每次加载时发生变化。主要技巧是使用 **ROUTES** InjectionToken，这是一个用于路由器配置的低级 API。我们没有在 RouterModule 的 forRoot/forChild 函数中直接传递路由，而是传递一个空数组，并在 providers 部分提供 routes 标记。在这种情况下，角度路由器将自动只使用来自所提供令牌的路由。

现在我们在 providers 部分定义了我们的路由，我们可以利用 **useFactory** provider 定义对象。这样，我们可以通过一个包含决定路线外观的逻辑的工厂。

**简短提醒:**如果您在早上 5:59 加载模块，并等到早上 6:01，则当天的路线将不可用，因为之前已经完成了路线配置。这意味着定义路由的逻辑只在模块加载时出现一次。

# 结论

我希望我能给你看一些新的有趣的东西。如果你对 Angular 感兴趣，可以看看我在 Medium 上的其他博文。

我的 GitHub 上有完整的示例:

[](https://github.com/HaasStefan/dynamic-routing-angular) [## GitHub-HaasStefan/dynamic-routing-Angular:Angular 中的动态路由示例

### 此项目是使用 Angular CLI 版本 13.2.2 生成的。为开发服务器运行 ng serve。导航到…

github.com](https://github.com/HaasStefan/dynamic-routing-angular)