# 我在 API 和继承中遇到的问题。网

> 原文：<https://levelup.gitconnected.com/the-problem-i-had-with-apis-and-inheritance-in-net-7f5ffa8e16f2>

## 以及如何轻松解决

![](img/313e3fb37f55d077c9255deb6735db67.png)

[rupixen.com](https://unsplash.com/@rupixen)在 [Unsplash](https://unsplash.com/photos/Q59HmzK38eQ) 上拍照

这就是我的问题。我的 *OrderController* 中有一个端点必须添加一个订单，如下所示(为了简洁明了，我将使用一个简短的例子):

我的 *OrderEntity* 看起来像这样:

到目前为止相当简单。问题出现在最后一行的*支付细节*中，类看起来像这样 *:*

不要害怕，空空如也是有原因的！其背后的想法是，将有多种不同的支付方法，包含继承该类的不同属性。在这种情况下，我们有两个:

是的，背后的思想是，根据我传递给控制器的 JSON 主体，它将决定我使用哪种支付方式。所以，假设我发送了这样的消息:

我希望 API 能够发现我发送的订单的付款方式应该是 Braintree。不幸的是，我得到的都是空的薪酬明细，平心而论，这确实有些道理，但我没想到。NET 不会像我预期的那样支持 API 中的继承。

现在，解决方案。互联网上有很多想法和解决方案，坦率地说，大部分要么是黑客，要么是杂乱无章、不可扩展的。例如，您可以在实际的 Order 类上添加所有不同的支付细节，并只传递正在使用的那个，但这并不能解决问题，尤其是如果您有大量的方法，那么最佳解决方案(或者至少看起来是最佳的)就是这样:

这里发生的是，我们使用 *StreamReader* 从 JSON 中获取数据并传递给控制器，然后我们可以将它映射到 *OrderEntity。*与众不同的是，我们可以使用初始 JSON 并解析它，以便从请求中转换支付细节，然后根据 *PaymentTypeId* 将数据转换为适当的对象。

我绝不认为这是完美的解决方案，然而在这种情况下这是一个很好的解决方案，但是如果有人有任何建议，我洗耳恭听。