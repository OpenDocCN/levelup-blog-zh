<html>
<head>
<title>Deploy an ML Project as Dashboard with Google Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署一个ML项目作为带有Google认证的仪表板</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/deploy-ml-project-as-dashboard-with-google-authentication-14fee8c6988c?source=collection_archive---------2-----------------------#2022-03-26">https://levelup.gitconnected.com/deploy-ml-project-as-dashboard-with-google-authentication-14fee8c6988c?source=collection_archive---------2-----------------------#2022-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2ac5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将机器学习算法作为一个应用程序部署在互联网上，增加了google身份验证的安全性。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2f73dc32a64fddb763da258f3f3b8b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*65DY-zgKzhXpZUSN"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">杰里米·贝赞格在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="f634" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个项目是整个项目的第二部分，第一部分在</p><p id="e823" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://siddharth1.medium.com/loading-and-extraction-83fedad258f0" rel="noopener">https://siddharth 1 . medium . com/loading-and-extraction-83 fedad 258 f 0</a></p><p id="8e03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文的代码可以在</p><p id="38e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/kshirsagarsiddharth/plotly_dash_dashboard_for_car_prediction/tree/master" rel="noopener ugc nofollow" target="_blank">kshiragarsiddharth/plotly _ dash _ dashboard _ for _ car _ prediction(github.com)</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="037a" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">我们需要为所有8个输入列创建核心组件</h2><p id="2e30" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">让我们从km _ travelled开始。我将为每一列创建一个核心组件，并逐步展示所采取的步骤。最后，我将把这个应用程序部署为python脚本</p><p id="1482" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该应用程序最终将如何工作</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms lt l"/></div></figure><h2 id="8993" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">应用程序最终会是什么样子</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/48e707c6b32b2e4bdfb1a306fd3e9a3f.png" data-original-src="https://miro.medium.com/v2/1*cnvAGNwiYbji2bJG4u0ZRw.gif"/></div></figure><h2 id="2f3d" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">1.km _ travelled的核心组件</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/5ce755726b203f49af8ef620abda061d.png" data-original-src="https://miro.medium.com/v2/1*4ej8aHbQgbwJsjY5fXyA2w.gif"/></div></figure><h2 id="0fe6" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">2.模型年份的核心组件</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/1fd14a56fa71b1ac09422fe285658f1c.png" data-original-src="https://miro.medium.com/v2/1*pz0xNW46QltiNXKFYKu-zg.gif"/></div></figure><h2 id="6782" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">3.发动机尺寸和税收的核心部件</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/3d0ad3d9cbb9ae45d4ab255a5e81bec9.png" data-original-src="https://miro.medium.com/v2/1*EFIf5TlXftXY_TGgIFSWfA.gif"/></div></figure><h2 id="a882" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">将剩余的柱作为构件添加</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/ed5e68d1bb094653b23312167a4be9e6.png" data-original-src="https://miro.medium.com/v2/1*daTw8OICVOv45hhLmPwT0w.gif"/></div></figure><h2 id="085b" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">现在所有的核心组件都准备好了，在添加模型来执行预测之前，我们在这个方法中遇到了一个问题。</h2><ol class=""><li id="ee85" class="mu mv iq ky b kz mn lc mo lf mw lj mx ln my lr mz na nb nc bi translated">在上面的代码中，只要输入描述的任何属性发生变化，就会触发回调函数。</li><li id="0a5a" class="mu mv iq ky b kz nd lc ne lf nf lj ng ln nh lr mz na nb nc bi translated">通过在上面的输入中输入数据，自己尝试一下。为了解决这个问题，我们将使用State，它允许您传递额外的值，而不触发回调。</li><li id="c68c" class="mu mv iq ky b kz nd lc ne lf nf lj ng ln nh lr mz na nb nc bi translated">这里有一个与上面相同的例子，但是使用了dcc。作为状态的输入组件和作为输入的新按钮组件。换句话说，我们希望只有在单击提交按钮时才调用机器学习算法。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="67b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仔细看gif，只有当我们点击提交键时，组件才会更新</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/f22601da90551c3541df619b5276f035.png" data-original-src="https://miro.medium.com/v2/1*yBwO4rwpDPKyncJqhZFKgg.gif"/></div></figure><h2 id="05f9" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">既然我们已经获得了所有的输入，让我们加载模型并实时预测价格</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/7bd3db5be83e55d8ba3a7f9b4991a3ad.png" data-original-src="https://miro.medium.com/v2/1*CY4a3nemP6KjibaeS0Rw_A.gif"/></div></figure><h2 id="d0fd" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">最后，该应用程序正在工作，让我们使用dash引导组件使这个应用程序真正美丽</h2><p id="e729" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">注意:这标志着仪表板框架的结束，从现在开始我们将只改进仪表板的外观</p><h2 id="6088" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">Dash引导组件最小示例</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="20f0" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">现在我们运行与上面相同的代码，不同的是我们将输入存储到一个变量中，让我们将div的元素替换到变量中。</h2><p id="0bba" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">让我用下图来说明这一点</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/305eb7739506479cfd68d26aab568cf9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Yo1wFFSlbTLTcpwKv_vxfg.png"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="1ef4" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">让我们将上述应用程序转换为引导组件的行和列，并使用变量替换这些行，</h2><ol class=""><li id="c8a5" class="mu mv iq ky b kz mn lc mo lf mw lj mx ln my lr mz na nb nc bi translated">为此，我创建了两个文件，一个是utils.py，另一个是app.py。在utils中，我定义了row1，在app.py中，我导入了该行。</li><li id="38fa" class="mu mv iq ky b kz nd lc ne lf nf lj ng ln nh lr mz na nb nc bi translated">在下面的代码中，只有一个组件被转换成dbc行。</li></ol><p id="d34d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:请通过python脚本创建2个文件来运行代码，并取消对<code class="fe ni nj nk nl b">utils import row1,row2</code>代码的注释</p><pre class="kg kh ki kj gt nm nl nn no aw np bi"><span id="d5e1" class="lu lv iq nl b gy nq nr l ns nt">```<br/># utils.py <br/><br/>import pandas as pd<br/>from dash import dcc, html<br/>import dash_bootstrap_components as dbc<br/>import numpy as np<br/><br/>df = pd.read_csv('car_price_data.csv').drop('Unnamed: 0', axis=1)<br/><br/><br/>row1 = dbc.Row([<br/>    dbc.Col(html.H5('KM Travelled')),<br/>    dbc.Col(dcc.Slider(<br/>        min=df['km_traveled'].min(),<br/>        max=df['km_traveled'].max(),<br/>        value=100.0,<br/>        id='km-travelled-slider',<br/>        tooltip={"placement": "bottom"}<br/>    )),<br/>    dbc.Col(html.H5('Pick Car Year')),<br/>    dbc.Col(dcc.Dropdown(<br/>        id='year-picker',<br/>        options=np.sort(df['year'].unique()),<br/>        value=2017<br/>    ))<br/>])</span><span id="1864" class="lu lv iq nl b gy nu nr l ns nt"># app.py<br/>from datetime import date<br/>import joblib<br/>from jupyter_dash import JupyterDash<br/>from utils import row1<br/>loaded_model = joblib.load('final_car_prediction_model.pkl')<br/>app = JupyterDash(__name__, external_stylesheets = [dbc.themes.BOOTSTRAP])<br/>app.layout = html.Div([<br/>   row1,<br/>  <br/>    <br/>    html.H2('tax-picker'),<br/>    dcc.Slider(<br/>        min=df['tax'].min(),<br/>        max=df['tax'].max(),<br/>        value=df['tax'].min(),<br/>        id='tax-slider',<br/>        tooltip={"placement": "bottom"}<br/>    ),<br/>    html.H2('engine-size'),<br/>    dcc.Slider(<br/>        min=df['engineSize'].min(),<br/>        max=df['engineSize'].max(),<br/>        value=df['engineSize'].min(),<br/>        id='engine-size-slider',<br/>        marks={i: str(i) for i in np.sort(df['engineSize'].unique())},<br/>        tooltip={"placement": "bottom"}<br/>    ),<br/><br/>    html.H2('km-per-liter'),<br/>    dcc.Slider(<br/>        min=df['km_per_liters'].min(),<br/>        max=df['km_per_liters'].max(),<br/>        value=df['km_per_liters'].min(),<br/>        id='km-per-liters-slider',<br/>        tooltip={"placement": "bottom"}<br/>    ),<br/><br/>    html.H2('model-dropdown'),<br/>    dcc.Dropdown(<br/>        id='model-dropdown',<br/>        options=np.sort(df['model'].unique()),<br/>        value=df['model'][0]<br/>    ),<br/>    html.H2('transmission-dropdown'),<br/>    dcc.Dropdown(<br/>        id='transmission-dropdown',<br/>        options=np.sort(df['transmission'].unique()),<br/>        value=df['transmission'][0]<br/>    ),<br/><br/>    html.H2('fuel-type-dropdown'),<br/>    dcc.Dropdown(<br/>        id='fuel-type-dropdown',<br/>        options=np.sort(df['fuel_type'].unique()),<br/>        value=df['fuel_type'][0]<br/>    ),<br/>    html.Button(id='submit-button-state', n_clicks=0, children='Submit'),<br/><br/><br/>    html.Div([<br/>        html.Div(id='km-travelled-slider-output',<br/>                 children=[html.P('km-travelled-slider-output'), ]),<br/>        html.Div(id='year-picker-output'),<br/>        html.Div(id='engine-size-slider-output'),<br/>        html.Div(id='tax-slider-output'),<br/>        html.Div(id='km-per-liters-slider-output'),<br/>        html.Div(id='model-dropdown-output'),<br/>        html.Div(id='transmission-dropdown-output'),<br/>        html.Div(id='fuel-type-dropdown-output'),<br/>        html.Div(id='prediction', style={'font-size':'60px'})<br/>    ], style={'font-size': '20px'})<br/><br/>])<br/><br/><br/>@app.callback(<br/>    Output('km-travelled-slider-output', 'children'),<br/>    Output('year-picker-output', 'children'),<br/>    Output('engine-size-slider-output', 'children'),<br/>    Output('tax-slider-output', 'children'),<br/>    Output('km-per-liters-slider-output', 'children'),<br/>    Output('model-dropdown-output', 'children'),<br/>    Output('transmission-dropdown-output', 'children'),<br/>    Output('fuel-type-dropdown-output', 'children'),<br/>    Output('prediction', 'children'),<br/><br/>    Input('submit-button-state', 'n_clicks'),<br/>    State('km-travelled-slider', 'value'),<br/>    State('year-picker', 'value'),<br/>    State('engine-size-slider', 'value'),<br/>    State('tax-slider', 'value'),<br/>    State('km-per-liters-slider', 'value'),<br/>    State('model-dropdown', 'value'),<br/>    State('transmission-dropdown', 'value'),<br/>    State('fuel-type-dropdown', 'value')<br/>)<br/>def update_output(n_clicks, km_travelled, date_value, engine_size, tax_value, km_per_liters, model_name, transmission, fuel_type):<br/>    prediction = loaded_model.predict(pd.DataFrame(<br/>        data=[[str(date_value), km_travelled, tax_value, engine_size,<br/>               km_per_liters, model_name, transmission, fuel_type]],<br/>        columns=joblib.load('column_names.pkl')))<br/><br/>    return (f"km_travelled: {km_travelled}",<br/>            f"date_value: {date_value}",<br/>            f"engine_size: {engine_size}",<br/>            f"Tax: {tax_value}",<br/>            f"Km Per Liters: {km_per_liters}",<br/>            f"model name: {model_name}",<br/>            f"transmission: {transmission}",<br/>            f"fuel_type: {fuel_type}",<br/>            f"prediction: {prediction}"<br/>            )<br/><br/><br/># app.run_server(mode="inline")<br/>app.run_server()</span><span id="db49" class="lu lv iq nl b gy nu nr l ns nt">Dash app running on <a class="ae kv" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8050/</a></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/95a281b3d8a87ea370adf2b64ab12e6d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*h0hZe26cUeL4BvuBm--3PQ.png"/></div></figure><p id="5b29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">接下来，我想要一些关于用户实时输入什么值的视觉反馈，所以我对不同的输入使用不同的功能。并且通过输出组件捕捉每个输入的视觉反馈。</strong></p><ol class=""><li id="a9b6" class="mu mv iq ky b kz la lc ld lf nv lj nw ln nx lr mz na nb nc bi translated">我使用dash daq作为输入组件的可视化输出</li><li id="1a58" class="mu mv iq ky b kz nd lc ne lf nf lj ng ln nh lr mz na nb nc bi translated">Dash DAQ包括一套强大的控制装置，使数据采集和控制集成到您的Dash应用程序变得更加简单。</li></ol><p id="b424" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下面的代码中，我定义了将直接从输入核心组件读取并显示实时输出的组件，这就是为什么我需要为每个组件创建单独的回调。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="fc48" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">每个组件输出的各自回调</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="295f" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">app的最终结构</h2><p id="8ae8" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">在GitHub找到最终实现的代码这是该应用程序的外观</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/0b4da3a75b88ecc14fdd027a48e9ed1a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*KJIN7BoGmK4Dmk6C0kGiRg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/48e707c6b32b2e4bdfb1a306fd3e9a3f.png" data-original-src="https://miro.medium.com/v2/1*cnvAGNwiYbji2bJG4u0ZRw.gif"/></div></figure><h2 id="c5cf" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">添加Google和github Oauth</h2><p id="9461" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">(文章来了，但代码在)</p><p id="6355" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/kshirsagarsiddharth/prediction_with_security/tree/master" rel="noopener ugc nofollow" target="_blank">kshiragarsiddharth/prediction _ with _ security(github.com)</a></p><h2 id="26e3" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">Heroku的部署</h2><p id="fa5b" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">未完待续……</p></div></div>    
</body>
</html>