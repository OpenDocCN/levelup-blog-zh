<html>
<head>
<title>How to use SED to manipulate text files (Part 1: print, delete, append)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用SED操作文本文件(第1部分:打印、删除、追加)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-use-sed-to-manipulate-text-files-part-1-print-delete-append-aa444143c4bd?source=collection_archive---------10-----------------------#2022-06-16">https://levelup.gitconnected.com/how-to-use-sed-to-manipulate-text-files-part-1-print-delete-append-aa444143c4bd?source=collection_archive---------10-----------------------#2022-06-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="277a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi ks translated"><span class="l kt ku kv bm kw kx ky kz la di"> S </span> ED(流编辑器)是类Unix系统中ED和QED(快速编辑器)的继承者，用于纯文本编辑。我们经常会遇到这样的情况:我们必须从一个巨大的文件中提取一些数据，或者从一个大数据文件中获取一两列数据。我们喝了咖啡，坐下来写一些代码，或者开始在互联网上寻找已经提供的代码。我不是要把我们叫出来，但是如果我告诉你有一个一行代码可以让你付出代价，你会有什么感觉？是的，SED可以用非常简单的一行程序做到这一点。</p><p id="8e55" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在本文中，我将总结一些基本的文件格式，然后在本文的后半部分，我将尝试举例说明如何使用SED从LAMMPS的日志文件中获取数据(LAMMPS是一个分子动力学模拟软件包)。</p><p id="c32c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">假设我们有一个名为'<em class="lb"> foo.data </em>的文本文件，其内容如下:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/eeda9862960a22a478ecf3fa8a4f4865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*hDOkm37CMWOV4ScQQvOQHw.jpeg"/></div></figure><h1 id="8fd1" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">语法:</strong></h1><blockquote class="mi mj mk"><p id="0d4d" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -option 'command '文本文件&gt;输出文件</p></blockquote><p id="5240" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们来分析一下-</p><ul class=""><li id="4264" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated"><strong class="jw ir"> sed </strong> =启动sed</li><li id="861e" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated"><strong class="jw ir">选项</strong> =任意可选参数(-n表示关闭自动打印，-i表示就地编辑，-e =表达式)</li><li id="57fc" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated"><strong class="jw ir">‘命令’</strong>=你想做的事情(正则表达式，模式匹配，删除)</li><li id="67ce" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated"><strong class="jw ir">文本文件</strong> =您想要处理的文件</li><li id="5d71" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated"><strong class="jw ir"> outputfile </strong> =如果你想保存输出到一个文件(可选)</li></ul><h1 id="cd9a" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">打印带SED的行:</strong></h1><p id="db26" class="pw-post-body-paragraph ju jv iq jw b jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn ng kp kq kr ij bi translated">如果我们想打印foo.data的第6行，那么命令</p><blockquote class="mi mj mk"><p id="7ea9" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed '6p' foo.data</p></blockquote><p id="bfb2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">会给我们这样的整个文件内容，它会打印第6行(<em class="lb"> LAMMPS是一个经典的分子动力学模拟代码，设计用于)</em>两次——一次用于<em class="lb"> 6p </em>，另一次用于不使用<em class="lb"> -n </em>。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/aa933913e9f41c1c026a7aca21e45f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*LC8JqpFN2nvPqBjKNxFUjw.jpeg"/></div></figure><p id="cbc7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但是我们可以通过在“命令”前添加-n来关闭自动打印:</p><blockquote class="mi mj mk"><p id="e82e" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '6p' foo.data</p></blockquote><p id="4b08" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，输出将只有第6行:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ebf069bd500e9807328bb127e78f4585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*kG-9nJuE2Fxhm2rNbcdXzA.jpeg"/></div></figure><p id="b736" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">同样，对于第二行，我们必须写“2p”。SED也能识别空行。如果你写‘5p’，你将得到第5行(空行)作为输出。同样，如果我们想从第3行到第5行打印，那么我们使用:</p><blockquote class="mi mj mk"><p id="a7c9" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '3，5p' foo.data</p></blockquote><p id="f59e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者，</p><blockquote class="mi mj mk"><p id="8fee" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '3，+2p' foo.data</p></blockquote><p id="72f6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了得到最后一行，我们使用$:</p><blockquote class="mi mj mk"><p id="33df" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '$p' foo.data</p></blockquote><h1 id="638d" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">删除:</h1><blockquote class="mi mj mk"><p id="3996" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed '6d' foo.data</p></blockquote><p id="81f1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">前述命令将删除第6行(<em class="lb"> LAMMPS是一个经典的分子动力学模拟代码，旨在)</em>，但原始文本文件不变。要修改原始文件，我们必须在命令前使用-i (inplace)。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/b089edea8c1f8cbc076547bb798d2493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*RfgAT37n_YyJjLjQ15rcRg.jpeg"/></div></figure><blockquote class="mi mj mk"><p id="f016" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -i '6d' foo.data</p></blockquote><p id="e5c8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，要查看文件，我们可以使用这些工具中的任何一个:cat、less或more。</p><blockquote class="mi mj mk"><p id="7f55" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">less foo.data</p><p id="850c" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">更多foo.data</p><p id="121f" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">cat foo.data</p></blockquote><p id="d728" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于<em class="lb"> less foo.data </em>，输出缓冲区将如下所示:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/b159c03a5d57af9826cf484d835a841d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*YTMEA3FO5mpJoODt8ExgIQ.jpeg"/></div></figure><p id="122f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">您可以看到我们删除的行丢失了，这个-i选项修改了原始文本文件。现在，让我们再把这条线放回去:</p><blockquote class="mi mj mk"><p id="caf0" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -i '5 a LAMMPS是一个经典的分子动力学模拟程序</p></blockquote><p id="fc97" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将把我们选择的行放在第5行之后。让我们看看这意味着什么:</p><ul class=""><li id="dace" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">任何数字(这里是5)=到第5行。</li><li id="895d" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated">a =附加在第5行之后(这意味着要插入第6行)</li><li id="0f7f" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated">兰姆普斯是…<strong class="jw ir"> </strong> =要追加的行</li></ul><p id="0de2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，如果我们再次看到文件使用较少，我们会看到原始文件已被保留。</p><h1 id="70d2" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">打印奇数/偶数行:</h1><p id="af66" class="pw-post-body-paragraph ju jv iq jw b jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn ng kp kq kr ij bi translated"><strong class="jw ir">古怪:</strong></p><blockquote class="mi mj mk"><p id="5cfb" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '1~2p' foo.data</p></blockquote><p id="fa46" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将打印奇数行(1，3，5，…)。)</p><p id="069f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">偶数:</strong></p><blockquote class="mi mj mk"><p id="1ba3" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '2~2p' foo.data</p></blockquote><p id="9219" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将打印偶数行(2，4，6，…)。)</p><ul class=""><li id="de92" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">1~2 =从<strong class="jw ir">第一行</strong>开始，然后跳转+2行:1+2 = <strong class="jw ir"> 3 </strong>，3+2 = <strong class="jw ir"> 5 </strong> …</li><li id="91c9" class="mo mp iq jw b jx mx kb my kf mz kj na kn nb kr mt mu mv mw bi translated">2~2 =从<strong class="jw ir">第2</strong>行开始，然后跳转+2行:2+2 = <strong class="jw ir"> 4 </strong>，4+2 = <strong class="jw ir"> 6 </strong> …</li></ul><p id="da1e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">类似地，4~3将得到第4、7、10行。</p><h1 id="6f4a" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">插入:</strong></h1><p id="5283" class="pw-post-body-paragraph ju jv iq jw b jx nc jz ka kb nd kd ke kf ne kh ki kj nf kl km kn ng kp kq kr ij bi translated">如果我们想在第4行插入一行呢？</p><blockquote class="mi mj mk"><p id="1129" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -i '4我在此插入一行' foo.data <br/> cat foo.data</p></blockquote><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/518de8c60ed74793f4b41707d0a4342a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*jcukhHBq146arIFZkNEpwA.jpeg"/></div></figure><h1 id="20be" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">变更行内容:</strong></h1><blockquote class="mi mj mk"><p id="7238" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -i '5 c模拟包' foo.data <br/> cat foo.data</p></blockquote><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7bf17b43cd6cac0217d6dd8330058672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*3is37LKBZAiR9HG2Qrs3KA.jpeg"/></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">插入</figcaption></figure><p id="d171" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在让我们回到之前的位置:</p><blockquote class="mi mj mk"><p id="be68" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed-I ' 4d；5 c模拟器' foo.data '</p></blockquote><p id="2c85" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将删除第4行(“此处插入的行”)，并将第5行从“模拟包”改回“模拟器”。分号(；)用于分隔两个命令。这将使文件看起来与我们开始时的文件完全一样。</p><p id="188f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">另一种方式:</strong></p><blockquote class="mi mj mk"><p id="4f13" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -i -e '4d' -e '5 c模拟器' foo.data</p></blockquote><ul class=""><li id="73c7" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">-e用于表达。</li></ul><h1 id="4929" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">杂项:</h1><blockquote class="mi mj mk"><p id="d547" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed '=' foo.data</p></blockquote><ul class=""><li id="da1d" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将在每一行之前打印行号——这是查看每一行的好方法。</li></ul><blockquote class="mi mj mk"><p id="b2c1" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed 'G' foo.data</p></blockquote><ul class=""><li id="61b0" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将在每行之后添加一个空行。</li></ul><blockquote class="mi mj mk"><p id="3312" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed ' =；G' foo.data <br/>或，sed -e '=' -e 'G' foo.data</p></blockquote><ul class=""><li id="db1d" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将打印数字，然后在每行后添加一个空行。</li></ul><blockquote class="mi mj mk"><p id="0c86" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed '1=' foo.data</p></blockquote><ul class=""><li id="809a" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将打印第一行之前的数字。</li></ul><blockquote class="mi mj mk"><p id="29ef" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed '$=' foo.data</p></blockquote><ul class=""><li id="2661" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将打印最后一行之前的数字。</li></ul><blockquote class="mi mj mk"><p id="c7ab" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed -n '$=' foo.data</p></blockquote><ul class=""><li id="b969" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将打印文件中的总行数(无内容打印)。</li></ul><blockquote class="mi mj mk"><p id="43ad" class="ju jv lb jw b jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq kr ij bi translated">sed '1~2 w oddlines.data' foo.data</p></blockquote><ul class=""><li id="96d3" class="mo mp iq jw b jx jy kb kc kf mq kj mr kn ms kr mt mu mv mw bi translated">这将只把奇数行打印到名为oddlines.data的文件中</li></ul><p id="5f1b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi ks translated">在第2部分中，我将详细介绍SED在模式匹配方面的工作原理，并向您展示如何使用SED只用一两行代码来操作大量数据——就这么简单！！我不是Unix的天才，但是我喜欢使用SED和类似SED的其他工具来方便使用。我在分享我的知识，这也是我的数字指南，一举两得！！谢谢你跟上这篇长文。祝您愉快！！</p></div></div>    
</body>
</html>