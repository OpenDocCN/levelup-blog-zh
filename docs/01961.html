<html>
<head>
<title>AWS, Azure, GCP: Resource Hierarchies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS，Azure，GCP:资源层次结构</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/aws-azure-gcp-resource-hierarchies-25b829127511?source=collection_archive---------3-----------------------#2020-02-09">https://levelup.gitconnected.com/aws-azure-gcp-resource-hierarchies-25b829127511?source=collection_archive---------3-----------------------#2020-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/8b67cf7c6d11e5c758811311dc5ace8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zsLH39mennEfQeDhE1JAWQ.jpeg"/></div></div></figure><div class=""/><p id="ad9b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文的目的是提供三个最大的云提供商的资源层次的高层次总结:亚马逊网络服务(AWS)、微软Azure和谷歌云平台(GCP)。我们的目标不是对不同的平台进行评级，对它们进行排序，或者推荐一个平台。在较高层次上讨论了不同的功能，并提供了更详细信息的链接。</p><h1 id="259d" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">资源层次结构</h1><p id="3913" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">资源层级是指在云平台帐户中如何组织资源，例如，结构是否扁平，或者是否可以构建层级，不同层级之间是否继承策略，权限如何管理等。从技术的角度来看，这些可能看起来像是小问题，但是花一点点努力来首先理解组织模型，然后在开始时设计如何实现它，可以在以后节省大量的精力。</p><p id="8e2a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与移动现有资源运行生产工作负载相比，在绘图板上尝试不同的方法要容易得多，也便宜得多。如果设计得当，在定义不同种类的策略、访问控制、管理设置、成本管理等时，可以有效地利用该结构。</p><p id="f29e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一方面，在最坏的情况下，错误的设计甚至可能导致严重的安全问题和危及生产工作负载。资源结构可以基于许多不同的方法或它们的组合来建模，例如，组织的操作结构、项目结构、资源生命周期、信任边界、工作负载类型(开发/测试/生产)等。因此，提前了解所选平台的资源层次结构并设计要实现的方法，将会在以后获得回报。</p><figure class="ma mb mc md gt is gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/d6c42cb068ca23755ef99122f464a5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*lznsHUz8kWjGn4Zu4LPCRw.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">图一。AWS、Azure和GCP资源层次结构。</figcaption></figure><p id="5169" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">AWS、Azure和GCP都支持多级资源层次结构。在组织和管理实体的方式上，层次结构与文件系统有一些相似之处，例如，每个资源可以有多个子资源，但只有一个父资源。所有这三个平台都支持分层设置策略和配置设置，这意味着在较高级别定义的策略和配置设置可以由较低级别的平台继承。但是，不同平台之间的级别数量以及不同级别是强制的还是可选的会有所不同。</p><h1 id="5e8c" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">自动警报系统</h1><p id="586b" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae mi" href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_getting-started_concepts.html" rel="noopener ugc nofollow" target="_blank"> AWS资源层次结构</a>有四个级别:组织、组织单位、帐户和资源。使用AWS服务需要有一个AWS帐户，因为所有服务都是在一个帐户中创建、启用或使用的。相反，使用组织和组织单位级别是可选的。</p><figure class="ma mb mc md gt is gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/d3ace984df652478a25a247d9250265a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*NmsKdHsNMxWSma0eSutpIQ.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">图二。AWS资源层次结构。</figcaption></figure><p id="3ce9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">组织实体代表一个组织，它用于将多个AWS帐户作为一个单元进行管理。拥有多个AWS帐户的组织可以使用组织实体在同一位置集中查看和管理他们的所有帐户。实体是组织中所有帐户的父容器。组织实体对帐户的控制程度取决于配置。例如，启用组织实体上的所有功能可完全控制帐户，启用合并计费则仅启用共享计费。建议在创建新组织时启用所有功能。以后可以更改配置，但所有帐户都必须批准更改。</p><p id="6602" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">组织单位是组织内帐户的容器。但是，没有组织实体就不能使用组织单位。一个组织单位可以包含帐户、其他组织单位或两者的组合。在实践中，组织单元可以用来在一个组织内建立一个组织或项目结构的模型。例如，一个组织有多个部门，这些部门被组织成团队，每个团队有多个产品，每个产品有多个环境。部门、团队和产品都是使用组织单元分层建模的。不同的环境在产品组织单元下都有自己的帐户。</p><p id="4d31" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">帐户资源是所有AWS服务的容器，例如虚拟机、S3桶、lambdas等。创建新资源时，它总是在一个帐户内创建。组织和组织单位可以有多个帐户，但一个帐户只能有一个父帐户。一个组织可以有两种类型的账户:一个主账户和多个成员账户。主帐户创建组织，并用于管理成员帐户。其他帐户是包含AWS资源的成员帐户。可以在组织中创建新的成员帐户，并且可以邀请其他现有帐户加入组织。</p><p id="e635" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">组织支持<a class="ae mi" href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scp.html" rel="noopener ugc nofollow" target="_blank">服务控制策略</a> (SCP)，可用于控制组织中所有帐户的最大可用权限。scp可用于保证所有帐户都遵循组织的访问控制策略。可以在组织、组织单位和帐户级别定义scp。然而，scp并不向用户授予权限，它们只是定义最大可用权限。这意味着仍然需要使用IAM策略单独定义用户权限。仅当基于身份和基于资源的策略以及SCP允许操作时，才允许操作。此外，该操作必须得到该帐户上所有家长的许可，否则将被阻止。</p><p id="c12f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">scp支持白名单和黑名单。白名单意味着只允许定义的动作，其他的都是禁止的。黑名单意味着除了定义的动作之外，一切都是允许的。如果在资源层次结构的较高级别中明确或隐含地禁止了某个动作，那么在较低的级别中就不能再允许该动作。</p><h1 id="896a" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">蔚蓝的</h1><p id="8c6f" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae mi" href="https://docs.microsoft.com/en-us/azure/governance/management-groups/overview" rel="noopener ugc nofollow" target="_blank"> Azure资源层次结构</a>有五个级别:根、管理组、订阅、资源组和资源。除了根之外，使用Azure服务需要有Azure订阅和至少一个资源组，因为所有服务都是在资源组内创建、启用或使用的。相反，使用管理组级别是可选的。</p><figure class="ma mb mc md gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mk"><img src="../Images/63105cb19a2e413b0f9fc53d89ae6eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nyhbwMN--AVuaKmmgMdUMQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">图3。Azure资源层次结构。</figcaption></figure><p id="c58f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根实体是资源层次结构的顶级节点，它代表一个组织。从技术上讲，根实体是内置于资源层次结构中的管理组，不能移动或删除。所有管理组、订阅、资源组和资源都归入根管理组。根管理组可用于在组织级别应用策略和权限。换句话说，分配给根管理组的策略和权限适用于层次结构中的所有资源。</p><p id="b78d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">管理组是组织内订阅的容器。管理组可以包含订阅、其他管理组或两者的组合。在实践中，管理组可以用来模拟一个组织内的组织或项目结构。</p><p id="a0ff" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">订阅资源是所有Azure服务的容器，例如虚拟机、存储帐户、功能等。创建新资源时，它必须与一个订阅和一个<a class="ae mi" href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/management/overview#resource-groups" rel="noopener ugc nofollow" target="_blank">资源组</a>相关联。资源组是订阅和资源之间的附加层，资源是保存相关Azure资源的容器。每个资源只能存在于一个资源组中，并且每个资源组可以包含位于不同位置的多个资源。同一资源组中的所有资源应该共享同一生命周期。当订阅从一个管理组移动到另一个管理组时，继承的策略和权限也会发生变化。</p><p id="74ba" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在实践中，管理组、订阅和资源组可用于在组织内建立组织结构或项目结构的模型。例如，一个组织有多个部门，这些部门被组织成团队，每个团队有多个产品，每个产品有多个环境。部门和团队都是使用管理组分层建模的。可以使用管理组或订阅对不同的产品进行建模。对于管理组，不同的环境可以有单独的订阅，或者可以放在同一个订阅中，但放在单独的资源组中。如果每个产品有一个订阅，唯一的替代方法是为不同的环境创建单独的资源组。</p><p id="9836" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">管理设置和权限可以应用于任何级别。在一个级别应用的设置和权限也总是应用于层次结构中所有较低的级别。例如，当策略应用于订阅时，它将应用于订阅中的所有资源组和资源。在较高级别授予的权限不能在较低级别撤销。</p><h1 id="2f2b" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">GCP</h1><p id="e06f" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><a class="ae mi" href="https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy" rel="noopener ugc nofollow" target="_blank"> GCP资源层次结构</a>有四个级别:组织、文件夹、项目和资源。所有使用Google云服务的帐户必须至少有一个项目资源，因为所有服务都是在一个项目中创建、启用或使用的。相反，使用组织和文件夹级别是可选的。</p><figure class="ma mb mc md gt is gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/d5e2ceecd5efe90e8cc55d757fee8c00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*jFApI006k-dcF7xGapMEkA.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">图4。GCP资源层次结构。</figcaption></figure><p id="5884" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">组织是资源层次结构的根节点，它代表一个组织。但是，组织资源是可选的，因此，GCP帐户不需要拥有该资源。当组织资源不存在时，项目归创建该项目的用户所有。当用户离开组织时，这可能是一个问题。相反，当组织资源存在时，项目归组织所有，并遵循组织的生命周期，而不是用户在Google Cloud上的生命周期。这意味着当用户离开组织时，项目不会受到影响。此外，组织资源支持对所有项目进行集中控制，并在组织级别管理访问控制。</p><p id="d151" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mi" href="https://cloud.google.com/resource-manager/docs/creating-managing-folders" rel="noopener ugc nofollow" target="_blank">文件夹</a>资源可以作为项目间额外的分组机制。但是，使用文件夹也需要定义组织资源。文件夹可以包含项目、其他文件夹或两者的组合。在实践中，文件夹可用于对组织内的组织或项目结构进行建模。例如，一个组织有多个部门，这些部门被组织成团队，每个团队有多个产品，每个产品有多个环境。部门、团队和产品都使用文件夹进行分层建模。不同的环境在产品文件夹下都有自己的项目。</p><p id="4b07" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">项目资源是所有Google云服务的容器，例如虚拟机、云存储桶、云功能等。创建新资源时，它总是在项目中创建。组织和文件夹可以有多个项目，但是一个项目一次只能有一个父项目、一个组织或一个文件夹。</p><p id="4d2e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以在任何资源级别设置云IAM策略，并且资源继承父节点的策略。例如，在组织级别设置的策略会被所有子文件夹和项目继承。类似地，在项目级别设置的策略由项目的所有资源继承。继承是可传递的，这意味着资源从项目继承策略，项目从文件夹继承策略，文件夹从组织继承策略。总而言之，组织级别的策略也适用于资源级别。当项目从一个文件夹移动到另一个文件夹时，继承的权限也会改变。</p></div></div>    
</body>
</html>