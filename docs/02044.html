<html>
<head>
<title>Playing Chrome’s Dinosaur Game using OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OpenCV玩Chrome的恐龙游戏</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/playing-chromes-dinosaur-game-using-opencv-19b3cf9c3636?source=collection_archive---------3-----------------------#2020-02-15">https://levelup.gitconnected.com/playing-chromes-dinosaur-game-using-opencv-19b3cf9c3636?source=collection_archive---------3-----------------------#2020-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9477" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用Python和OpenCV来玩恐龙游戏。在这里，我使用的是Windows，我的摄像头用于摄像头馈送，但你也可以使用Linux和MacOS的大部分代码。</p><p id="6fd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们基本上是要用摄像头的手部动作来玩Chrome恐龙游戏。</p><h1 id="142c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">演示</h1><p id="ec8d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们最终代码的一瞥。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/87493f1deb673959bed5123b4cf34a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cIspSBE1lPIyTRrroytKxA.gif"/></div></div></figure><h1 id="0050" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">我们开始吧</h1><h2 id="5103" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">您需要以下库</h2><pre class="lp lq lr ls gt mm mn mo mp aw mq bi"><span id="e5e0" class="ma km iq mn b gy mr ms l mt mu">import numpy as np<br/>import cv2<br/>import math<br/>import pyautogui</span></pre><p id="8912" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Pyautogui:  PyAutoGUI是一个Python模块，用于以编程方式控制鼠标和键盘，无需任何用户交互。</p><p id="26ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开相机并设置矩形</p><pre class="lp lq lr ls gt mm mn mo mp aw mq bi"><span id="6f42" class="ma km iq mn b gy mr ms l mt mu"># Open Camera<br/>capture = cv2.VideoCapture(0)<br/><br/>while capture.isOpened():<br/><br/>    # Capture frames from the camera<br/>    ret, frame = capture.read()<br/><br/>    # Get hand data from the rectangle sub window<br/>    cv2.rectangle(frame, (100, 100), (300, 300), (0, 255, 0), 0)<br/>    crop_image = frame[100:300, 100:300]</span></pre><p id="bb87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模糊图像以平滑一些边缘，将模糊的图像从BGR(蓝、绿、红)转换为HSV(色调、饱和度、值)，因为在HSV中比用BGR更容易过滤掉。</p><p id="899d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置H、S、V值的上限和下限，以便仅包括肤色、橙色色调。(随意发挥这些价值)。</p><p id="9c05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这被称为阈值处理，它将每个像素转换成白色或黑色，现在上下范围内的每个像素都是白色，而每隔一个像素是黑色，这样的图像被称为“掩模”。</p><pre class="lp lq lr ls gt mm mn mo mp aw mq bi"><span id="3e36" class="ma km iq mn b gy mr ms l mt mu"># Apply Gaussian blur<br/>blur = cv2.GaussianBlur(crop_image, (3, 3), 0)<br/><br/># Change color-space from BGR -&gt; HSV<br/>hsv = cv2.cvtColor(blur, cv2.COLOR_BGR2HSV)<br/><br/># Create a binary image with where white will be skin colors and rest is black<br/>mask2 = cv2.inRange(hsv, np.array([2, 0, 0]), np.array([20, 255, 255]))<br/><br/># Kernel for morphological transformation<br/>kernel = np.ones((5, 5))<br/><br/># Apply morphological transformations to filter out the background noise<br/>dilation = cv2.dilate(mask2, kernel, iterations=1)<br/>erosion = cv2.erode(dilation, kernel, iterations=1)<br/><br/># Apply Gaussian Blur and Threshold<br/>filtered = cv2.GaussianBlur(erosion, (3, 3), 0)<br/>ret, thresh = cv2.threshold(filtered, 127, 255, 0)</span></pre><p id="0690" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">寻找和绘制等高线。每个相邻的像素部分被称为一个轮廓。这将画出框架的每个白色“部分”的轮廓。输出看起来会像这样。</p><p id="426c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在需要找到轮廓(手)的中心，为此我们将使用cv2.moments来找到轮廓的质心。根据矩，质心被提取如下。当检测到手时，按下空格键，恐龙可以跳跃，如果你不打开恐龙窗口，你会看到每次检测到手时，按下空格键。</p><pre class="lp lq lr ls gt mm mn mo mp aw mq bi"><span id="8e52" class="ma km iq mn b gy mr ms l mt mu"># Find contours<br/>#image, contours, hierarchy = cv2.findContours(thresh, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)<br/>contours, hierachy = cv2.findContours(thresh, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)<br/><br/>try:<br/>    # Find contour with maximum area<br/>    contour = max(contours, key=lambda x: cv2.contourArea(x))<br/><br/>    # Create bounding rectangle around the contour<br/>    x, y, w, h = cv2.boundingRect(contour)<br/>    cv2.rectangle(crop_image, (x, y), (x + w, y + h), (0, 0, 255), 0)<br/><br/>    # Find convex hull<br/>    hull = cv2.convexHull(contour)<br/><br/>    # Draw contour<br/>    drawing = np.zeros(crop_image.shape, np.uint8)<br/>    cv2.drawContours(drawing, [contour], -1, (0, 255, 0), 0)<br/>    cv2.drawContours(drawing, [hull], -1, (0, 0, 255), 0)<br/><br/>    # Fi convexity defects<br/>    hull = cv2.convexHull(contour, returnPoints=False)<br/>    defects = cv2.convexityDefects(contour, hull)<br/><br/>    # Use cosine rule to find angle of the far point from the start and end point i.e. the convex points (the finger<br/>    # tips) for all defects<br/>    count_defects = 0</span><span id="cad4" class="ma km iq mn b gy mv ms l mt mu">for i in range(defects.shape[0]):<br/>    s, e, f, d = defects[i, 0]<br/>    start = tuple(contour[s][0])<br/>    end = tuple(contour[e][0])<br/>    far = tuple(contour[f][0])<br/><br/>    a = math.sqrt((end[0] - start[0]) ** 2 + (end[1] - start[1]) ** 2)<br/>    b = math.sqrt((far[0] - start[0]) ** 2 + (far[1] - start[1]) ** 2)<br/>    c = math.sqrt((end[0] - far[0]) ** 2 + (end[1] - far[1]) ** 2)<br/>    angle = (math.acos((b ** 2 + c ** 2 - a ** 2) / (2 * b * c)) * 180) / 3.14<br/><br/>    # if angle &gt;= 90 draw a circle at the far point<br/>    if angle &lt;= 90:<br/>        count_defects += 1<br/>        cv2.circle(crop_image, far, 1, [0, 0, 255], -1)<br/><br/>    cv2.line(crop_image, start, end, [0, 255, 0], 2)<br/><br/># Press SPACE if condition is match<br/>if count_defects &gt;= 4:<br/>    pyautogui.press('space')<br/>    cv2.putText(frame, "JUMP", (115, 80), cv2.FONT_HERSHEY_SIMPLEX, 2, 2, 2)</span></pre><h1 id="3c38" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><em class="mw">执行</em></h1><p id="80f9" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">运行程序，切换到chrome，打开chrome://dino</p><p id="7eae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开始时，将手放在长方形内。移动你的手让迪诺跳起来。</p><div class="mx my gp gr mz na"><a href="https://medium.com/@harshilp/invisibility-cloak-using-opencv-8b07142c83d6" rel="noopener follow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd ir gy z fp nf fr fs ng fu fw ip bi translated">隐身衣-使用OpenCV</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">如果你是哈利波特迷，你会知道什么是隐身衣。是啊！是斗篷让哈利…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">medium.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no ly na"/></div></div></a></div><h1 id="646f" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">完整代码</h1><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="770e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">github Link—【https://github.com/its-harshil/handdino-opencv T4】</p><p id="a223" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参考资料:</p><p id="53e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nr" href="https://medium.com/@sulphurgfx/playing-chromes-dinosaur-game-using-computer-vision-105da2f3114f" rel="noopener">https://medium . com/@ sulphur FX/playing-chromes-恐龙-游戏-使用-计算机-视觉-105da2f3114f </a></p><p id="22f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nr" href="https://github.com/SinghalHarsh/OpenCV-Projects/blob/master/Playing_Chrome_Dinosaur_Game.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/SinghalHarsh/OpenCV-Projects/blob/master/Playing _ Chrome _恐龙_Game.ipynb </a></p></div></div>    
</body>
</html>