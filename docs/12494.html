<html>
<head>
<title>How to Group-By Pandas DataFrames to Compute Sum</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对熊猫数据帧分组以计算总和</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-group-by-pandas-dataframes-to-compute-sum-82a6bd890cbf?source=collection_archive---------18-----------------------#2022-06-14">https://levelup.gitconnected.com/how-to-group-by-pandas-dataframes-to-compute-sum-82a6bd890cbf?source=collection_archive---------18-----------------------#2022-06-14</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="56be" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用Group By表达式聚合pandas数据框架中的列值</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/613a1d041a89942e558df37f744c6efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yiFo2t7uHPMKxoUsYH1wHw.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@markuswinkler?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马库斯·温克勒</a>在<a class="ae kz" href="https://unsplash.com/s/photos/object?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h2 id="fdce" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">子句最常用的应用之一是让用户计算一组给定数据中特定组值的总和。</p><p id="d232" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">在今天的简短教程中，我们将展示几种不同的方法来计算熊猫数据帧的group by表达式后的和。此外，我们将探讨如何对多个列执行分组操作，以及如何计算多个列的结果组的总和。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="2148" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">首先，让我们创建一个示例数据框架，我们将在本教程中引用它来演示一些概念和展示不同的方法。</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="4e09" class="la lb iu ms b gz nj nk l nl nm">import pandas as pd<br/></span><span id="d1a7" class="la lb iu ms b gz nn nk l nl nm">df = pd.DataFrame(<br/>    [<br/>        (1, 'A', 110, 10.0, True),<br/>        (2, 'B', 540, 9.5, False),<br/>        (3, 'A', 230, 12.1, True),<br/>        (4, 'C', 115, 12.5, True),<br/>        (5, 'C', 145, 21.1, False),<br/>        (6, 'D', 321, 9.97, False),<br/>        (7, 'A', 433, 7.85, True),<br/>        (8, 'B', 100, 5.65, True),<br/>        (9, 'B', 89, 8.0, False),<br/>        (10, 'B', 190, 9.7, True),<br/>        (11, 'C', 85, 6.4, True),<br/>        (12, 'A', 75, 4.5, False),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD', 'colE']<br/>)</span><span id="a884" class="la lb iu ms b gz nn nk l nl nm">print(df)</span><span id="5ddf" class="la lb iu ms b gz nn nk l nl nm"><strong class="ms iv"><em class="no">    colA colB  colC   colD   colE<br/></em></strong>0      1    A   110  10.00   True<br/>1      2    B   540   9.50  False<br/>2      3    A   230  12.10   True<br/>3      4    C   115  12.50   True<br/>4      5    C   145  21.10  False<br/>5      6    D   321   9.97  False<br/>6      7    A   433   7.85   True<br/>7      8    B   100   5.65   True<br/>8      9    B    89   8.00  False<br/>9     10    B   190   9.70   True<br/>10    11    C    85   6.40   True<br/>11    12    A    75   4.50  False</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="69cb" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用sum()方法</h2><p id="b0f9" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在让我们假设我们想要根据列<code class="fe mp mq mr ms b">colB</code>对数据帧进行分组，然后计算每个组的<code class="fe mp mq mr ms b">colC</code>的总和。</p><p id="a525" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">我们需要做的是首先在想要的列上调用<code class="fe mp mq mr ms b">groupby()</code>方法，然后通过分割<code class="fe mp mq mr ms b">groupby()</code>的结果来调用<code class="fe mp mq mr ms b">sum()</code>方法，以便指定我们想要计算总和的列。</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="455d" class="la lb iu ms b gz nj nk l nl nm">&gt;&gt;&gt; df.groupby('colB')['colC'].sum()<br/>colB<br/>A    848<br/>B    919<br/>C    345<br/>D    321<br/>Name: colC, dtype: int64</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="9b63" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用agg()方法</h2><p id="d1ba" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">或者，我们可以使用<code class="fe mp mq mr ms b">agg()</code>方法来执行各种类型的聚合，包括sum:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="b9e4" class="la lb iu ms b gz nj nk l nl nm">&gt;&gt;&gt; df.groupby('colB')['colC'].agg('sum')<br/>colB<br/>A    848<br/>B    919<br/>C    345<br/>D    321<br/>Name: colC, dtype: int64</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="dd17" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">按多列分组</h2><p id="e83c" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">如果要在group-by表达式中考虑多个列，只需将列名指定为列表:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="791d" class="la lb iu ms b gz nj nk l nl nm">&gt;&gt;&gt; df.groupby(['colB', 'colE'])['colC'].sum()<br/>colB  colE<br/>A     False     75<br/>      True     773<br/>B     False    629<br/>      True     290<br/>C     False    145<br/>      True     200<br/>D     False    321<br/>Name: colC, dtype: int64</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="f811" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">计算多列的总和</h2><p id="aeb5" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">同样，如果要计算多个列的总和，只需在对group-by表达式的结果进行切片时包括所有列名:</p><pre class="kk kl km kn gu nf ms ng nh aw ni bi"><span id="5a8f" class="la lb iu ms b gz nj nk l nl nm">&gt;&gt;&gt; df.groupby('colB')['colC', 'colD'].sum()<br/>      colC   colD<br/>colB<br/>A      848  34.45<br/>B      919  32.85<br/>C      345  40.00<br/>D      321   9.97</span></pre></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短教程中，我们讨论了用于计算数据帧中分组数据总和的<code class="fe mp mq mr ms b">GROUP BY</code>子句。</p><p id="d589" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated">此外，我们展示了两种不同的方法，您可以使用这两种方法来计算pandas数据框架中这些组的总和。</p></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="np nq gq gs nr ns"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mt jv mb mc mu jy me lj mv mg mh ln mw mj mk lr mx mm mn mo in bi translated"><strong class="ly iv">相关文章你可能也喜欢</strong></p><div class="np nq gq gs nr ns"><a href="https://towardsdatascience.com/how-to-merge-pandas-dataframes-221e49c41bec" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何合并熊猫数据帧</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">对熊猫数据帧执行左、右、内和反连接</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a href="https://towardsdatascience.com/how-to-iterate-over-rows-in-a-pandas-dataframe-6aa173fc6c84" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何迭代熊猫数据框架中的行</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">讨论如何在pandas中迭代行，以及为什么最好避免(如果可能的话)</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl my mz hy na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a href="https://towardsdatascience.com/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">加快PySpark和Pandas数据帧之间的转换</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">将大火花数据帧转换为熊猫时节省时间</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oj l od oe of ob og kt ns"/></div></div></a></div></div></div>    
</body>
</html>