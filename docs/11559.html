<html>
<head>
<title>How to collect NFT sales data using OpenSea API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用OpenSea API收集NFT销售数据</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-collect-nft-sales-data-using-opensea-api-5a6b9b163f7?source=collection_archive---------1-----------------------#2022-03-27">https://levelup.gitconnected.com/how-to-collect-nft-sales-data-using-opensea-api-5a6b9b163f7?source=collection_archive---------1-----------------------#2022-03-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6da9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文展示了如何从NFT最大的市场<a class="ae kl" href="https://opensea.io/" rel="noopener ugc nofollow" target="_blank"> OpenSea </a>收集NFT(不可替代代币)销售数据。您将看到一个使用<a class="ae kl" href="https://docs.opensea.io/reference/api-overview" rel="noopener ugc nofollow" target="_blank"> OpenSea API </a>获取历史销售数据的脚本。</p><p id="544b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了收集的数据，您将能够执行您的分析，建立仪表板，发现新的趋势，等等。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/47b5db4309ae2263574928b165f719bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlPwDJE6z4j--rGL_JYplQ.png"/></div></div></figure><p id="61cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">nft事务(称为事件)是资产发生状态变化，例如创建或转移。根据opensea，事件由以下字段组成:</p><ul class=""><li id="1ec9" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">事件类型:描述事件类型</li><li id="4a0c" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">asset / asset_bundle:包含发生此事件的资产或资产包的简化版本的子字段</li><li id="9216" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">创建日期:记录事件的时间</li><li id="5088" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">from_account / to_account:与此事件关联的帐户</li><li id="92da" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">is_private:一个布尔值，如果销售事件是私人销售，则为真</li><li id="c155" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">payment_token:该交易中使用的支付资产，如ETH、WETH或DAI</li><li id="7f2c" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><strong class="jp ir">数量</strong>:售出物品的数量。适用于半可替代资产</li><li id="e30f" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated"><strong class="jp ir"> total_price </strong>:购买资产的总价。这包括任何可能已经收取的版税</li></ul><p id="40c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出于我们的目的，只需要获得具有“<em class="lm">成功</em>状态的事件，即资产出售。</p><p id="8a17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lm">接下来，我们将一步步看如何从OpenSea API获取nft销售数据。</em>T13】</strong></p><h2 id="676d" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">1.获取OpenSea API密钥</h2><p id="1254" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">要开始发出请求，你需要OpenSea API密匙，可以从这里获得:<a class="ae kl" href="https://docs.opensea.io/reference/request-an-api-key" rel="noopener ugc nofollow" target="_blank">https://docs.opensea.io/reference/request-an-api-key</a>。</p><h2 id="2850" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">2.请求功能</h2><p id="0d94" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">此函数向端点发出请求，以获取两个日期之间发生的事件列表:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="5d4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点将返回一个事件对象列表和两个游标，用于检索下一页和上一页的结果。</p><h2 id="5226" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">3.解析事件函数</h2><p id="6719" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">该函数解析事件对象:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><h2 id="ac5e" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">4.检索两个日期之间的所有事件</h2><p id="23f4" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">现在，我们可以开始使用已经定义的函数检索两个日期之间发生的事件:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="43c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每次迭代请求时，解析响应，如果"<em class="lm"> next" </em>光标包含值(即有其他事件要获取)，则通过传递光标再次发出请求，依此类推，直到接收到所有结果。</p><p id="e932" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以找到一个现成的脚本，它具有这里显示的所有功能:<a class="ae kl" href="https://github.com/Checco9811/opensea-api-nft-sales" rel="noopener ugc nofollow" target="_blank">https://github.com/Checco9811/opensea-api-nft-sales</a>。</p><p id="61fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过将开始日期和结束日期作为参数来运行脚本，命令执行示例:</p><pre class="kn ko kp kq gt mn mo mp mq aw mr bi"><span id="91b8" class="ln lo iq mo b gy ms mt l mu mv">&gt; python script.py -s "2022-03-25" -e "2022-03-26"</span></pre><p id="ee47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者:</p><pre class="kn ko kp kq gt mn mo mp mq aw mr bi"><span id="ba10" class="ln lo iq mo b gy ms mt l mu mv">&gt; python script.py -s "2022-03-25 01:20" -e "2022-03-26 02:30"</span></pre><p id="db7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">帮助:</p><pre class="kn ko kp kq gt mn mo mp mq aw mr bi"><span id="cfc3" class="ln lo iq mo b gy ms mt l mu mv">&gt; python script.py -h<br/>options:<br/>  -h, --help            show this help message and exit<br/>  -s STARTDATE, --startdate STARTDATE<br/>                     The Start Date (YYYY-MM-DD or YYYY-MM-DD HH:mm)<br/>  -e ENDDATE, --enddate ENDDATE<br/>                       The End Date (YYYY-MM-DD or YYYY-MM-DD HH:mm)<br/>  -p PAUSE, --pause PAUSE<br/>                   Seconds to wait between http requests. Default: 1<br/>  -o OUTFILE, --outfile OUTFILE<br/>          Output file path for saving nft sales record in csv format</span></pre><h2 id="d229" class="ln lo iq bd lp lq lr dn ls lt lu dp lv jy lw lx ly kc lz ma mb kg mc md me mf bi translated">结论</h2><p id="e064" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">我们已经看到了如何使用OpenSea API收集两个给定日期之间的事件，但是也可以只从传递正确参数的单个集合中收集数据，或者考虑所有可能的事件类型，而不仅仅是销售事件。你可以在<a class="ae kl" href="https://docs.opensea.io/reference/retrieving-asset-events" rel="noopener ugc nofollow" target="_blank"> API文档</a>中找到所有细节。<br/>我希望这篇文章对你建立自己的NFT时间序列数据集和进行分析有用。</p><p id="c5b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读！</p><p id="a5a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【YouTube视频样本</p><p id="21b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/Checco9811/opensea-api-nft-sales" rel="noopener ugc nofollow" target="_blank"> GitHub代码</a></p><p id="5f8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.linkedin.com/in/francesco-falleni/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p></div></div>    
</body>
</html>