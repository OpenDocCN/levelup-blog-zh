<html>
<head>
<title>How to Generate a TypeScript API Reference: Building an NPM Package with TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何生成TypeScript API参考:使用TypeScript构建NPM包</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-to-generate-a-typescript-api-reference-building-an-npm-package-with-typescript-9b2dc44a3aaa?source=collection_archive---------15-----------------------#2022-03-07">https://levelup.gitconnected.com/how-to-generate-a-typescript-api-reference-building-an-npm-package-with-typescript-9b2dc44a3aaa?source=collection_archive---------15-----------------------#2022-03-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0144" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从TSDoc评论到vuepress文档网站</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/54fd85746d0ac670ec4cfee74815330b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ifYb3jjDhDWXvfDS5zO5AQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">约书亚·阿拉贡在<a class="ae ky" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="858c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://medium.com/full-human/creating-the-documentation-website-building-an-npm-package-with-typescript-f482ff80f28b" rel="noopener">的上一篇文章</a>中，我们看了看使用Diataxis文档系统框架为文档写些什么。该框架的四个主要文档部分之一是技术参考。技术参考是构建工具可以使用我们的代码来生成API参考的地方。</p><h1 id="d37a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">TSDoc快速介绍</h1><p id="77bf" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在Javascript中，您可以使用一种叫做JSDoc的特殊格式的注释用代码记录您的API。在TypeScript中，有一个等价的东西叫做TSDoc。TSDoc是这种类型注释的规范，由微软编写。</p><p id="fb19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个简单的例子，说明如何将TSDoc添加到代码中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="7cb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们看到了TSDoc注释的主要构件。首先，我们有方法的描述，后面是参数，关键字是<em class="mu"> @param </em>。您可以添加对该方法返回内容的解释(<em class="mu"> @returns </em>)以及如何使用该方法的示例(<em class="mu"> @example </em>)。</p><p id="478e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建此文档将允许我们生成降价文件以添加到我们的文档网站。但是将它添加到您的IDE中也会有好处。像VsCode这样的编辑器可以理解TSDoc，并像这样向您显示文档:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/8ae359026c420d8d0b3f55a99efb1385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOBpaH6AqIK9UmJ78JgVwA.png"/></div></div></figure><h1 id="f507" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在我们的包中使用TSDoc</h1><p id="4f2b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">开始使用TSDoc并不需要太多东西。但是您可以添加eslint-plugin-tsdoc来确保您没有犯语法错误。要安装eslint插件，请运行</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="1f1c" class="nb lw it mx b gy nc nd l ne nf">npm i -D eslint-plugin-tsdoc</span></pre><p id="dd29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并将其添加到您的eslint配置文件中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="360a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了生成API引用，我们有两个选择:我们可以使用<a class="ae ky" href="https://github.com/TypeStrong/typedoc" rel="noopener ugc nofollow" target="_blank"> typedoc </a>或者使用微软提供的一些<a class="ae ky" href="https://github.com/microsoft/rushstack/tree/master/apps" rel="noopener ugc nofollow" target="_blank">包</a>。我提到typedoc是因为它似乎是一个流行的选择。需要注意的一点是，typedoc不遵循TSDoc规范。TSDoc和typedoc有些区别，eslint-plugin-tsdoc会抱怨typedoc语法，从<a class="ae ky" href="https://github.com/TypeStrong/typedoc/issues/1480#issuecomment-766272234" rel="noopener ugc nofollow" target="_blank">本期</a>可以看出。</p><p id="ebde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文的其余部分，我们将使用微软的软件包。微软有一个工具叫api-extractor。该工具将创建一个文档模型，然后可以被另一个名为api-documenter的工具用来生成我们的markdown文件。</p><p id="e506" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装api提取器和api文档器</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="db9d" class="nb lw it mx b gy nc nd l ne nf">npm i -D @microsoft/api-extractor @microsoft/api-documenter</span></pre><p id="629e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe ng nh ni mx b">api-extractor init</code>生成一个基本的api-extractor.json。这个文件是位于你的包的根目录下的api-extractor的配置。您可以启用或禁用api-extractor的一些功能，并设置一些选项。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="a60a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上是我正在使用的配置。这里有两个重要的元素:<em class="mu"> mainEntryPointFilePath </em>和<em class="mu"> apiJsonFilePath </em>。<em class="mu"> mainEntryPointFilePath </em>应该指向main .d.ts文件。为了生成降价文件，api-documenter需要<code class="fe ng nh ni mx b">docModel.apiJsonFilePath</code>中的文档模型。由于我们使用的是vuepress，我们可以将JSON文件添加到vuepress <em class="mu">中。temp </em>文件夹也一样。</p><p id="2d11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们可以运行api-documenter来使用JSON文件生成markdown文档。我们的文档是手动创建的，除了一个文件夹api-reference。由于它已经生成，我们正在将它添加到. gitignore中。我们还需要更新我们之前创建的工作流<a class="ae ky" href="https://medium.com/p/f482ff80f28b" rel="noopener">来部署我们的文档网站，以便在部署它之前创建API参考。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在package.json中添加</figcaption></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">部署文档工作流</figcaption></figure><p id="5f4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是生成的最终页面:</p><div class="nj nk gp gr nl nm"><a href="https://purgecss.com/api-reference/purgecss.purgecss.purge.html" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">采购</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">移除未使用的CSS签名:user options UserDefinedOptions | string | undefined purge CSS选项或路径到…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">purgecss.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ks nm"/></div></div></a></div><h1 id="b801" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="3c3e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">无论是将API引用添加到您的网站，还是仅仅在ide中提供一个更好的文档，花点时间为您的包的公共API编写好的TSDoc对您的用户都是有用的。要生成文档页面，可以结合使用api-extractor和api-documenter。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="09d8" class="lv lw it bd lx ly oi ma mb mc oj me mf jz ok ka mh kc ol kd mj kf om kg ml mm bi translated">到目前为止的系列</h1><div class="nj nk gp gr nl"><div role="button" tabindex="0" class="ab bv gv cb fp on oo bn op ks ex"><div class="oq l"><div class="ab q"><div class="l di"><img alt="Floriel" class="l de bw or os fe" src="../Images/732b4646a56a5800967e6508f0b370c2.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*3hVtUT0QnmU35HBYJqAZFQ.jpeg"/><div class="fb bw l or os fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://floriel.medium.com/?source=post_page-----9b2dc44a3aaa--------------------------------" rel="noopener follow" target="_top">弗罗里尔</a></p></div></div><div class="ov ow gw l"><h2 class="bd iu ub uc fp ud fr fs ns fu fw is bi translated">用TypeScript构建NPM包</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi ue au uf ug uh qo ui an eh ei uj uk ul el em eo de bk ep" href="https://floriel.medium.com/list/building-an-npm-package-with-typescript-85c0de70d37c?source=post_page-----9b2dc44a3aaa--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="um l fo"><span class="bd b dl z dk">10 stories</span></div></div></div><div class="pi dh pj fp ab pk fo di"><div class="di pa bv pb pc"><div class="dh l"><img alt="" class="dh" src="../Images/92922f95293681a3035437f5b998cad6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*isyE5ZZNeijxSvohqSyeXg.jpeg"/></div></div><div class="di pa bv pd pe pf"><div class="dh l"><img alt="" class="dh" src="../Images/ffbf0fd208adfab2f81c7b7767e3a7ab.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*yOF3ZkTaF0NkLAEKSh3D2Q.jpeg"/></div></div><div class="di bv pg ph pf"><div class="dh l"><img alt="" class="dh" src="../Images/5aa2ec66a67215cf81c85bfe6f788cc6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*RU89TcfRAR5mmclMX9x57w.jpeg"/></div></div></div></div></div></div></div>    
</body>
</html>