<html>
<head>
<title>Hierarchical Indexing with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫分级索引</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/hierarchical-indexing-in-pandas-94ff198b7f35?source=collection_archive---------2-----------------------#2021-02-19">https://levelup.gitconnected.com/hierarchical-indexing-in-pandas-94ff198b7f35?source=collection_archive---------2-----------------------#2021-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9219" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于如何对Pandas使用层次索引(MultiIndex)的指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/317be2172d295105282fbd586f431a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9ZjxI59dV0EdkUis"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@benchaccounting?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">钳工</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="bb73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">分级索引允许我们在一个轴上使用多个索引级别。分层索引也称为多重索引。在这篇文章中，我将展示如何使用层次索引。简而言之，我将涵盖以下主题:</p><ul class=""><li id="0641" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">什么是MultiIndex？</li><li id="8e2a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么是拆分？</li><li id="81b6" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么是层次索引？</li><li id="f668" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">分层索引中的选择</li><li id="5382" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么是Swaplevel？</li><li id="9f69" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">分级索引中的排序</li><li id="3fb7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">分层索引中的汇总统计信息</li><li id="6484" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">数据框中的分层索引</li></ul><p id="3616" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始吧。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="f3f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我打算进口熊猫。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/c2b65144cfacb82baea0be859d9a4a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*8OoM0Q6MWVBiVIJhjBov5w.png"/></div></figure><p id="6afb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从正态分布中生成随机数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/ef880222471ae1c32dee3719a5fc7c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*M3t2taLLZ4PNxouincfa9Q.png"/></div></div></figure><h1 id="ea13" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">什么是MultiIndex？</h1><p id="b552" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">MultiIndex允许您在索引中选择多个行和列。为了理解MultiIndex，让我们看看数据的索引。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/41d68b4aa18b6ccab43e9a9ff9741f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*XPbp7jWAtJ4bQS1F-oonJg.png"/></div></figure><p id="7035" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">MultiIndex是一种用于数据帧的高级索引技术，它显示了多个级别的索引。我们的数据集有两个层次。您可以使用索引获得数据的子集。例如，让我们看看索引为a的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/e19176fe5ccbfbb21978f68515bc7244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*3YmbWoqAmibVhwHxKuuglA.png"/></div></figure><p id="fbdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以把数据切片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ae35686060d762be46affb2c6ac25623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*Ft_Td9xt4u58NC4dW_QWbg.png"/></div></figure><p id="3cd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以看到不止一个指数。例如，让我们看看索引为a和c的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/0d4d82393f2d0625ec3956eb03288e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*vRYhNZEe1dnYLNSGE3ca2Q.png"/></div></figure><p id="9d59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以从内部索引中选择值。让我们看看内部索引的第一个值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/0209ef5ccd8c968a57433b3e68407736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*9dFXrc3-hYpwpE900NvRlw.png"/></div></figure><h1 id="4c8f" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">什么是拆分？</h1><p id="d61e" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">stack方法将列名转换为索引值，unstack方法将索引值转换为列名。您可以使用拆分方法以表格的形式查看数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/878f55531401de96b39cf8b2ea72d1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*DmfJucz0PnByKNK1zc4Wzw.png"/></div></figure><p id="17af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要恢复数据集，可以使用stack方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/1fb712981646253eb00ced3e1c5370ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*9X_u00UwHI2KBOtNORiVbg.png"/></div></figure><h1 id="5d7c" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">什么是层次索引？</h1><p id="03d2" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">分层索引是一种在数据集中创建结构化组关系的方法。数据框可以有等级索引。为了展示这一点，让我创建一个数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/c434eaccafc4196b6241e6c967dcb940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*L4Fg5VJuh64U8F571ZTvWA.png"/></div></div></figure><p id="15d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，在这个数据集中，行和列都有层次索引。您可以命名层次级别。让我们看看这个。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/9f82e0b15c781105c6ca90cf62fc8dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*EPqQnVJrERfqu3HIzzdGug.png"/></div></div></figure><h1 id="9407" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">分层索引中的选择</h1><p id="59b7" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">您可以选择数据的子组。例如，让我们选择名为num的索引。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/52fe68ae5ca98e749d72be36c5c6d530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*DHeby9uOoj5YTcBLfD7icg.png"/></div></figure><h1 id="e4bc" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">什么是Swaplevel？</h1><p id="cb05" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">有时，您可能想要交换索引的级别。为此，您可以使用swaplevel方法。swaplevel方法采用两个级别并返回一个新对象。例如，让我们交换数据集中的课程和考试索引。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/ccd01ab29733fe1f3c6d67b125e3dbf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*AFz4TQy31rLjo3v6dBXCvA.png"/></div></figure><h1 id="ce98" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">分级索引中的排序</h1><p id="b86c" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">要按级别对索引进行排序，可以使用sort_index方法。例如，让我们按级别1对数据集进行排序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d66c80a7c619678cf51b47da0c227c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*VeRcJryUJ7b-8_zIkxXRIg.png"/></div></figure><h1 id="74a1" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">分层索引中的汇总统计信息</h1><p id="6034" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">系列或数据帧中的汇总统计数据可以通过一个级别找到。如果您有多个级别的数据，您可以根据级别计算汇总统计数据。例如，让我们根据数据集中的考试级别来查看总和值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7dbfbd25e8300a98839e64558b87f8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*Qd43iwruU8EmtT3Nx1Ijsg.png"/></div></figure><p id="727a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们根据字段级别来查看总值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/bee3517bbca12d39955d8159cb7cea21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*1Smwd2wjeCQo-N_0atzOJA.png"/></div></figure><h1 id="c760" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">数据框中的分层索引</h1><p id="769d" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">您可以将数据帧的列移动到行索引。为了展示这一点，让我们创建一个数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/bb40dafed7649b55408a7a876a744095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*-KlTiu7XJrJOUFRYTxwlpA.png"/></div></figure><p id="087f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们将这个数据集的a列和b列转换成一个行索引。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/8af45aa3495e4a8b464c12bf907536b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*-JSrWEcCjmj30hGIs0fLtA.png"/></div></figure><p id="fe2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在set_index方法中，移动到行的索引将从列中删除。可以使用drop = False将获得的列作为索引保留在同一位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/fddd406f0d4fcfc9675c77e4aed474f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*PvQnB0NMpZxkTBNzWZaS1Q.png"/></div></figure><p id="55b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们首先看一下data2来演示reset_index方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/ae34233e2e63b3b67a8cf01abe0cb9cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*-NrUSfrL69XHn-zSA7hIag.png"/></div></figure><p id="8f15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用reset_index方法来恢复数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/68880640b1a6b5909925e090d2d02ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*V3f-pZZ5pfePskO1xZpvNA.png"/></div></figure><p id="b097" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样。在这篇文章中，我解释了熊猫的层次索引。我希望你喜欢这篇文章。感谢阅读。在这里可以找到笔记本<a class="ae kv" href="https://github.com/TirendazAcademy/PANDAS-TUTORIAL/blob/main/13-Hierarchical%20Indexing.ipynb" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="3a0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">别忘了在<a class="ae kv" href="http://youtube.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae kv" href="http://twitter.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kv" href="http://github.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">GitHub</a>|<a class="ae kv" href="https://www.linkedin.com/in/tirendaz-academy" rel="noopener ugc nofollow" target="_blank">Linkedin</a>|<a class="ae kv" href="https://www.kaggle.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">ka ggle</a>上关注我们</p><div class="nx ny gp gr nz oa"><a href="https://medium.com/codex/python-pandas-tutorial-42be3e827e2a" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">Python熊猫教程</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">Pandas是Python最重要的库之一。在这篇博文中，我将谈论熊猫图书馆并展示…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo kp oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener  ugc nofollow" target="_blank" href="/practical-data-analysis-with-pandas-c40fbd2955fa"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">熊猫的实用数据分析</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">在我的上一篇文章中，我提到了在熊猫图书馆使用数据。Python最重要的库之一是熊猫…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="oj l"><div class="op l ol om on oj oo kp oa"/></div></div></a></div><p id="3486" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示支持👇</p></div></div>    
</body>
</html>