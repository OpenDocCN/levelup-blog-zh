<html>
<head>
<title>How ORDER BY is restricted in GROUP BY queries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GROUP BY查询中如何限制ORDER BY</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/how-order-by-is-restricted-in-group-by-queries-ba92ea57e2d9?source=collection_archive---------9-----------------------#2021-06-30">https://levelup.gitconnected.com/how-order-by-is-restricted-in-group-by-queries-ba92ea57e2d9?source=collection_archive---------9-----------------------#2021-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="da3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像往常一样，我在我的博客上分享我在这里学到的东西。随着我继续学习SQL，这种语言的细微复杂之处总是让我感到惊讶，除非你被它们迷住了，或者通过有意的学习，否则你不一定会学到。幸运的是，我的情况是后者。我指的是在<code class="fe ko kp kq kr b">GROUP BY</code>查询中使用的<code class="fe ko kp kq kr b">ORDER BY</code>子句。继续阅读了解更多信息。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/878f420929ce8228ead031cab082f0a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*wU86Uv1XG_PtZqRm.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">图片来自<a class="ae le" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=154203" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></figcaption></figure><p id="1c96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">自我推销:</p><p id="a314" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这里写的内容，尽一切办法，把这个博客和你最喜欢的帖子分享给其他可能从中受益或喜欢它的人。因为咖啡是我最喜欢的饮料，如果你愿意，你甚至可以给我买一杯！</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="84ec" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">重点SQL研究</h2><p id="c71a" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">从《OCA Oracle数据库SQL考试指南》这本书<a class="ae le" href="https://www.amazon.com/dp/B07484STST/ref=cm_sw_r_cp_apa_glt_Z6SXJH7DB4N4CTG42GGZ" rel="noopener ugc nofollow" target="_blank">(非附属链接)中，我读到一些信息，当出现<code class="fe ko kp kq kr b">GROUP BY</code>子句时，<code class="fe ko kp kq kr b">ORDER BY</code>有些受限。我觉得我应该已经知道这些了。但是，为了巩固我的知识，我写在这里。</a></p><p id="f1cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我使用Oracle数据库，因为这是我重点了解的实施。<em class="mk">我不是100%确定这些原则是否适用于其他SQL供应商</em>。</p><h2 id="3a9a" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">抽样资料</h2><p id="5923" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">对于示例查询，我使用的是作为流行实践<strong class="js iu"> HR </strong>模式一部分的<strong class="js iu"> EMPLOYEES </strong>表:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/4ff16e795fba73fc80d1a1b6b28b198e.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/0*Cmj6hgPi1TV2HanA"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">员工表描述</figcaption></figure><h2 id="6488" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">按SELECT子句列表中存在或不存在的列排序</h2><p id="67ca" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">这是一个相对简单的查询，带有一些<strong class="js iu">部门标识</strong>、<strong class="js iu">工作标识</strong>和<strong class="js iu">薪水</strong>信息。通知一<code class="fe ko kp kq kr b">ORDER BY</code>出现在<code class="fe ko kp kq kr b">SELECT</code>条款列表中的<strong class="js iu">部门标识</strong>:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="a36d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(注意:某些输出行受限于给定屏幕截图中的可用内容。)</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/8629e3a2a70caed158d67bb0b21b04cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/0*xwPd4b7LvQ0UDp-F"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">选择列表中的DEPARTMENT_ID列。</figcaption></figure><p id="0697" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一个查询类似于上面的查询。不同的是<strong class="js iu"> DEPARTMENT_ID </strong>不包含在<code class="fe ko kp kq kr b">SELECT</code>子句列表中。然而，我可以<code class="fe ko kp kq kr b">ORDER BY </code>没有问题的<strong class="js iu">部门ID </strong>列:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="1a15" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(注意:一些输出行受限于给定屏幕截图中的可用内容。)</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/1e36e8ab772f2e390a0f776c40e6c063.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/0*oWNB397yMxJSVGAn"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">DEPARTMENT_ID列不在选择列表中，但仍能进行排序。</figcaption></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/93d494a43e646be4fc00845f6c57c9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:2/0*vLEwB6g6a9ZMIkm4.gif"/></div></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="29ec" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">在GROUP BY查询中引入ORDER BY子句</h2><p id="a53d" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">现在让我们执行一个查询，将<code class="fe ko kp kq kr b">SUM()</code>列的<strong class="js iu">工资</strong>列。我们必须<code class="fe ko kp kq kr b">GROUP BY</code>不属于聚合函数调用的任何列。在本例中，<strong class="js iu"> JOB_ID </strong>列。但是，看看我尝试和<code class="fe ko kp kq kr b">ORDER BY</code>的<strong class="js iu">部门_ID </strong>列时会发生什么:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/4b337293e9b0b2fe973a47560293c8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/0*_VhsNJYmbzTL8CmL"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">报告了错误。</figcaption></figure><p id="9996" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果，那个查询是不允许的。</p><p id="6f59" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为什么不呢？在前面的一些示例查询中，我对一个列进行了<code class="fe ko kp kq kr b">ORDER BY</code>操作，不管该列是否在<code class="fe ko kp kq kr b">SELECT</code>子句列表中。</p><h1 id="c19b" class="mw ln it bd lo mx my mz lr na nb nc lu nd ne nf lx ng nh ni ma nj nk nl md nm bi translated">GROUP BY查询中的ORDER BY限制</h1><p id="295e" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">因为使用<code class="fe ko kp kq kr b">GROUP BY</code>子句时<code class="fe ko kp kq kr b">ORDER BY</code>是有限的。让我们来看看在这个特定的上下文中<code class="fe ko kp kq kr b">ORDER BY</code>子句中到底允许什么。</p><h2 id="e8ed" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">按SELECT子句列表中的列或GROUP BY子句中指定的列排序</h2><p id="2b52" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">您可以对出现在<code class="fe ko kp kq kr b">SELECT</code>子句列表中或在<code class="fe ko kp kq kr b">GROUP BY</code>子句中命名的列进行<code class="fe ko kp kq kr b">ORDER BY</code>操作。在下面的查询中，我在<code class="fe ko kp kq kr b">ORDER BY</code>子句中使用了<strong class="js iu"> JOB_ID </strong>列，在这种情况下，它涵盖了两个<em class="mk">规范</em>(这里不太严格地定义):</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/4a697f7801ff2626bea55d1a9bccb20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/0*HryI6rr97eLbsP-M"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">GROUP BY查询中ORDER BY子句的查询结果。</figcaption></figure><p id="b0d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(相关:<code class="fe ko kp kq kr b">ORDER BY</code> <em class="mk">目标</em>可以通过名称、别名或数字列列表位置来指定。)</p><h2 id="3315" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">按聚合函数排序</h2><p id="d4d1" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">对于这个例子，我通过<code class="fe ko kp kq kr b">SUM(SALARY)</code>聚合函数调用进行排序，这是完全有效的:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="0ae9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我每周发来的关于我在SQL/PHP世界做什么的邮件感兴趣吗？访问此<a class="ae le" href="https://digitalowlsprose.ck.page/1b35a06295" rel="noopener ugc nofollow" target="_blank">注册</a>(异地链接)页面并订阅。我保证没有垃圾邮件。谢谢大家！</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi no"><img src="../Images/331b692b4f697ba2dba4d309953b3406.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/0*6GtzQsIJYc7GJL__"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">ORDER BY SUM()聚合函数。</figcaption></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="393d" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">按任意聚合函数排序</h2><p id="d3fb" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">对我来说更棘手的是，排序集合函数<em class="mk">不需要出现在<code class="fe ko kp kq kr b">SELECT</code>子句中。这里我在<strong class="js iu">雇用日期</strong>列上使用了<code class="fe ko kp kq kr b">MAX()</code>聚合函数:</em></p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi np"><img src="../Images/0108923f39b73f2294887feba5c8ab74.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/0*1_lcCHfLKgDMXWkL"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">按MAX()聚合函数排序。</figcaption></figure><p id="c0ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是对<code class="fe ko kp kq kr b">SELECT</code>子句列表中<code class="fe ko kp kq kr b">MAX(HIRE_DATE)</code>聚合函数调用的后续查询，作为排序顺序的参考:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b82e395f71e74994ac690cf5b1ffb3e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/0*d2I3ivcJp32G2atZ"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">在SELECT子句列表中包括MAX()聚合函数调用。</figcaption></figure><h2 id="7255" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">未覆盖:用户、系统日期、UID</h2><p id="6470" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">参考书中还提到<code class="fe ko kp kq kr b">ORDER BY</code>可以指定<a class="ae le" href="https://docs.oracle.com/javadb/10.8.3.0/ref/rrefsqlj42476.html" rel="noopener ugc nofollow" target="_blank">用户</a>、<a class="ae le" href="https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions172.htm" rel="noopener ugc nofollow" target="_blank">系统日期</a>或<a class="ae le" href="https://docs.oracle.com/database/121/SQLRF/functions239.htm#SQLRF06153" rel="noopener ugc nofollow" target="_blank"> UID </a>当有<code class="fe ko kp kq kr b">GROUP BY</code>时。在撰写本文时，我还没有介绍这个功能，因为我不熟悉这些细节的最佳环境。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="6fdd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您看到任何不正确的地方或对代码有任何疑问，请在下面的评论区留下您的评论。感谢您的阅读！</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="c949" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请添加任何评论，强调您使用<code class="fe ko kp kq kr b">GROUP BY</code>子句对查询进行<code class="fe ko kp kq kr b">ORDER BY</code>排序的体验，从而帮助这篇博文变得更好。</p><p id="ee89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">喜欢你读过的？看到什么不正确的吗？请在下面评论，感谢阅读！！！</p><h1 id="551d" class="mw ln it bd lo mx my mz lr na nb nc lu nd ne nf lx ng nh ni ma nj nk nl md nm bi translated">行动的号召！</h1><p id="541b" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">感谢你花时间阅读这篇文章。我真心希望你发现了一些有趣和有启发性的东西。请在这里与你认识的其他人分享你的发现，他们也会从中获得同样的价值。</p><p id="49d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">访问<a class="ae le" href="https://wp.me/P28ctb-3KD" rel="noopener ugc nofollow" target="_blank"> Portfolio-Projects页面</a>查看我为客户完成的博客帖子/技术写作。</p><p id="b57d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://ko-fi.com/joshlovescoffee" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">如果你给我买咖啡，我一定会喝！</strong> </a></p><p id="3f08" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要在最新的博客文章发表时收到来自本博客(“数字猫头鹰散文”)的电子邮件通知(绝不是垃圾邮件)，请点击“点击订阅！”按钮在首页的侧边栏！(如有任何问题，请随时查看<a class="ae le" href="https://wp.me/P28ctb-3gI" rel="noopener ugc nofollow" target="_blank"> Digital Owl的散文隐私政策页面</a>:电子邮件更新、选择加入、选择退出、联系表格等……)</p><p id="d8f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请务必访问<a class="ae le" href="https://joshuaotwell.com/where-blog_post-in-digital-owls-prose-best-of/" rel="noopener ugc nofollow" target="_blank">“最佳”</a>页面，收集我的最佳博客文章。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="e2f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae le" href="https://joshuaotwell.com/about/" rel="noopener ugc nofollow" target="_blank"> Josh Otwell </a>作为一名SQL开发人员和博客作者，他热衷于学习和成长。其他最喜欢的活动是让他埋头于一本好书、一篇文章或Linux命令行。其中，他喜欢桌面RPG游戏，阅读奇幻小说，并与妻子和两个女儿共度时光。</p><p id="0115" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">免责声明:本文中的例子是关于如何实现类似结果的假设。它们不是最好的解决方案。所提供的大多数(如果不是全部)示例都是在个人发展/学习工作站环境中执行的，不应被视为生产质量或就绪。您的特定目标和需求可能会有所不同。使用那些最有利于你的需求和目标的实践。观点是我自己的。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="7c24" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mk">原载于2021年6月30日https://joshuaotwell.com</em><a class="ae le" href="https://joshuaotwell.com/how-order-by-is-restricted-in-group-by-queries/" rel="noopener ugc nofollow" target="_blank"><em class="mk"/></a><em class="mk">。</em></p></div></div>    
</body>
</html>