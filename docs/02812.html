<html>
<head>
<title>I Built an App That Uses All 7 New Features in JavaScript ES2020</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我开发了一个应用程序，它使用了JavaScript ES2020的所有7个新特性</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/i-built-an-app-that-uses-all-7-new-features-in-javascript-es2020-647205024984?source=collection_archive---------17-----------------------#2020-04-05">https://levelup.gitconnected.com/i-built-an-app-that-uses-all-7-new-features-in-javascript-es2020-647205024984?source=collection_archive---------17-----------------------#2020-04-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c833d354ac3d4c046d43184601989eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*10AyqKCN-035dR-L.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">单价计算器应用程序</figcaption></figure><p id="3e2e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">web开发的世界发展很快，尤其是在JavaScript生态系统中。新的特性、框架和库不断涌现，当你停止学习的时候，你的技能也开始变得过时。</p><p id="4280" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">保持JavaScript技能敏锐的一个重要部分是了解JavaScript的最新特性。因此，我认为构建一个包含JavaScript ES2020中所有七个新功能的应用程序会很有趣。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><p id="373b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我最近在好市多(Costco)进行了一次大采购，储备了一些生活必需品。像大多数商店一样，它们的价格标签显示每件商品的单价，因此你可以评估和比较每笔交易的质量。你带小包还是大包？(我在骗谁呢？是好市多。去大的！)</p><p id="7452" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但是如果单价没有显示出来呢？</p><p id="3470" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在本文中，我将构建一个单价计算器应用程序，前端使用普通JavaScript，后端使用<a class="ae lk" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>和<a class="ae lk" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express.js </a>。我将在<a class="ae lk" href="http://heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>上部署应用程序，这是一个简单的地方<a class="ae lk" href="https://devcenter.heroku.com/articles/getting-started-with-nodejs" rel="noopener ugc nofollow" target="_blank">快速部署node.js应用程序</a>。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="456a" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">JavaScript ES2020有什么新特性？</h1><p id="a8cd" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">JavaScript编程语言符合ECMAScript规范。从ES2015(或ES6)发布开始，每年都会发布一个新版本的JavaScript。截至目前，最新版本是ES2020 (ES11)。ES2020包含了7个令人兴奋的新特性，JavaScript开发人员已经等了很久了。新功能包括:</p><ol class=""><li id="51e0" class="mo mp it kh b ki kj km kn kq mq ku mr ky ms lc mt mu mv mw bi translated">Promise.allSettled()</li><li id="2399" class="mo mp it kh b ki mx km my kq mz ku na ky nb lc mt mu mv mw bi translated">可选链接</li><li id="034c" class="mo mp it kh b ki mx km my kq mz ku na ky nb lc mt mu mv mw bi translated">无效合并</li><li id="2dc1" class="mo mp it kh b ki mx km my kq mz ku na ky nb lc mt mu mv mw bi translated">globalThis</li><li id="41c8" class="mo mp it kh b ki mx km my kq mz ku na ky nb lc mt mu mv mw bi translated">动态导入</li><li id="467a" class="mo mp it kh b ki mx km my kq mz ku na ky nb lc mt mu mv mw bi translated">String.prototype.matchAll()</li><li id="0b7b" class="mo mp it kh b ki mx km my kq mz ku na ky nb lc mt mu mv mw bi translated">BigInt</li></ol><p id="1d14" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你应该注意到并不是所有的浏览器都支持这些特性。如果您想现在就开始使用这些特性，请确保您提供了适当的polyfills或使用Babel之类的transpiler，以确保您的代码与旧版本的浏览器兼容。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="8919" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">入门指南</h1><p id="9803" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">如果您想使用您自己的代码副本，首先创建一个Heroku帐户，并在您的机器上安装Heroku CLI。安装说明见本<a class="ae lk" href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up" rel="noopener ugc nofollow" target="_blank"> Heroku指南</a>。</p><p id="a889" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">一旦完成了这些，您就可以使用CLI轻松地创建和部署项目。运行这个示例应用程序<a class="ae lk" href="https://github.com/thawkin3/unit-price-calculator" rel="noopener ugc nofollow" target="_blank">所需的所有源代码都可以在GitHub </a>上获得。</p><p id="6aef" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">以下是如何克隆repo并部署到Heroku的分步说明:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="708f" class="nl lm it nh b gy nm nn l no np">git clone <a class="ae lk" href="https://github.com/thawkin3/unit-price-calculator.git" rel="noopener ugc nofollow" target="_blank">https://github.com/thawkin3/unit-price-calculator.git</a><br/>cd unit-price-calculator<br/>heroku create<br/>git push heroku master<br/>heroku open</span></pre></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="9982" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">系统概况</h1><p id="baad" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">我的单价计算器应用程序相当简单:它让你比较虚构产品的各种价格和重量选项，然后计算单价。当页面加载时，它通过点击两个API端点从服务器获取产品数据。然后，您可以选择您的产品、您喜欢的测量单位以及价格/重量组合。点击提交按钮后，单价计算就完成了。</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c833d354ac3d4c046d43184601989eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*10AyqKCN-035dR-L.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">单价计算器应用程序</figcaption></figure><p id="e074" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，您已经看到了该应用程序，让我们来看看我是如何使用ES2020的所有七项功能的。对于每个特性，我将讨论它到底是什么，它如何有用，以及我是如何使用它的。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="fcca" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">1.Promise.allSettled()</h1><p id="40db" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">当用户第一次访问calculator应用程序时，会启动三个API请求从服务器获取产品数据。我们使用<code class="fe nq nr ns nh b">Promise.allSettled()</code>等待所有三个请求完成:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="9242" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><code class="fe nq nr ns nh b">Promise.allSettled()</code>是在现有<code class="fe nq nr ns nh b">Promise.all()</code>功能基础上改进的新功能。这两种方法都允许您提供一个承诺数组作为参数，并且这两种方法都返回一个承诺。</p><p id="8158" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">不同的是，<code class="fe nq nr ns nh b">Promise.all()</code>如果有任何一个承诺被拒绝，就会提前短路拒绝自己。另一方面，<code class="fe nq nr ns nh b">Promise.allSettled()</code>等待<em class="nv">所有</em>的承诺被解决，不管它们是被解决还是被拒绝，然后解决自己。</p><p id="b9fe" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">所以如果你想从你所有的承诺中得到结果，即使有些承诺被拒绝，那就开始使用<code class="fe nq nr ns nh b">Promise.allSettled()</code>。</p><p id="3043" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们看另一个关于<code class="fe nq nr ns nh b">Promise.all()</code>的例子:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="618e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在让我们看另一个带有<code class="fe nq nr ns nh b">Promise.allSettled()</code>的例子，来注意当一个承诺被拒绝时的行为差异:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="c435" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">2.可选链接</h1><p id="2434" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">一旦获取了产品数据，我们就处理响应。从服务器返回的数据包含一个具有深层嵌套属性的对象数组。为了安全地访问这些属性，我们使用新的可选链接操作符:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="a984" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">可选链接是ES2020中我最感兴趣的功能。可选的链接操作符— <code class="fe nq nr ns nh b">?.</code> —允许您安全地访问对象的深层嵌套属性，而无需检查每个属性是否存在。</p><p id="bafe" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">例如，在ES2020之前，为了访问某个<code class="fe nq nr ns nh b">user</code>对象的<code class="fe nq nr ns nh b">street</code>属性，您可能会编写如下所示的代码:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="bcd5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了安全地访问<code class="fe nq nr ns nh b">street</code>属性，您首先必须确保<code class="fe nq nr ns nh b">user</code>对象存在并且<code class="fe nq nr ns nh b">address</code>属性存在，然后您可以尝试访问<code class="fe nq nr ns nh b">street</code>属性。</p><p id="e0a6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用可选的链接，访问嵌套属性的代码要短得多:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="0cc6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果在你的链中的任何一点一个值不存在，<code class="fe nq nr ns nh b">undefined</code>将被返回。否则，返回值将是您想要访问的属性的值，正如所预期的那样。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="1c5f" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">3.无效合并</h1><p id="701c" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">当应用程序加载时，我们还获取用户对测量单位的偏好:千克或磅。该首选项存储在本地存储中，因此对于首次访问者来说，该首选项尚不存在。为了使用本地存储中的值或默认使用千克进行处理，我们使用nullish合并运算符:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="f6d2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">nullish合并操作符— <code class="fe nq nr ns nh b">??</code> —是一个方便的操作符，当您特别想使用变量值时，只要它不是<code class="fe nq nr ns nh b">undefined</code>或<code class="fe nq nr ns nh b">null</code>。如果指定的变量是一个布尔值，并且即使它是<code class="fe nq nr ns nh b">false</code>也要使用它的值，那么应该使用这个操作符，而不是简单的OR — <code class="fe nq nr ns nh b">||</code> —操作符。</p><p id="502e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">例如，假设您有某个功能设置的开关。如果用户特别为该特性设置了一个值，那么你应该尊重他或她的选择。如果他们没有指定设置，那么您希望默认为他们的帐户启用该功能。</p><p id="c426" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在ES2020之前，您可能会这样写:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="c5a9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用nullish合并运算符，您的代码会更短、更容易理解:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="07ec" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">4.globalThis</h1><p id="59d0" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">如上所述，为了获取和设置用户对度量单位的偏好，我们使用本地存储。对于浏览器，本地存储对象是<code class="fe nq nr ns nh b">window</code>对象的一个属性。虽然您可以直接调用<code class="fe nq nr ns nh b">localStorage</code>，但是您也可以使用<code class="fe nq nr ns nh b">window.localStorage</code>来调用它。在ES2020中，我们还可以通过<code class="fe nq nr ns nh b">globalThis</code>对象访问它(还要注意再次使用可选链接来进行一些功能检测，以确保浏览器支持本地存储):</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8db1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个特性非常简单，但是它解决了很多有时会困扰你的矛盾。简单来说，<code class="fe nq nr ns nh b">globalThis</code>包含了对全局对象的引用。在浏览器中，全局对象是<code class="fe nq nr ns nh b">window</code>对象。在节点环境中，全局对象的字面意思是<code class="fe nq nr ns nh b">global</code>。使用<code class="fe nq nr ns nh b">globalThis</code>可以确保无论你的代码在什么环境下运行，你总是有一个对全局对象的有效引用。这样，您可以编写可移植的JavaScript模块，这些模块可以在浏览器的主线程、web worker或节点环境中正确运行。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="a1a3" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">5.动态导入</h1><p id="4a76" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">一旦用户选择了产品、测量单位、重量和价格组合，他或她就可以单击submit按钮来查找单价。当点击按钮时，一个用于计算单价的JavaScript模块被延迟加载。您可以在浏览器的开发工具中检查网络请求，查看第二个文件是否被加载，直到您单击按钮:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="71ab" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在ES2020之前，在JavaScript中使用<code class="fe nq nr ns nh b">import</code>语句意味着当请求父文件时，导入的文件会自动包含在父文件中。</p><p id="9aa2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">像<a class="ae lk" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank"> webpack </a>这样的捆绑器已经普及了“代码分割”的概念，这是一个允许你将你的JavaScript包分割成多个可以按需加载的文件的特性。React也用它的<code class="fe nq nr ns nh b">React.lazy()</code>方法实现了这个特性。</p><p id="931a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">代码分割对于单页应用程序(spa)非常有用。对于每个页面，您可以将您的代码分成单独的包，这样就只下载当前视图所需的代码。这大大加快了初始页面加载时间，因此最终用户不必提前下载整个应用程序。</p><p id="3b5f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">代码分割对于很少使用的大部分代码也很有帮助。例如，假设您的应用程序页面上有一个“导出PDF”按钮。PDF下载代码很大，在页面加载时包含它可以减少总的加载时间。但是，并不是每个访问此页面的用户都需要或想要导出PDF。为了提高性能，您可以延迟加载您的PDF下载代码，以便只有当用户单击“导出PDF”按钮时才下载额外的JavaScript包。</p><p id="8e90" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在ES2020中，动态导入被融入到JavaScript规范中！</p><p id="a144" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们看一个没有动态导入的“导出PDF”功能的设置示例:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="83a4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在让我们看看如何使用动态导入来延迟加载大型PDF下载模块:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="ee3c" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">6.String.prototype.matchAll()</h1><p id="a88d" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">当调用<code class="fe nq nr ns nh b">calculateUnitPrice</code>方法时，我们传递产品名称和价格/重量组合。价格/重量组合是一个字符串，看起来像“10公斤200美元”。我们需要解析该字符串以获得价格、重量和度量单位。(当然有更好的方法来设计这个应用程序，以避免像这样解析字符串，但我这样设置是为了演示下一个功能。)提取必要的数据，我们可以使用<code class="fe nq nr ns nh b">String.prototype.matchAll()</code>:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="6773" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这一行代码中包含了很多内容。我们基于一个正则表达式在字符串中查找匹配，该表达式搜索数字和字符串“lb”或“kg”。它返回一个迭代器，然后我们可以将它扩展到一个数组中。这个数组以三个元素结束，每个匹配一个元素(200、10和“kg”)。</p><p id="f38a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个特性可能是最难理解的，尤其是如果您不精通正则表达式的话。简单明了的解释是<code class="fe nq nr ns nh b">String.prototype.matchAll()</code>是对<code class="fe nq nr ns nh b">String.prototype.match()</code>和<code class="fe nq nr ns nh b">RegExp.prototype.exec()</code>功能的改进。这个新方法允许您将字符串与正则表达式进行匹配，并返回所有匹配结果的迭代器，包括捕获组。</p><p id="09b3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你都明白了吗？让我们看另一个例子来帮助巩固这个概念:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="7138" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">7.BigInt</h1><p id="21da" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">最后，我们将通过简单地将价格除以重量来计算单价。您可以使用普通数字来实现这一点，但在处理大数时，ES2020引入了<code class="fe nq nr ns nh b">BigInt</code>，它允许您在不损失精度的情况下对大整数进行计算。在我们的应用程序中，使用<code class="fe nq nr ns nh b">BigInt</code>是多余的，但是谁知道呢，也许我们的API端点会改变以包含一些疯狂的批量交易！</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="c644" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果您曾经处理过包含极大数字的数据，那么您就会知道在执行JavaScript数学运算时确保数字数据的完整性是多么痛苦。在ES2020之前，你可以安全存储的最大整数用<code class="fe nq nr ns nh b">Number.MAX_SAFE_INTEGER</code>表示，也就是2^53 - 1。</p><p id="64fa" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果您试图在变量中存储一个大于该值的数字，有时该数字不会被正确存储:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="c514" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">新的<code class="fe nq nr ns nh b">BigInt</code>数据类型有助于解决这个问题，并允许您处理更大的整数。要使一个整数成为一个<code class="fe nq nr ns nh b">BigInt</code>，你只需在整数的末尾加上字母<code class="fe nq nr ns nh b">n</code>或者在你的整数上调用函数<code class="fe nq nr ns nh b">BigInt()</code>:</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="3df3" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="8b22" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">就是这样！现在您已经了解了ES2020的所有新特性，还在等什么呢？现在就开始编写新的JavaScript吧！</p></div></div>    
</body>
</html>