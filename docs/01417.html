<html>
<head>
<title>Using the Node.js OS Module (Part 3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js操作系统模块(第3部分)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-the-node-js-os-module-part-3-e3f04529edbb?source=collection_archive---------1-----------------------#2019-12-27">https://levelup.gitconnected.com/using-the-node-js-os-module-part-3-e3f04529edbb?source=collection_archive---------1-----------------------#2019-12-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/73543f97d2c0932f2d17d33bce2aec69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BOM-x51twexVs0SA"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">布鲁斯·马尔斯在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4dc7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Node.js OS模块有许多有用的实用函数，用于获取有关运行OS模块程序的计算机系统的信息。它可以为我们提供硬件信息，如CPU、字节序、主目录、IP地址、主机名、程序运行的平台、系统正常运行时间、当前登录用户的信息等等。</p><p id="8377" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过在JS文件的顶部写<code class="fe le lf lg lh b">const os = require('os');</code>来使用OS模块。OS模块中有许多有用的属性。以下是操作系统模块中更有用的属性:</p><h1 id="0d07" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">操作系统版本</h1><p id="d10e" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.release</code>函数返回一个标识操作系统版本的字符串。在Unix和Linux系统上，该函数使用<code class="fe le lf lg lh b">uname</code>命令识别操作系统。在Windows上，使用Win32 API中的<code class="fe le lf lg lh b">GetVersionExW()</code>函数。例如，如果我们运行:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="5b38" class="mt lj it lh b gy mu mv l mw mx">console.log(os.release());</span></pre><p id="8ec7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们可能会得到这样的结果:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="8e12" class="mt lj it lh b gy mu mv l mw mx">'4.15.0-1036-gcp'</span></pre><h1 id="9e35" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">os.setPriority</h1><p id="8157" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.setPriority</code>函数让我们设置由进程ID指定的进程的调度优先级。它需要两个参数。第一个是进程ID，它是一个整数，标识要设置优先级的正在运行的进程。默认值为0。</p><p id="d921" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个参数是优先级，它是一个整数，表示我们想要设置的进程优先级的调度。它的范围从最高优先级的-20到最低优先级的19。</p><p id="8b04" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于Windows和POSIX系统之间优先级的差异，Node.js为我们提供了具有进程优先级的常量。</p><p id="a47f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们在<code class="fe le lf lg lh b">os.constants.priority</code>常量中。在Windows上，将进程优先级设置为<code class="fe le lf lg lh b">PRIORITY_HIGHEST</code>需要提升权限。如果运行该程序的用户没有提升的特权，那么它将被默认为<code class="fe le lf lg lh b">PRIORITY_HIGH</code>。</p><p id="996d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Node.js提供了以下优先级常量:</p><ul class=""><li id="643d" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><code class="fe le lf lg lh b">PRIORITY_LOW </code> —最低的进程调度优先级。这对应于Windows上的<code class="fe le lf lg lh b">IDLE_PRIORITY_CLASS</code>和所有其他平台上的19。</li><li id="01c2" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><code class="fe le lf lg lh b">PRIORITY_BELOW_NORMAL</code> —这在Windows上对应于<code class="fe le lf lg lh b">BELOW_NORMAL_PRIORITY_CLASS</code>，在所有其他平台上对应于10。</li><li id="18cf" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><code class="fe le lf lg lh b">PRIORITY_NORMAL</code> —默认的进程调度优先级。这对应于Windows上的<code class="fe le lf lg lh b">NORMAL_PRIORITY_CLASS</code>,在所有其他平台上的值为0。</li><li id="e0aa" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><code class="fe le lf lg lh b">PRIORITY_ABOVE_NORMAL</code> —这在Windows上对应于<code class="fe le lf lg lh b">ABOVE_NORMAL_PRIORITY_CLASS</code>，在所有其他平台上对应于-7。</li><li id="91b5" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><code class="fe le lf lg lh b">PRIORITY_HIGH</code> —这对应于Windows上的<code class="fe le lf lg lh b">HIGH_PRIORITY_CLASS</code>，在所有其他平台上是一个不错的值-14。</li><li id="0653" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><code class="fe le lf lg lh b">PRIORITY_HIGHEST</code> —最高的进程调度优先级。这对应于Windows上的<code class="fe le lf lg lh b">REALTIME_PRIORITY_CLASS</code>和所有其他平台上的-20。</li></ul><p id="cc52" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以在下面的代码中使用它:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="1a86" class="mt lj it lh b gy mu mv l mw mx">os.setPriority(0, os.constants.priority.PRIORITY_LOW)</span></pre><h1 id="921a" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">os.tmpdir</h1><p id="dc20" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.tmpdir</code>函数返回一个字符串，该字符串指定操作系统存储临时文件的默认目录。例如，如果我们写:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="6bf6" class="mt lj it lh b gy mu mv l mw mx">console.log(os.tmpdir());</span></pre><p id="e8ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们可能会得到:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="aaa9" class="mt lj it lh b gy mu mv l mw mx">'/tmp'</span></pre><p id="2c0d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Linux系统上。</p><h1 id="fd08" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">os.totalmem</h1><p id="ef0d" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.totalmem</code>函数返回系统内存总量，以整数形式表示为字节数。例如，如果我们运行:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="ad7a" class="mt lj it lh b gy mu mv l mw mx">console.log(os.totalmem());</span></pre><p id="5974" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们可能会得到这样的结果:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="f9f8" class="mt lj it lh b gy mu mv l mw mx">27389460480</span></pre><h1 id="07be" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">os.type</h1><p id="9a32" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.type</code>函数返回一个字符串，该字符串标识由<code class="fe le lf lg lh b">uname</code>命令返回的操作系统。比如Linux上可能是<code class="fe le lf lg lh b">'Linux'</code>，macOS上可能是<code class="fe le lf lg lh b">'Darwin'</code>，Windows上可能是<code class="fe le lf lg lh b">'Windows_NT'</code>。例如，如果我们运行以下代码:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="b558" class="mt lj it lh b gy mu mv l mw mx">console.log(os.type());</span></pre><p id="2928" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Linux系统上，我们得到<code class="fe le lf lg lh b">‘Linux’</code>。</p><h1 id="d873" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">os.uptime</h1><p id="ad8c" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.uptime</code>函数返回一个以秒为单位的系统正常运行时间的整数。例如，如果我们运行:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="7a53" class="mt lj it lh b gy mu mv l mw mx">console.log(os.uptime());</span></pre><p id="976c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们可能会得到这样的结果:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="ad99" class="mt lj it lh b gy mu mv l mw mx">4928</span></pre><figure class="ml mm mn mo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/71a972fbed661d65ad265bab9a7cc3ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*msYK_BzlG-xBBH4s"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">安娜·塔瓦雷斯在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="47ba" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">操作系统.用户信息</h1><p id="e46f" class="pw-post-body-paragraph kg kh it ki b kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><code class="fe le lf lg lh b">os.userInfo</code>函数返回一个对象，该对象包含当前有效用户的信息，即假定用户的用户身份。</p><p id="56b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这可能与当前登录的用户不同，因为用户可以在多用户操作系统中以不同用户的身份运行程序。在POSIX系统上，这通常是密码文件的子集。</p><p id="622c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">返回的对象包括<code class="fe le lf lg lh b">username</code>、<code class="fe le lf lg lh b">uid</code>、<code class="fe le lf lg lh b">gid</code>、<code class="fe le lf lg lh b">shell</code>和<code class="fe le lf lg lh b">homedir</code>属性。在Windows上，<code class="fe le lf lg lh b">uid</code>和<code class="fe le lf lg lh b">gid</code>为-1，<code class="fe le lf lg lh b">shell</code>为<code class="fe le lf lg lh b">null</code>。</p><p id="a792" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果用户没有<code class="fe le lf lg lh b">username</code>或<code class="fe le lf lg lh b">homedir</code>，将抛出<code class="fe le lf lg lh b">SystemError</code>。<code class="fe le lf lg lh b">os.userInfo</code>函数返回的<code class="fe le lf lg lh b">homedir</code>值由操作系统提供。</p><p id="3aac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这与<code class="fe le lf lg lh b">os.homedir</code>函数不同，后者从各种环境变量中返回用户主目录的路径字符串。在Unix和Linux系统上，如果定义了<code class="fe le lf lg lh b">$HOME</code>变量，它将使用它。</p><p id="e7d2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">否则，它将通过有效的UID查找主目录路径，该UID是您当前假设的用户身份的用户ID。例如，如果您使用<code class="fe le lf lg lh b">sudo</code>作为根用户使用计算机，那么有效用户ID将是根用户的用户ID。</p><p id="e319" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Windows上，如果定义了<code class="fe le lf lg lh b">USERPROFILE</code>的值，将会使用它。否则，它将是当前用户的配置文件目录的路径。</p><p id="8bdf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它有一个参数，这个对象让我们设置调用函数的选项。它可以有一个属性，即<code class="fe le lf lg lh b">encoding</code>属性，这是一个字符串，指示用于解释结果字符串的字符编码。</p><p id="c72c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">默认值是<code class="fe le lf lg lh b">'utf8'</code>，但也可以是<code class="fe le lf lg lh b">'buffer'</code>，将返回对象的属性值设置为缓冲区对象。该参数是可选的。</p><p id="4200" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果我们运行以下代码:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="873d" class="mt lj it lh b gy mu mv l mw mx">console.log(os.userInfo({ option: 'utf8' }));</span></pre><p id="8790" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可能会得到类似如下的结果:</p><pre class="ml mm mn mo gt mp lh mq mr aw ms bi"><span id="06b0" class="mt lj it lh b gy mu mv l mw mx">{ uid: 1000,<br/>  gid: 1000,<br/>  username: 'runner',<br/>  homedir: '/home/runner',<br/>  shell: '/bin/bash' }</span></pre><p id="7bd5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的输出中，<code class="fe le lf lg lh b">uid</code>是用户标识符，它标识了当前登录用户所采用的用户身份，如果它以自己的身份运行程序，它可能是当前登录的用户，或者如果Node.js程序当前以root身份运行，它可能是不同的用户，如root用户。这也称为当前有效用户。</p><p id="ea6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">gid</code>是组ID。它是将一个用户与其他有共同之处的用户联系起来的标识符。一个用户可以是一个或多个组的成员，并且可以有多个GID。</p><p id="e39d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">username</code>是当前有效用户的用户名。<code class="fe le lf lg lh b">homedir</code>是当前有效用户的主目录。<code class="fe le lf lg lh b">shell</code>是当前有效用户正在使用的命令行解释程序。</p><p id="47cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Node.js OS模块有许多有用的实用函数，用于获取有关运行OS模块程序的计算机系统的信息。</p><p id="85fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些模块有更多的属性，包含有用的信息，如CPU、字节序、主目录、IP地址、主机名、程序运行的平台、系统正常运行时间、当前登录用户的信息等等。它还让我们设置运行进程的优先级。</p></div></div>    
</body>
</html>