# 基于 PyTorch 的租金价格预测第一部分:数据清理

> 原文：<https://levelup.gitconnected.com/rent-price-prediction-using-pytorch-part1-data-cleaning-d4481fb07670>

这是 PyTorch 入门系列教程的第一部分。除了这些教程，我们还试图熟悉一些基本的深度学习建模。

![](img/ad5ccdc665ae1acf177489ab9b355bea.png)

由 [sergio souza](https://unsplash.com/@serjosoza?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

对于第一部分，我们将准备好我们的数据来应用模型。我们使用巴西房屋租金价格的数据集。

那么，我们开始吧。首先将数据读入熊猫数据帧:

查看 dataframe 的前五行，我们可以发现我们的一些特性需要转换成数值。列`city`、`animal`、`furniture`是分类的，所以它们是需要转换的列。

让我们看看 dataframe info 来检查每一列的数据类型:

嗯，看上面的输出，`floor`也需要转换成数值数据类型。

但是在此之前，让我们将列的名称重命名为更方便的名称:

# 转换城市值

准备好列名后，让我们将分类数据转换成数字。为此，我们将使用 sklearn 的标签编码器:

如上所示，我们创建了一个名为`cityLE`的标签编码器，并通过使用`fit_transform()`函数将城市名转换成整数:0、1、2、3 和 4。然后，在`inverse_transform()`的帮助下，我们可以从这些关键数字中取回城市名称。这很像 python 中的字典，每个键(整数)都映射到一个城市名。

# 数据探索性分析

到目前为止，我们已经将城市名称转换为数值。接下来，在转换其他列之前，我们将进行一些探索性的数据分析。简单来说，让我们看看每个城市有多少条记录:

注意`list(cityLE.classes_)`给出了所有城市名称的列表(以便映射到它们相应的数字)。显然我们大部分的记录都来自贝洛奥里藏特市。

让我们更深入地研究探索性数据分析。我们将根据房屋面积和总价来绘制每个租金价格。

你可能已经注意到了，这个散点图向我们展示了大部分区域的价值低于 1000-2000，价格也低于 40000。当然，我用这些值来限制面积和总量的范围。(在本教程的下一部分中，我们将删除超出此范围的行)
我的目的是删除将来可能对我们的模型产生干扰的记录。此外，在绘制数据时要有一个更合适的数字。然而，在现实世界的项目中，这可能不是一件好事，但在这里，我们只想清理数据，以便更好地进行学习。

对于每五个城市，我们绘制了成本/面积散点图(第六个数字是空的)。现在可以认识到，随着每栋房子面积的增加，租金价格也会上涨。我想现在够了 EDA。让我们继续将分类数据转换成数字。

# 转换家具价值

类似于我们将城市名转换为数字，我们将把家具列值转换为数字。之后，我们要检查这一列的值是多少。

根据图表显示的情况，大多数房子都配有家具。在数据转换之后，这一列的值将是 0 和 1。

# 转换动物价值观

类似于我们将城市名称和家具值转换为数字，我们将把动物列值转换为数字。之后，我们要检查这一列的值是多少。

根据图表显示，大多数房子允许带动物。在数据转换之后，这一列的值将是 0 和 1。

# 转换地板值

正如我们前面看到的，floor 的值不是 int64 类型。所以，让我们弄清楚为什么。

事实证明，对于该列中的空值，他们使用了破折号字符。所以，我们需要把这个值改成数字。因为我们的数据集中没有 0 层，所以我们用' 0 '代替'-'。

现在，该列的每个值都是一个字符串数字，让我们将其数据类型转换为 Int64。

因为将对象直接转换为 Int64 是不可能的，所以先转换为 float，然后再转换为 Int64。

让我们看看我们的数据框架信息。

到目前为止，一切顺利。我想我们已经达到了这部分教程的目标。我们的数据框架的每一列都有数值，这是我们的模型所需要的。因此，让我们将数据帧保存到 CSV 文件中。在接下来的部分中，我们将使用这个版本的数据集。

在接下来的部分，我们将使用 PyTorch 创建一些模型来预测房屋的租金价格。

你可以在[Jovian](https://jovian.ml/khatami7596/01-renting-price-data-cleaning)找到与这篇文章相关的笔记本，这里是 Kaggle 上数据集的链接:[数据集](https://www.kaggle.com/rubenssjr/brasilian-houses-to-rent)

*原载于 2020 年 6 月 4 日*[*【https://akhatami.com】*](https://akhatami.com/rent-price-prediction-using-pytorch-part1-data-cleaning/)*。*