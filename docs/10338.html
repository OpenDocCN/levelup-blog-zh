<html>
<head>
<title>Code a cookie-based darkmode switch in CSS and vanilla JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用CSS和普通JavaScript编写一个基于cookie的黑暗模式开关</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/code-a-cookie-based-darkmode-switch-in-css-and-vanilla-javascript-b2d89f99ea7d?source=collection_archive---------2-----------------------#2021-11-24">https://levelup.gitconnected.com/code-a-cookie-based-darkmode-switch-in-css-and-vanilla-javascript-b2d89f99ea7d?source=collection_archive---------2-----------------------#2021-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5d7e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本文中，我将向您展示如何用52行JavaScript轻松地编写黑暗模式开关。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/282660929c8288e50528d802bd56ec99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDQsXN6lFxgYlqXpJ_9eeQ.jpeg"/></div></div></figure><blockquote class="kr ks kt"><p id="b9a7" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">更新:</strong>感谢<a class="lr ls ep" href="https://medium.com/u/ce71a9a3f88c?source=post_page-----b2d89f99ea7d--------------------------------" rel="noopener" target="_blank">vojtēch Musil</a>的评论！为了更好的语义和可访问性，我将darkmode开关的<code class="fe lt lu lv lw b">&lt;div&gt;</code>元素改为了<code class="fe lt lu lv lw b">&lt;button&gt;</code>元素。</p></blockquote><h1 id="6c1c" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">HTML</h1><p id="d590" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">对于这个黑暗模式演示，我需要一个简单的HTML文件。在<code class="fe lt lu lv lw b">head</code>部分，我包含了CSS文件<code class="fe lt lu lv lw b">styles.css</code>和两个JavaScript文件<code class="fe lt lu lv lw b">darkmode.js</code>和<code class="fe lt lu lv lw b">project.js</code>。</p><p id="4e78" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">元字符集、元视口和标题只是为了完成一个最小的head部分。</p><p id="ebee" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated"><strong class="kx ir">黑暗模式按钮</strong>位于<em class="kw">线13 </em>上的<code class="fe lt lu lv lw b">&lt;header&gt;</code>元件内。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="5a2e" class="lx ly iq bd lz ma ng mc md me nh mg mh jw ni jx mj jz nj ka ml kc nk kd mn mo bi translated">CSS</h1><p id="573d" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">在样式表中，我定义了<code class="fe lt lu lv lw b">body</code>的明暗状态。另外，我将暗模式按钮的设计设置为亮模式和暗模式(classname active)状态。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/b54f8c3c314f2e10a8228936c5bc0fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZY1ivOTTdmXsZfRmzRzLA.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">超级简单的黑暗模式按钮</figcaption></figure><p id="0567" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">展示的CSS是最基本的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="1fd8" class="lx ly iq bd lz ma ng mc md me nh mg mh jw ni jx mj jz nj ka ml kc nk kd mn mo bi translated">project.js文件</h1><p id="2d4d" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">我用这个文件在<a class="ae nq" href="https://developer.mozilla.org/de/docs/Web/API/Window/DOMContentLoaded_event" rel="noopener ugc nofollow" target="_blank"> DOMContentLoaded </a>事件中用后面描述的函数<code class="fe lt lu lv lw b">darkmode_init()</code>初始化黑暗模式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="edcb" class="lx ly iq bd lz ma ng mc md me nh mg mh jw ni jx mj jz nj ka ml kc nk kd mn mo bi translated">darkmode.js文件</h1><p id="5f04" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">在这个例子中，我使用一个函数来包装完整的黑暗模式行为。这是完整的脚本。接下来，我用<strong class="kx ir">四个简单的步骤</strong>来解释这个脚本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="0edd" class="nr ly iq bd lz ns nt dn md nu nv dp mh mr nw nx mj mt ny nz ml mv oa ob mn oc bi translated">步骤1:引用按钮</h2><p id="4618" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">首先我从大教堂里拿了个开关。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="c740" class="nr ly iq bd lz ns nt dn md nu nv dp mh mr nw nx mj mt ny nz ml mv oa ob mn oc bi translated">步骤2:建立cookie功能</h2><p id="44a7" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated"><code class="fe lt lu lv lw b">darkmodeCookie</code>对象包含三种方法:</p><ul class=""><li id="995f" class="od oe iq kx b ky kz lb lc mr of mt og mv oh lq oi oj ok ol bi translated"><code class="fe lt lu lv lw b">set</code>设置黑暗模式cookie</li><li id="c4e0" class="od oe iq kx b ky om lb on mr oo mt op mv oq lq oi oj ok ol bi translated"><code class="fe lt lu lv lw b">get</code>读取黑暗模式cookie是否存在</li><li id="7268" class="od oe iq kx b ky om lb on mr oo mt op mv oq lq oi oj ok ol bi translated"><code class="fe lt lu lv lw b">remove</code>删除黑暗模式cookie</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="cc61" class="nr ly iq bd lz ns nt dn md nu nv dp mh mr nw nx mj mt ny nz ml mv oa ob mn oc bi translated">Steph 3: CSS类处理</h2><p id="d1a4" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">使用<code class="fe lt lu lv lw b">darkmodeCookie</code>对象的get方法，我检查darkmode cookie是否存在。如果是的话，我给开关添加一个<strong class="kx ir">活动类</strong>，给<code class="fe lt lu lv lw b">body</code>添加一个<strong class="kx ir">黑暗模式类</strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="ec2b" class="nr ly iq bd lz ns nt dn md nu nv dp mh mr nw nx mj mt ny nz ml mv oa ob mn oc bi translated">步骤4:开关处理</h2><p id="6243" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">这部分脚本向开关添加了一个<strong class="kx ir">事件监听器</strong>来切换它自己和主体的类。</p><p id="5fd7" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">在<em class="kw">第6行</em>中，我检查了在<em class="kw">第4行</em>中toggeling之后车身是否有黑暗模式等级。如果有，我设置了darkmode cookie，在这个例子中是一个月后到期(2，628，000，000毫秒)。如果页面是SSL加密的，则第8行中<code class="fe lt lu lv lw b">darmodeCookie.set()</code>的最后一个参数必须设置为<em class="kw"> true </em>。对于本地测试，只需将其设置为<em class="kw">假</em>。第二个参数是值，我只使用<em class="kw"> true </em>作为字符串。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/c94fe2314fe037bf5247cbc615bd63ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IfMgEEB6zpLW1ZIOT4I1ig.jpeg"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">在浏览器的开发工具中，你可以检查你的cookies</figcaption></figure><p id="87eb" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">如果cookie必须被删除，因为主体不包含darkmode类，我使用<code class="fe lt lu lv lw b">darkmodeCookie.remove()</code>删除darkmode cookie。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="94bb" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">结论</h1><p id="57bf" class="pw-post-body-paragraph ku kv iq kx b ky mp jr la lb mq ju ld mr ms lg lh mt mu lk ll mv mw lo lp lq ij bi translated">通过这些简单的步骤，您可以使用darkmode switch扩展使您的网站更加用户友好。为了更加灵活和可控，我会用PHP而不是JavaScript来设置body darkmode类。</p><p id="d6c5" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated"><strong class="kx ir">工作示例</strong><br/><a class="ae nq" href="https://www.stephan-romhart.de/medium.com/darkmode-switch-vanilla-js/" rel="noopener ugc nofollow" target="_blank">https://www . Stephan-rom hart . de/medium . com/dark mode-switch-vanilla-js/</a></p><p id="76bd" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated"><strong class="kx ir">感谢阅读。<br/> </strong>期待您的反馈。😍</p><p id="d4c5" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">请评论、书签或关注我，支持我的频道。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/92da62b8e793a4c529832d05868d829e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1FhJUsHLg1cOlQB5j9Uouw.jpeg"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">照片由戈平根的Tobias Frö hner拍摄</figcaption></figure><p id="32f3" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">如果你想让我写第二篇关于在wordpress或xenforo中实现darkmode的文章，请告诉我！</p><p id="55bd" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld mr lf lg lh mt lj lk ll mv ln lo lp lq ij bi translated">如果你心中有一个特定的主题，你会希望我写下来，让我在推特上知道:<a class="ae nq" href="https://www.twitter.com/@stephan_romhart" rel="noopener ugc nofollow" target="_blank">https://www.twitter.com/@stephan_romhart</a></p></div></div>    
</body>
</html>