<html>
<head>
<title>Ditch GraphQL When It Gets in the Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当GraphQL碍事时，将其丢弃</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/ditch-graphql-when-it-gets-in-the-way-4a71b4de1a12?source=collection_archive---------6-----------------------#2022-10-05">https://levelup.gitconnected.com/ditch-graphql-when-it-gets-in-the-way-4a71b4de1a12?source=collection_archive---------6-----------------------#2022-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f69c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您或您的团队是否在GraphQL概念上苦苦挣扎，或者对于您正在构建的东西来说，它是否感觉太重了？我最近开发了一个NextJS和Ktor应用程序，它从GraphQL开始，但最终不是正确的选择。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/228b5665e55abd42a5ac6a2bb74b1470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*spmLVUbYEY4gCNf4.png"/></div></div></figure><h1 id="9a04" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">GraphQL的优势</h1><p id="b5c8" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated"><strong class="js iu">开发者体验</strong></p><p id="233a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">向API中添加新的类型和字段是很简单的，对于您的客户来说，开始使用这些字段也同样简单。这是使用GraphQL的最大好处，并且在设计API时具有灵活性。</p><p id="2f53" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">一个API供多个客户使用</strong></p><p id="c069" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有一个网站、一个Android应用程序和一个iOS应用程序，能够灵活地调整每个应用程序请求的数据，并让它们在想要接收数据的时候控制<em class="md">，这种感觉真的很棒。不用维护多个API(移动和web)，您可以将所有精力投入到单个API中，并减少大量跨网络数据开发<strong class="js iu">和</strong>开销。</em></p><p id="59db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">性能</strong></p><p id="65d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通常使用REST API，需要多次调用来完成一项任务或获取列表中每一项的详细数据。例如，给我一个项目列表，然后进行第二次调用来获取一个或多个项目的详细信息，以显示给用户。使用GraphQL，您可以通过一个API调用而不是两个来获得列表旁边的所有详细数据。</p><h1 id="de5e" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">认识到缺陷</h1><p id="848b" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated"><strong class="js iu">错误处理</strong></p><p id="931b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">谈到GraphQL，错误处理总是一个有趣的话题。使用REST APIs，您可以在事件发生时返回特定的HTTP代码。灾难性或意外的错误通常会导致500，包含错误数据的错误请求通常会导致400。这让您可以使用前端代码中的承诺来检查是否有东西返回<strong class="js iu"> <em class="md"> ok </em> </strong>或<strong class="js iu"> <em class="md"> error </em> </strong>，然后适当地处理错误。</p><p id="48d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用GraphQL，您可以自行处理，因为所有内容都返回200，然后您添加一个错误对象，您必须解析该对象以查看是否真的有错误。</p><p id="bde8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有复杂的错误处理，那么这就是你的前端代码变得非常复杂的地方，处理来自后端的所有错误，并试图弄清楚什么是正确的HTML来显示给用户。</p><p id="eafd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您正在处理复杂的错误处理，那么在引入或继续使用GraphQL时，请认真考虑。</p><p id="d7a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">冗长的模式</strong></p><p id="7485" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于这个特定的应用程序，我们使用Ktor而不是Spring Boot，这是非常标准的，没有很多现成的铃铛和口哨。来自多年的Ruby编程，感觉很像Sinatra。</p><p id="5c06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们引入的<a class="ae me" href="https://github.com/ExpediaGroup/graphql-kotlin" rel="noopener ugc nofollow" target="_blank"> GraphQL库</a>有很大的魔力，你可以在其中实现一个接口(订阅、查询、变异),然后事情就可以正常工作了。但是您必须在相当多的地方定义这些<code class="fe mf mg mh mi b">JsonTypeInfo</code>注释，这样您才能使序列化与fasterxml-jackson一起工作。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mj"><img src="../Images/725909636b0a4622b7ddc110ed047cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M7EKGjwdZ60JvEnRFGkqiw.png"/></div></div></figure><p id="ba79" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总的来说，这限制了您在实现特定GraphQL接口的类中所能做的事情，并且您最终会得到许多这样的JSON注释。</p><p id="8e5c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">简单域</strong></p><p id="cefd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我们来说，我们正在测试一个事件源系统，它有一个简单的领域，其中有1或2个领域概念。对于我们所在的简单领域来说，在前端<em class="md">和后端</em>实现所有的模式和基础设施感觉非常繁重，我们只需要显示一个列表，添加一个新项目，并修改单个项目的属性。</p><p id="5eee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果领域更复杂，需要多个团队或者一个联合架构，那么我们会看到更多的好处。</p><p id="70bc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您的领域足够简单，考虑不要使用GraphQL，添加GraphQL只会导致膨胀和不必要的复杂性。</p><p id="edcd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">同一个团队维护的一个客户端</strong></p><p id="39b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我们来说，我们有一个后端API和一个前端应用程序，我们100%控制。我们没有从API灵活性中获得任何好处，因为我们也是更新前端的团队，可以在需要完成新功能或修复bug时更新后端API中的任何内容。</p><p id="6695" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你没有单独的团队或公司开发前端或移动应用程序，请考虑不要使用GraphQL。</p><p id="6800" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">团队使用GraphQL的经验</strong></p><p id="0e62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你的团队中没有至少一两个GraphQL专家，那么进度<strong class="js iu">会很慢。</strong>特别是在刚开始的时候<em class="md">和</em>每当有新人加入团队，你都会感觉慢下来。考虑为了构建和维护一个GraphQL API，团队知道多少或者将要学习多少。</p><p id="6c8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您没有专业知识或者希望团队和代码库的加速时间更短，可以考虑不使用GraphQL。</p><h1 id="5dbc" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结论</h1><p id="088e" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">总的来说，我们已经决定最终在这个应用中远离GraphQL，并且在我们构建的下一个应用中不使用它。您是否有过与GraphQL类似的经历，或者完全相反的经历？请在下面的评论中告诉我！</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="8f75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这篇文章，考虑<a class="ae me" href="https://medium.com/@ascourter/membership" rel="noopener">订阅Medium </a>！</p><p id="36ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你或你的公司有兴趣找人进行技术面试，那么请在Twitter ( <a class="ae me" href="http://twitter.com/Exosyphon" rel="noopener ugc nofollow" target="_blank"> @Exosyphon </a>)上给我发DM，或者访问我的<a class="ae me" href="https://andrewcourter.com/" rel="noopener ugc nofollow" target="_blank">网站</a>。如果你喜欢这样的话题，那么你可能也会喜欢我的<a class="ae me" href="https://www.youtube.com/channel/UCx3Vist13GWLzRPvhUxQ3Jg" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>。如果你喜欢3D打印的东西，去我的<a class="ae me" href="https://www.etsy.com/listing/1273702925/6-sided-fidget-cube" rel="noopener ugc nofollow" target="_blank"> Etsy商店</a>看看。祝您愉快！</p></div></div>    
</body>
</html>