<html>
<head>
<title>SwiftUI: Dissolve Effect</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI:溶解效果</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/swiftui-dissolve-effect-7e98a82c07a1?source=collection_archive---------10-----------------------#2020-05-23">https://levelup.gitconnected.com/swiftui-dissolve-effect-7e98a82c07a1?source=collection_archive---------10-----------------------#2020-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f398" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">是时候锻炼我们的肌肉了！在本周的教程中，我们将对经典的溶解效果进行一些改变！</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/7e13555f6a6bdcbb7ab66f7ae3be4cdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TQbNuxAPD1P4-QHsN5HVpA.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/63ea111ae86376aae590e32b6871bce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*3Qi0OKjHFQrGDgQn.gif"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">使用<code class="fe ki kj kk kl b">Rectangle</code>的溶解效果</figcaption></figure><blockquote class="ld le lf"><p id="ecb0" class="lg lh li lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在开始之前，请考虑使用这个<a class="ae md" href="https://trailingclosure.com/signup/" rel="noopener ugc nofollow" target="_blank">链接</a>订阅，如果你没有在<a class="ae md" href="https://trailingclosure.com/" rel="noopener ugc nofollow" target="_blank">TrailingClosure.com</a>上阅读这篇文章，请随时来看看我们！</p></blockquote><h2 id="0f68" class="me mf it bd mg mh mi dn mj mk ml dp mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">入门指南</h2><p id="fdfb" class="pw-post-body-paragraph lg lh it lj b lk na ju lm ln nb jx lp mn nc ls lt mr nd lw lx mv ne ma mb mc im bi translated">在上面的例子中，我展示了当<code class="fe ki kj kk kl b">Rectangle</code>被用作溶解效果的遮罩时的样子。然而，在本教程中，我们将创建一个<code class="fe ki kj kk kl b">ViewModifier</code>，它接受任何<code class="fe ki kj kk kl b">View</code>作为它用来创建溶解效果的形状。敬请关注，看看这种效果到底有多强大！</p><ol class=""><li id="666f" class="nf ng it lj b lk ll ln lo mn nh mr ni mv nj mc nk nl nm nn bi translated">创建一个名为<code class="fe ki kj kk kl b">ShapeDissolveModifier</code>的新<code class="fe ki kj kk kl b">ViewModifier</code>。下面是我们结构的样板文件。定义了两个变量。第一个是我们的<code class="fe ki kj kk kl b">mask</code>的溶解效果。我们的<code class="fe ki kj kk kl b">Mask</code>类型在上面被定义为<code class="fe ki kj kk kl b">ShapeDissolveModifier</code>上的通用类型。第二个是溶解动画的<code class="fe ki kj kk kl b">progress</code>。随着从<code class="fe ki kj kk kl b">0</code>到<code class="fe ki kj kk kl b">1</code>的增加，视图将消失。</li></ol><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="9057" class="me mf it kl b gy ns nt l nu nv">struct ShapeDissolveModifier&lt;Mask: View&gt;: ViewModifier {<br/>    <br/>    let mask: Mask<br/>    var progress: Double<br/>    <br/>    func body(content: Content) -&gt; some View {<br/>        content<br/>    }<br/>}</span></pre><ol class=""><li id="0061" class="nf ng it lj b lk ll ln lo mn nh mr ni mv nj mc nk nl nm nn bi translated">创建一个新功能<code class="fe ki kj kk kl b">buildMask(GeometryProxy, Double) -&gt; some View</code>。这个函数的工作是获取我们之前定义的蒙版模板<code class="fe ki kj kk kl b">mask</code>，并创建100个不同的<code class="fe ki kj kk kl b">opacity</code>副本。这些副本结合起来形成一个完整的面具，它会随着时间的推移而溶解。</li></ol><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="a199" class="me mf it kl b gy ns nt l nu nv">func buildMask(geometry: GeometryProxy, progress: Double) -&gt; some View {<br/>    // Create Dissolve Mask here...<br/>}</span></pre><ol class=""><li id="0e2b" class="nf ng it lj b lk ll ln lo mn nh mr ni mv nj mc nk nl nm nn bi translated">在该功能中，我们使用<code class="fe ki kj kk kl b">GeometryProxy</code>来计算掩模板副本的尺寸。</li></ol><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="46e9" class="me mf it kl b gy ns nt l nu nv">func buildMask(geometry: GeometryProxy, progress: Double) -&gt; some View {<br/>    <br/>    let width = geometry.size.width<br/>    let height = geometry.size.height<br/><br/>    let wUnit = width/10.0<br/>    let hUnit = height/10.0<br/><br/>    // resize the mask to 1/10th of the parent view.<br/>    let maskPiece = mask<br/>        .frame(width: wUnit, height: hUnit, alignment: .center)<br/>}</span></pre><ol class=""><li id="54fa" class="nf ng it lj b lk ll ln lo mn nh mr ni mv nj mc nk nl nm nn bi translated">接下来，我们需要创建三个闭包，以允许我们为掩码副本生成<code class="fe ki kj kk kl b">x</code>、<code class="fe ki kj kk kl b">y</code>和<code class="fe ki kj kk kl b">opacity</code>值。</li></ol><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="1976" class="me mf it kl b gy ns nt l nu nv">func buildMask(geometry: GeometryProxy, progress: Double) -&gt; some View {<br/>    <br/>    let width = geometry.size.width<br/>    let height = geometry.size.height<br/><br/>    let wUnit = width/10.0<br/>    let hUnit = height/10.0<br/><br/>    // resize the mask to 1/10th of the parent view.<br/>    let maskPiece = mask<br/>        .frame(width: wUnit, height: hUnit, alignment: .center)<br/>    <br/>    // Calculate X coordinate for a mask copy<br/>    let xCoord = { (x:Int) -&gt; CGFloat in<br/>        wUnit * CGFloat(x)<br/>    }<br/>    <br/>    // Calculate Y coordinate for a mask copy<br/>    let yCoord = { (y:Int) -&gt; CGFloat in<br/>        hUnit * CGFloat(y)<br/>    }<br/>    <br/>    // Calculate a random opacity for a mask copy<br/>    let opacity = { () -&gt; Double in<br/>        return Double.random(in: 0...3) * progress + progress<br/>    }<br/>    <br/>}</span></pre><ol class=""><li id="8eff" class="nf ng it lj b lk ll ln lo mn nh mr ni mv nj mc nk nl nm nn bi translated">现在把它们放在一起。我们将使用<code class="fe ki kj kk kl b">ForEach</code>生成带有适当值的<code class="fe ki kj kk kl b">100</code> <code class="fe ki kj kk kl b">mask</code>片段，使用我们刚刚制作的闭包。</li></ol><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="d224" class="me mf it kl b gy ns nt l nu nv">func buildMask(geometry: GeometryProxy, progress: Double) -&gt; some View {<br/>    <br/>    let width = geometry.size.width<br/>    let height = geometry.size.height<br/><br/>    let wUnit = width/10.0<br/>    let hUnit = height/10.0<br/><br/>    // resize the mask to 1/10th of the parent view.<br/>    let maskPiece = mask<br/>        .frame(width: wUnit, height: hUnit, alignment: .center)<br/>    <br/>    // Calculate X Coordinate for a mask copy<br/>    let xCoord = { (x:Int) -&gt; CGFloat in<br/>        wUnit * CGFloat(x)<br/>    }<br/>    <br/>    // Calculate Y Coordinate for a mask copy<br/>    let yCoord = { (y:Int) -&gt; CGFloat in<br/>        hUnit * CGFloat(y)<br/>    }<br/>    <br/>    // Calculate Random Opacity for a mask copy<br/>    let opacity = { () -&gt; Double in<br/>        return Double.random(in: 0...3) * progress + progress<br/>    }<br/>    <br/>    // Combine all of the mask pieces together<br/>    let fullMask = Group {<br/>        ForEach(0..&lt;100) { x in<br/>            maskPiece<br/>                .offset(x: xCoord(x%10), y: yCoord(x/10))<br/>                .opacity(opacity())<br/>        }<br/>    }<br/><br/>    return fullMask<br/>}</span></pre><h2 id="9182" class="me mf it bd mg mh mi dn mj mk ml dp mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">用法举例！</h2><p id="3028" class="pw-post-body-paragraph lg lh it lj b lk na ju lm ln nb jx lp mn nc ls lt mr nd lw lx mv ne ma mb mc im bi translated">现在有趣的部分来了。我已经收集了一些不同的例子。大多数情况下，我只是在玩它，但是你会看到一些简洁的用法。</p><p id="d459" class="pw-post-body-paragraph lg lh it lj b lk ll ju lm ln lo jx lp mn lr ls lt mr lv lw lx mv lz ma mb mc im bi translated">这些是基于仅仅改变传递给<code class="fe ki kj kk kl b">ShapeDissolveModifier</code>的<code class="fe ki kj kk kl b">mask</code>的不同效果。</p><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="b8cc" class="me mf it kl b gy ns nt l nu nv">Rectangle()<br/>    .foregroundColor(.blue)<br/>    .frame(width: 300, height: 300, alignment: .center)<br/>    .cornerRadius(10)<br/>    .modifier(ShapeDissolveModifier(mask:<br/>        Rectangle()<br/>    ,progress: progress))<br/>    .onAppear {<br/>        withAnimation(Animation.easeInOut(duration: 3.0)) {<br/>            self.progress = 1.0<br/>        }<br/>    }</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/7626eae1e1bcabfa096d02f76bef6a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*P4t6iCEL-xzlbDdH.gif"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated"><code class="fe ki kj kk kl b">Rectangle</code>面具</figcaption></figure><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="3e43" class="me mf it kl b gy ns nt l nu nv">Rectangle()<br/>    .scaleEffect(0.9)</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/3c04bac0b3493a7ce97108a8940ee384.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*7n7w7m5lYLDLyf7o.gif"/></div></figure><h2 id="b8ec" class="me mf it bd mg mh mi dn mj mk ml dp mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">用在图像上</h2><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="4569" class="me mf it kl b gy ns nt l nu nv">Image("mountains")<br/>    .resizable()<br/>    .scaledToFill()<br/>    .foregroundColor(.blue)<br/>    .frame(width: 300, height: 300, alignment: .center)<br/>    .cornerRadius(10)<br/>    .modifier(ShapeDissolveModifier(mask:<br/>        Rectangle()<br/>    ,progress: progress))<br/>    .onAppear {<br/>        withAnimation(Animation.easeInOut(duration: 3.0)) {<br/>            self.progress = 1.0<br/>        }<br/>    }</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/a68e3355315c6d1cf7b6b8c6521d9a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*uKWh_1V4A91oXmuQ.gif"/></div></figure><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="4204" class="me mf it kl b gy ns nt l nu nv">Triangle()<br/>    .rotation(Angle(degrees: 90))<br/>    .scaleEffect(3)</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/07158e0e8d7c08b10474917d7f82b0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*FJ1_wU41PcXwk0Ig.gif"/></div></figure><pre class="kn ko kp kq gt no kl np nq aw nr bi"><span id="84bd" class="me mf it kl b gy ns nt l nu nv">Circle()<br/>    .scaleEffect(1.5)</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/38fbad06088834d500b95995ec015844.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*2rTlyjihW18-PaEn.gif"/></div></figure><h2 id="c7a8" class="me mf it bd mg mh mi dn mj mk ml dp mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">支持未来像这样的教程！</h2><p id="be53" class="pw-post-body-paragraph lg lh it lj b lk na ju lm ln nb jx lp mn nc ls lt mr nd lw lx mv ne ma mb mc im bi translated">请考虑使用此<a class="ae md" href="https://trailingclosure.com/signup/" rel="noopener ugc nofollow" target="_blank">链接</a>进行订阅。如果你没有在<a class="ae md" href="https://trailingclosure.com/" rel="noopener ugc nofollow" target="_blank">TrailingClosure.com</a>看到这篇文章，请随时来看看我们！</p><p id="6883" class="pw-post-body-paragraph lg lh it lj b lk ll ju lm ln lo jx lp mn lr ls lt mr lv lw lx mv lz ma mb mc im bi translated">我们想看你的作品！如果你已经用这个教程制作了一些东西，请给我们发图片！在推特<a class="ae md" href="https://twitter.com/TrailingClosure" rel="noopener ugc nofollow" target="_blank"> @TrailingClosure </a>上找到我们，或者发邮件到<a class="ae md" href="mailto:howdy@trailingclosure.com" rel="noopener ugc nofollow" target="_blank">howdy@TrailingClosure.com</a>联系我们</p></div></div>    
</body>
</html>