<html>
<head>
<title>AWS + React.js Full Stack Development Tutorial — Build a Serverless Tournament Bracket Platform (Part 2: The Frontend)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS + React.js全栈开发教程—构建无服务器锦标赛支架平台(第2部分:前端)</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/aws-react-js-full-stack-development-tutorial-build-a-serverless-tournament-bracket-platform-b6dfbd878d46?source=collection_archive---------3-----------------------#2022-04-01">https://levelup.gitconnected.com/aws-react-js-full-stack-development-tutorial-build-a-serverless-tournament-bracket-platform-b6dfbd878d46?source=collection_archive---------3-----------------------#2022-04-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/910f986553f76bdfb425970e2a95988d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1Fm7IFxKncx5d88k"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@alvarordesign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿尔瓦罗·雷耶斯</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><h1 id="113f" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">第2部分:前端</h1><p id="8e34" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果你愿意，这个实验将提供一个动手编写JavaScript代码的机会。我们还将有机会使用AWS的名为“Amplify”的React库与后端基础设施进行接口。你可以在这里看到完整的前端代码<a class="ae kc" href="https://github.com/beatleboy501/PingPongBrackets" rel="noopener ugc nofollow" target="_blank"/>。因为这是一个完整的教程，所以我在这个特定的实验室中浓缩了很多代码。如果你对更实用的编码感兴趣，萨曼莎·盖兹有一个很棒的深入教程叫做React 101。</p><div class="lz ma gp gr mb mc"><a href="https://tighten.co/blog/react-101-building-a-gif-search-engine/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">React 101，第1部分:构建GIF搜索引擎</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">上次更新于2017年6月1日，以使用Create React App、Redux Form v6、React-Router v4和Firebase v3。寻找旧的…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">tighten.co</p></div></div></div></a></div><h1 id="f9e5" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">创建React应用</h1><p id="3e4f" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在这个实验中，我们将使用<a class="ae kc" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank">NPM</a>—<a class="ae kc" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">node . js</a>的默认包管理器——来设置我们的前端。如今，创建一个<a class="ae kc" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React.js </a>应用程序非常简单，有一个工具字面上叫做<a class="ae kc" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank"> Create React App </a>，你可以使用:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="49cf" class="mu ke iq mq b gy mv mw l mx my">$ nvm use 16 &amp;&amp; npx create-react-app frontend --use-npm &amp;&amp; cd frontend</span><span id="a723" class="mu ke iq mq b gy mz mw l mx my">Now using node v16.9.1 (npm v7.21.1)</span><span id="96a6" class="mu ke iq mq b gy mz mw l mx my">Creating a new React app in .../frontend.</span><span id="f1ac" class="mu ke iq mq b gy mz mw l mx my">Installing packages. This might take a couple of minutes.<br/>Installing react, react-dom, and react-scripts with cra-template...<br/>...</span></pre><p id="3a9a" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">这个项目的下一步，以及你为此写的任何前端代码，应该是安装<code class="fe nf ng nh mq b">ESLint</code>。多年来，当我开始一个新项目时，我会参考来自<a class="ae kc" href="http://twitter.com/alonronin" rel="noopener ugc nofollow" target="_blank"> @alonronin </a>的这篇关于媒体的文章:</p><div class="lz ma gp gr mb mc"><a href="https://medium.com/dailyjs/adding-eslint-to-your-project-7bd4feca35a8" rel="noopener follow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">将ESlint添加到项目中</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">在这篇文章中，我将通过几个简单的步骤，使用……</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">medium.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn jw mc"/></div></div></a></div><p id="427a" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">一旦你完成了ESLint的添加，下一步就是安装我们的前端代码所依赖的包。</p><h1 id="993f" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">材料-用户界面</h1><p id="7c96" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">多年来，一个名为<a class="ae kc" href="https://getbootstrap.com/docs/3.4/" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a>的前端样式框架统治着这片土地，当你浏览互联网时，你会发现到处都有。如今开发者已经远离它，开始使用<a class="ae kc" href="https://next.material-ui.com/" rel="noopener ugc nofollow" target="_blank">材质设计</a>。也许有一天会有更好的东西来代替材料，但是现在我们还在继续。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d6e9" class="mu ke iq mq b gy mv mw l mx my">$ npm i -S @material-ui/core @material-ui/icons @mui/material @<!-- -->emotion/styled</span></pre><h1 id="32c2" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">反应路由器</h1><p id="658e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">React应用程序能够改变路线，例如当访问<code class="fe nf ng nh mq b">example.com/home</code>时，你点击“登录”，你将被重新路由到<code class="fe nf ng nh mq b">example.com/login</code>。这里的技巧是你并没有真正得到一个新的页面或者DOM。现有的网页更新了新的内容，而我们对此一无所知。这种类型的应用程序被称为<a class="ae kc" href="https://en.wikipedia.org/wiki/Single-page_application" rel="noopener ugc nofollow" target="_blank">单页应用程序(SPA) </a>。为了使内容更新与路由变化相关联，我们使用标准的<a class="ae kc" href="https://reactrouter.com/" rel="noopener ugc nofollow" target="_blank"> React路由器库</a>。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="6037" class="mu ke iq mq b gy mv mw l mx my">$ npm i -S <!-- -->react-router-dom</span></pre><h1 id="e565" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">AWS放大器</h1><p id="b47c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">用于处理后端web服务(如API、认证代理等)。)<a class="ae kc" href="https://amplify.aws/" rel="noopener ugc nofollow" target="_blank"> AWS已经提供了一个库</a>，它消除了进行常规SDK调用的所有复杂性。Amplify在<a class="ae kc" href="https://reinvent.awsevents.com/" rel="noopener ugc nofollow" target="_blank"> AWS的年度会议</a>上宣布，名为<a class="ae kc" href="https://aws.amazon.com/blogs/mobile/announcing-aws-amplify-and-the-aws-mobile-cli/" rel="noopener ugc nofollow" target="_blank"> re:Invent于2017年</a>发布，此后一直在大步前进。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="6153" class="mu ke iq mq b gy mv mw l mx my">$ npm i -S aws-amplify aws-amplify-react</span></pre><h1 id="a800" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">类名</h1><p id="acc4" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">Classnames用于动态组合一个字符串，作为某些DOM元素的<code class="fe nf ng nh mq b">class</code>属性。这样你就可以用CSS来应用你的样式。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d699" class="mu ke iq mq b gy mv mw l mx my">$ npm i -S classnames</span></pre><h1 id="ec09" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">删除样板文件</h1><p id="034f" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">接下来，您终于可以在IDE中打开<code class="fe nf ng nh mq b">frontend</code>项目并开始编码了。<code class="fe nf ng nh mq b">src/index.js</code>文件附带了一些<a class="ae kc" href="https://stackoverflow.com/questions/3992199/what-is-boilerplate-code" rel="noopener ugc nofollow" target="_blank">样板代码</a>，我们将用下面的代码覆盖它们:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="d14c" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">然后下一步是删除<code class="fe nf ng nh mq b">App.js</code>、<code class="fe nf ng nh mq b">App.js</code>和<code class="fe nf ng nh mq b">App.test.js</code>，因为我们不再需要这些:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9a2cacc05f5a6fd64cb93713e15c84bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*g1UIBXB5B3PJ8SSxiY-2ew.png"/></div></figure><p id="4e06" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">此时，你的IDE会对你大喊对<code class="fe nf ng nh mq b">components/App</code>的引用是无效的。没关系，我们接下来会添加它们。</p><p id="97e9" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><code class="fe nf ng nh mq b">components</code>、<code class="fe nf ng nh mq b">constants</code>、<code class="fe nf ng nh mq b">providers</code>、<code class="fe nf ng nh mq b">utils</code>和<code class="fe nf ng nh mq b">conf</code>目录(及其内容)还不存在，因此我们将从GitHub repo中逐个复制它们，并将其放在我们的<code class="fe nf ng nh mq b">src/</code>文件夹中，同时了解它们的用途。</p><h1 id="9b82" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">组件目录</h1><p id="2324" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">components目录是React程序员常用的文件夹，用来存放可重用的UI部分(比如按钮和输入)。这也是我们将使用它的目的。如你所见，它有卡片、导航、菜单和加载小部件等功能。所有这些都将被应用程序用来作为一个整体形成UI。你可以<a class="ae kc" href="https://github.com/beatleboy501/PingPongBrackets/tree/master/src/components" rel="noopener ugc nofollow" target="_blank">在这里</a>下载组件。</p><h1 id="5716" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">常量目录</h1><p id="2bf5" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这个目录不是必需的，但是当涉及到可重用的常量变量时，它有助于组织代码(想想导航菜单选项)。您可以<a class="ae kc" href="https://github.com/beatleboy501/PingPongBrackets/tree/master/src/constants" rel="noopener ugc nofollow" target="_blank">在此</a>下载常量。</p><h1 id="711c" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">提供商目录</h1><p id="d9ac" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在React中使用provider模式向任何嵌套级别提供状态(在我们的例子中是调用API的服务),而不必通过props传递状态。您可以<a class="ae kc" href="https://github.com/beatleboy501/PingPongBrackets/tree/master/src/providers" rel="noopener ugc nofollow" target="_blank">在这里下载提供商</a>。</p><h1 id="5796" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">utils目录</h1><p id="09da" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这不是一个必需的目录，但它使我们的代码更干净，可以分离任何可重用的实用函数。你可以在这里下载实用程序。</p><h1 id="9e7a" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">conf目录</h1><p id="08f2" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在这种情况下，Conf是configuration的缩写。您可以更改Material-UI的样式主题或AWS Amplify Auth的用户属性。你可以在这里下载conf。</p><h1 id="f7e1" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">配置放大器</h1><p id="13ff" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">既然已经添加了所有必需的依赖项和文件，我们将需要为您的计算机配置AWS Amplify CLI。AWS Amplify是一个JavaScript库，用于将移动和web应用程序连接到AWS云服务。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="764d" class="mu ke iq mq b gy mv mw l mx my">$ amplify configure</span><span id="c0e2" class="mu ke iq mq b gy mz mw l mx my">Follow these steps to set up access to your AWS account:</span><span id="145f" class="mu ke iq mq b gy mz mw l mx my">Sign in to your AWS administrator account:</span><span id="f16b" class="mu ke iq mq b gy mz mw l mx my">https://console.aws.amazon.com/</span><span id="9357" class="mu ke iq mq b gy mz mw l mx my">Press Enter to continue</span><span id="edde" class="mu ke iq mq b gy mz mw l mx my">Specify the AWS Region</span><span id="6086" class="mu ke iq mq b gy mz mw l mx my">? <em class="nr">region</em>: us-east-1 (or whatever region is closest to you)</span><span id="5175" class="mu ke iq mq b gy mz mw l mx my">Specify the username of the new IAM user:</span><span id="7d60" class="mu ke iq mq b gy mz mw l mx my">? <em class="nr">user name</em>:  TournamentBracketsAdmin</span><span id="593f" class="mu ke iq mq b gy mz mw l mx my">(Finish the following part in the web console, giving programmatic and console access and accepting defaults for all else. **Make sure to download the credentials CSV file**)</span><span id="f009" class="mu ke iq mq b gy mz mw l mx my">? <em class="nr">accessKeyId</em>: (&lt;YOUR_ACCESS_KEY_ID&gt;)</span><span id="2a92" class="mu ke iq mq b gy mz mw l mx my">? <em class="nr">secretAccessKey</em>: (&lt;YOUR_SECRET_ACCESS_KEY&gt;)</span><span id="780e" class="mu ke iq mq b gy mz mw l mx my">This would update/create the AWS Profile in your local machine</span><span id="e15a" class="mu ke iq mq b gy mz mw l mx my">? <em class="nr">Profile Name</em>:  TournamentBrackets</span></pre><p id="9a06" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">请注意，您可以在最后更新或创建AWS CLI配置文件。这与Amplify CLI不同，但两者是相关的。此时，您已经将Amplify CLI配置为计算机上的一项服务。接下来要做的是在当前目录中初始化一个Amplify应用程序。这将允许您添加诸如身份验证、存储、API服务等内容。对于终端提示，请遵循以下文本。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="8676" class="mu ke iq mq b gy mv mw l mx my">$ amplify init</span><span id="9123" class="mu ke iq mq b gy mz mw l mx my">Note: It is recommended to run this command from the root of your app directory<br/>? Enter a name for the project frontend<br/>The following configuration will be applied:</span><span id="a069" class="mu ke iq mq b gy mz mw l mx my">Project information<br/>| Name: frontend<br/>| Environment: dev<br/>| Default editor: Visual Studio Code<br/>| App type: javascript<br/>| Javascript framework: react<br/>| Source Directory Path: src<br/>| Distribution Directory Path: build<br/>| Build Command: npm run-script build<br/>| Start Command: npm run-script start</span><span id="baa0" class="mu ke iq mq b gy mz mw l mx my">? Initialize the project with the above configuration? Yes<br/>Using default provider  awscloudformation</span><span id="252e" class="mu ke iq mq b gy mz mw l mx my">? Please choose the profile you want to use TournamentBrackets<br/>Adding backend environment dev to AWS Amplify Console app: x0xxxxx0xx0xxx<br/>⠹ Initializing project in the cloud...</span></pre><p id="331b" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">等一会儿，~去喝杯咖啡<em class="nr"> ~，</em>什么的，然后等到你在终端上看到这个:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="388b" class="mu ke iq mq b gy mv mw l mx my">✔ Successfully created initial AWS cloud resources for deployments.<br/>✔ Initialized provider successfully.<br/>Initialized your environment successfully.</span><span id="d327" class="mu ke iq mq b gy mz mw l mx my">Your project has been successfully initialized and connected to the cloud!</span></pre><p id="e557" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">恭喜你，你的前端现在已经连接到AWS了。接下来，我们将在应用程序中添加身份验证功能——首先从本地开始。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="d098" class="mu ke iq mq b gy mv mw l mx my">$ amplify add auth</span><span id="b275" class="mu ke iq mq b gy mz mw l mx my">Using service: Cognito, provided by: awscloudformation</span><span id="8988" class="mu ke iq mq b gy mz mw l mx my">The current configured provider is Amazon Cognito.</span><span id="2200" class="mu ke iq mq b gy mz mw l mx my">? Do you want to use the default authentication and security configuration? Manual configuration<br/>? Select the authentication/authorization services that you want to use: User Sign-Up &amp; Sign-In only<br/> (Best used with a cloud API only)<br/>? Please provide a friendly name for your resource that will be used to label this category in the project: TournamentBrackets<br/>? Please provide a name for your user pool: TournamentBracketsUserPool<br/> Warning: you will not be able to edit these selections.<br/>? How do you want users to be able to sign in? Email<br/>? Do you want to add User Pool Groups? No<br/>? Do you want to add an admin queries API? No<br/>? Multifactor authentication (MFA) user login options: OFF<br/>? Email based user registration/forgot password: Enabled (Requires per-user email entry at registration)<br/>? Please specify an email verification subject:  Your Tournament Brackets Verification Code<br/>? Please specify an email verification message: Your Tournament Brackets Verification Code is {####}<br/>? Do you want to override the default password policy for this User Pool? No<br/> Warning: you will not be able to edit these selections.<br/>? What attributes are required for signing up? Email, Family Name (This attribute is not supported by Login With Amazon.), Given Name (This attribute is not supported by Login With Amazon.) <br/>? Specify the app's refresh token expiration period (in days): 30<br/>? Do you want to specify the user attributes this app can read and write? Yes<br/>? Specify read attributes: Email, Family Name, Given Name<br/>? Specify write attributes:<br/>? Do you want to enable any of the following capabilities?<br/>? Do you want to use an OAuth flow? Yes<br/>? What domain name prefix do you want to use? tournament-bracket-auth<br/>? Enter your redirect signin URI: <a class="ae kc" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a> <br/>? Do you want to add another redirect signin URI No<br/>? Enter your redirect signout URI: <a class="ae kc" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a><br/>? Do you want to add another redirect signout URI No<br/>? Select the OAuth flows enabled for this project. Authorization code grant<br/>? Select the OAuth scopes enabled for this project. Phone, Email, OpenID, Profile, aws.cognito.signin.user.admin<br/>? Select the social providers you want to configure for your user pool:<br/>? Do you want to configure Lambda Triggers for Cognito? No</span><span id="809c" class="mu ke iq mq b gy mz mw l mx my">Successfully added auth resource TournamentBrackets locally</span></pre><p id="6708" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">如您所见，Auth可以高度定制，但我们为我们的解决方案选择了最简单的配置之一。检查Amplify状态，查看Auth是否已添加:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="9f47" class="mu ke iq mq b gy mv mw l mx my">$ amplify status</span><span id="f2a5" class="mu ke iq mq b gy mz mw l mx my">Current Environment: dev</span><span id="102c" class="mu ke iq mq b gy mz mw l mx my">| Category | Resource name     | Operation | Provider plugin   |<br/>| -------- | ----------------- | --------- | ----------------- |<br/>| Auth     | TournamentBrackets | Create    | awscloudformation |</span></pre><p id="47c3" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">我们将在前端应用程序中添加另一个类别，即托管。直到最近，这还不能用Amplify CLI配置，而且设置起来更复杂。现在，托管包含在CLI中，有几个选项可供您选择。首先，你可以选择自己管理或者让Amazon管理你的应用程序。我们将选择管理我们自己。下一个要做的决定是您是托管<code class="fe nf ng nh mq b">prod</code>工作负载还是<code class="fe nf ng nh mq b">dev</code>工作负载。这两种选择都涉及到在S3桶中托管静态资产。<code class="fe nf ng nh mq b">prod</code>选项将使用AWS的名为CloudFront的CDN将它们分发到世界各地的缓存位置</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="78b2" class="mu ke iq mq b gy mv mw l mx my">$ amplify add hosting</span><span id="1a5c" class="mu ke iq mq b gy mz mw l mx my">? Select the plugin module to execute Amazon CloudFront and S3<br/>? Select the environment setup: DEV (S3 only with HTTP)<br/>? hosting bucket name tournament-bracket-hosting-bucket<br/>? index doc for the website index.html<br/>? error doc for the website index.html</span></pre><p id="6629" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">这些身份验证和托管配置只存在于本地，因此我们接下来将在云中创建它们。将Amplify项目推送到您的云环境中，将会在之前在CloudFormation中创建的基础栈中创建嵌套栈。注意:如果您遇到问题并正在重新创建AWS资源，请确保在重新开始之前删除现有的CloudFormation堆栈。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="f7b2" class="mu ke iq mq b gy mv mw l mx my">$ amplify push </span><span id="91d7" class="mu ke iq mq b gy mz mw l mx my">✔ Successfully pulled backend environment dev from the cloud.</span><span id="97bb" class="mu ke iq mq b gy mz mw l mx my">Current Environment: dev</span><span id="c256" class="mu ke iq mq b gy mz mw l mx my">| Category | Resource name     | Operation | Provider plugin   |<br/>| -------- | ----------------- | --------- | ----------------- |<br/>| Auth     | TournamentBrackets | Create    | awscloudformation |<br/>| Hosting  | S3AndCloudFront   | Create    | awscloudformation |<br/>? Are you sure you want to continue? Yes<br/>⠏ Updating resources in the cloud. This may take a few minutes...</span><span id="850e" class="mu ke iq mq b gy mz mw l mx my">✔ All resources are updated in the cloud</span><span id="46bb" class="mu ke iq mq b gy mz mw l mx my">Hosting endpoint: ...</span></pre><p id="87bc" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">就像你的网站已经在网上发布了一样。它还没有完全运行，因为我们在登录后重定向到本地主机。让我们花点时间来回顾一下。到目前为止，我们已经创建了以下内容:</p><p id="e769" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><strong class="ld ir">基本堆栈</strong></p><ul class=""><li id="ccf2" class="ns nt iq ld b le na li nb lm nu lq nv lu nw ly nx ny nz oa bi translated">IAM角色</li><li id="b317" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">S3水桶</li></ul><p id="2664" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><strong class="ld ir">授权栈</strong></p><ul class=""><li id="6a83" class="ns nt iq ld b le na li nb lm nu lq nv lu nw ly nx ny nz oa bi translated">λ函数</li><li id="82ac" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">IAM政策和角色</li><li id="93f8" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">Cognito用户池和用户池客户端</li></ul><p id="fe74" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><strong class="ld ir">托管栈</strong></p><ul class=""><li id="89d4" class="ns nt iq ld b le na li nb lm nu lq nv lu nw ly nx ny nz oa bi translated">S3水桶</li></ul><p id="3d3d" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">因为这些资源是在AWS CloudFormation中使用Infrastructure as Code (IaC)创建的，所以最好不要在web控制台中手动更新它们。对这些资源的任何更新只能通过CloudFormation完成。</p><h1 id="a76a" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">修改React应用</h1><p id="d8fb" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">该应用程序将有6个页面:<em class="nr">登录</em>，<em class="nr">创建一个新的括号</em>，<em class="nr">列出一个用户的所有括号</em>，<em class="nr">查看单个括号</em>，<em class="nr">上传</em>，以及<em class="nr">列出所有用户</em>。要在本地预览应用程序，您可以运行<code class="fe nf ng nh mq b">$ npm start</code>。应用程序将在<code class="fe nf ng nh mq b">http://localhost:3000/</code>运行。然而，如果没有后端，你就不能用它做很多事情。</p><p id="2b74" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">让我们看看代码，并借此机会做一些现场编码:</p><p id="cc15" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><code class="fe nf ng nh mq b"><strong class="ld ir">src/aws-exports.js</strong></code></p><p id="57c9" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">这个文件是由Amplify自动生成的。它包含有关AWS地区、科宁托和S3的信息。当应用程序初始化时，这些信息作为配置传递给Amplify JS库。</p><p id="5309" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><code class="fe nf ng nh mq b"><strong class="ld ir">amplify/</strong></code></p><p id="7a87" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">这个自动生成的目录包含用于Auth和Hosting类别的CloudFormation模板。CloudFormation允许您使用一个简单的文本文件，以自动化和安全的方式建模和提供应用程序所需的所有资源。</p><p id="59d0" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><code class="fe nf ng nh mq b"><strong class="ld ir">src/index.js</strong></code></p><p id="dd67" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">这是一个做一些现场编码的机会。我们需要做一些改变，以挂钩放大到反应应用程序</p><ul class=""><li id="71f1" class="ns nt iq ld b le na li nb lm nu lq nv lu nw ly nx ny nz oa bi translated">在第5行，让我们添加一个新的行，并将Amplify导入到项目中</li><li id="0ca4" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">添加另一个新行并导入我们之前在<code class="fe nf ng nh mq b">src/aws-exports.js</code>中看到的配置</li><li id="a5fd" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">再添加一行并将配置从Amplify库中传递给configure函数</li><li id="8f11" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">最后，您的索引文件应该如下所示</li></ul><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="f41b" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><code class="fe nf ng nh mq b"><strong class="ld ir">src/components/App.jsx</strong></code></p><ul class=""><li id="134b" class="ns nt iq ld b le na li nb lm nu lq nv lu nw ly nx ny nz oa bi translated">在第3行导入一个<a class="ae kc" href="https://reactjs.org/docs/higher-order-components.html" rel="noopener ugc nofollow" target="_blank">高阶组件</a>，名为“<a class="ae kc" href="https://docs.amplify.aws/ui/auth/authenticator/q/framework/react/#withauthenticator" rel="noopener ugc nofollow" target="_blank"> withAuthenticator </a>”。这将基本上用一个认证层包装你的整个应用程序。一切都开箱即用。不需要编写任何代码来存储用户会话或添加登录页面等等。</li><li id="7c71" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">在第15行导入注册的配置</li><li id="2382" class="ns nt iq ld b le ob li oc lm od lq oe lu of ly nx ny nz oa bi translated">在第48行，将整个应用程序包装在“with authenticator”HOC中。</li></ul><p id="27c8" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">您的<code class="fe nf ng nh mq b">App.jsx</code>文件应该如下所示:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">App.jsx</figcaption></figure><p id="34c5" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated"><code class="fe nf ng nh mq b"><strong class="ld ir">src/providers/InvokeApiContext.jsx</strong></code></p><p id="2ff0" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">在这个文件中，我们添加了一个叫做<a class="ae kc" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React上下文API </a>的东西。这是React应用程序中使用的一种模式，用于跨组件提供值，而不必显式地将它们传递到树的每一层。在这种情况下，我们希望能够全局访问的值是我们后端API的基本URL。</p><p id="eac0" class="pw-post-body-paragraph lb lc iq ld b le na lg lh li nb lk ll lm nc lo lp lq nd ls lt lu ne lw lx ly ij bi translated">属性指定了我们将要使用的URL。因为我们还没有创建必要的后端资源(AWS API Gateway和AWS Lambda)，所以我们现在将保留这个值。</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="aaa9" class="mu ke iq mq b gy mv mw l mx my">...</span><span id="1938" class="mu ke iq mq b gy mz mw l mx my">state = { <br/>  base: ‘https://xxx.execute-api.us-west-2.amazonaws.com/mock/api' <br/>}</span><span id="c93a" class="mu ke iq mq b gy mz mw l mx my">...</span></pre><h1 id="6daa" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论</h1><p id="4723" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">本教程的前端部分到此结束。接下来，我们将简要介绍DevOps和基础架构。在每个实验结束时，你应该在开发的所有方面都有了全面的经验。</p></div></div>    
</body>
</html>