<html>
<head>
<title>Escaping the Python Import Maze: Tips for Avoiding Circular Imports in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逃离Python导入迷宫:避免Python中循环导入的技巧</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/escaping-the-python-import-maze-tips-for-avoiding-circular-imports-in-python-9046b0be5cb?source=collection_archive---------10-----------------------#2022-12-23">https://levelup.gitconnected.com/escaping-the-python-import-maze-tips-for-avoiding-circular-imports-in-python-9046b0be5cb?source=collection_archive---------10-----------------------#2022-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/93cc1d2e8543d915aff2f1d61a49ce41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JmpW9EQr-EulR7ah.png"/></div></div></figure><p id="99b2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当两个或多个模块相互依赖时，可能会发生循环导入。如果每个模块试图在完全加载之前导入另一个模块，就会发生这种情况，导致不可预知的行为和运行时错误。为了避免这些问题，必须仔细考虑代码中的导入语句，并使用下一节中描述的方法之一来打破导入循环。下面是一个错误语句的例子。</p><pre class="kz la lb lc gt ld le lf bn lg lh bi"><span id="0f36" class="li lj it le b be lk ll l lm ln">"ImportError: cannot import name 'users_bp' from partially initialized module 'src.users.routes' (most likely due to a circular import) "</span></pre><h1 id="b330" class="lo lj it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">销毁循环进口的5种方法</h1><figure class="kz la lb lc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ml"><img src="../Images/f842ca5b816d6f340b4c09137f90ff6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dqsSf1b6N4ioWwio.jpg"/></div></div></figure><h1 id="fcc2" class="lo lj it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">在函数中导入模块</h1><p id="c9f0" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">避免循环导入的一种方法是在函数内部导入模块，而不是在模块的顶层导入。这允许模块仅在需要时被导入，而不是在模块第一次被导入时被导入。例如:</p><pre class="kz la lb lc gt ld le lf bn lg lh bi"><span id="da6b" class="li lj it le b be lk ll l lm ln">def foo():<br/>    from module1 import bar<br/>    bar()</span></pre><h1 id="e2e8" class="lo lj it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">使用导入方式</h1><p id="7f09" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">另一种避免循环导入的方法是使用<code class="fe mr ms mt le b">import as</code>语法。这允许您使用不同的名称导入模块，然后可以使用该名称在代码中引用该模块。例如:</p><pre class="kz la lb lc gt ld le lf bn lg lh bi"><span id="a5b7" class="li lj it le b be lk ll l lm ln">import module1 as m1<br/><br/>def foo():<br/>    m1.bar()</span></pre><h1 id="763b" class="lo lj it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">将导入移动到模块的末尾</h1><p id="e6fc" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">第三种选择是在定义了所有其他代码之后，将import语句移到模块的末尾。这确保了模块在被另一个模块导入之前已经被完全定义。例如:</p><pre class="kz la lb lc gt ld le lf bn lg lh bi"><span id="da62" class="li lj it le b be lk ll l lm ln">def foo():<br/>    pass<br/><br/>def bar():<br/>    pass<br/><br/>import module1</span></pre><h1 id="ce9c" class="lo lj it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">使用<code class="fe mr ms mt le b">IMPORTLIB</code>库</h1><p id="686c" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">避免循环导入的另一个选择是使用<code class="fe mr ms mt le b">importlib</code>库，它允许你在运行时动态导入一个模块。如果在运行时之前不确定需要导入哪个模块，这可能会很有用。例如:</p><pre class="kz la lb lc gt ld le lf bn lg lh bi"><span id="08cd" class="li lj it le b be lk ll l lm ln">import importlib<br/><br/>def foo():<br/>    module = importlib.import_module("module1")<br/>    module.bar()</span></pre><h1 id="8fc5" class="lo lj it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">创建要从中导入的通用文件</h1><p id="f5c2" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">另一种选择是创建一个两个模块都可以导入的公共文件。这有助于打破进口循环，避免循环进口。例如:</p><pre class="kz la lb lc gt ld le lf bn lg lh bi"><span id="0f52" class="li lj it le b be lk ll l lm ln"># common.py<br/>def foo():<br/>    pass<br/><br/>def bar():<br/>    pass<br/><br/># module1.py<br/>from common import foo<br/>def baz():<br/>    foo()<br/><br/># module2.py<br/>from common import bar<br/>def qux():<br/>    bar()</span></pre><p id="6120" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，不要浪费几个小时试图弄清楚循环导入意味着什么，您可以尝试使用这些方法中的任何一种，并且您很快就可以完成。我推荐第五种方法。它非常有效。感谢阅读。在我的<a class="ae mu" href="https://stephenadesina.com/blog/" rel="noopener ugc nofollow" target="_blank">博客</a>上阅读更多文章。</p><p id="9928" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如有任何调试问题，请在评论或LinkedIn 上联系我。</p><p id="9049" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> Secundum Allos Parakletos </strong></p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="949f" class="lo lj it bd lp lq nc ls lt lu nd lw lx ly ne ma mb mc nf me mf mg ng mi mj mk bi translated">分级编码</h1><p id="f04f" class="pw-post-body-paragraph kb kc it kd b ke mm kg kh ki mn kk kl km mo ko kp kq mp ks kt ku mq kw kx ky im bi translated">感谢您成为我们社区的一员！在你离开之前:</p><ul class=""><li id="62e4" class="nh ni it kd b ke kf ki kj km nj kq nk ku nl ky nm nn no np bi translated">👏为故事鼓掌，跟着作者走👉</li><li id="435e" class="nh ni it kd b ke nq ki nr km ns kq nt ku nu ky nm nn no np bi translated">📰查看<a class="ae mu" href="https://levelup.gitconnected.com/?utm_source=pub&amp;utm_medium=post" rel="noopener ugc nofollow" target="_blank">升级编码出版物</a>中的更多内容</li><li id="60c4" class="nh ni it kd b ke nq ki nr km ns kq nt ku nu ky nm nn no np bi translated">🔔关注我们:<a class="ae mu" href="https://twitter.com/gitconnected" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae mu" href="https://www.linkedin.com/company/gitconnected" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae mu" href="https://newsletter.levelup.dev" rel="noopener ugc nofollow" target="_blank">时事通讯</a></li></ul><p id="2e3a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">🚀👉<a class="ae mu" href="https://jobs.levelup.dev/talent/welcome?referral=true" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">加入升级达人集体，找到一份惊艳的工作</strong> </a></p></div></div>    
</body>
</html>