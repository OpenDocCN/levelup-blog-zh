<html>
<head>
<title>cPacketSniffer: write a packet sniffer in C</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用C写一个包嗅探器</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/cpacketsniffer-write-a-packet-sniffer-in-c-9ea769f0de1a?source=collection_archive---------13-----------------------#2022-09-26">https://levelup.gitconnected.com/cpacketsniffer-write-a-packet-sniffer-in-c-9ea769f0de1a?source=collection_archive---------13-----------------------#2022-09-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="bbb7" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">背景</h1><p id="98f4" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这篇文章中，我想介绍我的新项目:<code class="fe lj lk ll lm b"><a class="ae ln" href="https://github.com/baoqger/cPacketSniffer" rel="noopener ugc nofollow" target="_blank">cPacketSniffer</a></code>。我花了两个月的时间在这上面。终于算出来了，放在这里觉得很自豪！</p><div class="lo lp gp gr lq lr"><a href="https://github.com/baoqger/cPacketSniffer" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">基于libpcap的C语言网络数据包捕获</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">cPacketSniffer是一个基于libpcap用C语言编写的Linux网络数据包嗅探器。cPacketSniffer用于…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">github.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf mg lr"/></div></div></a></div><h1 id="021a" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">动机</h1><p id="7c93" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">简单地说，我想在<code class="fe lj lk ll lm b">network programming</code>和<code class="fe lj lk ll lm b">Linux system programming</code>中磨砺我的技术。这两个话题都可以把你引向计算机或者软件的底层。费曼说<a class="ae ln" href="https://en.wikipedia.org/wiki/There%27s_Plenty_of_Room_at_the_Bottom" rel="noopener ugc nofollow" target="_blank">“底部空间很大”</a>，我觉得这个物理定律也可以适用于软件。</p><h1 id="b530" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">确认</h1><p id="1416" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我很幸运地看到了这个网站<a class="ae ln" href="http://tcpip.marcolavoie.ca/index.html" rel="noopener ugc nofollow" target="_blank">“Linux中的网络编程”</a>，它用<code class="fe lj lk ll lm b">C++</code>开发了一个网络数据包捕获工具。在确认这个网站上的文档和源代码都是完整清晰的之后，我决定用C语言对其进行重构。这是我的项目<code class="fe lj lk ll lm b">cPacketSniffer</code>的起点。</p><h1 id="6d85" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">特征</h1><p id="ed52" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">作为网络数据包嗅探器，<code class="fe lj lk ll lm b">cPacketSniffer</code>提供了以下功能:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/1685b0fbf1d9388f03a58390f6f661e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/0*ZKogKoRXZZ3JVsNC.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">cPacketSniffer</figcaption></figure><ul class=""><li id="b922" class="ms mt iq kn b ko mu ks mv kw mw la mx le my li mz na nb nc bi translated">与<code class="fe lj lk ll lm b">libpcap</code>集成支持:过滤抓包、离线抓包、特定设备抓包、混杂模式抓包。</li><li id="4d00" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">分析TCP/IP协议栈低层的网络数据包，包括<code class="fe lj lk ll lm b">Ethernet</code>、<code class="fe lj lk ll lm b">ARP</code>、<code class="fe lj lk ll lm b">ICMP</code>、<code class="fe lj lk ll lm b">IP(IPv4)</code>、<code class="fe lj lk ll lm b">TCP</code>、<code class="fe lj lk ll lm b">UDP</code>等。应用层也有一个协议:<code class="fe lj lk ll lm b">TFTP</code>。</li><li id="161a" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">检测网络安全攻击:<br/> - ARP欺骗检测。<br/> -平洪水检测。</li><li id="004d" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">分析和跟踪网络流量:<br/> - TCP会话跟踪和流量分析。<br/> - TFTP会话跟踪和流量分析。</li></ul><p id="c29f" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated">下图展示了<code class="fe lj lk ll lm b">cPacketSniffer</code>的一些典型用法:</p><p id="d07b" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated"><strong class="kn ir">数据包分析</strong>:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/5abc09be6198978b785258273a53d10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*w4yDv4umC-bkVrO9.png"/></div></div></figure><p id="3328" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated"><strong class="kn ir"> ARP欺骗检测</strong>:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nq"><img src="../Images/945252822d7fc8e47d389d4b994d266b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0ZOi378yDimzGoHa.png"/></div></div></figure><p id="9790" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated"><strong class="kn ir">平洪水检测</strong>:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nr"><img src="../Images/a3e6fb65a6b270dbd52966ed7c0c7fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UqTuxrVe18TbcTHI.png"/></div></div></figure><p id="034b" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated"><strong class="kn ir"> TCP会话跟踪</strong>:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ns"><img src="../Images/5d9cdde4d5dbda112a4af6d6104c9f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lV_nxdWDW0lCjRWY.png"/></div></div></figure><p id="f18f" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated">除了上述与网络编程相关的功能外，它还包括以下几点:</p><ul class=""><li id="8caf" class="ms mt iq kn b ko mu ks mv kw mw la mx le my li mz na nb nc bi translated">用c开发通用数据结构(哈希表和二叉查找树)</li><li id="f1b3" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">c语言中的错误处理。</li><li id="0971" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">c中的数据封装(面向对象风格编程)。</li><li id="4efd" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">c中的手动内存管理。</li><li id="f9fc" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">等等。</li></ul><p id="7725" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated">本文不会详细讨论这几点，以后我会分别就这些话题写文章。</p><h1 id="04c6" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">未来的工作</h1><p id="3313" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在<code class="fe lj lk ll lm b">cPacketSniffer</code>可以根据设计作为网络数据包嗅探器。此外，它还可以作为一个试验台来尝试实验功能。下一步我计划尝试以下想法:</p><ul class=""><li id="0467" class="ms mt iq kn b ko mu ks mv kw mw la mx le my li mz na nb nc bi translated">实现网络入侵检测功能。</li><li id="1d2a" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">使用高级数据结构(如二分搜索法树)提高性能。</li><li id="9eb8" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">内存和缓存性能调优。</li><li id="f121" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">通过垃圾收集实现自动内存管理。</li><li id="209d" class="ms mt iq kn b ko nd ks ne kw nf la ng le nh li mz na nb nc bi translated">集成<code class="fe lj lk ll lm b">ncurses</code>用于基于文本的用户界面。</li></ul><p id="988b" class="pw-post-body-paragraph kl km iq kn b ko mu kq kr ks mv ku kv kw ni ky kz la nj lc ld le nk lg lh li ij bi translated">请继续关注我的博客！</p></div></div>    
</body>
</html>