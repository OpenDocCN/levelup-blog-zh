<html>
<head>
<title>Real-world Examples to Get You Started With Unit Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您开始单元测试的真实例子</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/real-world-examples-to-get-you-started-with-unit-testing-9e51b6d2b819?source=collection_archive---------16-----------------------#2021-01-11">https://levelup.gitconnected.com/real-world-examples-to-get-you-started-with-unit-testing-9e51b6d2b819?source=collection_archive---------16-----------------------#2021-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d110" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Jest在Javascript中进行单元测试</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/76607c0ae5eef8c2d24af33f726e440c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AjI-6OHQ_MHw1XGfOEvPtg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">图片由来自<a class="ae kv" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=762486" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae kv" href="https://pixabay.com/users/testbytes-1013799/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=762486" rel="noopener ugc nofollow" target="_blank"> testbytes </a></figcaption></figure><p id="3957" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你还记得你必须写的1+1 = 2(或类似的)测试吗？我想，“为什么我需要一个检验1+1 = 2的测试。每个人都知道。”</p><p id="b3ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，在这个帖子里。我将向您展示一些真实世界的测试示例，而不是1+1 = 2测试，我们将看到编写测试如何帮助您查明bug，并让您对代码充满信心。</p><h2 id="e3c4" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">先决条件</h2><ul class=""><li id="9ffd" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated">关于<a class="ae kv" href="https://en.wikipedia.org/wiki/Chess" rel="noopener ugc nofollow" target="_blank">国际象棋</a>的基本知识和玩法。</li></ul><h2 id="7575" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">我们在测试什么</h2><p id="7b02" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">因为，我们不想写1+1 = 2的测试，我们要测试的是<a class="ae kv" href="https://en.wikipedia.org/wiki/Chess" rel="noopener ugc nofollow" target="_blank">棋</a>函数。不要让<a class="ae kv" href="https://en.wikipedia.org/wiki/Chess" rel="noopener ugc nofollow" target="_blank">棋</a>这个词吓到你。我将带你浏览一下为了理解这个测试你需要了解的国际象棋术语。</p><p id="c8eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想知道我在哪里使用了这些函数，我们正在测试。你可以看看我以前的帖子。</p><ul class=""><li id="58d5" class="ml mm iq ky b kz la lc ld lf mz lj na ln nb lr ms mt mu mv bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/build-a-chess-tactics-app-with-react-part-1-49be01fc63b5">用React构建一个象棋战术应用(第一部分)</a></li><li id="f2bf" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ms mt mu mv bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/build-a-chess-tactics-app-with-react-part-2-35621640afd1">用React构建一个象棋战术应用(第二部分)</a></li><li id="fd6e" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ms mt mu mv bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-a-simple-chess-app-with-react-e18c0179b167">如何用React创建一个简单的象棋App</a></li></ul><h2 id="53b6" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">开始之前</h2><p id="9876" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">在我们开始之前，我想向你介绍一些你需要知道的国际象棋术语，以便理解我们编写的测试。</p><h2 id="2f9a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">棋盘坐标</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/1074179b087a66d1530554fbae39b7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5NnE3diI2zE8dG1LlEmpJg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">棋盘坐标</figcaption></figure><p id="947a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">棋盘就像一个8×8的矩阵。其尺寸沿y轴标注为1–8，沿x轴标注为“a”-“h”。</p><p id="716c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了指向棋盘上的一个正方形，我们取x和y，称两者的交点为正方形。</p><p id="cbf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比如上图指向g5广场。如果你想了解更多，你可以去<a class="ae kv" href="https://www.chessprogramming.org/Algebraic_Chess_Notation" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h2 id="019b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">象棋分</h2><p id="4cfa" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">分是棋子位置的文本表示。它包含了从特定位置开始游戏的所有必要信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/6a301d070a28c1727ca1ea0f7b4d774e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0D3xWTUyfDpwu1hD_O4YFg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">象棋分</figcaption></figure><p id="8eba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面我们有一个在<a class="ae kv" href="https://lichess.org/analysis/standard/r1bqk2r/pppp1ppp/2n2n2/2b1p3/2B1P3/2N2N2/PPPP1PPP/R1BQK2R_w_KQkq_-_6_5" rel="noopener ugc nofollow" target="_blank"> Lichess </a>看粉的例子。一个开源的在线下棋网站。你可以在这里了解更多关于fen <a class="ae kv" href="https://www.chessprogramming.org/Forsyth-Edwards_Notation" rel="noopener ugc nofollow" target="_blank">的知识。</a></p><h2 id="ef3d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">象棋移动</h2><p id="7736" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">在棋盘上走棋的文字表示叫做<a class="ae kv" href="https://www.chessprogramming.org/Algebraic_Chess_Notation#Standard_Algebraic_Notation_.28SAN.29" rel="noopener ugc nofollow" target="_blank">散</a>。San包含描述在给定位置移动的所有必要信息。san移动看起来像这样，Bc5、Bb4、Kh1等等。你可以在这里了解更多关于san <a class="ae kv" href="https://www.chessprogramming.org/Algebraic_Chess_Notation#Standard_Algebraic_Notation_.28SAN.29" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h2 id="4028" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">回到测试</h2><p id="b2e5" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">现在，基本的方法。让我们开始测试。我们将测试两个功能</p><ol class=""><li id="2925" class="ml mm iq ky b kz la lc ld lf mz lj na ln nb lr ni mt mu mv bi translated">给它一分，它会还回来，让它站在哪一边。</li><li id="21c2" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ni mt mu mv bi translated"><code class="fe nj nk nl nm b">makeMove</code> —给定一个分三步走。它在移动完成后返回fen，而full move也包含其他关于移动的信息。</li></ol><h2 id="5555" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">项目设置</h2><p id="0605" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">为了测试这些功能，我们需要一个npm项目和几个npm包。</p><p id="20af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个新文件夹，并在其中创建一个npm项目。</p><pre class="kg kh ki kj gt nn nm no np aw nq bi"><span id="f2a4" class="ls lt iq nm b gy nr ns l nt nu">mkdir real-world-jest &amp;&amp; cd real-world-jest &amp;&amp; npm init -y</span></pre><p id="7024" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正在安装所需的依赖项。我们将使用<a class="ae kv" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> jest </a>作为测试框架。</p><pre class="kg kh ki kj gt nn nm no np aw nq bi"><span id="9acf" class="ls lt iq nm b gy nr ns l nt nu">yarn add --dev jest</span></pre><p id="9918" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要一个函数使用的象棋库</p><pre class="kg kh ki kj gt nn nm no np aw nq bi"><span id="7fc7" class="ls lt iq nm b gy nr ns l nt nu">yarn add chess.js</span></pre><p id="a25b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将这个<code class="fe nj nk nl nm b">scripts</code>添加到您的<code class="fe nj nk nl nm b">package.json</code>中。</p><pre class="kg kh ki kj gt nn nm no np aw nq bi"><span id="fe3b" class="ls lt iq nm b gy nr ns l nt nu">"scripts": {<br/> "test": "jest"<br/>}</span></pre><p id="b212" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个名为<code class="fe nj nk nl nm b">utils.js</code>的文件。并粘贴下面的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="55b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将创建另一个名为<code class="fe nj nk nl nm b">utils.test.js</code>的文件。我们将在那里编写我们的测试。</p><h2 id="e9d2" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">getSideToPlayFromFen</h2><p id="546b" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们将为这个函数编写3个测试。</p><ol class=""><li id="1490" class="ml mm iq ky b kz la lc ld lf mz lj na ln nb lr ni mt mu mv bi translated">我们将测试它是否变黑。</li><li id="c455" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ni mt mu mv bi translated">我们将测试它是否变成白色。</li><li id="a3d3" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ni mt mu mv bi translated">如果fen不包含必要的信息，我们将测试它是否变成白色。</li></ol><p id="d168" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们测试的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="997d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果运行<code class="fe nj nk nl nm b">yarn test</code>。它过去了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/a436ca8f3ba652ae1795e0d0ffb800f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*NEC6I9BSYivO-I7Pu091Aw.png"/></div></figure><h2 id="99a8" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">进行移动</h2><p id="8433" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们将为这个函数编写2个测试。</p><ol class=""><li id="3d34" class="ml mm iq ky b kz la lc ld lf mz lj na ln nb lr ni mt mu mv bi translated">我们将测试，如果我们在那个位置通过fen和合法移动，它将返回更新的fen和完整移动。</li><li id="8339" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ni mt mu mv bi translated">我们将测试，如果我们在那个位置传递一个fen和非法移动，它将返回null。</li></ol><p id="1868" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是它的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="758c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果现在运行<code class="fe nj nk nl nm b">yarn test</code>。它过去了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/9b33ba91d9d619f5605dfd6b3f8c85eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*vfgsJjNakKJbR_TerGUJvw.png"/></div></figure><h2 id="2967" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">现在怎么办？</h2><p id="36dd" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">现在，我们通过了测试。我们可以将这些测试添加到我们的CI/CD管道中。</p><p id="caa1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者每当您收到问题报告时。在研究你的代码之前。您可以首先运行测试套件，并确保所有测试都通过。</p><p id="f277" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">失败的测试也会告诉你，到底是什么失败了，你需要在哪里寻找。</p><p id="4c54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试还会告诉你你的cod是否有问题。或者任何第三方包发生了变化，导致测试失败。</p><p id="3f24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里找到完整的源代码。</p><div class="ny nz gp gr oa ob"><a href="https://github.com/varunpvp/real-world-jest/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">真实世界笑话</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">让你从jest开始的真实世界的例子。为varunvpp/real-world-jest开发做出贡献，创建一个…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kp ob"/></div></div></a></div><p id="36c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想知道，我在哪里用过这个功能。你可以看看我以前的帖子。</p><ul class=""><li id="b591" class="ml mm iq ky b kz la lc ld lf mz lj na ln nb lr ms mt mu mv bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/build-a-chess-tactics-app-with-react-part-1-49be01fc63b5">用React建立一个象棋战术应用(第一部分)</a></li><li id="f9d2" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ms mt mu mv bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/build-a-chess-tactics-app-with-react-part-2-35621640afd1">用React(第二部分)</a>打造一款象棋战术App</li><li id="d3d0" class="ml mm iq ky b kz nc lc nd lf ne lj nf ln ng lr ms mt mu mv bi translated"><a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/how-to-create-a-simple-chess-app-with-react-e18c0179b167">如何用React创建一个简单的象棋App</a></li></ul><p id="fbd1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望，我已经给了你开始编写单元测试的好例子。如果你喜欢，就鼓掌吧。</p><p id="efbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读，<br/>测试愉快。</p></div></div>    
</body>
</html>