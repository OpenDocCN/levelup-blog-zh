<html>
<head>
<title>All you need to know about SQS and Kinesis is Here</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你需要知道的关于SQS和Kinesis的一切都在这里</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/all-you-need-to-know-about-sqs-and-kinesis-is-here-33bfd699b9dd?source=collection_archive---------13-----------------------#2020-06-03">https://levelup.gitconnected.com/all-you-need-to-know-about-sqs-and-kinesis-is-here-33bfd699b9dd?source=collection_archive---------13-----------------------#2020-06-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/45a10da05d263e53a5fe0d4b7f33c6ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KpVGyRoU41Fze4KZ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><em class="kc">最初发表于</em><a class="ae kd" href="https://edward-huang.com/cloud/aws/devops/2020/05/30/all-you-need-to-know-about-sqs-and-kinesis-is-here/" rel="noopener ugc nofollow" target="_blank"><em class="kc">【https://edward-huang.com】</em></a><em class="kc">。</em></figcaption></figure><p id="daec" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在设计一个可靠的分布式系统或消息系统时，使用AWS资源时首先想到的是SQS和Kinesis。</p><p id="86e5" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">乍一看，Kinesis有一个比SQS更强大的功能。关于Kinesis的一点是它可以处理大量的数据；你可以重播消息，或者让多个消费者订阅你的Kinesis流。然而，Kinesis也是一个昂贵的工具，在学习开发Kinesis时有很多学习曲线。这也取决于你的应用，有时你在使用中不需要像Kinesis这样的大型提升工具，SQS会工作得非常好。</p><p id="8b11" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在这篇文章中，我想讨论Kinesis和SQS，向你展示Kinesis和SQS的优点和缺点。最后，我将深入探讨这两个系统之间的差异以及这两种服务的最佳用例。</p><h1 id="3e4c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">由外界刺激引起的不随意运动</h1><p id="7770" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">在有流数据管道或Kinesis之前，处理大数据应用的唯一方式是使用<a class="ae kd" href="https://www.7wdata.be/business-analytics/batch-vs-real-time-data-processing/" rel="noopener ugc nofollow" target="_blank">批处理</a>。</p><p id="6d08" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">生产者将聚合所有的文件，把它放入一个存储文件，或简单存储(S3)。然后，消费者将通过Cron作业进行批处理，即每天一次，来处理每一批新数据。</p><p id="d7c2" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这种大数据操作存在一个问题。使用批处理，您无法实时处理数据。需要实时分析的应用程序，如股票市场应用程序、欺诈检测甚至点击流，将总是处理过去的数据。</p><p id="2647" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">Kinesis stream是一个流管道，有助于在您的应用程序中创建实时数据流处理。</p><h1 id="b8cf" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">动力流的好处</h1><h1 id="996a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">多个消费者</h1><p id="f379" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">一旦生产者向管道发布了新数据，就可以立即从各种消费者那里使用这些数据。</p><p id="dd15" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">它提供了记录(数据)的排序，以及向多个消费者读取或重放相同顺序的能力。</p><p id="74ad" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">每个消费者在Kinesis迭代器分片中都有自己的检查点，用来跟踪他们在哪里消费数据。</p><p id="2d59" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有一个增强的扇出功能，每个用户可以接收自己的2MB/秒管道读取吞吐量。</p><h1 id="cf13" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">实时</h1><p id="38b5" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">Kinesis拥有最大的数据接收或处理吞吐量。当生产者将数据发布到Kinesis流时，消费者通常可以在不到一秒钟的时间内获得数据——不管您写了多少数据。</p><h1 id="9153" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">大数据</h1><p id="ff18" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">如果你需要每天在单个流中处理数兆字节的数据，Kinesis可以帮你做到。您可以推送来自许多数据生产者的数据，并存储以供以后处理或实时处理。</p><p id="3cf1" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">请注意，Kinesis默认存储记录24小时，最长可达168小时。</p><h1 id="d91d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">运动流的缺点</h1><h1 id="cafe" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">碎片管理</h1><p id="d414" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">您需要管理您的数据碎片。知道是否需要根据拥有的消费者数量来增加或减少碎片的数量。</p><h1 id="9869" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">复杂的消费者和生产者库</h1><p id="e8e9" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">为了获得最佳性能，Kinesis提供了消费者和生产者库。作为一个生产者库，您使用Java接口部署C++二进制文件，用于读写Kinesis流的数据记录。要添加消费者库，您需要实现一个可以与其他语言通信的Java应用程序。不管怎样，开发和维护这个库都需要一些时间。</p><h1 id="0f63" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">保持状态</h1><p id="8649" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">Kinesis允许它的每个消费者独立地从数据流中读取数据。它要求每个消费者管理自己在流中的迭代器/检查点，以及他们已经读取和处理了多远。如果您有多个消费者从Kinesis流中读取数据，那么消费者元数据将存储在DynamoDB中，您需要管理每个消费者的检查点，以便从Kinesis流中的每个碎片中读取数据。</p><h1 id="f75d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">简单队列服务(SQS)</h1><p id="153d" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">SQS有助于分离您的微服务和分布式系统。</p><p id="b1f3" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">使用SQS，您可以在任意数量的软件组件之间发送、存储或接收消息。您不需要担心组件上的任何数据丢失，也不需要服务始终可用。您可以通过将队列作为中间层在服务之间传输数据来单独扩展系统。您还可以让每个服务执行独立的功能，以提高系统的可伸缩性和可靠性。</p><h1 id="d79e" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">SQS的利益</h1><h1 id="de14" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">使用方便</h1><p id="deaf" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">用于SQS的AWS SDK易于使用。你不需要创建一个生产者或客户端库来与SQS互动。</p><h1 id="7ee5" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">读取吞吐量</h1><p id="3499" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">SQS可以快速扩展大量数据，无需用户干预。它允许您根据从队列中读取的任务量动态增加读取吞吐量。SQS缓冲处理负载峰值的请求。</p><h1 id="935a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">SQS的缺点</h1><h1 id="1af6" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">创建检查点</h1><p id="1fbf" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">如果没有和配置，则有AWS预设的延迟时间属性和可见性超时属性。</p><p id="1a40" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">延迟时间属性是从消息到达SQS到消费者看到消息的延迟时间。</p><p id="2d79" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">可见性超时是指当使用者读取消息时，在可见性超时过期之前，该消息对正在读取它的其他使用者不可见。消费者将再次看到该消息。</p><p id="3915" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">SQS不像Kinesis Stream那样有多个消费者，消息至少传递一次行为，消费者可能会收到重复的消息。</p><p id="b220" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">因此，最佳做法是在收到邮件后将其删除。</p><h1 id="c1c3" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">消息可重放性</h1><p id="f37b" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">因为消费者通常会在消息处理后将其删除，所以在SQS中没有消息可重放性。</p><p id="7f29" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">相比之下，Kinesis中的每个消费者都有其检查点，指向他们处理的最新记录，SQS为其所有消费者提供单个迭代器。</p><h1 id="1c16" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">SQS的使用案例</h1><p id="103a" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">如果您想要解耦您的软件组件或者将任务分配给多个工作人员，可以使用SQS。</p><p id="d490" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果您有任何具有大量后台任务的操作，您可以将后台任务发送到SQS，以从该服务中移除故障点。例如，在向DDB写信之前，需要在后台执行一个繁琐的过程。该服务无法同时处理大量的请求。因此，通过将每个应用程序放在SQS中，我们可以轻松处理显著的流量高峰，并且不需要担心服务中断时的数据丢失。此外，SQS有一个死信队列功能，如果14天没有处理，可以将数据存储在DLQ中。</p><h1 id="8110" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Kinesis的用例</h1><p id="dc0d" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">Kinesis可以帮助你实时传输数据。如果有多个消费者需要对数据进行分析，您可以将数据放在Kinesis管道中，让众多消费者从流中读取数据。</p><p id="5704" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">Kinesis最适合用于记录事件数据、实时分析、搜索功能或欺诈检测——多个消费者需要实时处理或处理的任何事情</p><h1 id="c5cd" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">摘要</h1><p id="95c1" class="pw-post-body-paragraph ke kf iq kg b kh ma kj kk kl mb kn ko kp mc kr ks kt md kv kw kx me kz la lb ij bi translated">在云中开发应用程序时，有各种各样的工具和资源。设计应用程序的注意事项是理解并研究应用程序的用例，并知道哪些工具适合什么目的。</p><p id="7c6c" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果您正在处理大量实时数据，或者需要让多个用户订阅这些数据，那么可以考虑Kinesis。如果没有，考虑一下SQS。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="f3d8" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="kg ir">感谢阅读！如果你喜欢这篇文章，请随意订阅我的时事通讯中的</strong><a class="ae kd" href="https://edward-huang.com/subscribe/" rel="noopener ugc nofollow" target="_blank"><strong class="kg ir"/></a><strong class="kg ir">来获取关于科技职业的文章、有趣的链接和内容！</strong></p><p id="0784" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你可以关注我，也可以在<a class="ae kd" href="https://medium.com/@edwardgunawan880" rel="noopener">媒体</a>上关注我，以获得更多类似的帖子。</p></div></div>    
</body>
</html>