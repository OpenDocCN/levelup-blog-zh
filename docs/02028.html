<html>
<head>
<title>Using The Ternary Operator And Nullish Coalescing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用三元运算符和零化合并</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/using-the-ternary-operator-and-nullish-coalescing-b315237770fa?source=collection_archive---------4-----------------------#2020-02-13">https://levelup.gitconnected.com/using-the-ternary-operator-and-nullish-coalescing-b315237770fa?source=collection_archive---------4-----------------------#2020-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e97c6ded5cdc1a0256d2f9799c4b4522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ka71g33KmxATP-c4"/></div></div></figure><p id="2bdc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们每天都在代码中使用条件语句——它是所有编程语言的基石。然而，如果一个值被立即赋值或返回，那么写出整个<strong class="ka ir"> IF ELSE </strong>语句可能会有点麻烦。有没有更简单的方法让我们写出这些条件句？让我们来看看<a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator" rel="noopener ugc nofollow" target="_blank">三进制算子</a>！</p><p id="aa58" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">三元运算符是写出条件的简便方法，主要用于“一行程序”。让我们看看这如何改善我们的生活，并使我们的代码更加简洁。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="3b49" class="lg lh iq lc b gy li lj l lk ll">const person = {<br/>  name: "Becky",<br/>  age: 23,<br/>  isStudent: null<br/>}</span><span id="dcbf" class="lg lh iq lc b gy lm lj l lk ll">// Cumbersome conditional for immediately assigning a value<br/>if (person.age &gt;= 18) {<br/>  person.isStudent = 'yes'<br/>} else {<br/>  person.isStudent = 'no'<br/>}</span><span id="fed8" class="lg lh iq lc b gy lm lj l lk ll">// The ternary operator is a lot more concise and returns the value<br/>person.isStudent = person.age &gt;= 18 ? 'yes' : 'no'</span></pre><p id="52ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面是一个非常简单的例子，说明了三元运算符如何将5行的常规<strong class="ka ir"> IF ELSE </strong>语句的开销最小化到一行代码中。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="b08c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">三元运算符的工作方式相当优雅。首先，我们有一个条件，后面跟一个<code class="fe lu lv lw lc b">?</code>，然后我们有第一个表达式，如果条件评估为真，则返回第一个表达式，然后是一个<code class="fe lu lv lw lc b">:</code>，如果评估为假，则返回第二个表达式。</p><p id="e991" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里需要注意的一点是，IF是一个语句，而三元运算符是一个表达式，它返回一个值，这对于压缩代码非常有用。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="0b48" class="lg lh iq lc b gy li lj l lk ll">conditional ? truthyExpression : falsyExpression</span></pre><p id="5f69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">值得注意的是，在计算条件时，如果值还不是布尔值，JavaScript将使用类型转换将它强制转换为布尔值。这意味着一些值将被评估为<em class="lx">真值</em>或<em class="lx">假值</em>。</p><p id="8261" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lx">注意:JS中的以下值求值为falsy → false，null，0，0n，“”，“”，`，undefined，NaN。</em> <a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Glossary/Falsy" rel="noopener ugc nofollow" target="_blank"> <em class="lx">在这里阅读更多关于falsy值的内容</em> </a> <em class="lx">。</em></p><p id="37d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这实质上意味着，与典型的条件一样，您可以使用三元运算符来确定某个值是否存在。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="414f" class="lg lh iq lc b gy li lj l lk ll">person.name ? 'Name exists' : 'Unknown person'</span></pre></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><h1 id="5c8c" class="ly lh iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">TypeScript带来了什么？</h1><p id="8596" class="pw-post-body-paragraph jy jz iq ka b kb mv kd ke kf mw kh ki kj mx kl km kn my kp kq kr mz kt ku kv ij bi translated">然而，在TypeScript中，我们有一个额外的功能，其功能与三元运算符非常相似，称为<a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing" rel="noopener ugc nofollow" target="_blank"> nullish合并</a>，它是在TypeScript的3.7版本中引入的。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="b8fa" class="lg lh iq lc b gy li lj l lk ll">conditional ?? fallbackExpression</span></pre><p id="c5e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么，nullish同余与普通的三元运算符有什么不同呢？最根本的区别是，它会检查一个值是否存在。如果该值存在，即不是<code class="fe lu lv lw lc b">null</code>或<code class="fe lu lv lw lc b">undefined</code>，则将返回该值。如果该值不存在，将返回“fallback”。让我们仔细看看这个。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="fe0f" class="lg lh iq lc b gy li lj l lk ll">const person = {<br/>  name: 'Becky',<br/>  gender: null<br/>}</span><span id="3e43" class="lg lh iq lc b gy lm lj l lk ll">// Value is present<br/>const name = person.name ?? 'Unknown person'<br/>console.log(name)<br/>&gt; Becky</span><span id="2e91" class="lg lh iq lc b gy lm lj l lk ll">// Value is not present<br/>const gender = person.gender ?? 'Unknown gender'<br/>console.log(gender)<br/>&gt; Unknown gender</span></pre><p id="3753" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的例子中，当<code class="fe lu lv lw lc b">name</code>属性存在时，它将被返回，在本例中，它被注销到控制台。然而，由于<code class="fe lu lv lw lc b">gender</code>不存在，因此返回“回退”并记录到控制台。这真是太棒了！</p><p id="e6c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="http://www.typescriptlang.org/play/#code/MYewdgzgLgBADgUwE4XDAvDA3gKBvmMAQwFsEAuGAcgCEFgBrATyoBo8CBzBMAE2UpgArgBsROAL44cAehkwAakRFCE8JAgg8oOUJBAiEAOhEhOACkQpwR4mRgB+B9QCqYBmBAB3MIVIIqAEppOUVlVUIQWDgNLTAdPVRDEzNLZFQwI24+ZEdnKjcPb19s-iQgnCA" rel="noopener ugc nofollow" target="_blank">这个你可以自己实验！</a></p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2e64ff03b946be1cf6a8d32f84288ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TkFuLrkiPuBT_-J0"/></div></div></figure><p id="aab6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用三元运算符时，我们可以像在条件运算符中一样调用函数。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="59f3" class="lg lh iq lc b gy li lj l lk ll">const name = person.name ? foo() : bar()</span></pre><p id="8674" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的例子中，如果<code class="fe lu lv lw lc b">name</code>属性存在于<code class="fe lu lv lw lc b">person</code>对象上并且评估为真，那么<code class="fe lu lv lw lc b">foo()</code>函数将被调用，其结果将被存储在<code class="fe lu lv lw lc b">name</code>变量中。同样，如果<code class="fe lu lv lw lc b">name</code>属性的计算结果为falsy，那么<code class="fe lu lv lw lc b">bar()</code>函数将被调用并返回。</p><p id="e64c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">nullish合并也会发生这种情况，如果正在计算的属性没有定义，我们可以使用函数调用作为“后备”。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="759f" class="lg lh iq lc b gy li lj l lk ll">const name = person.name ?? foo()</span></pre><p id="978a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这非常有用，肯定会使代码更容易阅读和维护。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="4724" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以考虑一个稍微复杂一点的例子。考虑下面的场景，一个有两个需求需要满足的条件。我们如何用三进制写这个？</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="0bbb" class="lg lh iq lc b gy li lj l lk ll">const foo = person.isStudent &amp;&amp; person.age &lt;= 24 ? 'yes' : 'no'</span></pre><p id="aa66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面将检查这个人是24岁或更小的学生。如果我们愿意的话，我们还可以潜在地加入一些战术括号，使事情更容易区分。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="f9e9" class="lg lh iq lc b gy li lj l lk ll">const foo = (person.isStudent) &amp;&amp; (person.age &lt;= 24) ? 'yes' : 'no'</span></pre><p id="663d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这两个例子之间没有功能上的变化。唯一的变化是语法上的，为了增强未来开发人员的可读性，他们可能会在维护代码库的同时遇到这个代码片段。</p><p id="1a1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以进行的进一步优化是将条件提取到它自己的变量中。这样可以使检查的目的更明确，例子更简洁。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="194a" class="lg lh iq lc b gy li lj l lk ll">// Define the condition<br/>const isJuniorStudent = person.isStudent &amp;&amp; person.age &lt;= 24</span><span id="4335" class="lg lh iq lc b gy lm lj l lk ll">// Evaluate the condition<br/>const foo = isJuniorStudent ? 'yes' : 'no'</span></pre><p id="d866" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于下一个需要维护该功能的开发人员来说，这可能更容易理解。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="e4d1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们有一些嵌套的条件句呢？这会改变写出三元运算符的方式吗？有点，但它的核心基本保持不变。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="d7ba" class="lg lh iq lc b gy li lj l lk ll">const foo = person.isStudent ? (person.isFullTime ? 'yes' : 'no') : 'maybe'</span></pre><p id="3b04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在基本示例中，我们看到，如果这个人是学生并且在全日制学习，那么表达式的计算结果为<code class="fe lu lv lw lc b">yes</code>，而如果这个人是学生但是没有全日制学习，那么<code class="fe lu lv lw lc b">no</code>就是返回的响应。如果不知道这个人是不是学生，那么返回<code class="fe lu lv lw lc b">maybe</code>。</p><p id="f4eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这相当于一个常规条件，如下所示。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="cf31" class="lg lh iq lc b gy li lj l lk ll">let foo</span><span id="3204" class="lg lh iq lc b gy lm lj l lk ll">if (person.isStudent) {<br/>  if (person.isFullTime) {<br/>    foo = 'yes'<br/>  } else {<br/>    foo = 'no'<br/>  }<br/>} else {<br/>  foo = 'maybe'<br/>}</span></pre><p id="5275" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，在某种程度上，速记函数可能变得比传统方法更加繁琐和复杂，难以维护和阅读。在编写一些更复杂的简写条件时，应该仔细考虑可维护性和可读性。</p><p id="2053" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就我个人而言，我会将速记条件分解成命名变量，然后构建一个结果。这将使用三元运算符，但也有助于保持代码的可读性和可维护性。</p><pre class="kx ky kz la gt lb lc ld le aw lf bi"><span id="7792" class="lg lh iq lc b gy li lj l lk ll">// Determines if full time student or not<br/>const isFullTime = person.isFullTime ? 'yes' : 'no'</span><span id="2c77" class="lg lh iq lc b gy lm lj l lk ll">const foo = person.isStudent ? isFullTime : 'maybe'</span></pre></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/22862130af058f47a3a47472254d88b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s5GJhcbMPTmiS5Pj"/></div></div></figure><h1 id="82f7" class="ly lh iq bd lz ma nb mc md me nc mg mh mi nd mk ml mm ne mo mp mq nf ms mt mu bi translated">最后，有什么有用的工具吗？</h1><p id="5865" class="pw-post-body-paragraph jy jz iq ka b kb mv kd ke kf mw kh ki kj mx kl km kn my kp kq kr mz kt ku kv ij bi translated">我很高兴我们问了这个问题，因为碰巧的是，确实有。首先，有一些令人惊奇的资源，它们可能涵盖了你仍然可能有的关于三元运算符或零化合并函数的任何问题。您可以在下面找到这些资源。</p><p id="cd32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="http://www.typescriptlang.org/play/" rel="noopener ugc nofollow" target="_blank">打字稿游乐场</a> <br/> <a class="ae kw" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing" rel="noopener ugc nofollow" target="_blank">打字稿— v3.7 </a></p><p id="95fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://jsfiddle.net/" rel="noopener ugc nofollow" target="_blank">js dild</a><br/><a class="ae kw" href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Conditional_Operator" rel="noopener ugc nofollow" target="_blank">MDN—三元运算符</a></p><p id="6cf2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢你阅读这篇文章，我希望你学到了一些新的东西。如果你有任何意见，请随意写在下面的评论区！</p><p id="1443" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再见了。</p></div></div>    
</body>
</html>