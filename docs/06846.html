<html>
<head>
<title>Build a Chess Tactics App with React (Part 2): Using a Chess Tactics API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用React构建象棋战术应用程序(第2部分):使用象棋战术API</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/build-a-chess-tactics-app-with-react-part-2-35621640afd1?source=collection_archive---------10-----------------------#2021-01-07">https://levelup.gitconnected.com/build-a-chess-tactics-app-with-react-part-2-35621640afd1?source=collection_archive---------10-----------------------#2021-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c9d4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从头做起</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/089588ba4bb2e77336d1cec98bfaed37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bo3qawt5qlR_ZW6zLOrkEg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@eliapelle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Elia Pellegrini </a>在<a class="ae kv" href="https://unsplash.com/s/photos/chess?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="750d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/build-a-chess-tactics-app-with-react-part-1-49be01fc63b5">上一篇文章</a>中，我们为我们的战术应用程序创建了核心组件。在这种情况下，我们将通过将应用程序插入API服务并显示移动反馈来完成应用程序。</p><p id="a531" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们开始之前，让我们再看一看在帖子的结尾我们会有什么。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/d72ebb26d99c5feeb48b57173c76de52.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/1*yxlEeQWnBZR4Hp3wPqD0DA.gif"/></div></figure><p id="3c63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有这里是<a class="ae kv" href="https://varunpvp.github.io/tactics-trainer/" rel="noopener ugc nofollow" target="_blank"> app链接</a>，如果你想试试的话。</p><h2 id="1566" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">API服务</h2><p id="d4f4" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">我们将使用<a class="ae kv" href="https://chessblunders.org/api" rel="noopener ugc nofollow" target="_blank">chesblunders</a>的<code class="fe mr ms mt mu b">/api/blunder/get</code> api端点从api获取随机策略。要进行api调用，我们需要axios。让我们安装axios。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="3bd7" class="lt lu iq mu b gy mz na l nb nc">yarn add axios</span></pre><p id="c82a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们已经安装了axios。让我们写一个函数来获取策略。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4f95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我通过<a class="ae kv" href="https://github.com/Rob--W/cors-anywhere" rel="noopener ugc nofollow" target="_blank"> cors-anywhere </a>代理chessbulunder api调用，以避免任何cors问题。并从env中选择url。</p><p id="806e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">加载响应后。我们将响应数据转换为<code class="fe mr ms mt mu b">Tactic</code>类型。</p><p id="f590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们换成<code class="fe mr ms mt mu b">App.tsx</code>，让它与我们的api服务一起工作。</p><p id="31c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，删除我们为测试应用程序而添加的硬编码策略。</p><p id="6c24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要做三件事。</p><ul class=""><li id="c27d" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">创建一个函数调用<code class="fe mr ms mt mu b">loadTactic</code>，它将获取策略并将其添加到我们的<code class="fe mr ms mt mu b">tactics</code>数组中。</li><li id="6a34" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">A <code class="fe mr ms mt mu b">useEffect</code>调用<code class="fe mr ms mt mu b">loadTactic</code>从api加载战术。</li><li id="fb3b" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">在<code class="fe mr ms mt mu b">TacticBoard</code>的<code class="fe mr ms mt mu b">onSolve</code>回调中，将从<code class="fe mr ms mt mu b">tactics</code>数组中删除第一个战术。并调用<code class="fe mr ms mt mu b">loadTactic</code>加载下一个战术。</li></ul><p id="6cad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是修改后的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b082" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你看到，我在<code class="fe mr ms mt mu b">useEffect</code>中调用了<code class="fe mr ms mt mu b">loadTactic</code>两次。这是为了确保我们已经准备好下一个策略，而用户正在解决当前的一个。</p><p id="59ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样，我们应该通过从api服务获取策略来让我们的应用程序工作。</p><h2 id="d947" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">移动反馈</h2><p id="52bd" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">我们的应用程序正在运行。但是它没有向用户显示任何反馈。比如哪一方该上场，战术解决，正确或不正确的移动。</p><p id="ab59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们来补充一下。你看，我们的反馈用户界面有4种状态</p><ul class=""><li id="7d92" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">一边玩</li><li id="58e6" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">策略解决</li><li id="a9f9" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">错误的移动</li><li id="7461" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">正确的移动</li></ul><p id="15d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要创建一个状态变量来保存反馈UI的状态。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="28d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并在渲染<code class="fe mr ms mt mu b">TacticBoard</code>组件之前将下面的代码添加到<code class="fe mr ms mt mu b">App.tsx</code>中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0bc3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了简单起见，我在<code class="fe mr ms mt mu b">App.css</code>中添加了css样式。可以在<a class="ae kv" href="https://github.com/varunpvp/tactics-trainer" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到。</p><p id="9693" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们差不多完成了。需要做4件小事。</p><ol class=""><li id="dd5a" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nt nl nm nn bi translated">在<code class="fe mr ms mt mu b">onCorrect</code>回调。我们需要将提示设置为<code class="fe mr ms mt mu b">correct</code>和<code class="fe mr ms mt mu b">setTimeout</code>1秒，以将其设置回<code class="fe mr ms mt mu b">sideToPlay</code>。</li><li id="cb23" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nt nl nm nn bi translated">在<code class="fe mr ms mt mu b">onIncorrect</code>回调。我们确实喜欢<code class="fe mr ms mt mu b">onCorrect</code>，但是将提示设置为<code class="fe mr ms mt mu b">incorrect</code>而不是<code class="fe mr ms mt mu b">correct</code>。</li><li id="e9f1" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nt nl nm nn bi translated">在<code class="fe mr ms mt mu b">onSolve</code>回调中。我们将把提示设置为<code class="fe mr ms mt mu b">solved</code>。</li><li id="f59d" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nt nl nm nn bi translated">在<code class="fe mr ms mt mu b">loadTactic</code>中，何时完成战术的加载。我们将把提示设置为<code class="fe mr ms mt mu b">sideToPlay</code>。</li></ol><p id="9f13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，一切就绪。这就是我们最终代码的样子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="56a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经运行了应用程序的最终版本。</p><p id="c259" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以添加许多其他很酷的东西。像正确或不正确的移动声音，战术计时器，跳过当前战术和改善用户界面等。</p><p id="5c43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我就说到这里。如果你有任何想法或改进。欢迎你做出改变。这里是<a class="ae kv" href="https://github.com/varunpvp/tactics-trainer" rel="noopener ugc nofollow" target="_blank"> Github回购</a></p><div class="nu nv gp gr nw nx"><a href="https://github.com/varunpvp/tactics-trainer" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">varunvpp/战术训练员</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">一个应用程序来训练你的国际象棋战术技能。通过创建以下帐户，为varunvpp/战术培训师的发展做出贡献…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol kp nx"/></div></div></a></div><p id="0fe6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是<a class="ae kv" href="https://varunpvp.github.io/tactics-trainer/" rel="noopener ugc nofollow" target="_blank">应用</a>最终版本的链接。</p><div class="nu nv gp gr nw nx"><a href="https://varunpvp.github.io/tactics-trainer/" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">象棋战术训练器</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">一个训练你国际象棋战术技能的应用程序</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">varunvpp . github . io</p></div></div></div></a></div><p id="8856" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你们喜欢它，并发现它很有用。如果是的话，给它一个掌声。</p><p id="0153" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>