<html>
<head>
<title>Adding Graphics to a Vue App with D3 — Line Graph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用D3向Vue应用添加图形—线图</h1>
<blockquote>原文：<a href="https://levelup.gitconnected.com/adding-graphics-to-a-vue-app-with-d3-line-graph-2caa1b2f2a14?source=collection_archive---------9-----------------------#2021-01-31">https://levelup.gitconnected.com/adding-graphics-to-a-vue-app-with-d3-line-graph-2caa1b2f2a14?source=collection_archive---------9-----------------------#2021-01-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f66d194ea0622a8e6f92371c21096d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*huBWCSnAnc91vTvt"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">克里斯托弗·伯恩斯在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="96ae" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">图表</h1><p id="66ec" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们可以用D3给我们的Vue应用添加图表。</p><p id="8787" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">例如，我们可以写:</p><p id="f543" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><code class="fe mh mi mj mk b">public/data.csv</code></p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="08c0" class="mt kh it mk b gy mu mv l mw mx">year,population<br/>2006,20<br/>2008,35<br/>2010,48<br/>2012,51<br/>2014,63<br/>2016,23<br/>2017,42</span></pre><p id="603f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><code class="fe mh mi mj mk b">App.vue</code></p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="5bdb" class="mt kh it mk b gy mu mv l mw mx">&lt;template&gt;<br/>  &lt;div id="app"&gt;&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>import * as d3 from "d3";<br/>import Vue from "vue";</span><span id="e37e" class="mt kh it mk b gy my mv l mw mx">export default {<br/>  name: "App",<br/>  mounted() {<br/>    Vue.nextTick(async () =&gt; {<br/>      const margin = { top: 20, right: 20, bottom: 30, left: 50 },<br/>        width = 960 - margin.left - margin.right,<br/>        height = 500 - margin.top - margin.bottom;</span><span id="8ce4" class="mt kh it mk b gy my mv l mw mx">      const x = d3.scaleTime().range([0, width]);<br/>      const y = d3.scaleLinear().range([height, 0]);</span><span id="111e" class="mt kh it mk b gy my mv l mw mx">      const valueline = d3<br/>        .line()<br/>        .x(function (d) {<br/>          return x(d.year);<br/>        })<br/>        .y(function (d) {<br/>          return y(d.population);<br/>        });</span><span id="eb7a" class="mt kh it mk b gy my mv l mw mx">      const svg = d3<br/>        .select("body")<br/>        .append("svg")<br/>        .attr("width", width + margin.left + margin.right)<br/>        .attr("height", height + margin.top + margin.bottom)<br/>        .append("g")<br/>        .attr("transform", `translate(${margin.left}, ${margin.top})`);</span><span id="2b8d" class="mt kh it mk b gy my mv l mw mx">      const data = await d3.csv("/data.csv");</span><span id="9ef3" class="mt kh it mk b gy my mv l mw mx">      data.forEach(function (d) {<br/>        d.population = +d.population;<br/>      });</span><span id="86e3" class="mt kh it mk b gy my mv l mw mx">      x.domain(<br/>        d3.extent(data, function (d) {<br/>          return d.year;<br/>        })<br/>      );</span><span id="2fe4" class="mt kh it mk b gy my mv l mw mx">      y.domain([<br/>        0,<br/>        d3.max(data, function (d) {<br/>          return d.population;<br/>        }),<br/>      ]);</span><span id="daf5" class="mt kh it mk b gy my mv l mw mx">      svg<br/>        .append("path")<br/>        .data([data])<br/>        .attr("class", "line")<br/>        .attr("d", valueline);</span><span id="d3ce" class="mt kh it mk b gy my mv l mw mx">      svg<br/>        .append("g")<br/>        .attr("transform", `translate(0, ${height})`)<br/>        .call(d3.axisBottom(x));</span><span id="a54b" class="mt kh it mk b gy my mv l mw mx">      svg.append("g").call(d3.axisLeft(y));<br/>    });<br/>  },<br/>};<br/>&lt;/script&gt;</span><span id="63da" class="mt kh it mk b gy my mv l mw mx">&lt;style&gt;<br/>.line {<br/>  fill: none;<br/>  stroke: green;<br/>  stroke-width: 5px;<br/>}<br/>&lt;/style&gt;</span></pre><p id="a75c" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们有在<code class="fe mh mi mj mk b">public/data.csv</code>读到的数据。</p><p id="f87c" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后我们通过创建宽度和高度的常量来创建图形。/</p><p id="e84a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后我们添加<code class="fe mh mi mj mk b">x</code>和<code class="fe mh mi mj mk b">y</code>轴对象:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="2f6b" class="mt kh it mk b gy mu mv l mw mx">const margin = {<br/>    top: 20,<br/>    right: 20,<br/>    bottom: 30,<br/>    left: 50<br/>  },<br/>  width = 960 - margin.left - margin.right,<br/>  height = 500 - margin.top - margin.bottom;</span><span id="8ddb" class="mt kh it mk b gy my mv l mw mx">const x = d3.scaleTime().range([0, width]);<br/>const y = d3.scaleLinear().range([height, 0]);</span></pre><p id="f015" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后，我们通过编写以下内容为x轴和y轴创建线对象:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="7f4a" class="mt kh it mk b gy mu mv l mw mx">const valueline = d3<br/>  .line()<br/>  .x(function(d) {<br/>    return x(d.year);<br/>  })<br/>  .y(function(d) {<br/>    return y(d.population);<br/>  });</span></pre><p id="f5f1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后，我们将SVG添加到<code class="fe mh mi mj mk b">body</code>中，方法是:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="35c3" class="mt kh it mk b gy mu mv l mw mx">const svg = d3<br/>  .select("body")<br/>  .append("svg")<br/>  .attr("width", width + margin.left + margin.right)<br/>  .attr("height", height + margin.top + margin.bottom)<br/>  .append("g")<br/>  .attr("transform", `translate(${margin.left}, ${margin.top})`);</span></pre><p id="7cc7" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后，我们通过写入来读入我们想要显示的数据:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="a840" class="mt kh it mk b gy mu mv l mw mx">const data = await d3.csv("/data.csv");</span></pre><p id="aa09" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来，我们通过将<code class="fe mh mi mj mk b">population</code>转换成数字来转换读取的数据:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="82b6" class="mt kh it mk b gy mu mv l mw mx">data.forEach(function(d) {<br/>  d.population = +d.population;<br/>});</span></pre><p id="b615" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后我们添加回调来返回x和y轴的数据:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="8f5a" class="mt kh it mk b gy mu mv l mw mx">x.domain(<br/>  d3.extent(data, function(d) {<br/>    return d.year;<br/>  })<br/>);</span><span id="3b4e" class="mt kh it mk b gy my mv l mw mx">y.domain([<br/>  0,<br/>  d3.max(data, function(d) {<br/>    return d.population;<br/>  }),<br/>]);</span></pre><p id="d06b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后，我们使用以下内容为折线图创建线条:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="5f7d" class="mt kh it mk b gy mu mv l mw mx">svg<br/>  .append("path")<br/>  .data([data])<br/>  .attr("class", "line")<br/>  .attr("d", valueline);</span></pre><p id="8953" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">最后，我们将x轴和y轴相加:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="6a60" class="mt kh it mk b gy mu mv l mw mx">svg<br/>   .append("g")<br/>   .attr("transform", `translate(0, ${height})`)<br/>   .call(d3.axisBottom(x));</span><span id="3ab8" class="mt kh it mk b gy my mv l mw mx">svg.append("g").call(d3.axisLeft(y));</span></pre><p id="0f32" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们必须添加一些样式来移除线条的宽度并设置线条的粗细:</p><pre class="ml mm mn mo gt mp mk mq mr aw ms bi"><span id="8838" class="mt kh it mk b gy mu mv l mw mx">&lt;style&gt;<br/>.line {<br/>  fill: none;<br/>  stroke: green;<br/>  stroke-width: 5px;<br/>}<br/>&lt;/style&gt;</span></pre><p id="60d5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在我们应该会看到一个折线图。</p><h1 id="bcd4" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="96aa" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们可以在我们的Vue应用程序中添加一个带有D3的线图。</p></div></div>    
</body>
</html>